
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Parametric Statistical Models &#8212; The Principles of Statistical Modelling</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '3.stat-models';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Maximum Likelihood Estimation" href="4.maximum-likelihood.html" />
    <link rel="prev" title="Probability and Random Variables" href="2.prob-random-vars.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="The Principles of Statistical Modelling - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="The Principles of Statistical Modelling - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.understanding-variance.html">Understanding Variance</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.prob-random-vars.html">Probability and Random Variables</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Parametric Statistical Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.maximum-likelihood.html">Maximum Likelihood Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.classical-inference.html">Classical Statistical Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCHN63101-Advanced-Data-Skills/principles-stat-modelling" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCHN63101-Advanced-Data-Skills/principles-stat-modelling/issues/new?title=Issue%20on%20page%20%2F3.stat-models.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/3.stat-models.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Parametric Statistical Models</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-a-model">Defining a Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parametric-models">Parametric Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-analogy-of-the-shadow">The Analogy of the Shadow</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#elements-of-a-model">Elements of a Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-population-distribution">The Population Distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-mean-function">The Mean Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-variance-function">The Variance Function</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-modelling-process">The Modelling Process</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-models-and-the-normal-distribution">Linear Models and the Normal Distribution</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="parametric-statistical-models">
<h1>Parametric Statistical Models<a class="headerlink" href="#parametric-statistical-models" title="Link to this heading">#</a></h1>
<p>In the previous section, we saw how a probability distribution can be used as a <em>model</em> of the data-generating process. We will now take this idea a little further to understand the notion of a <em>parametric statistical model</em>. This is a foundational idea that captures the vast majority of statistical analyses we will learn about on this course. This is the framework upon which we will be building and will provide the structure to see all statistical analyses as part of a very general whole. This is where we take a step away from statistics being a “bag of tricks” and instead view statistical analyses as many specialisations of the same idea.</p>
<section id="defining-a-model">
<h2>Defining a Model<a class="headerlink" href="#defining-a-model" title="Link to this heading">#</a></h2>
<figure class="align-right">
<a class="reference internal image-reference" href="_images/toy-train.jpg"><img alt="_images/toy-train.jpg" src="_images/toy-train.jpg" style="width: 251.60000000000002px; height: 367.6px;" /></a>
</figure>
<p>To begin with, we should make sure we are clear on what a <em>model</em> is. Much like the more general use of the word, a <em>model</em> is a representation of reality, but usually one that represents a <em>simplification</em> of a reality. A model train is not a train, it is a simplified representation of a train. It can perform the basic operations of train (i.e. moving along a track), but it cannot fulfill all the same duties as a real train. Nevertheless, the model capture something <em>fundamental</em> about a train, even if it is not exactly the same.</p>
<p>In much the same way, a <em>mathematical model</em> is a representation of reality that is a <em>simplification</em> but, we hope, captures something <em>fundamental</em> about reality. In order to do so, the model must be able to explain the data we can observe, but also make predictions that can be tested. We have already seen how a probability distribution can achieve this. We can explain the variation that we see in real data via the distribution’s shape and scale, which are controlled by the expected value and variance of the distribution. We can also make future predictions via reference to the expected value, with the variance telling us how accurate these prediction will be.</p>
<section id="parametric-models">
<h3>Parametric Models<a class="headerlink" href="#parametric-models" title="Link to this heading">#</a></h3>
<p>You may already be familiar with the notion of a <em>parametric</em> statistical model. On this course, we will mostly be concerned with parametric models, as these are the most widely used and (if their assumptions are true) the most powerful. In essence, this form of model uses a probability distribution to represent the <em>population</em> from which we are sampling our data. The parameters of this distribution are considered <em>constants</em>. This means that they do not change across different samples and their values are fixed in place. In this way, we see them as representing some ultimate truth of nature<a class="footnote-reference brackets" href="#constant-foot" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. The general aim of any experiment is to gather enough samples so that we can estimate these population parameters with some degree of accuracy. Hence, the aim of <em>parametric</em> statistical methods is to estimate the values of the <em>parameters of the population distribution</em>. The term is therefore intimately tied to the notion of the <em>parameters</em> of a probability distribution. For instance, if a parametric method assumes a normal distribution, then our general aim is to estimate the values of the <em>mean</em> and <em>variance</em>.</p>
</section>
<section id="the-analogy-of-the-shadow">
<h3>The Analogy of the Shadow<a class="headerlink" href="#the-analogy-of-the-shadow" title="Link to this heading">#</a></h3>
<p>One way of understanding the basic principles of a statistical model is using the analogy of an object casting a shadow. The object is the thing we are most interested in observing, however, we can only learn about its shape and dimensions by studying its shadow. As the sun moves through the sky, the shadow changes. Because of this, each time we study the shadow some elements will be slightly different. Furthermore, the shadow is not a perfect representation of the object, it is distorted and will not be able to represent all the complexity of the object in question. However, if we take enough observations of the shadow we should be able to reach some reasonable conclusions about the object casting the shadow. In this analogy, the object is the population we are trying to study, whereas the shadow is the data we sample.</p>
<p>Although we cannot directly observe the object, we can learn about it by studying the shadow. However, this is a very difficult task, particularly if the object in question is some complex 3D shape (like a statue or sculpture). In order to make this easier, we make some simplifying assumption about its shape. Say, we assume the object can be represented by a cylinder. This is our <em>model</em> of the object. Much like a probability distribution, we know this is a simplification, but we hope it will be close enough to be <em>useful</em>. By doing so, we reduce what we want to learn about the object to its <em>radius</em> and <em>height</em>, as this is all we need to calculate many different properties of a cylinder. From there, we use multiple observations of the shadow to estimate what the radius and height might be. Once we are confident we have a good estimate of these parameters, we can complete our model and reach conclusions about the general dimensions of the object.</p>
<figure class="align-left">
<a class="reference internal image-reference" href="_images/shadow-analogy.png"><img alt="_images/shadow-analogy.png" src="_images/shadow-analogy.png" style="width: 430.8px; height: 430.2px;" /></a>
</figure>
<p>We could, of course, choose a more complex model to represent the object in an attempt to learn about more of its subtle geometric properties. As we work through this course, much of what we will be learning is increasing model complexity designed to capturing more subtle elements of the population in question. We will start with simple models and then increae the complexity, like going from a basic cylinder to a complex 3D mesh of polygons. With greater complexity comes greater difficulty in estimating the parameters and greater difficulty in understanding the model. However, the aim is to do a better job of capturing the population without making too many simplifications. This is the art of <em>model building</em>. We desire a model that is complex enough to accurately capture the elements of the population that are of most interest, but no more. We do not expect a model to be <em>perfect</em>, but we do want it to have some utility in answering our experimental questions, a sentiment echoed in a famous quote by <a class="reference external" href="https://en.wikipedia.org/wiki/George_E._P._Box">George Box</a>.</p>
<blockquote class="epigraph">
<div><p>All models are wrong, but some are useful.</p>
<p class="attribution">—George E. P. Box</p>
</div></blockquote>
</section>
</section>
<section id="elements-of-a-model">
<h2>Elements of a Model<a class="headerlink" href="#elements-of-a-model" title="Link to this heading">#</a></h2>
<p>Now that we have more of a sense of what a model is, let us talk more specifically about the elements that make up a statistical model. This will be a bit abstract at the moment, but will make more sense when we start to see this used in the coming weeks.</p>
<section id="the-population-distribution">
<h3>The Population Distribution<a class="headerlink" href="#the-population-distribution" title="Link to this heading">#</a></h3>
<p>The first element of a parametric statistical model is the assumed distribution for the population. As we will come to see, many statistical methods are designed around assuming that our outcome is a <em>continuous random variable</em> that is drawn from a <em>normal distribution</em>. We will stick to this assumption for the remainder of this unit, but just note that this is not the <em>only</em> distribution we could assume for our population. Statistical theory is much more general than just the normal distribution. However, for ease, we will keep this assumption in place. As such, we will assume that</p>
<div class="math notranslate nohighlight">
\[
y_{i} \sim \mathcal{N}\left(\mu,\sigma^{2}\right).
\]</div>
<p>This is much the same as we have seen already. However, we need to also consider how we take <em>other variables</em> into account. Typically, an experiment does not involve just measuring a single variable. Instead, we are interested in the relationship between our measurements and other variables that we either actively manipulate or measure simultaneously. Our variable of primary interest is known as the <em>outcome variable</em>, whereas any other variables that we believe are related to the outcome are known as <em>predictor</em> variables. For example, within the <code class="docutils literal notranslate"><span class="pre">mtcars</span></code> dataset we can consider <code class="docutils literal notranslate"><span class="pre">mpg</span></code> as our outcome variable with <code class="docutils literal notranslate"><span class="pre">wt</span></code> (<em>weight</em>) and <code class="docutils literal notranslate"><span class="pre">hp</span></code> (<em>horsepower</em>) as our predictor variables. In notation, we refer to our outcome as <span class="math notranslate nohighlight">\(y\)</span> and our predictors as <span class="math notranslate nohighlight">\(x\)</span>. Our assumption is then that the value of our <em>outcome</em> is some function of our <em>predictors</em>, plus error</p>
<div class="math notranslate nohighlight">
\[
y = f(\mathbf{x}) + \epsilon,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> refers to all <span class="math notranslate nohighlight">\(k\)</span> predictor variables (i.e. <span class="math notranslate nohighlight">\(\mathbf{x} = \left\{x_{1}, x_{2}, x_{3}, \dots, x_{k}\right\}\)</span>). This is just a formal way of saying that we assume that there is some <em>connection</em> between our outcome and our predictors. The actual form of this connection is not known, but we assume it exists (otherwise, why did we conduct the experiment in the first place?)</p>
<div class="tip admonition">
<p class="admonition-title">Variable Terminology</p>
<p>Within this lesson, we have used the terms <em>outcome</em> and <em>predictor</em> variables. However, you may already know these by different names. Within psychology, the outcome variable is more commonly known as the <em>dependent</em> variable (or DV), with the predictor variables more commonly known as the <em>independent</em> variables (or IVs). We have avoided these terms for two main reasons. Firstly, IV and DV are not as commonly used within the statistical literature and tend to only be used by psychologists. As such, it is helpful to get used to slightly different language. Secondly, the terms <em>dependent</em> and <em>independent</em> tend to be used in relation to whether variables are <em>correlated</em> and thus it is confusing to refer to independent dependent variables, or dependent independent variables. The terms <em>outcome</em> and <em>predictor</em> are also much more descriptive. We measure the outcome variable as the <em>outcome of our experiment</em> and we assume that the predictor variables can be used to <em>predict the value of the outcome</em>. In this way, it can be easier to remember the meaning and role of each type of variable, rather than using the slightly ambiguous terms <em>dependent</em> and <em>independent</em>.</p>
</div>
<p>In order to do this, we should define some terminology first. …</p>
<div class="math notranslate nohighlight">
\[
y_{i}|\mathbf{x}_{i} \sim \mathcal{N}\left(E(y_{i}|\mathbf{x}_{i}),\text{Var}(y_{i}|\mathbf{x}_{i})\right).
\]</div>
<p>This is a bit messy and the dependence of <span class="math notranslate nohighlight">\(y\)</span> on the values of <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> is usually taken <em>implicitly</em>, rather than written directly in the notation (to make things easier to read). However, there is no harm being a bit more precise here for the moment..</p>
<p>So, this is saying that the distribution of <span class="math notranslate nohighlight">\(y\)</span>, given some values of the predictor variables, is a normal distribution with a mean given by the mean function <span class="math notranslate nohighlight">\(E(y_{i}|\mathbf{x}_{i})\)</span> and a variance given by the variance function <span class="math notranslate nohighlight">\(\text{Var}(y_{i}|\mathbf{x}_{i})\)</span>. Because the output of these functions depends upon the values of the predictor variables, this implies that, across all values of <span class="math notranslate nohighlight">\(y\)</span>, the general form of the distribution stays the same, but both the <em>mean</em> and the <em>variance</em> can change. Although somewhat abstract at present, we will see how this allows us to accommodate the relationship between our outcome and our predictor variables into the model.</p>
</section>
<section id="the-mean-function">
<h3>The Mean Function<a class="headerlink" href="#the-mean-function" title="Link to this heading">#</a></h3>
<p>The simplest form is when we have <em>no</em> predictor variables and thus</p>
<div class="math notranslate nohighlight">
\[
E(y_{i}|\mathbf{x}_{i}) = E(y_{i}) = \mu
\]</div>
<p>As a preview of where we are going with this, a more complicated form is when we have a single predictor variable and assume a straight-line relatonship between our outcome and predictor. This gives a <em>simple linear regression</em> model, defined by the mean-function</p>
<div class="math notranslate nohighlight">
\[
E(y_{i}|x_{i}) = \beta_{0} + \beta_{1}x_{i}
\]</div>
<p>…</p>
<p>The simplified full model is then</p>
<div class="math notranslate nohighlight">
\[
y_{i} \sim \mathcal{N}\left(\beta_{0} + \beta_{1}x_{i},\sigma^{2}\right),
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
    y_{i}   &amp;\sim \mathcal{N}\left(\mu_{i},\sigma^{2}\right) \\
    \mu{_i} &amp;= \beta_{0} + \beta_{1}x_{i}.
\end{align*}
\end{split}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
    y_{i}        &amp;= \beta_{0} + \beta_{1}x_{i} + \epsilon_{i} \\
    \epsilon_{i} &amp;\sim \mathcal{N}\left(0,\sigma^{2}\right).
\end{align*}
\end{split}\]</div>
<p>As we can see, there are multiple ways to write the same model, so try and make sure you understand all of them.</p>
</section>
<section id="the-variance-function">
<h3>The Variance Function<a class="headerlink" href="#the-variance-function" title="Link to this heading">#</a></h3>
<p>For instance, if we assumed that the variance <em>decreased</em> as a function of the value of the predictor variable, we might have something that looks like the plot below (3D plot with the width of the distribution decreasing across values of x).</p>
<p>The mean of the distribution defines a degree of <em>structure</em> within the data, whereas the variance term captures the degree to which the data differs from this structure. For instance, the <em>mean</em> is a very simple model that captures the structure of the data in terms of its <em>scaling</em>. We can think of the mean as capturing the <em>constant offset from 0</em> inherent in the units of the data. Without any other information, this is the most we can say.</p>
</section>
</section>
<section id="the-modelling-process">
<h2>The Modelling Process<a class="headerlink" href="#the-modelling-process" title="Link to this heading">#</a></h2>
<figure class="align-default" id="modelling-fig">
<a class="reference internal image-reference" href="_images/modelling-complete-v.png"><img alt="_images/modelling-complete-v.png" src="_images/modelling-complete-v.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Flowchart of the general procedure for parametric statistical modelling.</span><a class="headerlink" href="#modelling-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Given what we can see in Fig…, we have now discussed the <em>model specification</em> part of statistical modelling. We shall therefore finish this lesson with a brief discussion of <em>estimation</em> and <em>inference</em> to provide the complete overview of the process. The remainder of this unit will be dedicated to seeing this in action for a selection of analyses that you may already be familiar with.</p>
</section>
<section id="linear-models-and-the-normal-distribution">
<h2>Linear Models and the Normal Distribution<a class="headerlink" href="#linear-models-and-the-normal-distribution" title="Link to this heading">#</a></h2>
<p>The plot below is an interactive 3D visualisation of a normal probability model applied to <code class="docutils literal notranslate"><span class="pre">mpg</span></code> from the <code class="docutils literal notranslate"><span class="pre">mtcars</span></code> dataset. Using the sample mean and variance as estimates of the population parameters, this model implies</p>
<div class="math notranslate nohighlight">
\[
\text{MPG}_{i} \sim \mathcal{N}\left(20.09,36.32\right).
\]</div>
<p>Thus, irrespective of the car in question, each value of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> is conceptualised as a random draw from a normal distribution with a mean of 20.09 and a variance of 36.32. Seven of these distributions are shown as examples in the plot, but it is important to recognise that this model applies to <em>all</em> cars.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<script title="htmlwidgets" src="data:application/javascript;base64,KGZ1bmN0aW9uKCkgewogIC8vIElmIHdpbmRvdy5IVE1MV2lkZ2V0cyBpcyBhbHJlYWR5IGRlZmluZWQsIHRoZW4gdXNlIGl0OyBvdGhlcndpc2UgY3JlYXRlIGEKICAvLyBuZXcgb2JqZWN0LiBUaGlzIGFsbG93cyBwcmVjZWRpbmcgY29kZSB0byBzZXQgb3B0aW9ucyB0aGF0IGFmZmVjdCB0aGUKICAvLyBpbml0aWFsaXphdGlvbiBwcm9jZXNzICh0aG91Z2ggbm9uZSBjdXJyZW50bHkgZXhpc3QpLgogIHdpbmRvdy5IVE1MV2lkZ2V0cyA9IHdpbmRvdy5IVE1MV2lkZ2V0cyB8fCB7fTsKCiAgLy8gU2VlIGlmIHdlJ3JlIHJ1bm5pbmcgaW4gYSB2aWV3ZXIgcGFuZS4gSWYgbm90LCB3ZSdyZSBpbiBhIHdlYiBicm93c2VyLgogIHZhciB2aWV3ZXJNb2RlID0gd2luZG93LkhUTUxXaWRnZXRzLnZpZXdlck1vZGUgPQogICAgICAvXGJ2aWV3ZXJfcGFuZT0xXGIvLnRlc3Qod2luZG93LmxvY2F0aW9uKTsKCiAgLy8gU2VlIGlmIHdlJ3JlIHJ1bm5pbmcgaW4gU2hpbnkgbW9kZS4gSWYgbm90LCBpdCdzIGEgc3RhdGljIGRvY3VtZW50LgogIC8vIE5vdGUgdGhhdCBzdGF0aWMgd2lkZ2V0cyBjYW4gYXBwZWFyIGluIGJvdGggU2hpbnkgYW5kIHN0YXRpYyBtb2RlcywgYnV0CiAgLy8gb2J2aW91c2x5LCBTaGlueSB3aWRnZXRzIGNhbiBvbmx5IGFwcGVhciBpbiBTaGlueSBhcHBzL2RvY3VtZW50cy4KICB2YXIgc2hpbnlNb2RlID0gd2luZG93LkhUTUxXaWRnZXRzLnNoaW55TW9kZSA9CiAgICAgIHR5cGVvZih3aW5kb3cuU2hpbnkpICE9PSAidW5kZWZpbmVkIiAmJiAhIXdpbmRvdy5TaGlueS5vdXRwdXRCaW5kaW5nczsKCiAgLy8gV2UgY2FuJ3QgY291bnQgb24galF1ZXJ5IGJlaW5nIGF2YWlsYWJsZSwgc28gd2UgaW1wbGVtZW50IG91ciBvd24KICAvLyB2ZXJzaW9uIGlmIG5lY2Vzc2FyeS4KICBmdW5jdGlvbiBxdWVyeVNlbGVjdG9yQWxsKHNjb3BlLCBzZWxlY3RvcikgewogICAgaWYgKHR5cGVvZihqUXVlcnkpICE9PSAidW5kZWZpbmVkIiAmJiBzY29wZSBpbnN0YW5jZW9mIGpRdWVyeSkgewogICAgICByZXR1cm4gc2NvcGUuZmluZChzZWxlY3Rvcik7CiAgICB9CiAgICBpZiAoc2NvcGUucXVlcnlTZWxlY3RvckFsbCkgewogICAgICByZXR1cm4gc2NvcGUucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBhc0FycmF5KHZhbHVlKSB7CiAgICBpZiAodmFsdWUgPT09IG51bGwpCiAgICAgIHJldHVybiBbXTsKICAgIGlmICgkLmlzQXJyYXkodmFsdWUpKQogICAgICByZXR1cm4gdmFsdWU7CiAgICByZXR1cm4gW3ZhbHVlXTsKICB9CgogIC8vIEltcGxlbWVudCBqUXVlcnkncyBleHRlbmQKICBmdW5jdGlvbiBleHRlbmQodGFyZ2V0IC8qLCAuLi4gKi8pIHsKICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDEpIHsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07CiAgICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7CiAgICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShwcm9wKSkgewogICAgICAgICAgdGFyZ2V0W3Byb3BdID0gc291cmNlW3Byb3BdOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIHRhcmdldDsKICB9CgogIC8vIElFOCBkb2Vzbid0IHN1cHBvcnQgQXJyYXkuZm9yRWFjaC4KICBmdW5jdGlvbiBmb3JFYWNoKHZhbHVlcywgY2FsbGJhY2ssIHRoaXNBcmcpIHsKICAgIGlmICh2YWx1ZXMuZm9yRWFjaCkgewogICAgICB2YWx1ZXMuZm9yRWFjaChjYWxsYmFjaywgdGhpc0FyZyk7CiAgICB9IGVsc2UgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgdmFsdWVzW2ldLCBpLCB2YWx1ZXMpOwogICAgICB9CiAgICB9CiAgfQoKICAvLyBSZXBsYWNlcyB0aGUgc3BlY2lmaWVkIG1ldGhvZCB3aXRoIHRoZSByZXR1cm4gdmFsdWUgb2YgZnVuY1NvdXJjZS4KICAvLwogIC8vIE5vdGUgdGhhdCBmdW5jU291cmNlIHNob3VsZCBub3QgQkUgdGhlIG5ldyBtZXRob2QsIGl0IHNob3VsZCBiZSBhIGZ1bmN0aW9uCiAgLy8gdGhhdCBSRVRVUk5TIHRoZSBuZXcgbWV0aG9kLiBmdW5jU291cmNlIHJlY2VpdmVzIGEgc2luZ2xlIGFyZ3VtZW50IHRoYXQgaXMKICAvLyB0aGUgb3ZlcnJpZGRlbiBtZXRob2QsIGl0IGNhbiBiZSBjYWxsZWQgZnJvbSB0aGUgbmV3IG1ldGhvZC4gVGhlIG92ZXJyaWRkZW4KICAvLyBtZXRob2QgY2FuIGJlIGNhbGxlZCBsaWtlIGEgcmVndWxhciBmdW5jdGlvbiwgaXQgaGFzIHRoZSB0YXJnZXQgcGVybWFuZW50bHkKICAvLyBib3VuZCB0byBpdCBzbyAidGhpcyIgd2lsbCB3b3JrIGNvcnJlY3RseS4KICBmdW5jdGlvbiBvdmVycmlkZU1ldGhvZCh0YXJnZXQsIG1ldGhvZE5hbWUsIGZ1bmNTb3VyY2UpIHsKICAgIHZhciBzdXBlckZ1bmMgPSB0YXJnZXRbbWV0aG9kTmFtZV0gfHwgZnVuY3Rpb24oKSB7fTsKICAgIHZhciBzdXBlckZ1bmNCb3VuZCA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gc3VwZXJGdW5jLmFwcGx5KHRhcmdldCwgYXJndW1lbnRzKTsKICAgIH07CiAgICB0YXJnZXRbbWV0aG9kTmFtZV0gPSBmdW5jU291cmNlKHN1cGVyRnVuY0JvdW5kKTsKICB9CgogIC8vIEFkZCBhIG1ldGhvZCB0byBkZWxlZ2F0b3IgdGhhdCwgd2hlbiBpbnZva2VkLCBjYWxscwogIC8vIGRlbGVnYXRlZS5tZXRob2ROYW1lLiBJZiB0aGVyZSBpcyBubyBzdWNoIG1ldGhvZCBvbgogIC8vIHRoZSBkZWxlZ2F0ZWUsIGJ1dCB0aGVyZSB3YXMgb25lIG9uIGRlbGVnYXRvciBiZWZvcmUKICAvLyBkZWxlZ2F0ZU1ldGhvZCB3YXMgY2FsbGVkLCB0aGVuIHRoZSBvcmlnaW5hbCB2ZXJzaW9uCiAgLy8gaXMgaW52b2tlZCBpbnN0ZWFkLgogIC8vIEZvciBleGFtcGxlOgogIC8vCiAgLy8gdmFyIGEgPSB7CiAgLy8gICBtZXRob2QxOiBmdW5jdGlvbigpIHsgY29uc29sZS5sb2coJ2ExJyk7IH0KICAvLyAgIG1ldGhvZDI6IGZ1bmN0aW9uKCkgeyBjb25zb2xlLmxvZygnYTInKTsgfQogIC8vIH07CiAgLy8gdmFyIGIgPSB7CiAgLy8gICBtZXRob2QxOiBmdW5jdGlvbigpIHsgY29uc29sZS5sb2coJ2IxJyk7IH0KICAvLyB9OwogIC8vIGRlbGVnYXRlTWV0aG9kKGEsIGIsICJtZXRob2QxIik7CiAgLy8gZGVsZWdhdGVNZXRob2QoYSwgYiwgIm1ldGhvZDIiKTsKICAvLyBhLm1ldGhvZDEoKTsKICAvLyBhLm1ldGhvZDIoKTsKICAvLwogIC8vIFRoZSBvdXRwdXQgd291bGQgYmUgImIxIiwgImEyIi4KICBmdW5jdGlvbiBkZWxlZ2F0ZU1ldGhvZChkZWxlZ2F0b3IsIGRlbGVnYXRlZSwgbWV0aG9kTmFtZSkgewogICAgdmFyIGluaGVyaXRlZCA9IGRlbGVnYXRvclttZXRob2ROYW1lXTsKICAgIGRlbGVnYXRvclttZXRob2ROYW1lXSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgdGFyZ2V0ID0gZGVsZWdhdGVlOwogICAgICB2YXIgbWV0aG9kID0gZGVsZWdhdGVlW21ldGhvZE5hbWVdOwoKICAgICAgLy8gVGhlIG1ldGhvZCBkb2Vzbid0IGV4aXN0IG9uIHRoZSBkZWxlZ2F0ZWUuIEluc3RlYWQsCiAgICAgIC8vIGNhbGwgdGhlIG1ldGhvZCBvbiB0aGUgZGVsZWdhdG9yLCBpZiBpdCBleGlzdHMuCiAgICAgIGlmICghbWV0aG9kKSB7CiAgICAgICAgdGFyZ2V0ID0gZGVsZWdhdG9yOwogICAgICAgIG1ldGhvZCA9IGluaGVyaXRlZDsKICAgICAgfQoKICAgICAgaWYgKG1ldGhvZCkgewogICAgICAgIHJldHVybiBtZXRob2QuYXBwbHkodGFyZ2V0LCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9OwogIH0KCiAgLy8gSW1wbGVtZW50IGEgdmFndWUgZmFjc2ltaWxpZSBvZiBqUXVlcnkncyBkYXRhIG1ldGhvZAogIGZ1bmN0aW9uIGVsZW1lbnREYXRhKGVsLCBuYW1lLCB2YWx1ZSkgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMikgewogICAgICByZXR1cm4gZWxbImh0bWx3aWRnZXRfZGF0YV8iICsgbmFtZV07CiAgICB9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMykgewogICAgICBlbFsiaHRtbHdpZGdldF9kYXRhXyIgKyBuYW1lXSA9IHZhbHVlOwogICAgICByZXR1cm4gZWw7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIldyb25nIG51bWJlciBvZiBhcmd1bWVudHMgZm9yIGVsZW1lbnREYXRhOiAiICsKICAgICAgICBhcmd1bWVudHMubGVuZ3RoKTsKICAgIH0KICB9CgogIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzQ0NjE3MC9lc2NhcGUtc3RyaW5nLWZvci11c2UtaW4tamF2YXNjcmlwdC1yZWdleAogIGZ1bmN0aW9uIGVzY2FwZVJlZ0V4cChzdHIpIHsKICAgIHJldHVybiBzdHIucmVwbGFjZSgvW1wtXFtcXVwvXHtcfVwoXClcKlwrXD9cLlxcXF5cJFx8XS9nLCAiXFwkJiIpOwogIH0KCiAgZnVuY3Rpb24gaGFzQ2xhc3MoZWwsIGNsYXNzTmFtZSkgewogICAgdmFyIHJlID0gbmV3IFJlZ0V4cCgiXFxiIiArIGVzY2FwZVJlZ0V4cChjbGFzc05hbWUpICsgIlxcYiIpOwogICAgcmV0dXJuIHJlLnRlc3QoZWwuY2xhc3NOYW1lKTsKICB9CgogIC8vIGVsZW1lbnRzIC0gYXJyYXkgKG9yIGFycmF5LWxpa2Ugb2JqZWN0KSBvZiBIVE1MIGVsZW1lbnRzCiAgLy8gY2xhc3NOYW1lIC0gY2xhc3MgbmFtZSB0byB0ZXN0IGZvcgogIC8vIGluY2x1ZGUgLSBpZiB0cnVlLCBvbmx5IHJldHVybiBlbGVtZW50cyB3aXRoIGdpdmVuIGNsYXNzTmFtZTsKICAvLyAgIGlmIGZhbHNlLCBvbmx5IHJldHVybiBlbGVtZW50cyAqd2l0aG91dCogZ2l2ZW4gY2xhc3NOYW1lCiAgZnVuY3Rpb24gZmlsdGVyQnlDbGFzcyhlbGVtZW50cywgY2xhc3NOYW1lLCBpbmNsdWRlKSB7CiAgICB2YXIgcmVzdWx0cyA9IFtdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykgewogICAgICBpZiAoaGFzQ2xhc3MoZWxlbWVudHNbaV0sIGNsYXNzTmFtZSkgPT0gaW5jbHVkZSkKICAgICAgICByZXN1bHRzLnB1c2goZWxlbWVudHNbaV0pOwogICAgfQogICAgcmV0dXJuIHJlc3VsdHM7CiAgfQoKICBmdW5jdGlvbiBvbihvYmosIGV2ZW50TmFtZSwgZnVuYykgewogICAgaWYgKG9iai5hZGRFdmVudExpc3RlbmVyKSB7CiAgICAgIG9iai5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgZnVuYywgZmFsc2UpOwogICAgfSBlbHNlIGlmIChvYmouYXR0YWNoRXZlbnQpIHsKICAgICAgb2JqLmF0dGFjaEV2ZW50KGV2ZW50TmFtZSwgZnVuYyk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBvZmYob2JqLCBldmVudE5hbWUsIGZ1bmMpIHsKICAgIGlmIChvYmoucmVtb3ZlRXZlbnRMaXN0ZW5lcikKICAgICAgb2JqLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBmdW5jLCBmYWxzZSk7CiAgICBlbHNlIGlmIChvYmouZGV0YWNoRXZlbnQpIHsKICAgICAgb2JqLmRldGFjaEV2ZW50KGV2ZW50TmFtZSwgZnVuYyk7CiAgICB9CiAgfQoKICAvLyBUcmFuc2xhdGUgYXJyYXkgb2YgdmFsdWVzIHRvIHRvcC9yaWdodC9ib3R0b20vbGVmdCwgYXMgdXN1YWwgd2l0aAogIC8vIHRoZSAicGFkZGluZyIgQ1NTIHByb3BlcnR5CiAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQ1NTL3BhZGRpbmcKICBmdW5jdGlvbiB1bnBhY2tQYWRkaW5nKHZhbHVlKSB7CiAgICBpZiAodHlwZW9mKHZhbHVlKSA9PT0gIm51bWJlciIpCiAgICAgIHZhbHVlID0gW3ZhbHVlXTsKICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDEpIHsKICAgICAgcmV0dXJuIHt0b3A6IHZhbHVlWzBdLCByaWdodDogdmFsdWVbMF0sIGJvdHRvbTogdmFsdWVbMF0sIGxlZnQ6IHZhbHVlWzBdfTsKICAgIH0KICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDIpIHsKICAgICAgcmV0dXJuIHt0b3A6IHZhbHVlWzBdLCByaWdodDogdmFsdWVbMV0sIGJvdHRvbTogdmFsdWVbMF0sIGxlZnQ6IHZhbHVlWzFdfTsKICAgIH0KICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDMpIHsKICAgICAgcmV0dXJuIHt0b3A6IHZhbHVlWzBdLCByaWdodDogdmFsdWVbMV0sIGJvdHRvbTogdmFsdWVbMl0sIGxlZnQ6IHZhbHVlWzFdfTsKICAgIH0KICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDQpIHsKICAgICAgcmV0dXJuIHt0b3A6IHZhbHVlWzBdLCByaWdodDogdmFsdWVbMV0sIGJvdHRvbTogdmFsdWVbMl0sIGxlZnQ6IHZhbHVlWzNdfTsKICAgIH0KICB9CgogIC8vIENvbnZlcnQgYW4gdW5wYWNrZWQgcGFkZGluZyBvYmplY3QgdG8gYSBDU1MgdmFsdWUKICBmdW5jdGlvbiBwYWRkaW5nVG9Dc3MocGFkZGluZ09iaikgewogICAgcmV0dXJuIHBhZGRpbmdPYmoudG9wICsgInB4ICIgKyBwYWRkaW5nT2JqLnJpZ2h0ICsgInB4ICIgKyBwYWRkaW5nT2JqLmJvdHRvbSArICJweCAiICsgcGFkZGluZ09iai5sZWZ0ICsgInB4IjsKICB9CgogIC8vIE1ha2VzIGEgbnVtYmVyIHN1aXRhYmxlIGZvciBDU1MKICBmdW5jdGlvbiBweCh4KSB7CiAgICBpZiAodHlwZW9mKHgpID09PSAibnVtYmVyIikKICAgICAgcmV0dXJuIHggKyAicHgiOwogICAgZWxzZQogICAgICByZXR1cm4geDsKICB9CgogIC8vIFJldHJpZXZlcyBydW50aW1lIHdpZGdldCBzaXppbmcgaW5mb3JtYXRpb24gZm9yIGFuIGVsZW1lbnQuCiAgLy8gVGhlIHJldHVybiB2YWx1ZSBpcyBlaXRoZXIgbnVsbCwgb3IgYW4gb2JqZWN0IHdpdGggZmlsbCwgcGFkZGluZywKICAvLyBkZWZhdWx0V2lkdGgsIGRlZmF1bHRIZWlnaHQgZmllbGRzLgogIGZ1bmN0aW9uIHNpemluZ1BvbGljeShlbCkgewogICAgdmFyIHNpemluZ0VsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcigic2NyaXB0W2RhdGEtZm9yPSciICsgZWwuaWQgKyAiJ11bdHlwZT0nYXBwbGljYXRpb24vaHRtbHdpZGdldC1zaXppbmcnXSIpOwogICAgaWYgKCFzaXppbmdFbCkKICAgICAgcmV0dXJuIG51bGw7CiAgICB2YXIgc3AgPSBKU09OLnBhcnNlKHNpemluZ0VsLnRleHRDb250ZW50IHx8IHNpemluZ0VsLnRleHQgfHwgInt9Iik7CiAgICBpZiAodmlld2VyTW9kZSkgewogICAgICByZXR1cm4gc3Audmlld2VyOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHNwLmJyb3dzZXI7CiAgICB9CiAgfQoKICAvLyBAcGFyYW0gdGFza3MgQXJyYXkgb2Ygc3RyaW5ncyAob3IgZmFsc3kgdmFsdWUsIGluIHdoaWNoIGNhc2Ugbm8tb3ApLgogIC8vICAgRWFjaCBlbGVtZW50IG11c3QgYmUgYSB2YWxpZCBKYXZhU2NyaXB0IGV4cHJlc3Npb24gdGhhdCB5aWVsZHMgYQogIC8vICAgZnVuY3Rpb24uIE9yLCBjYW4gYmUgYW4gYXJyYXkgb2Ygb2JqZWN0cyB3aXRoICJjb2RlIiBhbmQgImRhdGEiCiAgLy8gICBwcm9wZXJ0aWVzOyBpbiB0aGlzIGNhc2UsIHRoZSAiY29kZSIgcHJvcGVydHkgc2hvdWxkIGJlIGEgc3RyaW5nCiAgLy8gICBvZiBKUyB0aGF0J3MgYW4gZXhwciB0aGF0IHlpZWxkcyBhIGZ1bmN0aW9uLCBhbmQgImRhdGEiIHNob3VsZCBiZQogIC8vICAgYW4gb2JqZWN0IHRoYXQgd2lsbCBiZSBhZGRlZCBhcyBhbiBhZGRpdGlvbmFsIGFyZ3VtZW50IHdoZW4gdGhhdAogIC8vICAgZnVuY3Rpb24gaXMgY2FsbGVkLgogIC8vIEBwYXJhbSB0YXJnZXQgVGhlIG9iamVjdCB0aGF0IHdpbGwgYmUgInRoaXMiIGZvciBlYWNoIGZ1bmN0aW9uCiAgLy8gICBleGVjdXRpb24uCiAgLy8gQHBhcmFtIGFyZ3MgQXJyYXkgb2YgYXJndW1lbnRzIHRvIGJlIHBhc3NlZCB0byB0aGUgZnVuY3Rpb25zLiAoVGhlCiAgLy8gICBzYW1lIGFyZ3VtZW50cyB3aWxsIGJlIHBhc3NlZCB0byBhbGwgZnVuY3Rpb25zLikKICBmdW5jdGlvbiBldmFsQW5kUnVuKHRhc2tzLCB0YXJnZXQsIGFyZ3MpIHsKICAgIGlmICh0YXNrcykgewogICAgICBmb3JFYWNoKHRhc2tzLCBmdW5jdGlvbih0YXNrKSB7CiAgICAgICAgdmFyIHRoZXNlQXJncyA9IGFyZ3M7CiAgICAgICAgaWYgKHR5cGVvZih0YXNrKSA9PT0gIm9iamVjdCIpIHsKICAgICAgICAgIHRoZXNlQXJncyA9IHRoZXNlQXJncy5jb25jYXQoW3Rhc2suZGF0YV0pOwogICAgICAgICAgdGFzayA9IHRhc2suY29kZTsKICAgICAgICB9CiAgICAgICAgdmFyIHRhc2tGdW5jID0gdHJ5RXZhbCh0YXNrKTsKICAgICAgICBpZiAodHlwZW9mKHRhc2tGdW5jKSAhPT0gImZ1bmN0aW9uIikgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJUYXNrIG11c3QgYmUgYSBmdW5jdGlvbiEgU291cmNlOlxuIiArIHRhc2spOwogICAgICAgIH0KICAgICAgICB0YXNrRnVuYy5hcHBseSh0YXJnZXQsIHRoZXNlQXJncyk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgLy8gQXR0ZW1wdCBldmFsKCkgYm90aCB3aXRoIGFuZCB3aXRob3V0IGVuY2xvc2luZyBpbiBwYXJlbnRoZXNlcy4KICAvLyBOb3RlIHRoYXQgZW5jbG9zaW5nIGNvZXJjZXMgYSBmdW5jdGlvbiBkZWNsYXJhdGlvbiBpbnRvCiAgLy8gYW4gZXhwcmVzc2lvbiB0aGF0IGV2YWwoKSBjYW4gcGFyc2UKICAvLyAob3RoZXJ3aXNlLCBhIFN5bnRheEVycm9yIGlzIHRocm93bikKICBmdW5jdGlvbiB0cnlFdmFsKGNvZGUpIHsKICAgIHZhciByZXN1bHQgPSBudWxsOwogICAgdHJ5IHsKICAgICAgcmVzdWx0ID0gZXZhbCgiKCIgKyBjb2RlICsgIikiKTsKICAgIH0gY2F0Y2goZXJyb3IpIHsKICAgICAgaWYgKCEoZXJyb3IgaW5zdGFuY2VvZiBTeW50YXhFcnJvcikpIHsKICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgfQogICAgICB0cnkgewogICAgICAgIHJlc3VsdCA9IGV2YWwoY29kZSk7CiAgICAgIH0gY2F0Y2goZSkgewogICAgICAgIGlmIChlIGluc3RhbmNlb2YgU3ludGF4RXJyb3IpIHsKICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBlOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogIGZ1bmN0aW9uIGluaXRTaXppbmcoZWwpIHsKICAgIHZhciBzaXppbmcgPSBzaXppbmdQb2xpY3koZWwpOwogICAgaWYgKCFzaXppbmcpCiAgICAgIHJldHVybjsKCiAgICB2YXIgY2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImh0bWx3aWRnZXRfY29udGFpbmVyIik7CiAgICBpZiAoIWNlbCkKICAgICAgcmV0dXJuOwoKICAgIGlmICh0eXBlb2Yoc2l6aW5nLnBhZGRpbmcpICE9PSAidW5kZWZpbmVkIikgewogICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm1hcmdpbiA9ICIwIjsKICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5wYWRkaW5nID0gcGFkZGluZ1RvQ3NzKHVucGFja1BhZGRpbmcoc2l6aW5nLnBhZGRpbmcpKTsKICAgIH0KCiAgICBpZiAoc2l6aW5nLmZpbGwpIHsKICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwogICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLndpZHRoID0gIjEwMCUiOwogICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmhlaWdodCA9ICIxMDAlIjsKICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLndpZHRoID0gIjEwMCUiOwogICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gIjEwMCUiOwogICAgICBjZWwuc3R5bGUucG9zaXRpb24gPSAiYWJzb2x1dGUiOwogICAgICB2YXIgcGFkID0gdW5wYWNrUGFkZGluZyhzaXppbmcucGFkZGluZyk7CiAgICAgIGNlbC5zdHlsZS50b3AgPSBwYWQudG9wICsgInB4IjsKICAgICAgY2VsLnN0eWxlLnJpZ2h0ID0gcGFkLnJpZ2h0ICsgInB4IjsKICAgICAgY2VsLnN0eWxlLmJvdHRvbSA9IHBhZC5ib3R0b20gKyAicHgiOwogICAgICBjZWwuc3R5bGUubGVmdCA9IHBhZC5sZWZ0ICsgInB4IjsKICAgICAgZWwuc3R5bGUud2lkdGggPSAiMTAwJSI7CiAgICAgIGVsLnN0eWxlLmhlaWdodCA9ICIxMDAlIjsKCiAgICAgIHJldHVybiB7CiAgICAgICAgZ2V0V2lkdGg6IGZ1bmN0aW9uKCkgeyByZXR1cm4gY2VsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoOyB9LAogICAgICAgIGdldEhlaWdodDogZnVuY3Rpb24oKSB7IHJldHVybiBjZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0OyB9CiAgICAgIH07CgogICAgfSBlbHNlIHsKICAgICAgZWwuc3R5bGUud2lkdGggPSBweChzaXppbmcud2lkdGgpOwogICAgICBlbC5zdHlsZS5oZWlnaHQgPSBweChzaXppbmcuaGVpZ2h0KTsKCiAgICAgIHJldHVybiB7CiAgICAgICAgZ2V0V2lkdGg6IGZ1bmN0aW9uKCkgeyByZXR1cm4gY2VsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoOyB9LAogICAgICAgIGdldEhlaWdodDogZnVuY3Rpb24oKSB7IHJldHVybiBjZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0OyB9CiAgICAgIH07CiAgICB9CiAgfQoKICAvLyBEZWZhdWx0IGltcGxlbWVudGF0aW9ucyBmb3IgbWV0aG9kcwogIHZhciBkZWZhdWx0cyA9IHsKICAgIGZpbmQ6IGZ1bmN0aW9uKHNjb3BlKSB7CiAgICAgIHJldHVybiBxdWVyeVNlbGVjdG9yQWxsKHNjb3BlLCAiLiIgKyB0aGlzLm5hbWUpOwogICAgfSwKICAgIHJlbmRlckVycm9yOiBmdW5jdGlvbihlbCwgZXJyKSB7CiAgICAgIHZhciAkZWwgPSAkKGVsKTsKCiAgICAgIHRoaXMuY2xlYXJFcnJvcihlbCk7CgogICAgICAvLyBBZGQgYWxsIHRoZXNlIGVycm9yIGNsYXNzZXMsIGFzIFNoaW55IGRvZXMKICAgICAgdmFyIGVyckNsYXNzID0gInNoaW55LW91dHB1dC1lcnJvciI7CiAgICAgIGlmIChlcnIudHlwZSAhPT0gbnVsbCkgewogICAgICAgIC8vIHVzZSB0aGUgY2xhc3NlcyBvZiB0aGUgZXJyb3IgY29uZGl0aW9uIGFzIENTUyBjbGFzcyBuYW1lcwogICAgICAgIGVyckNsYXNzID0gZXJyQ2xhc3MgKyAiICIgKyAkLm1hcChhc0FycmF5KGVyci50eXBlKSwgZnVuY3Rpb24odHlwZSkgewogICAgICAgICAgcmV0dXJuIGVyckNsYXNzICsgIi0iICsgdHlwZTsKICAgICAgICB9KS5qb2luKCIgIik7CiAgICAgIH0KICAgICAgZXJyQ2xhc3MgPSBlcnJDbGFzcyArICIgaHRtbHdpZGdldHMtZXJyb3IiOwoKICAgICAgLy8gSXMgZWwgaW5saW5lIG9yIGJsb2NrPyBJZiBpbmxpbmUgb3IgaW5saW5lLWJsb2NrLCBqdXN0IGRpc3BsYXk6bm9uZSBpdAogICAgICAvLyBhbmQgYWRkIGFuIGlubGluZSBlcnJvci4KICAgICAgdmFyIGRpc3BsYXkgPSAkZWwuY3NzKCJkaXNwbGF5Iik7CiAgICAgICRlbC5kYXRhKCJyZXN0b3JlLWRpc3BsYXktbW9kZSIsIGRpc3BsYXkpOwoKICAgICAgaWYgKGRpc3BsYXkgPT09ICJpbmxpbmUiIHx8IGRpc3BsYXkgPT09ICJpbmxpbmUtYmxvY2siKSB7CiAgICAgICAgJGVsLmhpZGUoKTsKICAgICAgICBpZiAoZXJyLm1lc3NhZ2UgIT09ICIiKSB7CiAgICAgICAgICB2YXIgZXJyb3JTcGFuID0gJCgiPHNwYW4+IikuYWRkQ2xhc3MoZXJyQ2xhc3MpOwogICAgICAgICAgZXJyb3JTcGFuLnRleHQoZXJyLm1lc3NhZ2UpOwogICAgICAgICAgJGVsLmFmdGVyKGVycm9yU3Bhbik7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGRpc3BsYXkgPT09ICJibG9jayIpIHsKICAgICAgICAvLyBJZiBibG9jaywgYWRkIGFuIGVycm9yIGp1c3QgYWZ0ZXIgdGhlIGVsLCBzZXQgdmlzaWJpbGl0eTpub25lIG9uIHRoZQogICAgICAgIC8vIGVsLCBhbmQgcG9zaXRpb24gdGhlIGVycm9yIHRvIGJlIG9uIHRvcCBvZiB0aGUgZWwuCiAgICAgICAgLy8gTWFyayBpdCB3aXRoIGEgdW5pcXVlIElEIGFuZCBDU1MgY2xhc3Mgc28gd2UgY2FuIHJlbW92ZSBpdCBsYXRlci4KICAgICAgICAkZWwuY3NzKCJ2aXNpYmlsaXR5IiwgImhpZGRlbiIpOwogICAgICAgIGlmIChlcnIubWVzc2FnZSAhPT0gIiIpIHsKICAgICAgICAgIHZhciBlcnJvckRpdiA9ICQoIjxkaXY+IikuYWRkQ2xhc3MoZXJyQ2xhc3MpLmNzcygicG9zaXRpb24iLCAiYWJzb2x1dGUiKQogICAgICAgICAgICAuY3NzKCJ0b3AiLCBlbC5vZmZzZXRUb3ApCiAgICAgICAgICAgIC5jc3MoImxlZnQiLCBlbC5vZmZzZXRMZWZ0KQogICAgICAgICAgICAvLyBzZXR0aW5nIHdpZHRoIGNhbiBwdXNoIG91dCB0aGUgcGFnZSBzaXplLCBmb3JjaW5nIG90aGVyd2lzZQogICAgICAgICAgICAvLyB1bm5lY2Vzc2FyeSBzY3JvbGxiYXJzIHRvIGFwcGVhciBhbmQgbWFraW5nIGl0IGltcG9zc2libGUgZm9yCiAgICAgICAgICAgIC8vIHRoZSBlbGVtZW50IHRvIHNocmluazsgc28gdXNlIG1heC13aWR0aCBpbnN0ZWFkCiAgICAgICAgICAgIC5jc3MoIm1heFdpZHRoIiwgZWwub2Zmc2V0V2lkdGgpCiAgICAgICAgICAgIC5jc3MoImhlaWdodCIsIGVsLm9mZnNldEhlaWdodCk7CiAgICAgICAgICBlcnJvckRpdi50ZXh0KGVyci5tZXNzYWdlKTsKICAgICAgICAgICRlbC5hZnRlcihlcnJvckRpdik7CgogICAgICAgICAgLy8gUmVhbGx5IGR1bWIgd2F5IHRvIGtlZXAgdGhlIHNpemUvcG9zaXRpb24gb2YgdGhlIGVycm9yIGluIHN5bmMgd2l0aAogICAgICAgICAgLy8gdGhlIHBhcmVudCBlbGVtZW50IGFzIHRoZSB3aW5kb3cgaXMgcmVzaXplZCBvciB3aGF0ZXZlci4KICAgICAgICAgIHZhciBpbnRJZCA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkgewogICAgICAgICAgICBpZiAoIWVycm9yRGl2WzBdLnBhcmVudEVsZW1lbnQpIHsKICAgICAgICAgICAgICBjbGVhckludGVydmFsKGludElkKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZXJyb3JEaXYKICAgICAgICAgICAgICAuY3NzKCJ0b3AiLCBlbC5vZmZzZXRUb3ApCiAgICAgICAgICAgICAgLmNzcygibGVmdCIsIGVsLm9mZnNldExlZnQpCiAgICAgICAgICAgICAgLmNzcygibWF4V2lkdGgiLCBlbC5vZmZzZXRXaWR0aCkKICAgICAgICAgICAgICAuY3NzKCJoZWlnaHQiLCBlbC5vZmZzZXRIZWlnaHQpOwogICAgICAgICAgfSwgNTAwKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBjbGVhckVycm9yOiBmdW5jdGlvbihlbCkgewogICAgICB2YXIgJGVsID0gJChlbCk7CiAgICAgIHZhciBkaXNwbGF5ID0gJGVsLmRhdGEoInJlc3RvcmUtZGlzcGxheS1tb2RlIik7CiAgICAgICRlbC5kYXRhKCJyZXN0b3JlLWRpc3BsYXktbW9kZSIsIG51bGwpOwoKICAgICAgaWYgKGRpc3BsYXkgPT09ICJpbmxpbmUiIHx8IGRpc3BsYXkgPT09ICJpbmxpbmUtYmxvY2siKSB7CiAgICAgICAgaWYgKGRpc3BsYXkpCiAgICAgICAgICAkZWwuY3NzKCJkaXNwbGF5IiwgZGlzcGxheSk7CiAgICAgICAgJChlbC5uZXh0U2libGluZykuZmlsdGVyKCIuaHRtbHdpZGdldHMtZXJyb3IiKS5yZW1vdmUoKTsKICAgICAgfSBlbHNlIGlmIChkaXNwbGF5ID09PSAiYmxvY2siKXsKICAgICAgICAkZWwuY3NzKCJ2aXNpYmlsaXR5IiwgImluaGVyaXQiKTsKICAgICAgICAkKGVsLm5leHRTaWJsaW5nKS5maWx0ZXIoIi5odG1sd2lkZ2V0cy1lcnJvciIpLnJlbW92ZSgpOwogICAgICB9CiAgICB9LAogICAgc2l6aW5nOiB7fQogIH07CgogIC8vIENhbGxlZCBieSB3aWRnZXQgYmluZGluZ3MgdG8gcmVnaXN0ZXIgYSBuZXcgdHlwZSBvZiB3aWRnZXQuIFRoZSBkZWZpbml0aW9uCiAgLy8gb2JqZWN0IGNhbiBjb250YWluIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczoKICAvLyAtIG5hbWUgKHJlcXVpcmVkKSAtIEEgc3RyaW5nIGluZGljYXRpbmcgdGhlIGJpbmRpbmcgbmFtZSwgd2hpY2ggd2lsbCBiZQogIC8vICAgdXNlZCBieSBkZWZhdWx0IGFzIHRoZSBDU1MgY2xhc3NuYW1lIHRvIGxvb2sgZm9yLgogIC8vIC0gaW5pdGlhbGl6ZSAob3B0aW9uYWwpIC0gQSBmdW5jdGlvbihlbCkgdGhhdCB3aWxsIGJlIGNhbGxlZCBvbmNlIHBlcgogIC8vICAgd2lkZ2V0IGVsZW1lbnQ7IGlmIGEgdmFsdWUgaXMgcmV0dXJuZWQsIGl0IHdpbGwgYmUgcGFzc2VkIGFzIHRoZSB0aGlyZAogIC8vICAgdmFsdWUgdG8gcmVuZGVyVmFsdWUuCiAgLy8gLSByZW5kZXJWYWx1ZSAocmVxdWlyZWQpIC0gQSBmdW5jdGlvbihlbCwgZGF0YSwgaW5pdFZhbHVlKSB0aGF0IHdpbGwgYmUKICAvLyAgIGNhbGxlZCB3aXRoIGRhdGEuIFN0YXRpYyBjb250ZXh0cyB3aWxsIGNhdXNlIHRoaXMgdG8gYmUgY2FsbGVkIG9uY2UgcGVyCiAgLy8gICBlbGVtZW50OyBTaGlueSBhcHBzIHdpbGwgY2F1c2UgdGhpcyB0byBiZSBjYWxsZWQgbXVsdGlwbGUgdGltZXMgcGVyCiAgLy8gICBlbGVtZW50LCBhcyB0aGUgZGF0YSBjaGFuZ2VzLgogIHdpbmRvdy5IVE1MV2lkZ2V0cy53aWRnZXQgPSBmdW5jdGlvbihkZWZpbml0aW9uKSB7CiAgICBpZiAoIWRlZmluaXRpb24ubmFtZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIldpZGdldCBtdXN0IGhhdmUgYSBuYW1lIik7CiAgICB9CiAgICBpZiAoIWRlZmluaXRpb24udHlwZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIldpZGdldCBtdXN0IGhhdmUgYSB0eXBlIik7CiAgICB9CiAgICAvLyBDdXJyZW50bHkgd2Ugb25seSBzdXBwb3J0IG91dHB1dCB3aWRnZXRzCiAgICBpZiAoZGVmaW5pdGlvbi50eXBlICE9PSAib3V0cHV0IikgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIlVucmVjb2duaXplZCB3aWRnZXQgdHlwZSAnIiArIGRlZmluaXRpb24udHlwZSArICInIik7CiAgICB9CiAgICAvLyBUT0RPOiBWZXJpZnkgdGhhdCAubmFtZSBpcyBhIHZhbGlkIENTUyBjbGFzc25hbWUKCiAgICAvLyBTdXBwb3J0IG5ldy1zdHlsZSBpbnN0YW5jZS1ib3VuZCBkZWZpbml0aW9ucy4gT2xkLXN0eWxlIGNsYXNzLWJvdW5kCiAgICAvLyBkZWZpbml0aW9ucyBoYXZlIG9uZSB3aWRnZXQgIm9iamVjdCIgcGVyIHdpZGdldCBwZXIgdHlwZS9jbGFzcyBvZgogICAgLy8gd2lkZ2V0OyB0aGUgcmVuZGVyVmFsdWUgYW5kIHJlc2l6ZSBtZXRob2RzIG9uIHN1Y2ggd2lkZ2V0IG9iamVjdHMKICAgIC8vIHRha2UgZWwgYW5kIGluc3RhbmNlIGFyZ3VtZW50cywgYmVjYXVzZSB0aGUgd2lkZ2V0IG9iamVjdCBjYW4ndAogICAgLy8gc3RvcmUgdGhlbS4gTmV3LXN0eWxlIGluc3RhbmNlLWJvdW5kIGRlZmluaXRpb25zIGhhdmUgb25lIHdpZGdldAogICAgLy8gb2JqZWN0IHBlciB3aWRnZXQgaW5zdGFuY2U7IHRoZSBkZWZpbml0aW9uIHRoYXQncyBwYXNzZWQgaW4gZG9lc24ndAogICAgLy8gcHJvdmlkZSByZW5kZXJWYWx1ZSBvciByZXNpemUgbWV0aG9kcyBhdCBhbGwsIGp1c3QgdGhlIHNpbmdsZSBtZXRob2QKICAgIC8vICAgZmFjdG9yeShlbCwgd2lkdGgsIGhlaWdodCkKICAgIC8vIHdoaWNoIHJldHVybnMgYW4gb2JqZWN0IHRoYXQgaGFzIHJlbmRlclZhbHVlKHgpIGFuZCByZXNpemUodywgaCkuCiAgICAvLyBUaGlzIGVuYWJsZXMgYSBmYXIgbW9yZSBuYXR1cmFsIHByb2dyYW1taW5nIHN0eWxlIGZvciB0aGUgd2lkZ2V0CiAgICAvLyBhdXRob3IsIHdobyBjYW4gc3RvcmUgcGVyLWluc3RhbmNlIHN0YXRlIHVzaW5nIGVpdGhlciBPTy1zdHlsZQogICAgLy8gaW5zdGFuY2UgZmllbGRzIG9yIGZ1bmN0aW9uYWwtc3R5bGUgY2xvc3VyZSB2YXJpYWJsZXMgKEkgZ3Vlc3MgdGhpcwogICAgLy8gaXMgaW4gY29udHJhc3QgdG8gd2hhdCBjYW4gb25seSBiZSBjYWxsZWQgQy1zdHlsZSBwc2V1ZG8tT08gd2hpY2ggaXMKICAgIC8vIHdoYXQgd2UgcmVxdWlyZWQgYmVmb3JlKS4KICAgIGlmIChkZWZpbml0aW9uLmZhY3RvcnkpIHsKICAgICAgZGVmaW5pdGlvbiA9IGNyZWF0ZUxlZ2FjeURlZmluaXRpb25BZGFwdGVyKGRlZmluaXRpb24pOwogICAgfQoKICAgIGlmICghZGVmaW5pdGlvbi5yZW5kZXJWYWx1ZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIldpZGdldCBtdXN0IGhhdmUgYSByZW5kZXJWYWx1ZSBmdW5jdGlvbiIpOwogICAgfQoKICAgIC8vIEZvciBzdGF0aWMgcmVuZGVyaW5nIChub24tU2hpbnkpLCB1c2UgYSBzaW1wbGUgd2lkZ2V0IHJlZ2lzdHJhdGlvbgogICAgLy8gc2NoZW1lLiBXZSBhbHNvIHVzZSB0aGlzIHNjaGVtZSBmb3IgU2hpbnkgYXBwcy9kb2N1bWVudHMgdGhhdCBhbHNvCiAgICAvLyBjb250YWluIHN0YXRpYyB3aWRnZXRzLgogICAgd2luZG93LkhUTUxXaWRnZXRzLndpZGdldHMgPSB3aW5kb3cuSFRNTFdpZGdldHMud2lkZ2V0cyB8fCBbXTsKICAgIC8vIE1lcmdlIGRlZmF1bHRzIGludG8gdGhlIGRlZmluaXRpb247IGRvbid0IG11dGF0ZSB0aGUgb3JpZ2luYWwgZGVmaW5pdGlvbi4KICAgIHZhciBzdGF0aWNCaW5kaW5nID0gZXh0ZW5kKHt9LCBkZWZhdWx0cywgZGVmaW5pdGlvbik7CiAgICBvdmVycmlkZU1ldGhvZChzdGF0aWNCaW5kaW5nLCAiZmluZCIsIGZ1bmN0aW9uKHN1cGVyZnVuYykgewogICAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUpIHsKICAgICAgICB2YXIgcmVzdWx0cyA9IHN1cGVyZnVuYyhzY29wZSk7CiAgICAgICAgLy8gRmlsdGVyIG91dCBTaGlueSBvdXRwdXRzLCB3ZSBvbmx5IHdhbnQgdGhlIHN0YXRpYyBraW5kCiAgICAgICAgcmV0dXJuIGZpbHRlckJ5Q2xhc3MocmVzdWx0cywgImh0bWwtd2lkZ2V0LW91dHB1dCIsIGZhbHNlKTsKICAgICAgfTsKICAgIH0pOwogICAgd2luZG93LkhUTUxXaWRnZXRzLndpZGdldHMucHVzaChzdGF0aWNCaW5kaW5nKTsKCiAgICBpZiAoc2hpbnlNb2RlKSB7CiAgICAgIC8vIFNoaW55IGlzIHJ1bm5pbmcuIFJlZ2lzdGVyIHRoZSBkZWZpbml0aW9uIHdpdGggYW4gb3V0cHV0IGJpbmRpbmcuCiAgICAgIC8vIFRoZSBkZWZpbml0aW9uIGl0c2VsZiB3aWxsIG5vdCBiZSB0aGUgb3V0cHV0IGJpbmRpbmcsIGluc3RlYWQKICAgICAgLy8gd2Ugd2lsbCBtYWtlIGFuIG91dHB1dCBiaW5kaW5nIG9iamVjdCB0aGF0IGRlbGVnYXRlcyB0byB0aGUKICAgICAgLy8gZGVmaW5pdGlvbi4gVGhpcyBpcyBiZWNhdXNlIHdlIGZvb2xpc2hseSB1c2VkIHRoZSBzYW1lIG1ldGhvZAogICAgICAvLyBuYW1lIChyZW5kZXJWYWx1ZSkgZm9yIGh0bWx3aWRnZXRzIGRlZmluaXRpb24gYW5kIFNoaW55IGJpbmRpbmdzCiAgICAgIC8vIGJ1dCB0aGV5IGFjdHVhbGx5IGhhdmUgcXVpdGUgZGlmZmVyZW50IHNlbWFudGljcyAodGhlIFNoaW55CiAgICAgIC8vIGJpbmRpbmdzIHJlY2VpdmUgZGF0YSB0aGF0IGluY2x1ZGVzIGxvdHMgb2YgbWV0YWRhdGEgdGhhdCBpdAogICAgICAvLyBzdHJpcHMgb2ZmIGJlZm9yZSBjYWxsaW5nIGh0bWx3aWRnZXRzIHJlbmRlclZhbHVlKS4gV2UgY2FuJ3QKICAgICAgLy8ganVzdCBpZ25vcmUgdGhlIGRpZmZlcmVuY2UgYmVjYXVzZSBpbiBzb21lIHdpZGdldHMgaXQncyBoZWxwZnVsCiAgICAgIC8vIHRvIGNhbGwgdGhpcy5yZW5kZXJWYWx1ZSgpIGZyb20gaW5zaWRlIG9mIHJlc2l6ZSgpLCBhbmQgaWYKICAgICAgLy8gd2UncmUgbm90IGRlbGVnYXRpbmcsIHRoZW4gdGhhdCBjYWxsIHdpbGwgZ28gdG8gdGhlIFNoaW55CiAgICAgIC8vIHZlcnNpb24gaW5zdGVhZCBvZiB0aGUgaHRtbHdpZGdldHMgdmVyc2lvbi4KCiAgICAgIC8vIE1lcmdlIGRlZmF1bHRzIHdpdGggZGVmaW5pdGlvbiwgd2l0aG91dCBtdXRhdGluZyBlaXRoZXIuCiAgICAgIHZhciBiaW5kaW5nRGVmID0gZXh0ZW5kKHt9LCBkZWZhdWx0cywgZGVmaW5pdGlvbik7CgogICAgICAvLyBUaGlzIG9iamVjdCB3aWxsIGJlIG91ciBhY3R1YWwgU2hpbnkgYmluZGluZy4KICAgICAgdmFyIHNoaW55QmluZGluZyA9IG5ldyBTaGlueS5PdXRwdXRCaW5kaW5nKCk7CgogICAgICAvLyBXaXRoIGEgZmV3IGV4Y2VwdGlvbnMsIHdlJ2xsIHdhbnQgdG8gc2ltcGx5IHVzZSB0aGUgYmluZGluZ0RlZidzCiAgICAgIC8vIHZlcnNpb24gb2YgbWV0aG9kcyBpZiB0aGV5IGFyZSBhdmFpbGFibGUsIG90aGVyd2lzZSBmYWxsIGJhY2sgdG8KICAgICAgLy8gU2hpbnkncyBkZWZhdWx0cy4gTk9URTogSWYgU2hpbnkncyBvdXRwdXQgYmluZGluZ3MgZ2FpbiBhZGRpdGlvbmFsCiAgICAgIC8vIG1ldGhvZHMgaW4gdGhlIGZ1dHVyZSwgYW5kIHdlIHdhbnQgdGhlbSB0byBiZSBvdmVycmlkZWFibGUgYnkKICAgICAgLy8gSFRNTFdpZGdldCBiaW5kaW5nIGRlZmluaXRpb25zLCB0aGVuIHdlJ2xsIG5lZWQgdG8gYWRkIHRoZW0gdG8gdGhpcwogICAgICAvLyBsaXN0LgogICAgICBkZWxlZ2F0ZU1ldGhvZChzaGlueUJpbmRpbmcsIGJpbmRpbmdEZWYsICJnZXRJZCIpOwogICAgICBkZWxlZ2F0ZU1ldGhvZChzaGlueUJpbmRpbmcsIGJpbmRpbmdEZWYsICJvblZhbHVlQ2hhbmdlIik7CiAgICAgIGRlbGVnYXRlTWV0aG9kKHNoaW55QmluZGluZywgYmluZGluZ0RlZiwgIm9uVmFsdWVFcnJvciIpOwogICAgICBkZWxlZ2F0ZU1ldGhvZChzaGlueUJpbmRpbmcsIGJpbmRpbmdEZWYsICJyZW5kZXJFcnJvciIpOwogICAgICBkZWxlZ2F0ZU1ldGhvZChzaGlueUJpbmRpbmcsIGJpbmRpbmdEZWYsICJjbGVhckVycm9yIik7CiAgICAgIGRlbGVnYXRlTWV0aG9kKHNoaW55QmluZGluZywgYmluZGluZ0RlZiwgInNob3dQcm9ncmVzcyIpOwoKICAgICAgLy8gVGhlIGZpbmQsIHJlbmRlclZhbHVlLCBhbmQgcmVzaXplIGFyZSBoYW5kbGVkIGRpZmZlcmVudGx5LCBiZWNhdXNlIHdlCiAgICAgIC8vIHdhbnQgdG8gYWN0dWFsbHkgZGVjb3JhdGUgdGhlIGJlaGF2aW9yIG9mIHRoZSBiaW5kaW5nRGVmIG1ldGhvZHMuCgogICAgICBzaGlueUJpbmRpbmcuZmluZCA9IGZ1bmN0aW9uKHNjb3BlKSB7CiAgICAgICAgdmFyIHJlc3VsdHMgPSBiaW5kaW5nRGVmLmZpbmQoc2NvcGUpOwoKICAgICAgICAvLyBPbmx5IHJldHVybiBlbGVtZW50cyB0aGF0IGFyZSBTaGlueSBvdXRwdXRzLCBub3Qgc3RhdGljIG9uZXMKICAgICAgICB2YXIgZHluYW1pY1Jlc3VsdHMgPSByZXN1bHRzLmZpbHRlcigiLmh0bWwtd2lkZ2V0LW91dHB1dCIpOwoKICAgICAgICAvLyBJdCdzIHBvc3NpYmxlIHRoYXQgd2hhdGV2ZXIgY2F1c2VkIFNoaW55IHRvIHRoaW5rIHRoZXJlIG1pZ2h0IGJlCiAgICAgICAgLy8gbmV3IGR5bmFtaWMgb3V0cHV0cywgYWxzbyBjYXVzZWQgdGhlcmUgdG8gYmUgbmV3IHN0YXRpYyBvdXRwdXRzLgogICAgICAgIC8vIFNpbmNlIHRoZXJlIG1pZ2h0IGJlIGxvdHMgb2YgZGlmZmVyZW50IGh0bWx3aWRnZXRzIGJpbmRpbmdzLCB3ZQogICAgICAgIC8vIHNjaGVkdWxlIGV4ZWN1dGlvbiBmb3IgbGF0ZXItLW5vIG5lZWQgdG8gc3RhdGljUmVuZGVyIG11bHRpcGxlCiAgICAgICAgLy8gdGltZXMuCiAgICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoICE9PSBkeW5hbWljUmVzdWx0cy5sZW5ndGgpCiAgICAgICAgICBzY2hlZHVsZVN0YXRpY1JlbmRlcigpOwoKICAgICAgICByZXR1cm4gZHluYW1pY1Jlc3VsdHM7CiAgICAgIH07CgogICAgICAvLyBXcmFwIHJlbmRlclZhbHVlIHRvIGhhbmRsZSBpbml0aWFsaXphdGlvbiwgd2hpY2ggdW5mb3J0dW5hdGVseSBpc24ndAogICAgICAvLyBzdXBwb3J0ZWQgbmF0aXZlbHkgYnkgU2hpbnkgYXQgdGhlIHRpbWUgb2YgdGhpcyB3cml0aW5nLgoKICAgICAgc2hpbnlCaW5kaW5nLnJlbmRlclZhbHVlID0gZnVuY3Rpb24oZWwsIGRhdGEpIHsKICAgICAgICBTaGlueS5yZW5kZXJEZXBlbmRlbmNpZXMoZGF0YS5kZXBzKTsKICAgICAgICAvLyBSZXNvbHZlIHN0cmluZ3MgbWFya2VkIGFzIGphdmFzY3JpcHQgbGl0ZXJhbHMgdG8gb2JqZWN0cwogICAgICAgIGlmICghKGRhdGEuZXZhbHMgaW5zdGFuY2VvZiBBcnJheSkpIGRhdGEuZXZhbHMgPSBbZGF0YS5ldmFsc107CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGRhdGEuZXZhbHMgJiYgaSA8IGRhdGEuZXZhbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5ldmFsdWF0ZVN0cmluZ01lbWJlcihkYXRhLngsIGRhdGEuZXZhbHNbaV0pOwogICAgICAgIH0KICAgICAgICBpZiAoIWJpbmRpbmdEZWYucmVuZGVyT25OdWxsVmFsdWUpIHsKICAgICAgICAgIGlmIChkYXRhLnggPT09IG51bGwpIHsKICAgICAgICAgICAgZWwuc3R5bGUudmlzaWJpbGl0eSA9ICJoaWRkZW4iOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBlbC5zdHlsZS52aXNpYmlsaXR5ID0gImluaGVyaXQiOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoIWVsZW1lbnREYXRhKGVsLCAiaW5pdGlhbGl6ZWQiKSkgewogICAgICAgICAgaW5pdFNpemluZyhlbCk7CgogICAgICAgICAgZWxlbWVudERhdGEoZWwsICJpbml0aWFsaXplZCIsIHRydWUpOwogICAgICAgICAgaWYgKGJpbmRpbmdEZWYuaW5pdGlhbGl6ZSkgewogICAgICAgICAgICB2YXIgcmVjdCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgICB2YXIgcmVzdWx0ID0gYmluZGluZ0RlZi5pbml0aWFsaXplKGVsLCByZWN0LndpZHRoLCByZWN0LmhlaWdodCk7CiAgICAgICAgICAgIGVsZW1lbnREYXRhKGVsLCAiaW5pdF9yZXN1bHQiLCByZXN1bHQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBiaW5kaW5nRGVmLnJlbmRlclZhbHVlKGVsLCBkYXRhLngsIGVsZW1lbnREYXRhKGVsLCAiaW5pdF9yZXN1bHQiKSk7CiAgICAgICAgZXZhbEFuZFJ1bihkYXRhLmpzSG9va3MucmVuZGVyLCBlbGVtZW50RGF0YShlbCwgImluaXRfcmVzdWx0IiksIFtlbCwgZGF0YS54XSk7CiAgICAgIH07CgogICAgICAvLyBPbmx5IG92ZXJyaWRlIHJlc2l6ZSBpZiBiaW5kaW5nRGVmIGltcGxlbWVudHMgaXQKICAgICAgaWYgKGJpbmRpbmdEZWYucmVzaXplKSB7CiAgICAgICAgc2hpbnlCaW5kaW5nLnJlc2l6ZSA9IGZ1bmN0aW9uKGVsLCB3aWR0aCwgaGVpZ2h0KSB7CiAgICAgICAgICAvLyBTaGlueSBjYW4gY2FsbCByZXNpemUgYmVmb3JlIGluaXRpYWxpemUvcmVuZGVyVmFsdWUgaGF2ZSBiZWVuCiAgICAgICAgICAvLyBjYWxsZWQsIHdoaWNoIGRvZXNuJ3QgbWFrZSBzZW5zZSBmb3Igd2lkZ2V0cy4KICAgICAgICAgIGlmIChlbGVtZW50RGF0YShlbCwgImluaXRpYWxpemVkIikpIHsKICAgICAgICAgICAgYmluZGluZ0RlZi5yZXNpemUoZWwsIHdpZHRoLCBoZWlnaHQsIGVsZW1lbnREYXRhKGVsLCAiaW5pdF9yZXN1bHQiKSk7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgU2hpbnkub3V0cHV0QmluZGluZ3MucmVnaXN0ZXIoc2hpbnlCaW5kaW5nLCBiaW5kaW5nRGVmLm5hbWUpOwogICAgfQogIH07CgogIHZhciBzY2hlZHVsZVN0YXRpY1JlbmRlclRpbWVySWQgPSBudWxsOwogIGZ1bmN0aW9uIHNjaGVkdWxlU3RhdGljUmVuZGVyKCkgewogICAgaWYgKCFzY2hlZHVsZVN0YXRpY1JlbmRlclRpbWVySWQpIHsKICAgICAgc2NoZWR1bGVTdGF0aWNSZW5kZXJUaW1lcklkID0gc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICBzY2hlZHVsZVN0YXRpY1JlbmRlclRpbWVySWQgPSBudWxsOwogICAgICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTsKICAgICAgfSwgMSk7CiAgICB9CiAgfQoKICAvLyBSZW5kZXIgc3RhdGljIHdpZGdldHMgYWZ0ZXIgdGhlIGRvY3VtZW50IGZpbmlzaGVzIGxvYWRpbmcKICAvLyBTdGF0aWNhbGx5IHJlbmRlciBhbGwgZWxlbWVudHMgdGhhdCBhcmUgb2YgdGhpcyB3aWRnZXQncyBjbGFzcwogIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIgPSBmdW5jdGlvbigpIHsKICAgIHZhciBiaW5kaW5ncyA9IHdpbmRvdy5IVE1MV2lkZ2V0cy53aWRnZXRzIHx8IFtdOwogICAgZm9yRWFjaChiaW5kaW5ncywgZnVuY3Rpb24oYmluZGluZykgewogICAgICB2YXIgbWF0Y2hlcyA9IGJpbmRpbmcuZmluZChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpOwogICAgICBmb3JFYWNoKG1hdGNoZXMsIGZ1bmN0aW9uKGVsKSB7CiAgICAgICAgdmFyIHNpemVPYmogPSBpbml0U2l6aW5nKGVsLCBiaW5kaW5nKTsKCiAgICAgICAgdmFyIGdldFNpemUgPSBmdW5jdGlvbihlbCkgewogICAgICAgICAgaWYgKHNpemVPYmopIHsKICAgICAgICAgICAgcmV0dXJuIHt3OiBzaXplT2JqLmdldFdpZHRoKCksIGg6IHNpemVPYmouZ2V0SGVpZ2h0KCl9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXIgcmVjdCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgICByZXR1cm4ge3c6IHJlY3Qud2lkdGgsIGg6IHJlY3QuaGVpZ2h0fQogICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIGlmIChoYXNDbGFzcyhlbCwgImh0bWwtd2lkZ2V0LXN0YXRpYy1ib3VuZCIpKQogICAgICAgICAgcmV0dXJuOwogICAgICAgIGVsLmNsYXNzTmFtZSA9IGVsLmNsYXNzTmFtZSArICIgaHRtbC13aWRnZXQtc3RhdGljLWJvdW5kIjsKCiAgICAgICAgdmFyIGluaXRSZXN1bHQ7CiAgICAgICAgaWYgKGJpbmRpbmcuaW5pdGlhbGl6ZSkgewogICAgICAgICAgdmFyIHNpemUgPSBnZXRTaXplKGVsKTsKICAgICAgICAgIGluaXRSZXN1bHQgPSBiaW5kaW5nLmluaXRpYWxpemUoZWwsIHNpemUudywgc2l6ZS5oKTsKICAgICAgICAgIGVsZW1lbnREYXRhKGVsLCAiaW5pdF9yZXN1bHQiLCBpbml0UmVzdWx0KTsKICAgICAgICB9CgogICAgICAgIGlmIChiaW5kaW5nLnJlc2l6ZSkgewogICAgICAgICAgdmFyIGxhc3RTaXplID0gZ2V0U2l6ZShlbCk7CiAgICAgICAgICB2YXIgcmVzaXplSGFuZGxlciA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgdmFyIHNpemUgPSBnZXRTaXplKGVsKTsKICAgICAgICAgICAgaWYgKHNpemUudyA9PT0gMCAmJiBzaXplLmggPT09IDApCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBpZiAoc2l6ZS53ID09PSBsYXN0U2l6ZS53ICYmIHNpemUuaCA9PT0gbGFzdFNpemUuaCkKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIGxhc3RTaXplID0gc2l6ZTsKICAgICAgICAgICAgYmluZGluZy5yZXNpemUoZWwsIHNpemUudywgc2l6ZS5oLCBpbml0UmVzdWx0KTsKICAgICAgICAgIH07CgogICAgICAgICAgb24od2luZG93LCAicmVzaXplIiwgcmVzaXplSGFuZGxlcik7CgogICAgICAgICAgLy8gVGhpcyBpcyBuZWVkZWQgZm9yIGNhc2VzIHdoZXJlIHdlJ3JlIHJ1bm5pbmcgaW4gYSBTaGlueQogICAgICAgICAgLy8gYXBwLCBidXQgdGhlIHdpZGdldCBpdHNlbGYgaXMgbm90IGEgU2hpbnkgb3V0cHV0LCBidXQKICAgICAgICAgIC8vIHJhdGhlciBhIHNpbXBsZSBzdGF0aWMgd2lkZ2V0LiBPbmUgZXhhbXBsZSBvZiB0aGlzIGlzCiAgICAgICAgICAvLyBhbiBybWFya2Rvd24gZG9jdW1lbnQgdGhhdCBoYXMgcnVudGltZTpzaGlueSBhbmQgd2lkZ2V0CiAgICAgICAgICAvLyB0aGF0IGlzbid0IGluIGEgcmVuZGVyIGZ1bmN0aW9uLiBTaGlueSBvbmx5IGtub3dzIHRvCiAgICAgICAgICAvLyBjYWxsIHJlc2l6ZSBoYW5kbGVycyBmb3IgU2hpbnkgb3V0cHV0cywgbm90IGZvciBzdGF0aWMKICAgICAgICAgIC8vIHdpZGdldHMsIHNvIHdlIGRvIGl0IG91cnNlbHZlcy4KICAgICAgICAgIGlmICh3aW5kb3cualF1ZXJ5KSB7CiAgICAgICAgICAgIHdpbmRvdy5qUXVlcnkoZG9jdW1lbnQpLm9uKAogICAgICAgICAgICAgICJzaG93bi5odG1sd2lkZ2V0cyBzaG93bi5icy50YWIuaHRtbHdpZGdldHMgc2hvd24uYnMuY29sbGFwc2UuaHRtbHdpZGdldHMiLAogICAgICAgICAgICAgIHJlc2l6ZUhhbmRsZXIKICAgICAgICAgICAgKTsKICAgICAgICAgICAgd2luZG93LmpRdWVyeShkb2N1bWVudCkub24oCiAgICAgICAgICAgICAgImhpZGRlbi5odG1sd2lkZ2V0cyBoaWRkZW4uYnMudGFiLmh0bWx3aWRnZXRzIGhpZGRlbi5icy5jb2xsYXBzZS5odG1sd2lkZ2V0cyIsCiAgICAgICAgICAgICAgcmVzaXplSGFuZGxlcgogICAgICAgICAgICApOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIFRoaXMgaXMgbmVlZGVkIGZvciB0aGUgc3BlY2lmaWMgY2FzZSBvZiBpb3NsaWRlcywgd2hpY2gKICAgICAgICAgIC8vIGZsaXBzIHNsaWRlcyBiZXR3ZWVuIGRpc3BsYXk6bm9uZSBhbmQgZGlzcGxheTpibG9jay4KICAgICAgICAgIC8vIElkZWFsbHkgd2Ugd291bGQgbm90IGhhdmUgdG8gaGF2ZSBpb3NsaWRlLXNwZWNpZmljIGNvZGUKICAgICAgICAgIC8vIGhlcmUsIGJ1dCByYXRoZXIgaGF2ZSBpb3NsaWRlcyByYWlzZSBhIGdlbmVyaWMgZXZlbnQsCiAgICAgICAgICAvLyBidXQgdGhlIHJtYXJrZG93biBwYWNrYWdlIGp1c3Qgd2VudCB0byBDUkFOIHNvIHRoZQogICAgICAgICAgLy8gd2luZG93IHRvIGdldHRpbmcgdGhhdCBmaXhlZCBtYXkgYmUgbG9uZy4KICAgICAgICAgIGlmICh3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcikgewogICAgICAgICAgICAvLyBJdCdzIE9LIHRvIGxpbWl0IHRoaXMgdG8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIKICAgICAgICAgICAgLy8gYnJvd3NlcnMgYmVjYXVzZSBpb3NsaWRlcyBpdHNlbGYgb25seSBzdXBwb3J0cwogICAgICAgICAgICAvLyBzdWNoIGJyb3dzZXJzLgogICAgICAgICAgICBvbihkb2N1bWVudCwgInNsaWRlZW50ZXIiLCByZXNpemVIYW5kbGVyKTsKICAgICAgICAgICAgb24oZG9jdW1lbnQsICJzbGlkZWxlYXZlIiwgcmVzaXplSGFuZGxlcik7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YXIgc2NyaXB0RGF0YSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoInNjcmlwdFtkYXRhLWZvcj0nIiArIGVsLmlkICsgIiddW3R5cGU9J2FwcGxpY2F0aW9uL2pzb24nXSIpOwogICAgICAgIGlmIChzY3JpcHREYXRhKSB7CiAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2Uoc2NyaXB0RGF0YS50ZXh0Q29udGVudCB8fCBzY3JpcHREYXRhLnRleHQpOwogICAgICAgICAgLy8gUmVzb2x2ZSBzdHJpbmdzIG1hcmtlZCBhcyBqYXZhc2NyaXB0IGxpdGVyYWxzIHRvIG9iamVjdHMKICAgICAgICAgIGlmICghKGRhdGEuZXZhbHMgaW5zdGFuY2VvZiBBcnJheSkpIGRhdGEuZXZhbHMgPSBbZGF0YS5ldmFsc107CiAgICAgICAgICBmb3IgKHZhciBrID0gMDsgZGF0YS5ldmFscyAmJiBrIDwgZGF0YS5ldmFscy5sZW5ndGg7IGsrKykgewogICAgICAgICAgICB3aW5kb3cuSFRNTFdpZGdldHMuZXZhbHVhdGVTdHJpbmdNZW1iZXIoZGF0YS54LCBkYXRhLmV2YWxzW2tdKTsKICAgICAgICAgIH0KICAgICAgICAgIGJpbmRpbmcucmVuZGVyVmFsdWUoZWwsIGRhdGEueCwgaW5pdFJlc3VsdCk7CiAgICAgICAgICBldmFsQW5kUnVuKGRhdGEuanNIb29rcy5yZW5kZXIsIGluaXRSZXN1bHQsIFtlbCwgZGF0YS54XSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwoKICAgIGludm9rZVBvc3RSZW5kZXJIYW5kbGVycygpOwogIH0KCgogIGZ1bmN0aW9uIGhhc19qUXVlcnkzKCkgewogICAgaWYgKCF3aW5kb3cualF1ZXJ5KSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHZhciAkdmVyc2lvbiA9IHdpbmRvdy5qUXVlcnkuZm4uanF1ZXJ5OwogICAgdmFyICRtYWpvcl92ZXJzaW9uID0gcGFyc2VJbnQoJHZlcnNpb24uc3BsaXQoIi4iKVswXSk7CiAgICByZXR1cm4gJG1ham9yX3ZlcnNpb24gPj0gMzsKICB9CgogIC8qCiAgLyBTaGlueSAxLjQgYnVtcGVkIGpRdWVyeSBmcm9tIDEueCB0byAzLnggd2hpY2ggbWVhbnMgalF1ZXJ5J3MKICAvIG9uLXJlYWR5IGhhbmRsZXIgKGkuZS4sICQoZm4pKSBpcyBub3cgYXN5bmNyb25vdXMgKGkuZS4sIGl0IG5vdwogIC8gcmVhbGx5IG1lYW5zICQoc2V0VGltZW91dChmbikpLgogIC8gaHR0cHM6Ly9qcXVlcnkuY29tL3VwZ3JhZGUtZ3VpZGUvMy4wLyNicmVha2luZy1jaGFuZ2UtZG9jdW1lbnQtcmVhZHktaGFuZGxlcnMtYXJlLW5vdy1hc3luY2hyb25vdXMKICAvCiAgLyBTaW5jZSBTaGlueSB1c2VzICQoKSB0byBzY2hlZHVsZSBpbml0U2hpbnksIHNoaW55Pj0xLjQgY2FsbHMgaW5pdFNoaW55CiAgLyBvbmUgdGljayBsYXRlciB0aGFuIGl0IGRpZCBiZWZvcmUsIHdoaWNoIG1lYW5zIHN0YXRpY1JlbmRlcigpIGlzCiAgLyBjYWxsZWQgcmVuZGVyVmFsdWUoKSBlYXJsaWVyIHRoYW4gKGFkdmFuY2VkKSB3aWRnZXQgYXV0aG9ycyBtaWdodCBiZSBleHBlY3RpbmcuCiAgLyBodHRwczovL2dpdGh1Yi5jb20vcnN0dWRpby9zaGlueS9pc3N1ZXMvMjYzMAogIC8KICAvIEZvciBhIGNvbmNyZXRlIGV4YW1wbGUsIGxlYWZsZXQgaGFzIHNvbWUgbWV0aG9kcyAoZS5nLiwgdXBkYXRlQm91bmRzKQogIC8gd2hpY2ggcmVmZXJlbmNlIFNoaW55IG1ldGhvZHMgcmVnaXN0ZXJlZCBpbiBpbml0U2hpbnkgKGUuZy4sIHNldElucHV0VmFsdWUpLgogIC8gU2luY2UgbGVhZmxldCBpcyBwcml2eSB0byB0aGlzIGxpZmUtY3ljbGUsIGl0IGtub3dzIHRvIHVzZSBzZXRUaW1lb3V0KCkgdG8KICAvIGRlbGF5IGV4ZWN1dGlvbiBvZiB0aG9zZSBtZXRob2RzICh1bnRpbCBTaGlueSBtZXRob2RzIGFyZSByZWFkeSkKICAvIGh0dHBzOi8vZ2l0aHViLmNvbS9yc3R1ZGlvL2xlYWZsZXQvYmxvYi8xOGVjOTgxL2phdmFzY3JpcHQvc3JjL2luZGV4LmpzI0wyNjYtTDI2OAogIC8KICAvIElkZWFsbHkgd2lkZ2V0IGF1dGhvcnMgd291bGRuJ3QgbmVlZCB0byB1c2UgdGhpcyBzZXRUaW1lb3V0KCkgaGFjayB0aGF0CiAgLyBsZWFmbGV0IHVzZXMgdG8gY2FsbCBTaGlueSBtZXRob2RzIG9uIGEgc3RhdGljUmVuZGVyKCkuIEluIHRoZSBsb25nIHJ1biwKICAvIHRoZSBsb2dpYyBpbml0U2hpbnkgc2hvdWxkIGJlIGJyb2tlbiB1cCBzbyB0aGF0IG1ldGhvZCByZWdpc3RyYXRpb24gaGFwcGVucwogIC8gcmlnaHQgYXdheSwgYnV0IGJpbmRpbmcgaGFwcGVucyBsYXRlci4KICAqLwogIGZ1bmN0aW9uIG1heWJlU3RhdGljUmVuZGVyTGF0ZXIoKSB7CiAgICBpZiAoc2hpbnlNb2RlICYmIGhhc19qUXVlcnkzKCkpIHsKICAgICAgd2luZG93LmpRdWVyeSh3aW5kb3cuSFRNTFdpZGdldHMuc3RhdGljUmVuZGVyKTsKICAgIH0gZWxzZSB7CiAgICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTsKICAgIH0KICB9CgogIGlmIChkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKSB7CiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIiwgZnVuY3Rpb24oKSB7CiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCBhcmd1bWVudHMuY2FsbGVlLCBmYWxzZSk7CiAgICAgIG1heWJlU3RhdGljUmVuZGVyTGF0ZXIoKTsKICAgIH0sIGZhbHNlKTsKICB9IGVsc2UgaWYgKGRvY3VtZW50LmF0dGFjaEV2ZW50KSB7CiAgICBkb2N1bWVudC5hdHRhY2hFdmVudCgib25yZWFkeXN0YXRlY2hhbmdlIiwgZnVuY3Rpb24oKSB7CiAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAiY29tcGxldGUiKSB7CiAgICAgICAgZG9jdW1lbnQuZGV0YWNoRXZlbnQoIm9ucmVhZHlzdGF0ZWNoYW5nZSIsIGFyZ3VtZW50cy5jYWxsZWUpOwogICAgICAgIG1heWJlU3RhdGljUmVuZGVyTGF0ZXIoKTsKICAgICAgfQogICAgfSk7CiAgfQoKCiAgd2luZG93LkhUTUxXaWRnZXRzLmdldEF0dGFjaG1lbnRVcmwgPSBmdW5jdGlvbihkZXBuYW1lLCBrZXkpIHsKICAgIC8vIElmIG5vIGtleSwgZGVmYXVsdCB0byB0aGUgZmlyc3QgaXRlbQogICAgaWYgKHR5cGVvZihrZXkpID09PSAidW5kZWZpbmVkIikKICAgICAga2V5ID0gMTsKCiAgICB2YXIgbGluayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRlcG5hbWUgKyAiLSIgKyBrZXkgKyAiLWF0dGFjaG1lbnQiKTsKICAgIGlmICghbGluaykgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIkF0dGFjaG1lbnQgIiArIGRlcG5hbWUgKyAiLyIgKyBrZXkgKyAiIG5vdCBmb3VuZCBpbiBkb2N1bWVudCIpOwogICAgfQogICAgcmV0dXJuIGxpbmsuZ2V0QXR0cmlidXRlKCJocmVmIik7CiAgfTsKCiAgd2luZG93LkhUTUxXaWRnZXRzLmRhdGFmcmFtZVRvRDMgPSBmdW5jdGlvbihkZikgewogICAgdmFyIG5hbWVzID0gW107CiAgICB2YXIgbGVuZ3RoOwogICAgZm9yICh2YXIgbmFtZSBpbiBkZikgewogICAgICAgIGlmIChkZi5oYXNPd25Qcm9wZXJ0eShuYW1lKSkKICAgICAgICAgICAgbmFtZXMucHVzaChuYW1lKTsKICAgICAgICBpZiAodHlwZW9mKGRmW25hbWVdKSAhPT0gIm9iamVjdCIgfHwgdHlwZW9mKGRmW25hbWVdLmxlbmd0aCkgPT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQWxsIGZpZWxkcyBtdXN0IGJlIGFycmF5cyIpOwogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mKGxlbmd0aCkgIT09ICJ1bmRlZmluZWQiICYmIGxlbmd0aCAhPT0gZGZbbmFtZV0ubGVuZ3RoKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQWxsIGZpZWxkcyBtdXN0IGJlIGFycmF5cyBvZiB0aGUgc2FtZSBsZW5ndGgiKTsKICAgICAgICB9CiAgICAgICAgbGVuZ3RoID0gZGZbbmFtZV0ubGVuZ3RoOwogICAgfQogICAgdmFyIHJlc3VsdHMgPSBbXTsKICAgIHZhciBpdGVtOwogICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgbGVuZ3RoOyByb3crKykgewogICAgICAgIGl0ZW0gPSB7fTsKICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCBuYW1lcy5sZW5ndGg7IGNvbCsrKSB7CiAgICAgICAgICAgIGl0ZW1bbmFtZXNbY29sXV0gPSBkZltuYW1lc1tjb2xdXVtyb3ddOwogICAgICAgIH0KICAgICAgICByZXN1bHRzLnB1c2goaXRlbSk7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0czsKICB9OwoKICB3aW5kb3cuSFRNTFdpZGdldHMudHJhbnNwb3NlQXJyYXkyRCA9IGZ1bmN0aW9uKGFycmF5KSB7CiAgICAgIGlmIChhcnJheS5sZW5ndGggPT09IDApIHJldHVybiBhcnJheTsKICAgICAgdmFyIG5ld0FycmF5ID0gYXJyYXlbMF0ubWFwKGZ1bmN0aW9uKGNvbCwgaSkgewogICAgICAgICAgcmV0dXJuIGFycmF5Lm1hcChmdW5jdGlvbihyb3cpIHsKICAgICAgICAgICAgICByZXR1cm4gcm93W2ldCiAgICAgICAgICB9KQogICAgICB9KTsKICAgICAgcmV0dXJuIG5ld0FycmF5OwogIH07CiAgLy8gU3BsaXQgdmFsdWUgYXQgc3BsaXRDaGFyLCBidXQgYWxsb3cgc3BsaXRDaGFyIHRvIGJlIGVzY2FwZWQKICAvLyB1c2luZyBlc2NhcGVDaGFyLiBBbnkgb3RoZXIgY2hhcmFjdGVycyBlc2NhcGVkIGJ5IGVzY2FwZUNoYXIKICAvLyB3aWxsIGJlIGluY2x1ZGVkIGFzIHVzdWFsIChpbmNsdWRpbmcgZXNjYXBlQ2hhciBpdHNlbGYpLgogIGZ1bmN0aW9uIHNwbGl0V2l0aEVzY2FwZSh2YWx1ZSwgc3BsaXRDaGFyLCBlc2NhcGVDaGFyKSB7CiAgICB2YXIgcmVzdWx0cyA9IFtdOwogICAgdmFyIGVzY2FwZU1vZGUgPSBmYWxzZTsKICAgIHZhciBjdXJyZW50UmVzdWx0ID0gIiI7CiAgICBmb3IgKHZhciBwb3MgPSAwOyBwb3MgPCB2YWx1ZS5sZW5ndGg7IHBvcysrKSB7CiAgICAgIGlmICghZXNjYXBlTW9kZSkgewogICAgICAgIGlmICh2YWx1ZVtwb3NdID09PSBzcGxpdENoYXIpIHsKICAgICAgICAgIHJlc3VsdHMucHVzaChjdXJyZW50UmVzdWx0KTsKICAgICAgICAgIGN1cnJlbnRSZXN1bHQgPSAiIjsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlW3Bvc10gPT09IGVzY2FwZUNoYXIpIHsKICAgICAgICAgIGVzY2FwZU1vZGUgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjdXJyZW50UmVzdWx0ICs9IHZhbHVlW3Bvc107CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGN1cnJlbnRSZXN1bHQgKz0gdmFsdWVbcG9zXTsKICAgICAgICBlc2NhcGVNb2RlID0gZmFsc2U7CiAgICAgIH0KICAgIH0KICAgIGlmIChjdXJyZW50UmVzdWx0ICE9PSAiIikgewogICAgICByZXN1bHRzLnB1c2goY3VycmVudFJlc3VsdCk7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0czsKICB9CiAgLy8gRnVuY3Rpb24gYXV0aG9yZWQgYnkgWWlodWkvSkogQWxsYWlyZQogIHdpbmRvdy5IVE1MV2lkZ2V0cy5ldmFsdWF0ZVN0cmluZ01lbWJlciA9IGZ1bmN0aW9uKG8sIG1lbWJlcikgewogICAgdmFyIHBhcnRzID0gc3BsaXRXaXRoRXNjYXBlKG1lbWJlciwgJy4nLCAnXFwnKTsKICAgIGZvciAodmFyIGkgPSAwLCBsID0gcGFydHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIHZhciBwYXJ0ID0gcGFydHNbaV07CiAgICAgIC8vIHBhcnQgbWF5IGJlIGEgY2hhcmFjdGVyIG9yICdudW1lcmljJyBtZW1iZXIgbmFtZQogICAgICBpZiAobyAhPT0gbnVsbCAmJiB0eXBlb2YgbyA9PT0gIm9iamVjdCIgJiYgcGFydCBpbiBvKSB7CiAgICAgICAgaWYgKGkgPT0gKGwgLSAxKSkgeyAvLyBpZiB3ZSBhcmUgYXQgdGhlIGVuZCBvZiB0aGUgbGluZSB0aGVuIGV2YWx1bGF0ZQogICAgICAgICAgaWYgKHR5cGVvZiBvW3BhcnRdID09PSAic3RyaW5nIikKICAgICAgICAgICAgb1twYXJ0XSA9IHRyeUV2YWwob1twYXJ0XSk7CiAgICAgICAgfSBlbHNlIHsgLy8gb3RoZXJ3aXNlIGNvbnRpbnVlIHRvIG5leHQgZW1iZWRkZWQgb2JqZWN0CiAgICAgICAgICBvID0gb1twYXJ0XTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9OwoKICAvLyBSZXRyaWV2ZSB0aGUgSFRNTFdpZGdldCBpbnN0YW5jZSAoaS5lLiB0aGUgcmV0dXJuIHZhbHVlIG9mIGFuCiAgLy8gSFRNTFdpZGdldCBiaW5kaW5nJ3MgaW5pdGlhbGl6ZSgpIG9yIGZhY3RvcnkoKSBmdW5jdGlvbikKICAvLyBhc3NvY2lhdGVkIHdpdGggYW4gZWxlbWVudCwgb3IgbnVsbCBpZiBub25lLgogIHdpbmRvdy5IVE1MV2lkZ2V0cy5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uKGVsKSB7CiAgICByZXR1cm4gZWxlbWVudERhdGEoZWwsICJpbml0X3Jlc3VsdCIpOwogIH07CgogIC8vIEZpbmRzIHRoZSBmaXJzdCBlbGVtZW50IGluIHRoZSBzY29wZSB0aGF0IG1hdGNoZXMgdGhlIHNlbGVjdG9yLAogIC8vIGFuZCByZXR1cm5zIHRoZSBIVE1MV2lkZ2V0IGluc3RhbmNlIChpLmUuIHRoZSByZXR1cm4gdmFsdWUgb2YKICAvLyBhbiBIVE1MV2lkZ2V0IGJpbmRpbmcncyBpbml0aWFsaXplKCkgb3IgZmFjdG9yeSgpIGZ1bmN0aW9uKQogIC8vIGFzc29jaWF0ZWQgd2l0aCB0aGF0IGVsZW1lbnQsIGlmIGFueS4gSWYgbm8gZWxlbWVudCBtYXRjaGVzIHRoZQogIC8vIHNlbGVjdG9yLCBvciB0aGUgZmlyc3QgbWF0Y2hpbmcgZWxlbWVudCBoYXMgbm8gSFRNTFdpZGdldAogIC8vIGluc3RhbmNlIGFzc29jaWF0ZWQgd2l0aCBpdCwgdGhlbiBudWxsIGlzIHJldHVybmVkLgogIC8vCiAgLy8gVGhlIHNjb3BlIGFyZ3VtZW50IGlzIG9wdGlvbmFsLCBhbmQgZGVmYXVsdHMgdG8gd2luZG93LmRvY3VtZW50LgogIHdpbmRvdy5IVE1MV2lkZ2V0cy5maW5kID0gZnVuY3Rpb24oc2NvcGUsIHNlbGVjdG9yKSB7CiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAxKSB7CiAgICAgIHNlbGVjdG9yID0gc2NvcGU7CiAgICAgIHNjb3BlID0gZG9jdW1lbnQ7CiAgICB9CgogICAgdmFyIGVsID0gc2NvcGUucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7CiAgICBpZiAoZWwgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gd2luZG93LkhUTUxXaWRnZXRzLmdldEluc3RhbmNlKGVsKTsKICAgIH0KICB9OwoKICAvLyBGaW5kcyBhbGwgZWxlbWVudHMgaW4gdGhlIHNjb3BlIHRoYXQgbWF0Y2ggdGhlIHNlbGVjdG9yLCBhbmQKICAvLyByZXR1cm5zIHRoZSBIVE1MV2lkZ2V0IGluc3RhbmNlcyAoaS5lLiB0aGUgcmV0dXJuIHZhbHVlcyBvZgogIC8vIGFuIEhUTUxXaWRnZXQgYmluZGluZydzIGluaXRpYWxpemUoKSBvciBmYWN0b3J5KCkgZnVuY3Rpb24pCiAgLy8gYXNzb2NpYXRlZCB3aXRoIHRoZSBlbGVtZW50cywgaW4gYW4gYXJyYXkuIElmIGVsZW1lbnRzIHRoYXQKICAvLyBtYXRjaCB0aGUgc2VsZWN0b3IgZG9uJ3QgaGF2ZSBhbiBhc3NvY2lhdGVkIEhUTUxXaWRnZXQKICAvLyBpbnN0YW5jZSwgdGhlIHJldHVybmVkIGFycmF5IHdpbGwgY29udGFpbiBudWxscy4KICAvLwogIC8vIFRoZSBzY29wZSBhcmd1bWVudCBpcyBvcHRpb25hbCwgYW5kIGRlZmF1bHRzIHRvIHdpbmRvdy5kb2N1bWVudC4KICB3aW5kb3cuSFRNTFdpZGdldHMuZmluZEFsbCA9IGZ1bmN0aW9uKHNjb3BlLCBzZWxlY3RvcikgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMSkgewogICAgICBzZWxlY3RvciA9IHNjb3BlOwogICAgICBzY29wZSA9IGRvY3VtZW50OwogICAgfQoKICAgIHZhciBub2RlcyA9IHNjb3BlLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpOwogICAgdmFyIHJlc3VsdHMgPSBbXTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHsKICAgICAgcmVzdWx0cy5wdXNoKHdpbmRvdy5IVE1MV2lkZ2V0cy5nZXRJbnN0YW5jZShub2Rlc1tpXSkpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdHM7CiAgfTsKCiAgdmFyIHBvc3RSZW5kZXJIYW5kbGVycyA9IFtdOwogIGZ1bmN0aW9uIGludm9rZVBvc3RSZW5kZXJIYW5kbGVycygpIHsKICAgIHdoaWxlIChwb3N0UmVuZGVySGFuZGxlcnMubGVuZ3RoKSB7CiAgICAgIHZhciBoYW5kbGVyID0gcG9zdFJlbmRlckhhbmRsZXJzLnNoaWZ0KCk7CiAgICAgIGlmIChoYW5kbGVyKSB7CiAgICAgICAgaGFuZGxlcigpOwogICAgICB9CiAgICB9CiAgfQoKICAvLyBSZWdpc3RlciB0aGUgZ2l2ZW4gY2FsbGJhY2sgZnVuY3Rpb24gdG8gYmUgaW52b2tlZCBhZnRlciB0aGUKICAvLyBuZXh0IHRpbWUgc3RhdGljIHdpZGdldHMgYXJlIHJlbmRlcmVkLgogIHdpbmRvdy5IVE1MV2lkZ2V0cy5hZGRQb3N0UmVuZGVySGFuZGxlciA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7CiAgICBwb3N0UmVuZGVySGFuZGxlcnMucHVzaChjYWxsYmFjayk7CiAgfTsKCiAgLy8gVGFrZXMgYSBuZXctc3R5bGUgaW5zdGFuY2UtYm91bmQgZGVmaW5pdGlvbiwgYW5kIHJldHVybnMgYW4KICAvLyBvbGQtc3R5bGUgY2xhc3MtYm91bmQgZGVmaW5pdGlvbi4gVGhpcyBzYXZlcyB1cyBmcm9tIGhhdmluZwogIC8vIHRvIHJld3JpdGUgYWxsIHRoZSBsb2dpYyBpbiB0aGlzIGZpbGUgdG8gYWNjb21vZGF0ZSBib3RoCiAgLy8gdHlwZXMgb2YgZGVmaW5pdGlvbnMuCiAgZnVuY3Rpb24gY3JlYXRlTGVnYWN5RGVmaW5pdGlvbkFkYXB0ZXIoZGVmbikgewogICAgdmFyIHJlc3VsdCA9IHsKICAgICAgbmFtZTogZGVmbi5uYW1lLAogICAgICB0eXBlOiBkZWZuLnR5cGUsCiAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGVsLCB3aWR0aCwgaGVpZ2h0KSB7CiAgICAgICAgcmV0dXJuIGRlZm4uZmFjdG9yeShlbCwgd2lkdGgsIGhlaWdodCk7CiAgICAgIH0sCiAgICAgIHJlbmRlclZhbHVlOiBmdW5jdGlvbihlbCwgeCwgaW5zdGFuY2UpIHsKICAgICAgICByZXR1cm4gaW5zdGFuY2UucmVuZGVyVmFsdWUoeCk7CiAgICAgIH0sCiAgICAgIHJlc2l6ZTogZnVuY3Rpb24oZWwsIHdpZHRoLCBoZWlnaHQsIGluc3RhbmNlKSB7CiAgICAgICAgcmV0dXJuIGluc3RhbmNlLnJlc2l6ZSh3aWR0aCwgaGVpZ2h0KTsKICAgICAgfQogICAgfTsKCiAgICBpZiAoZGVmbi5maW5kKQogICAgICByZXN1bHQuZmluZCA9IGRlZm4uZmluZDsKICAgIGlmIChkZWZuLnJlbmRlckVycm9yKQogICAgICByZXN1bHQucmVuZGVyRXJyb3IgPSBkZWZuLnJlbmRlckVycm9yOwogICAgaWYgKGRlZm4uY2xlYXJFcnJvcikKICAgICAgcmVzdWx0LmNsZWFyRXJyb3IgPSBkZWZuLmNsZWFyRXJyb3I7CgogICAgcmV0dXJuIHJlc3VsdDsKICB9Cn0pKCk7Cg=="></script>
<script title="rglWebGL-binding" src="data:application/javascript;base64,LyogZWwgaXMgdGhlIGRpdiwgaG9sZGluZyB0aGUgcmdsIG9iamVjdCBhcyBlbC5yZ2xpbnN0YW5jZSwKICAgICB3aGljaCBob2xkcyB4IGFzIGVsLnJnbGluc3RhbmNlLnNjZW5lCiAgIHggaXMgdGhlIEpTT04gZW5jb2RlZCByZ2x3aWRnZXQuCiovCgoKSFRNTFdpZGdldHMud2lkZ2V0KHsKCiAgbmFtZTogJ3JnbFdlYkdMJywKCiAgdHlwZTogJ291dHB1dCcsCgogIGZhY3Rvcnk6IGZ1bmN0aW9uKGVsLCB3aWR0aCwgaGVpZ2h0KSB7CiAgICBlbC53aWR0aCA9IHdpZHRoOwogICAgZWwuaGVpZ2h0ID0gaGVpZ2h0OwogICAgdmFyIHJnbCA9IG5ldyByZ2x3aWRnZXRDbGFzcygpLAogICAgICAgIG9uY2hhbmdlc2VsZWN0aW9uID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZ2wuc2NlbmUuY3Jvc3N0YWxrLnNlbF9oYW5kbGUubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHJnbC5jbGVhckJydXNoKGV4Y2VwdCA9IGUucmdsU3Vic2NlbmVJZCk7CiAgICAgICAgICByZ2wuc2VsZWN0aW9uKGUsIGZhbHNlKTsKICAgICAgICB9LAogICAgICAgIG9uY2hhbmdlZmlsdGVyID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgcmdsLnNlbGVjdGlvbihlLCB0cnVlKTsKICAgICAgICB9OwogICAgCiAgICByZXR1cm4geyAKICAgICAgcmVuZGVyVmFsdWU6IGZ1bmN0aW9uKHgpIHsKICAgICAgICB2YXIgaSwgcGVsLCBwbGF5ZXIsIGdyb3VwcywKICAgICAgICAgICAgaW5TaGlueSA9ICh0eXBlb2YgU2hpbnkgIT09ICJ1bmRlZmluZWQiKTsKICAgICAgCiAgICAgICAgeC5jcm9zc3RhbGsuZ3JvdXAgPSBncm91cHMgPSBbXS5jb25jYXQoeC5jcm9zc3RhbGsuZ3JvdXApOwogICAgICAgIHguY3Jvc3N0YWxrLmlkID0gW10uY29uY2F0KHguY3Jvc3N0YWxrLmlkKTsKICAgICAgICB4LmNyb3NzdGFsay5rZXkgPSBbXS5jb25jYXQoeC5jcm9zc3RhbGsua2V5KTsKICAgICAgICB4LmNyb3NzdGFsay5zZWxfaGFuZGxlID0gbmV3IEFycmF5KGdyb3Vwcy5sZW5ndGgpOwogICAgICAgIHguY3Jvc3N0YWxrLmZpbF9oYW5kbGUgPSBuZXcgQXJyYXkoZ3JvdXBzLmxlbmd0aCk7CiAgICAgICAgeC5jcm9zc3RhbGsuc2VsZWN0aW9uID0gW107CiAgICAgICAgZm9yIChpID0gMDsgaSA8IGdyb3Vwcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgeC5jcm9zc3RhbGsuc2VsX2hhbmRsZVtpXSA9IG5ldyBjcm9zc3RhbGsuU2VsZWN0aW9uSGFuZGxlKGdyb3Vwc1tpXSwge3NoYXJlZElkOiB4LmNyb3NzdGFsay5pZFtpXX0pOwogICAgICAgICAgeC5jcm9zc3RhbGsuc2VsX2hhbmRsZVtpXS5vbigiY2hhbmdlIiwgb25jaGFuZ2VzZWxlY3Rpb24pOwogICAgICAgICAgeC5jcm9zc3RhbGsuZmlsX2hhbmRsZVtpXSA9IG5ldyBjcm9zc3RhbGsuRmlsdGVySGFuZGxlKGdyb3Vwc1tpXSwge3NoYXJlZElkOiB4LmNyb3NzdGFsay5pZFtpXX0pOwogICAgICAgICAgeC5jcm9zc3RhbGsuZmlsX2hhbmRsZVtpXS5vbigiY2hhbmdlIiwgb25jaGFuZ2VmaWx0ZXIpOwogICAgICAgIH0KICAgICAgICBpZiAoaW5TaGlueSkgewogICAgICAgICAgLy8gU2hpbnkgY2FsbHMgdGhpcyBtdWx0aXBsZSB0aW1lcywgc28gd2UgbmVlZCBleHRyYSBjbGVhbnVwCiAgICAgICAgICAvLyBiZXR3ZWVuCiAgICAgICAgICByZ2wuc3BoZXJlID0gdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgICByZ2wuaW5pdGlhbGl6ZShlbCwgeCk7CiAgICAgICAgcmdsLmluaXRHTCgpOwogIAogIC8qIFdlIG1pZ2h0IGhhdmUgYmVlbiBjYWxsZWQgYWZ0ZXIgKHNvbWUgb2YpIHRoZSBwbGF5ZXJzIHdlcmUgcmVuZGVyZWQuCiAgICAgV2UgbmVlZCB0byBtYWtlIHN1cmUgd2UgcmVzcG9uZCB0byB0aGVpciBpbml0aWFsIHZhbHVlcy4gKi8KCiAgICAgICAgaWYgKHR5cGVvZiB4LnBsYXllcnMgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICB2YXIgcGxheWVycyA9IFtdLmNvbmNhdCh4LnBsYXllcnMpOwogICAgICAgICAgZm9yIChpID0gMDsgaSA8IHBsYXllcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgcGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocGxheWVyc1tpXSk7CiAgICAgICAgICAgIGlmIChwZWwpIHsKICAgICAgICAgICAgICBwbGF5ZXIgPSBwZWwucmdsUGxheWVyOwogICAgICAgICAgICAgIGlmIChwbGF5ZXIgJiYgKCFwbGF5ZXIuaW5pdGlhbGl6ZWQgfHwgaW5TaGlueSkpIHsKICAgICAgICAgICAgICAgIHJnbC5QbGF5ZXIocGVsLCBwbGF5ZXIpOwogICAgICAgICAgICAgICAgcGxheWVyLmluaXRpYWxpemVkID0gdHJ1ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmdsLmRyYWcgPSAwOwogICAgICAgIHJnbC5kcmF3U2NlbmUoKTsKICAgICAgfSwKCiAgICAgIHJlc2l6ZTogZnVuY3Rpb24od2lkdGgsIGhlaWdodCkgewogICAgICAgIGVsLndpZHRoID0gd2lkdGg7CiAgICAgICAgZWwuaGVpZ2h0ID0gaGVpZ2h0OwogICAgICAgIGVsLnJnbGluc3RhbmNlLnJlc2l6ZShlbCk7CiAgICAgICAgZWwucmdsaW5zdGFuY2UuZHJhd1NjZW5lKCk7CiAgICAgIH0KICAgIH07CiAgfQp9KTsK"></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,Ly8vLyBUbyBnZW5lcmF0ZSB0aGUgaGVscCBwYWdlcyBmb3IgdGhpcyBsaWJyYXJ5LCB1c2UKCi8vIGpzZG9jIC0tdGVtcGxhdGUgL3Vzci9sb2NhbC9saWIvbm9kZV9tb2R1bGVzL2Zvb2RvYy90ZW1wbGF0ZSAqLnNyYy5qcyAtUiBSRUFETUUubWQgLWMgSlNEb2MuanNvbgoKLy8gVG8gdGVzdCwgc2V0IGVudmlyb25tZW50IHZhcmlhYmxlIFJHTF9ERUJVR0dJTkc9dHJ1ZQovLyBiZWZvcmUgYnVpbGRpbmcuCgovKiBnbG9iYWxzIHJnbHdpZGdldENsYXNzOiB0cnVlICovCgovKioKICogVGhlIGNsYXNzIG9mIGFuIHJnbCB3aWRnZXQKICogQGNsYXNzCiovCnJnbHdpZGdldENsYXNzID0gZnVuY3Rpb24oKSB7CiAgICB0aGlzLmNhbnZhcyA9IG51bGw7CiAgICB0aGlzLnVzZXJNYXRyaXggPSBuZXcgQ2FudmFzTWF0cml4NCgpOwogICAgdGhpcy50eXBlcyA9IFtdOwogICAgdGhpcy5wck1hdHJpeCA9IG5ldyBDYW52YXNNYXRyaXg0KCk7CiAgICB0aGlzLm12TWF0cml4ID0gbmV3IENhbnZhc01hdHJpeDQoKTsKICAgIHRoaXMudnAgPSBudWxsOwogICAgdGhpcy5wcm12TWF0cml4ID0gbnVsbDsKICAgIHRoaXMub3JpZ3MgPSBudWxsOwogICAgdGhpcy5nbCA9IG51bGw7CiAgICB0aGlzLnNjZW5lID0gbnVsbDsKICAgIHRoaXMuc2VsZWN0ID0ge3N0YXRlOiAiaW5hY3RpdmUiLCBzdWJzY2VuZTogbnVsbCwgcmVnaW9uOiB7cDE6IHt4OjAsIHk6MH0sIHAyOiB7eDowLCB5OjB9fX07CiAgICB0aGlzLmRyYXdpbmcgPSBmYWxzZTsKfTsKCiAgICByZ2x3aWRnZXRDbGFzcy5mX2lzX2xpdCA9IDE7CiAgICByZ2x3aWRnZXRDbGFzcy5mX2lzX3Ntb290aCA9IDI7CiAgICByZ2x3aWRnZXRDbGFzcy5mX2hhc190ZXh0dXJlID0gNDsKICAgIHJnbHdpZGdldENsYXNzLmZfZGVwdGhfc29ydCA9IDg7CiAgICByZ2x3aWRnZXRDbGFzcy5mX2ZpeGVkX3F1YWRzID0gMTY7CiAgICByZ2x3aWRnZXRDbGFzcy5mX2lzX3RyYW5zcGFyZW50ID0gMzI7CiAgICByZ2x3aWRnZXRDbGFzcy5mX2lzX2xpbmVzID0gNjQ7CiAgICByZ2x3aWRnZXRDbGFzcy5mX3Nwcml0ZXNfM2QgPSAxMjg7CiAgICByZ2x3aWRnZXRDbGFzcy5mX2lzX3N1YnNjZW5lID0gMjU2OwogICAgcmdsd2lkZ2V0Q2xhc3MuZl9pc19jbGlwcGxhbmVzID0gNTEyOwogICAgcmdsd2lkZ2V0Q2xhc3MuZl9maXhlZF9zaXplID0gMTAyNDsKICAgIHJnbHdpZGdldENsYXNzLmZfaXNfcG9pbnRzID0gMjA0ODsKICAgIHJnbHdpZGdldENsYXNzLmZfaXNfdHdvc2lkZWQgPSA0MDk2OwogICAgcmdsd2lkZ2V0Q2xhc3MuZl9mYXRfbGluZXMgPSA4MTkyOwogICAgcmdsd2lkZ2V0Q2xhc3MuZl9pc19icnVzaCA9IDE2Mzg0OwogICAgcmdsd2lkZ2V0Q2xhc3MuZl9oYXNfZm9nID0gMzI3Njg7CiAgICByZ2x3aWRnZXRDbGFzcy5mX3JvdGF0aW5nID0gNjU1MzY7CiAgICAKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5mb2dOb25lID0gMDsKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5mb2dMaW5lYXIgPSAxOwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmZvZ0V4cCA9IDI7CiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZm9nRXhwMiA9IDM7CgogICAgLyoqCiAgICAgKiBNZXRob2RzIHJlbGF0ZWQgdG8gb2Jzb2xldGUgYXBwcm9hY2hlcy4KICAgICAqIEBuYW1lIF9fX09CU09MRVRFX01FVEhPRFNfX18KICAgICAqIEBtZW1iZXJvZiByZ2x3aWRnZXRDbGFzcwogICAgICogQGtpbmQgZnVuY3Rpb24KICAgICAqIEBpbnN0YW5jZQogICAgICovCiAgICAgCiAgICAvKioKICAgICAqIFN0YXJ0IHRoZSB3cml0ZVdlYkdMIHNjZW5lLiBUaGlzIGlzIG9ubHkgdXNlZCBieSB3cml0ZVdlYkdMOyByZ2x3aWRnZXQgaGFzCiAgICAgICBubyBkZWJ1ZyBlbGVtZW50LgogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHR5cGVvZiB0aGlzLnByZWZpeCAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICB0aGlzLmRlYnVnZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMucHJlZml4ICsgImRlYnVnIik7CiAgICAgICAgdGhpcy5kZWJ1ZygiIik7CiAgICAgIH0KICAgICAgdGhpcy5kcmFnID0gMDsKICAgICAgdGhpcy5kcmF3U2NlbmUoKTsKICAgIH07Cg=="></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,ICAgIC8qKgogICAgICogVXRpbGl0eSBtZXRob2RzCiAgICAgKiBAbmFtZSBfX19VVElMSVRZX01FVEhPRFNfX18KICAgICAqIEBtZW1iZXJvZiByZ2x3aWRnZXRDbGFzcwogICAgICogQGtpbmQgZnVuY3Rpb24KICAgICAqIEBpbnN0YW5jZQogICAgICovCiAgICAgCiAgICAvKioKICAgICAqIE11bHRpcGx5IG1hdHJpeCBieSB2ZWN0b3IKICAgICAqIEByZXR1cm5zIHtudW1iZXJbXX0KICAgICAqIEBwYXJhbSBNIHtudW1iZXJbXVtdfSBMZWZ0IG9wZXJhbmQKICAgICAqIEBwYXJhbSB2IHtudW1iZXJbXX0gUmlnaHQgb3BlcmFuZAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5tdWx0TVYgPSBmdW5jdGlvbihNLCB2KSB7CiAgICAgICAgcmV0dXJuIFsgTS5tMTEgKiB2WzBdICsgTS5tMTIgKiB2WzFdICsgTS5tMTMgKiB2WzJdICsgTS5tMTQgKiB2WzNdLAogICAgICAgICAgICAgICAgIE0ubTIxICogdlswXSArIE0ubTIyICogdlsxXSArIE0ubTIzICogdlsyXSArIE0ubTI0ICogdlszXSwKICAgICAgICAgICAgICAgICBNLm0zMSAqIHZbMF0gKyBNLm0zMiAqIHZbMV0gKyBNLm0zMyAqIHZbMl0gKyBNLm0zNCAqIHZbM10sCiAgICAgICAgICAgICAgICAgTS5tNDEgKiB2WzBdICsgTS5tNDIgKiB2WzFdICsgTS5tNDMgKiB2WzJdICsgTS5tNDQgKiB2WzNdCiAgICAgICAgICAgICAgIF07CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIE11bHRpcGx5IHJvdyB2ZWN0b3IgYnkgTWF0cml4CiAgICAgKiBAcmV0dXJucyB7bnVtYmVyW119CiAgICAgKiBAcGFyYW0gdiB7bnVtYmVyW119IGxlZnQgb3BlcmFuZAogICAgICogQHBhcmFtIE0ge251bWJlcltdW119IHJpZ2h0IG9wZXJhbmQKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MubXVsdFZNID0gZnVuY3Rpb24odiwgTSkgewogICAgICAgIHJldHVybiBbIE0ubTExICogdlswXSArIE0ubTIxICogdlsxXSArIE0ubTMxICogdlsyXSArIE0ubTQxICogdlszXSwKICAgICAgICAgICAgICAgICBNLm0xMiAqIHZbMF0gKyBNLm0yMiAqIHZbMV0gKyBNLm0zMiAqIHZbMl0gKyBNLm00MiAqIHZbM10sCiAgICAgICAgICAgICAgICAgTS5tMTMgKiB2WzBdICsgTS5tMjMgKiB2WzFdICsgTS5tMzMgKiB2WzJdICsgTS5tNDMgKiB2WzNdLAogICAgICAgICAgICAgICAgIE0ubTE0ICogdlswXSArIE0ubTI0ICogdlsxXSArIE0ubTM0ICogdlsyXSArIE0ubTQ0ICogdlszXQogICAgICAgICAgICAgICBdOwogICAgfTsKICAgIAogICAgLyoqCiAgICAgKiBFdWNsaWRlYW4gbGVuZ3RoIG9mIGEgdmVjdG9yCiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfQogICAgICogQHBhcmFtIHYge251bWJlcltdfQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy52bGVuID0gZnVuY3Rpb24odikgewogICAgICByZXR1cm4gTWF0aC5zcXJ0KHJnbHdpZGdldENsYXNzLmRvdHByb2QodiwgdikpOwogICAgfTsKCiAgICAvKioKICAgICAqIERvdCBwcm9kdWN0IG9mIHR3byB2ZWN0b3JzCiAgICAgKiBAaW5zdGFuY2Ugcmdsd2lkZ2V0Q2xhc3MKICAgICAqIEByZXR1cm5zIHtudW1iZXJ9CiAgICAgKiBAcGFyYW0gYSB7bnVtYmVyW119CiAgICAgKiBAcGFyYW0gYiB7bnVtYmVyW119CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLmRvdHByb2QgPSBmdW5jdGlvbihhLCBiKSB7CiAgICAgIHJldHVybiBhWzBdKmJbMF0gKyBhWzFdKmJbMV0gKyBhWzJdKmJbMl07CiAgICB9OwoKICAgIC8qKgogICAgICogQ3Jvc3MgcHJvZHVjdCBvZiB0d28gdmVjdG9ycwogICAgICogQHJldHVybnMge251bWJlcltdfQogICAgICogQHBhcmFtIGEge251bWJlcltdfQogICAgICogQHBhcmFtIGIge251bWJlcltdfQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy54cHJvZCA9IGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgcmV0dXJuIFthWzFdKmJbMl0gLSBhWzJdKmJbMV0sCiAgICAgICAgICBhWzJdKmJbMF0gLSBhWzBdKmJbMl0sCiAgICAgICAgICBhWzBdKmJbMV0gLSBhWzFdKmJbMF1dOwogICAgfTsKCiAgICAvKioKICAgICAqIEJpbmQgdmVjdG9ycyBvciBtYXRyaWNlcyBieSBjb2x1bW5zCiAgICAgKiBAcmV0dXJucyB7bnVtYmVyW11bXX0KICAgICAqIEBwYXJhbSBhIHtudW1iZXJbXVtdfQogICAgICogQHBhcmFtIGIge251bWJlcltdfG51bWJlcltdW119CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLmNiaW5kID0gZnVuY3Rpb24oYSwgYikgewogICAgICBpZiAoYi5sZW5ndGggPCBhLmxlbmd0aCkKICAgICAgICBiID0gcmdsd2lkZ2V0Q2xhc3MucmVwZWF0VG9MZW4oYiwgYS5sZW5ndGgpOwogICAgICBlbHNlIGlmIChhLmxlbmd0aCA8IGIubGVuZ3RoKQogICAgICAgIGEgPSByZ2x3aWRnZXRDbGFzcy5yZXBlYXRUb0xlbihhLCBiLmxlbmd0aCk7CiAgICAgIHJldHVybiBhLm1hcChmdW5jdGlvbihjdXJyZW50VmFsdWUsIGluZGV4KSB7CiAgICAgICAgICAgIHJldHVybiBbXS5jb25jYXQoY3VycmVudFZhbHVlKS5jb25jYXQoYltpbmRleF0pOwogICAgICB9KTsKICAgIH07CgogICAgLyoqCiAgICAgKiBTd2FwIGVsZW1lbnRzCiAgICAgKiBAcmV0dXJucyB7YW55W119CiAgICAgKiBAcGFyYW0gYSB7YW55W119CiAgICAgKiBAcGFyYW0gaSB7bnVtYmVyfSBFbGVtZW50IHRvIHN3YXAKICAgICAqIEBwYXJhbSBqIHtudW1iZXJ9IE90aGVyIGVsZW1lbnQgdG8gc3dhcAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5zd2FwID0gZnVuY3Rpb24oYSwgaSwgaikgewogICAgICB2YXIgdGVtcCA9IGFbaV07CiAgICAgIGFbaV0gPSBhW2pdOwogICAgICBhW2pdID0gdGVtcDsKICAgIH07CgogICAgLyoqCiAgICAgKiBGbGF0dGVuIGEgbWF0cml4IGludG8gYSB2ZWN0b3IKICAgICAqIEByZXR1cm5zIHthbnlbXX0KICAgICAqIEBwYXJhbSBhIHthbnlbXVtdfQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5mbGF0dGVuID0gZnVuY3Rpb24oYXJyLCByZXN1bHQpIHsKICAgICAgdmFyIHZhbHVlOwogICAgICBpZiAodHlwZW9mIHJlc3VsdCA9PT0gInVuZGVmaW5lZCIpIHJlc3VsdCA9IFtdOwogICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoID0gYXJyLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFsdWUgPSBhcnJbaV07CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7CiAgICAgICAgICByZ2x3aWRnZXRDbGFzcy5mbGF0dGVuKHZhbHVlLCByZXN1bHQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIC8qKgogICAgICogc2V0IGVsZW1lbnQgb2YgMWQgb3IgMmQgYXJyYXkgYXMgaWYgaXQgd2FzIGZsYXR0ZW5lZC4KICAgICAqIENvbHVtbiBtYWpvciwgemVybyBiYXNlZCEKICAgICAqIEByZXR1cm5zIHthbnlbXXxhbnlbXVtdfQogICAgICogQHBhcmFtIHthbnlbXXxhbnlbXVtdfSBhIC0gYXJyYXkKICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpIC0gZWxlbWVudAogICAgICogQHBhcmFtIHthbnl9IHZhbHVlCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5zZXRFbGVtZW50ID0gZnVuY3Rpb24oYSwgaSwgdmFsdWUpIHsKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYVswXSkpIHsKICAgICAgICB2YXIgZGltID0gYS5sZW5ndGgsCiAgICAgICAgICAgIGNvbCA9IE1hdGguZmxvb3IoaS9kaW0pLAogICAgICAgICAgICByb3cgPSBpICUgZGltOwogICAgICAgIGFbcm93XVtjb2xdID0gdmFsdWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYVtpXSA9IHZhbHVlOwogICAgICB9CiAgICB9OwoKICAgIC8qKgogICAgICogVHJhbnNwb3NlIGFuIGFycmF5CiAgICAgKiBAcmV0dXJucyB7YW55W11bXX0KICAgICAqIEBwYXJhbSB7YW55W11bXX0gYQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUudHJhbnNwb3NlID0gZnVuY3Rpb24oYSkgewogICAgICB2YXIgbmV3QXJyYXkgPSBbXSwKICAgICAgICAgIG4gPSBhLmxlbmd0aCwKICAgICAgICAgIG0gPSBhWzBdLmxlbmd0aCwKICAgICAgICAgIGk7CiAgICAgIGZvcihpID0gMDsgaSA8IG07IGkrKyl7CiAgICAgICAgbmV3QXJyYXkucHVzaChbXSk7CiAgICAgIH0KCiAgICAgIGZvcihpID0gMDsgaSA8IG47IGkrKyl7CiAgICAgICAgZm9yKHZhciBqID0gMDsgaiA8IG07IGorKyl7CiAgICAgICAgICBuZXdBcnJheVtqXS5wdXNoKGFbaV1bal0pOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbmV3QXJyYXk7CiAgICB9OwoKICAgIC8qKgogICAgICogQ2FsY3VsYXRlIHN1bSBvZiBzcXVhcmVzIG9mIGEgbnVtZXJpYyB2ZWN0b3IKICAgICAqIEByZXR1cm5zIHtudW1iZXJ9CiAgICAgKiBAcGFyYW0ge251bWJlcltdfSB4CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5zdW1zcSA9IGZ1bmN0aW9uKHgpIHsKICAgICAgdmFyIHJlc3VsdCA9IDAsIGk7CiAgICAgIGZvciAoaT0wOyBpIDwgeC5sZW5ndGg7IGkrKykKICAgICAgICByZXN1bHQgKz0geFtpXSp4W2ldOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKCiAgICAvKioKICAgICAqIENvbnZlcnQgYSBtYXRyaXggdG8gYSBDYW52YXNNYXRyaXg0CiAgICAgKiBAcmV0dXJucyB7Q2FudmFzTWF0cml4NH0KICAgICAqIEBwYXJhbSB7bnVtYmVyW11bXXxudW1iZXJbXX0gbWF0CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS50b0NhbnZhc01hdHJpeDQgPSBmdW5jdGlvbihtYXQpIHsKICAgICAgaWYgKG1hdCBpbnN0YW5jZW9mIENhbnZhc01hdHJpeDQpCiAgICAgICAgcmV0dXJuIG1hdDsKICAgICAgdmFyIHJlc3VsdCA9IG5ldyBDYW52YXNNYXRyaXg0KCk7CiAgICAgIG1hdCA9IHJnbHdpZGdldENsYXNzLmZsYXR0ZW4odGhpcy50cmFuc3Bvc2UobWF0KSk7CiAgICAgIHJlc3VsdC5sb2FkKG1hdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIC8qKgogICAgICogQ29udmVydCBhbiBSLXN0eWxlIG51bWVyaWMgY29sb3VyIHN0cmluZyB0byBhbiByZ2IgdmVjdG9yCiAgICAgKiBAcmV0dXJucyB7bnVtYmVyW119CiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcwogICAgICovCiAgICAvKiBqc2hpbnQgYml0d2lzZTpmYWxzZSAqLyAKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5zdHJpbmdUb1JnYiA9IGZ1bmN0aW9uKHMpIHsKICAgICAgcyA9IHMucmVwbGFjZSgiIyIsICIiKTsKICAgICAgdmFyIGJpZ2ludCA9IHBhcnNlSW50KHMsIDE2KTsKICAgICAgcmV0dXJuIFsoKGJpZ2ludCA+PiAxNikgJiAyNTUpLzI1NSwKICAgICAgICAgICAgICAoKGJpZ2ludCA+PiA4KSAmIDI1NSkvMjU1LAogICAgICAgICAgICAgICAoYmlnaW50ICYgMjU1KS8yNTVdOwogICAgfTsKICAgIC8qIGpzaGludCBiaXR3aXNlOnRydWUgKi8KICAgIC8qKgogICAgICogV2hpY2ggbGlzdCBkb2VzIGEgcGFydGljdWxhciBpZCBjb21lIGZyb20/CiAgICAgKiBAcmV0dXJucyB7IHN0cmluZyB9CiAgICAgKiBAcGFyYW0ge251bWJlcn0gaWQgVGhlIGlkIHRvIGxvb2sgdXAuCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS53aGljaExpc3QgPSBmdW5jdGlvbihpZCkgewogICAgICB2YXIgb2JqID0gdGhpcy5nZXRPYmooaWQpLAogICAgICAgICAgZmxhZ3MgPSBvYmouZmxhZ3M7CiAgICAgICAgaWYgKG9iai50eXBlID09PSAibGlnaHQiKQogICAgICAgICAgcmV0dXJuICJsaWdodHMiOwogICAgICAgIGlmIChyZ2x3aWRnZXRDbGFzcy5pc1NldChmbGFncywgcmdsd2lkZ2V0Q2xhc3MuZl9pc19zdWJzY2VuZSkpCiAgICAgICAgICAgIHJldHVybiAic3Vic2NlbmVzIjsKICAgICAgICBpZiAocmdsd2lkZ2V0Q2xhc3MuaXNTZXQoZmxhZ3MsIHJnbHdpZGdldENsYXNzLmZfaXNfY2xpcHBsYW5lcykpCiAgICAgICAgICAgIHJldHVybiAiY2xpcHBsYW5lcyI7CiAgICAgICAgaWYgKHJnbHdpZGdldENsYXNzLmlzU2V0KGZsYWdzLCByZ2x3aWRnZXRDbGFzcy5mX2lzX3RyYW5zcGFyZW50KSkKICAgICAgICAgICAgcmV0dXJuICJ0cmFuc3BhcmVudCI7CiAgICAgICAgcmV0dXJuICJvcGFxdWUiOwogICAgfTsKICAgIAogICAgLyoqCiAgICAgKiBUYWtlIGEgY29tcG9uZW50LWJ5LWNvbXBvbmVudCBwcm9kdWN0IG9mIHR3byAzIHZlY3RvcnMKICAgICAqIEByZXR1cm5zIHtudW1iZXJbXX0KICAgICAqIEBwYXJhbSB7bnVtYmVyW119IHgKICAgICAqIEBwYXJhbSB7bnVtYmVyW119IHkKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmNvbXBvbmVudFByb2R1Y3QgPSBmdW5jdGlvbih4LCB5KSB7CiAgICAgIGlmICh0eXBlb2YgeSA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICB0aGlzLmFsZXJ0T25jZSgiQmFkIGFyZyB0byBjb21wb25lbnRQcm9kdWN0Iik7CiAgICAgIH0KICAgICAgdmFyIHJlc3VsdCA9IG5ldyBGbG9hdDMyQXJyYXkoMyksIGk7CiAgICAgIGZvciAoaSA9IDA7IGk8MzsgaSsrKQogICAgICAgIHJlc3VsdFtpXSA9IHhbaV0qeVtpXTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgLyoqCiAgICAgKiBHZXQgbmV4dCBoaWdoZXIgcG93ZXIgb2YgdHdvCiAgICAgKiBAcmV0dXJucyB7IG51bWJlciB9CiAgICAgKiBAcGFyYW0geyBudW1iZXIgfSB2YWx1ZSAtIGlucHV0IHZhbHVlCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5nZXRQb3dlck9mVHdvID0gZnVuY3Rpb24odmFsdWUpIHsKICAgICAgdmFyIHBvdyA9IDE7CiAgICAgIHdoaWxlKHBvdzx2YWx1ZSkgewogICAgICAgIHBvdyAqPSAyOwogICAgICB9CiAgICAgIHJldHVybiBwb3c7CiAgICB9OwoKICAgIC8qKgogICAgICogVW5pcXVlIGVudHJpZXMKICAgICAqIEByZXR1cm5zIHsgYW55W10gfQogICAgICogQHBhcmFtIHsgYW55W10gfSBhcnIgLSBBbiBhcnJheQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUudW5pcXVlID0gZnVuY3Rpb24oYXJyKSB7CiAgICAgIGFyciA9IFtdLmNvbmNhdChhcnIpOwogICAgICByZXR1cm4gYXJyLmZpbHRlcihmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIHNlbGYpIHsKICAgICAgICByZXR1cm4gc2VsZi5pbmRleE9mKHZhbHVlKSA9PT0gaW5kZXg7CiAgICAgIH0pOwogICAgfTsKCiAgICAvKioKICAgICAqIFNoYWxsb3cgY29tcGFyZSBvZiBhcnJheXMKICAgICAqIEByZXR1cm5zIHsgYm9vbGVhbiB9CiAgICAgKiBAcGFyYW0geyBhbnlbXSB9IGEgLSBBbiBhcnJheQogICAgICogQHBhcmFtIHsgYW55W10gfSBiIC0gQW5vdGhlciBhcnJheQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZXF1YWxBcnJheXMgPSBmdW5jdGlvbihhLCBiKSB7CiAgICAgIHJldHVybiBhID09PSBiIHx8IChhICYmIGIgJiYKICAgICAgICAgICAgICAgICAgICAgIGEubGVuZ3RoID09PSBiLmxlbmd0aCAmJgogICAgICAgICAgICAgICAgICAgICAgYS5ldmVyeShmdW5jdGlvbih2LCBpKSB7cmV0dXJuIHYgPT09IGJbaV07fSkpOwogICAgfTsKICAgIAogICAgLyoqCiAgICAgKiBSZXBlYXQgYW4gYXJyYXkgdG8gYSBkZXNpcmVkIGxlbmd0aAogICAgICogQHJldHVybnMge2FueVtdfQogICAgICogQHBhcmFtIHthbnkgfCBhbnlbXX0gYXJyIFRoZSBpbnB1dCBhcnJheQogICAgICogQHBhcmFtIHtudW1iZXJ9IGxlbiBUaGUgZGVzaXJlZCBvdXRwdXQgbGVuZ3RoCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnJlcGVhdFRvTGVuID0gZnVuY3Rpb24oYXJyLCBsZW4pIHsKICAgICAgYXJyID0gW10uY29uY2F0KGFycik7CiAgICAgIGlmICghYXJyLmxlbmd0aCkgCiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoImFycmF5IGlzIGxlbmd0aCAwIik7CiAgICAgIHdoaWxlIChhcnIubGVuZ3RoIDwgbGVuLzIpCiAgICAgICAgYXJyID0gYXJyLmNvbmNhdChhcnIpOwogICAgICByZXR1cm4gYXJyLmNvbmNhdChhcnIuc2xpY2UoMCwgbGVuIC0gYXJyLmxlbmd0aCkpOwogICAgfTsKCiAgICAvKioKICAgICAqIEdpdmUgYSBzaW5nbGUgYWxlcnQgbWVzc2FnZSwgbm90IHRvIGJlIHJlcGVhdGVkLgogICAgICogQHBhcmFtIHtzdHJpbmd9IG1zZyAgVGhlIG1lc3NhZ2UgdG8gZ2l2ZS4KICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmFsZXJ0T25jZSA9IGZ1bmN0aW9uKG1zZykgewogICAgICAvLyBkZWJ1Z2dlcjsKICAgICAgaWYgKHR5cGVvZiB0aGlzLmFsZXJ0ZWQgIT09ICJ1bmRlZmluZWQiKQogICAgICAgIHJldHVybjsKICAgICAgdGhpcy5hbGVydGVkID0gdHJ1ZTsKICAgICAgYWxlcnQobXNnKTsKICAgIH07CgogICAgLyoqCiAgICAgKiBHZXQgYW4gb2JqZWN0IGJ5IGlkIG51bWJlci4KICAgICAqIEByZXR1cm5zIHsgT2JqZWN0IH0KICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpZAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZ2V0T2JqID0gZnVuY3Rpb24oaWQpIHsKICAgICAgaWYgKHR5cGVvZiBpZCAhPT0gIm51bWJlciIpIHsKICAgICAgICB0aGlzLmFsZXJ0T25jZSgiZ2V0T2JqIGlkIGlzICIrdHlwZW9mIGlkKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5zY2VuZS5vYmplY3RzW2lkXTsKICAgIH07CgogICAgLyoqCiAgICAgKiBHZXQgaWRzIG9mIGEgcGFydGljdWxhciB0eXBlIGZyb20gYSBzdWJzY2VuZSBvciB0aGUgd2hvbGUgc2NlbmUKICAgICAqIEByZXR1cm5zIHsgbnVtYmVyW10gfQogICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgV2hhdCB0eXBlIG9mIG9iamVjdD8KICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdWJzY2VuZSAgV2hpY2ggc3Vic2NlbmU/ICBJZiBub3QgZ2l2ZW4sIGZpbmQgaW4gdGhlIHdob2xlIHNjZW5lCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5nZXRJZHNCeVR5cGUgPSBmdW5jdGlvbih0eXBlLCBzdWJzY2VuZSkgewogICAgICB2YXIKICAgICAgICByZXN1bHQgPSBbXSwgaSwgc2VsZiA9IHRoaXMsIGlkczsKICAgICAgaWYgKHR5cGVvZiBzdWJzY2VuZSA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnNjZW5lLm9iamVjdHMpLmZvckVhY2goCiAgICAgICAgICBmdW5jdGlvbihrZXkpIHsKICAgICAgICAgICAga2V5ID0gcGFyc2VJbnQoa2V5LCAxMCk7CiAgICAgICAgICAgIGlmIChzZWxmLmdldE9iaihrZXkpLnR5cGUgPT09IHR5cGUpCiAgICAgICAgICAgICAgcmVzdWx0LnB1c2goa2V5KTsKICAgICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIGlkcyA9IHRoaXMuZ2V0T2JqKHN1YnNjZW5lKS5vYmplY3RzOwogICAgICAgIGZvciAoaT0wOyBpIDwgaWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBpZiAodGhpcy5nZXRPYmooaWRzW2ldKS50eXBlID09PSB0eXBlKSB7CiAgICAgICAgICAgIHJlc3VsdC5wdXNoKGlkc1tpXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIC8qKgogICAgICogR2V0IGEgcGFydGljdWxhciBtYXRlcmlhbCBwcm9wZXJ0eSBmb3IgYW4gb2JqCiAgICAgKiBAcmV0dXJucyB7IGFueSB9CiAgICAgKiBAcGFyYW0ge29iamVjdH0gb2JqICBXaGljaCBvYmplY3Q/CiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvcGVydHkgV2hpY2ggbWF0ZXJpYWwgcHJvcGVydHk/CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5nZXRNYXRlcmlhbCA9IGZ1bmN0aW9uKG9iaiwgcHJvcGVydHkpIHsKICAgICAgdmFyIG1hdDsKICAgICAgaWYgKHR5cGVvZiBvYmoubWF0ZXJpYWwgPT09ICJ1bmRlZmluZWQiKQogICAgICAgIGNvbnNvbGUuZXJyb3IoIm1hdGVyaWFsIHVuZGVmaW5lZCIpOwogICAgICBtYXQgPSBvYmoubWF0ZXJpYWxbcHJvcGVydHldOwogICAgICBpZiAodHlwZW9mIG1hdCA9PT0gInVuZGVmaW5lZCIpCiAgICAgICAgICBtYXQgPSB0aGlzLnNjZW5lLm1hdGVyaWFsW3Byb3BlcnR5XTsKICAgICAgcmV0dXJuIG1hdDsKICAgIH07CiAgICAKICAgLyoqCiAgICAgKiBHZXQgYSBwYXJ0aWN1bGFyIG1hdGVyaWFsIHByb3BlcnR5IGZvciBhbiBpZAogICAgICogQHJldHVybnMgeyBhbnkgfQogICAgICogQHBhcmFtIHtudW1iZXJ9IGlkICBXaGljaCBvYmplY3Q/CiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvcGVydHkgV2hpY2ggbWF0ZXJpYWwgcHJvcGVydHk/CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5nZXRNYXRlcmlhbElkID0gZnVuY3Rpb24oaWQsIHByb3BlcnR5KSB7CiAgICAgIHZhciBvYmogPSB0aGlzLmdldE9iaihpZCk7CiAgICAgIHJldHVybiB0aGlzLmdldE1hdGVyaWFsKG9iaiwgcHJvcGVydHkpOwogICAgfTsKCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZ2V0QWRqID0gZnVuY3Rpb24gKG9iaiwgaW5kZXgsIG9mZnNldCwgdGV4dCkgewogICAgICB2YXIgbGVuLCBwb3M7CiAgICAgIGlmICh0eXBlb2Ygb2JqLnBvcyA9PT0gInVuZGVmaW5lZCIpCiAgICAgICAgcmV0dXJuIHJnbHdpZGdldENsYXNzLmZsYXR0ZW4ob2JqLmFkaik7CiAgICAgIHBvcyA9IG9iai5wb3NbaW5kZXggJSBvYmoucG9zLmxlbmd0aF07CiAgICAgIHN3aXRjaChwb3MpIHsKICAgICAgICBjYXNlIDA6IHJldHVybiBbMC41LCAwLjUsIDAuNV07CiAgICAgICAgY2FzZSAxOiByZXR1cm4gWzAuNSwgMSArIG9mZnNldCwgMC41XTsKICAgICAgICBjYXNlIDM6IHJldHVybiBbMC41LCAtb2Zmc2V0LCAwLjVdOwogICAgICAgIGNhc2UgNTogcmV0dXJuIFswLjUsIDAuNSwgLW9mZnNldF07CiAgICAgICAgY2FzZSA2OiByZXR1cm4gWzAuNSwgMC41LCAxICsgb2Zmc2V0XTsKICAgICAgICBjYXNlIDI6IAogICAgICAgIGNhc2UgNDogaWYgKHR5cGVvZiB0ZXh0ID09PSAidW5kZWZpbmVkIikKICAgICAgICAgICAgICAgICAgbGVuID0gMTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgbGVuID0gdGV4dC5sZW5ndGg7CiAgICAgICAgICAgICAgICBpZiAocG9zID09PSAyKQogICAgICAgICAgICAgICAgICByZXR1cm4gWzEgKyBvZmZzZXQvbGVuLCAwLjUsIDAuNV07CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgIHJldHVybiBbLW9mZnNldC9sZW4sIDAuNSwgMC41XTsKICAgICAgfQogICAgfTsKCiAgICAvKioKICAgICAqIENvdW50IGNsaXBwaW5nIHBsYW5lcyBpbiBhIHNjZW5lCiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuY291bnRDbGlwcGxhbmVzID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpcywKICAgICAgICAgIGJvdW5kID0gMDsKICAgICAgCiAgICAgIE9iamVjdC5rZXlzKHRoaXMuc2NlbmUub2JqZWN0cykuZm9yRWFjaCgKICAgICAgICBmdW5jdGlvbihrZXkpIHsKICAgICAgICAgIHZhciBvYmogPSBzZWxmLmdldE9iaihwYXJzZUludChrZXksIDEwKSk7CiAgICAgICAgICBpZiAob2JqLnR5cGUgPT09ICJjbGlwcGxhbmVzIikKICAgICAgICAgICAgYm91bmQgPSBib3VuZCArIG9iai5vZmZzZXRzLmxlbmd0aDsKICAgICAgICB9KTsKICAgICAgcmV0dXJuIGJvdW5kOwogICAgfTsKCiAgICAvKioKICAgICAqIENvdW50IGNsaXBwaW5nIHBsYW5lIG9iamVjdHMgaW4gYSBzY2VuZQogICAgICogQHJldHVybnMge251bWJlcn0KICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmNvdW50Q2xpcHBsYW5lT2JqcyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5jb3VudE9ianMoImNsaXBwbGFuZXMiKTsKICAgIH07CgogICAgLyoqCiAgICAgKiBDb3VudCBsaWdodHMgaW4gYSBzY2VuZQogICAgICogQHJldHVybnMgeyBudW1iZXIgfQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuY291bnRMaWdodHMgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuY291bnRPYmpzKCJsaWdodCIpOwogICAgfTsKCiAgICAvKioKICAgICAqIENvdW50IG9iamVjdHMgb2Ygc3BlY2lmaWMgdHlwZSBpbiBhIHNjZW5lCiAgICAgKiBAcmV0dXJucyB7IG51bWJlciB9CiAgICAgKiBAcGFyYW0geyBzdHJpbmcgfSB0eXBlIC0gVHlwZSBvZiBvYmplY3QgdG8gY291bnQKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmNvdW50T2JqcyA9IGZ1bmN0aW9uKHR5cGUpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLAogICAgICAgICAgYm91bmQgPSAwOwoKICAgICAgT2JqZWN0LmtleXModGhpcy5zY2VuZS5vYmplY3RzKS5mb3JFYWNoKAogICAgICAgIGZ1bmN0aW9uKGtleSkgewogICAgICAgICAgaWYgKHNlbGYuZ2V0T2JqKHBhcnNlSW50KGtleSwgMTApKS50eXBlID09PSB0eXBlKQogICAgICAgICAgICBib3VuZCA9IGJvdW5kICsgMTsKICAgICAgICB9KTsKICAgICAgcmV0dXJuIGJvdW5kOwogICAgfTsKCiAgICAvKioKICAgICAqIERpc3BsYXkgYSBkZWJ1ZyBtZXNzYWdlCiAgICAgKiBAcGFyYW0geyBzdHJpbmcgfSBtc2cgLSBUaGUgbWVzc2FnZSB0byBkaXNwbGF5CiAgICAgKiBAcGFyYW0geyBPYmplY3QgfSBbaW1nXSAtIEltYWdlIHRvIGluc2VydCBiZWZvcmUgbWVzc2FnZQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZGVidWcgPSBmdW5jdGlvbihtc2csIGltZykgewogICAgICBpZiAodHlwZW9mIHRoaXMuZGVidWdlbGVtZW50ICE9PSAidW5kZWZpbmVkIiAmJiB0aGlzLmRlYnVnZWxlbWVudCAhPT0gbnVsbCkgewogICAgICAgIHRoaXMuZGVidWdlbGVtZW50LmlubmVySFRNTCA9IG1zZzsKICAgICAgICBpZiAodHlwZW9mIGltZyAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgIHRoaXMuZGVidWdlbGVtZW50Lmluc2VydEJlZm9yZShpbWcsIHRoaXMuZGVidWdlbGVtZW50LmZpcnN0Q2hpbGQpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChtc2cgIT09ICIiKQogICAgICAgIGFsZXJ0KG1zZyk7CiAgICB9OwoKICAgIC8qKgogICAgICogSWYgd2UgYXJlIGluIGFuIGlvc2xpZGVzIG9yIHNsaWR5IHByZXNlbnRhdGlvbiwgZ2V0IHRoZQogICAgICogRE9NIGVsZW1lbnQgb2YgdGhlIGN1cnJlbnQgc2xpZGUKICAgICAqIEByZXR1cm5zIHsgT2JqZWN0IH0KICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmdldFNsaWRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciByZXN1bHQgPSB0aGlzLmVsLCBkb25lID0gZmFsc2U7CiAgICAgIHdoaWxlIChyZXN1bHQgJiYgIWRvbmUgJiYgdGhpcy5zY2VuZS5jb250ZXh0LnJtYXJrZG93bikgewogICAgICAJc3dpdGNoKHRoaXMuc2NlbmUuY29udGV4dC5ybWFya2Rvd24pIHsKICAgICAgICAgIGNhc2UgImlvc2xpZGVzX3ByZXNlbnRhdGlvbiI6CiAgICAgICAgICAgIGlmIChyZXN1bHQudGFnTmFtZSA9PT0gIlNMSURFIikgcmV0dXJuIHJlc3VsdDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJzbGlkeV9wcmVzZW50YXRpb24iOgogICAgICAgICAgICBpZiAocmVzdWx0LnRhZ05hbWUgPT09ICJESVYiICYmIHJlc3VsdC5jbGFzc0xpc3QuY29udGFpbnMoInNsaWRlIikpCiAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gbnVsbDsKICAgICAgCX0KICAgICAgCXJlc3VsdCA9IHJlc3VsdC5wYXJlbnRFbGVtZW50OwogICAgICB9CiAgICAgIHJldHVybiBudWxsOwogICAgfTsKCiAgICAvKioKICAgICAqIElzIHRoaXMgc2NlbmUgdmlzaWJsZSBpbiB0aGUgYnJvd3Nlcj8KICAgICAqIEByZXR1cm5zIHsgYm9vbGVhbiB9CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5pc0luQnJvd3NlclZpZXdwb3J0ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciByZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksCiAgICAgICAgICB3aW5kSGVpZ2h0ID0gKHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KSwKICAgICAgICAgIHdpbmRXaWR0aCA9ICh3aW5kb3cuaW5uZXJXaWR0aCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgpOwogICAgICBpZiAodGhpcy5zY2VuZS5jb250ZXh0ICYmIHRoaXMuc2NlbmUuY29udGV4dC5ybWFya2Rvd24gIT09IG51bGwpIHsKICAgICAgCWlmICh0aGlzLnNsaWRlKQogICAgICAJICByZXR1cm4gKHRoaXMuc2NlbmUuY29udGV4dC5ybWFya2Rvd24gPT09ICJpb3NsaWRlc19wcmVzZW50YXRpb24iICYmCiAgICAgIAkgICAgICAgICAgdGhpcy5zbGlkZS5jbGFzc0xpc3QuY29udGFpbnMoImN1cnJlbnQiKSkgfHwKICAgICAgCSAgICAgICAgICh0aGlzLnNjZW5lLmNvbnRleHQucm1hcmtkb3duID09PSAic2xpZHlfcHJlc2VudGF0aW9uIiAmJgogICAgICAJICAgICAgICAgICF0aGlzLnNsaWRlLmNsYXNzTGlzdC5jb250YWlucygiaGlkZGVuIikpOwogICAgICB9CiAgICAgIHJldHVybiAoCiAgICAgIAlyZWN0LnRvcCA+PSAtd2luZEhlaWdodCAmJgogICAgICAJcmVjdC5sZWZ0ID49IC13aW5kV2lkdGggJiYKICAgICAgCXJlY3QuYm90dG9tIDw9IDIqd2luZEhlaWdodCAmJgogICAgICAJcmVjdC5yaWdodCA8PSAyKndpbmRXaWR0aCk7CiAgICB9OwogICAgCiAgICByZ2x3aWRnZXRDbGFzcy5rZXlkaWZmID0gZnVuY3Rpb24ob2JqMSwgb2JqMikgewogICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iajEpLCBpLCByZXN1bHQgPSBbXTsKICAgICAgZm9yIChpPTA7aTxrZXlzLmxlbmd0aDtpKyspIHsKICAgICAgICBpZiAodHlwZW9mIG9iajFba2V5c1tpXV0gIT09ICJ1bmRlZmluZWQiICYmCiAgICAgICAgICAgIHR5cGVvZiBvYmoyW2tleXNbaV1dID09PSAidW5kZWZpbmVkIikKICAgICAgICAgIHJlc3VsdC5wdXNoKGtleXNbaV0pOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIHJnbHdpZGdldENsYXNzLmlzU2V0ID0gZnVuY3Rpb24oZmxhZ3MsIGZsYWcpIHsKICAgICAgLyoganNoaW50IGJpdHdpc2U6IGZhbHNlICovCiAgICAgIHJldHVybiAoZmxhZ3MgJiBmbGFnKSAhPT0gMDsKICAgICAgLyoganNoaW50IGJpdHdpc2U6IHRydWUgKi8KICAgIH07CiAgICAKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS51c2VyMndpbmRvdyA9IGZ1bmN0aW9uKHAsIHN1YmlkKSB7CiAgICAgIHZhciBtLCB2ID0gW10uY29uY2F0KHApOwogICAgICAKICAgICAgdGhpcy5zZXRtdk1hdHJpeChzdWJpZCk7CiAgICAgIG0gPSBuZXcgQ2FudmFzTWF0cml4NCh0aGlzLm12TWF0cml4KTsKICAgICAgdiA9IHJnbHdpZGdldENsYXNzLm11bHRWTSh2LCBtKTsKICAgICAgdGhpcy5zZXRwck1hdHJpeChzdWJpZCk7CiAgICAgIG0gPSBuZXcgQ2FudmFzTWF0cml4NCh0aGlzLnByTWF0cml4KTsKICAgICAgdiA9IHJnbHdpZGdldENsYXNzLm11bHRWTSh2LCBtKTsKICAgICAgdGhpcy5nZXRWaWV3cG9ydChzdWJpZCk7CiAgICAgIHZbMF0gPSB2WzBdKjAuNS92WzNdICsgMC41ICsgdGhpcy52cC54L3RoaXMudnAud2lkdGg7CiAgICAgIHZbMV0gPSB2WzFdKjAuNS92WzNdICsgMC41ICsgdGhpcy52cC55L3RoaXMudnAuaGVpZ2h0OwogICAgICB2WzJdID0gKDEgKyB2WzJdL3ZbM10pKjAuNTsKICAgICAgcmV0dXJuIHYuc2xpY2UoMCwgMyk7CiAgICB9OwoKICAgIC8qKgogICAgICogQW5kcmV3J3MgY29udmV4IGh1bGwgYWxnb3JpdGhtLiAKICAgICAqIEZyb20gV2lraXBlZGlhLCB1c2VkIHVuZGVyIENyZWF0aXZlIENvbW1vbnMgQXR0cmlidXRpb24tU2hhcmVBbGlrZSBMaWNlbnNlCiAgICAgKiBAcmV0dXJucyB7IEFycmF5IH0gSW5kaWNlcyBvZiBjb252ZXggaHVsbCBwb2ludHMKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MuY2h1bGwgPSBmdW5jdGlvbihwb2ludHMpIHsKICAgICAgZnVuY3Rpb24gY3Jvc3MoYSwgYiwgbykgewogICAgICAgIHJldHVybiAoYVswXSAtIG9bMF0pICogKGJbMV0gLSBvWzFdKSAtIChhWzFdIC0gb1sxXSkgKiAoYlswXSAtIG9bMF0pOwogICAgICB9CiAgICAgICAgCiAgICAgIHBvaW50cy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgICByZXR1cm4gYVswXSA9PT0gYlswXSA/IGFbMV0gLSBiWzFdIDogYVswXSAtIGJbMF07CiAgICAgIH0pOwoKICAgICAgdmFyIGxvd2VyID0gW10sIHVwcGVyID0gW107CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgd2hpbGUgKGxvd2VyLmxlbmd0aCA+PSAyICYmIGNyb3NzKGxvd2VyW2xvd2VyLmxlbmd0aCAtIDJdLCBsb3dlcltsb3dlci5sZW5ndGggLSAxXSwgcG9pbnRzW2ldKSA8PSAwKSB7CiAgICAgICAgICBsb3dlci5wb3AoKTsKICAgICAgICB9CiAgICAgICAgbG93ZXIucHVzaChwb2ludHNbaV0pOwogICAgICB9CgogICAgICBmb3IgKGkgPSBwb2ludHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICB3aGlsZSAodXBwZXIubGVuZ3RoID49IDIgJiYgY3Jvc3ModXBwZXJbdXBwZXIubGVuZ3RoIC0gMl0sIHVwcGVyW3VwcGVyLmxlbmd0aCAtIDFdLCBwb2ludHNbaV0pIDw9IDApIHsKICAgICAgICAgIHVwcGVyLnBvcCgpOwogICAgICAgIH0KICAgICAgICB1cHBlci5wdXNoKHBvaW50c1tpXSk7CiAgICAgIH0KCiAgICAgIHVwcGVyLnBvcCgpOwogICAgICBsb3dlci5wb3AoKTsKICAgICAgcmV0dXJuIGxvd2VyLmNvbmNhdCh1cHBlcik7CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIFJvdW5kIG51bWJlciB0byBnaXZlbiBwcmVjaXNpb24KICAgICAqIEBwYXJhbSB7IG51bWJlciB9IHgKICAgICAqIEBwYXJhbSB7IG51bWJlciB9IGRpZ2l0cwogICAgICogQHJldHVybnMgeyBudW1iZXIgfSAKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3Muc2lnbmlmID0gZnVuY3Rpb24oeCwgZGlnaXRzKSB7IAogICAgICByZXR1cm4gcGFyc2VGbG9hdCh4LnRvUHJlY2lzaW9uKGRpZ2l0cykpOwogICAgfTsKICAgICAgCiAgICAvKioKICAgICAqIENoZWNrIGZvciBOQSwgTmFOLCB1bmRlZmluZWQsIG9yIG51bGwKICAgICAqIEBwYXJhbSB4CiAgICAgKiBAcmV0dXJucyB7IGJvb2wgfQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5taXNzaW5nID0gZnVuY3Rpb24oeCkgewogICAgICByZXR1cm4geCAhPT0gIi1JbmYiICYmIHggIT09ICJJbmYiICYmCiAgICAgICAgICAgICAoaXNOYU4oeCkgfHwgeCA9PT0gbnVsbCB8fCB0eXBlb2YoeCkgPT09ICJ1bmRlZmluZWQiKTsKICAgIH07CgogICAgLyoqCiAgICAgKiBXcml0ZSBtYXRyaXggdG8gbG9nCiAgICAgKiBAcGFyYW0gTQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5sb2dNYXRyaXggPSBmdW5jdGlvbihNKSB7CiAgICAgIGNvbnNvbGUubG9nKCJtYXRyaXgoYygiK00ubTExKyIsIitNLm0xMisiLCIrTS5tMTMrIiwiK00ubTE0KyIsXG4iKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNLm0yMSsiLCIrTS5tMjIrIiwiK00ubTIzKyIsIitNLm0yNCsiLFxuIisKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTS5tMzErIiwiK00ubTMyKyIsIitNLm0zMysiLCIrTS5tMzQrIixcbiIrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE0ubTQxKyIsIitNLm00MisiLCIrTS5tNDMrIiwiK00ubTQ0KyIpLCBieXJvdz1UUlVFLCBuY29sPTQpIik7CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIFdyaXRlIHZlY3RvciB0byBsb2cKICAgICAqIEBwYXJhbSB7dmVjdG9yfSB2CiAgICAgKi8KICAgICAKICAgIHJnbHdpZGdldENsYXNzLmxvZ1ZlYzMgPSBmdW5jdGlvbih2KSB7CiAgICAgIGNvbnNvbGUubG9nKCJjKCIrdlswXSsiLCIrdlsxXSsiLCIrdlsyXSsiKSIpOwogICAgfTsKICAgIAogICAgLyoqCiAgICAgKiBTdW0gdHdvIHZlY3RvcnMKICAgICAqIEBwYXJhbSB7dmVjdG9yfSB4CiAgICAgKiBAcGFyYW0ge3ZlY3Rvcn0geQogICAgICovCiAgICAgcmdsd2lkZ2V0Q2xhc3MudnN1bSA9IGZ1bmN0aW9uKHgsIHkpIHsKICAgICAgIHZhciBpLCByZXN1bHQgPSBbXS5jb25jYXQoeCk7CiAgICAgICBmb3IgKGkgPSAwOyBpIDwgeS5sZW5ndGg7IGkrKykKICAgICAgICAgcmVzdWx0W2ldICs9IHlbaV07CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICB9OwogICAgIAogICAgLyoqCiAgICAgKiBkaWZmZXJlbmNlIG9mIHR3byB2ZWN0b3JzCiAgICAgKiBAcGFyYW0ge3ZlY3Rvcn0geAogICAgICogQHBhcmFtIHt2ZWN0b3J9IHkKICAgICAqLwogICAgIHJnbHdpZGdldENsYXNzLnZkaWZmID0gZnVuY3Rpb24oeCwgeSkgewogICAgICAgIHJldHVybiByZ2x3aWRnZXRDbGFzcy52c3VtKHgsIHJnbHdpZGdldENsYXNzLnZzY2FsZSh5LCAtMSkpOwogICAgIH07CgogICAgLyoqCiAgICAgKiBTY2FsZSBhIHZlY3RvcgogICAgICogQHBhcmFtIHtudW1iZXJ9IHMKICAgICAqIEBwYXJhbSB7dmVjdG9yfSB4CiAgICAgKi8KICAgICByZ2x3aWRnZXRDbGFzcy52c2NhbGUgPSBmdW5jdGlvbih4LCBzKSB7CiAgICAgICB2YXIgaSwgcmVzdWx0ID0gW10uY29uY2F0KHgpOwogICAgICAgZm9yIChpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspCiAgICAgICAgIHJlc3VsdFtpXSAqPSBzOwogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgfTsKICAgIAogICAgLyoqCiAgICAgKiBOb3JtYWxpemUgYSB2ZWN0b3IKICAgICAqIEBwYXJhbSB7dmVjdG9yfSB2CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uKHYpIHsKICAgICAgcmV0dXJuIHJnbHdpZGdldENsYXNzLnZzY2FsZSh2LCAxL3JnbHdpZGdldENsYXNzLnZsZW4odikpOwogICAgfTsKICAgIAogICAgLyoqCiAgICAgKiBDb21wdXRlIHRoZSBkaW1lbnNpb25zIG9mIGEgcmVndWxhciBhcnJheQogICAgICogd2l0aG91dCBjaGVja2luZyB0aGF0IGl0IGlzIHJlZ3VsYXIKICAgICAqLyAKICAgIHJnbHdpZGdldENsYXNzLmFycmF5RGltID0gZnVuY3Rpb24oYXJyKSB7CiAgICAgIHZhciByZXN1bHQgPSBbXTsKICAgICAgd2hpbGUgKHR5cGVvZiBhcnIubGVuZ3RoICE9PSAidW5kZWZpbmVkIikgewogICAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQoYXJyLmxlbmd0aCk7CiAgICAgICAgYXJyID0gYXJyWzBdOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9Owo="></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,LyoqCiAgICAgKiBNZXRob2RzIHJlbGF0ZWQgdG8gYnVmZmVyZWQgZGF0YQogICAgICogQG5hbWUgX19fTUVUSE9EU19GT1JfQlVGRkVSU19fXwogICAgICogQG1lbWJlcm9mIHJnbHdpZGdldENsYXNzCiAgICAgKiBAa2luZCBmdW5jdGlvbgogICAgICogQGluc3RhbmNlCiAgICAgKi8KICAgIC8qKgogICAgICogRGV0ZWN0IHJnbEJ1ZmZlcmVkIG9iamVjdAogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gb2JqIC0gdmVydGljZXMgb3Igc2ltaWxhciAKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmlzQnVmZmVyZWQgPSBmdW5jdGlvbihvYmopIHsKICAgICAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICJzdHJpbmciOwogICAgfTsKCiAgICAvKiBUaGUgbmV4dCB0d28gZnVuY3Rpb25zIGFyZSB0YWtlbiBmcm9tIAogICAgIAogICAgIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvQmFzZTY0X2VuY29kaW5nX2FuZF9kZWNvZGluZwogICAgIAogICAgIFRoZXkgd2VyZSB3cml0dGVuIGJ5IE1vemlsbGEgQ29udHJpYnV0b3JzIGFuZCBkZWRpY2F0ZWQKICAgICB0byB0aGUgcHVibGljIGRvbWFpbiB1bmRlciBDQzAuICovCiAgICAgCiAgICAvKiBBcnJheSBvZiBieXRlcyB0byBCYXNlNjQgc3RyaW5nIGRlY29kaW5nICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuYjY0VG9VaW50NiA9IGZ1bmN0aW9uKG5DaHIpIHsKICAgICAgcmV0dXJuIG5DaHIgPiA2NCAmJiBuQ2hyIDwgOTEgPyBuQ2hyIC0gNjUgOiAKICAgICAgICAgICAgIG5DaHIgPiA5NiAmJiBuQ2hyIDwgMTIzID8gbkNociAtIDcxIDogCiAgICAgICAgICAgICBuQ2hyID4gNDcgJiYgbkNociA8IDU4ID8gbkNociArIDQgOiAKICAgICAgICAgICAgIG5DaHIgPT09IDQzID8gNjIgOiAKICAgICAgICAgICAgIG5DaHIgPT09IDQ3ID8gNjMgOiAKICAgICAgICAgICAgIDA7CiAgICB9OwoKICAgIC8qIGpzaGludCBiaXR3aXNlOmZhbHNlICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuYmFzZTY0RGVjVG9BcnIgPSBmdW5jdGlvbihzQmFzZTY0LCBuQmxvY2tzU2l6ZSkgewogICAgICB2YXIgc0I2NEVuYyA9IHNCYXNlNjQucmVwbGFjZSgvW15BLVphLXowLTlcK1wvXS9nLCAiIiksCiAgICAgICAgbkluTGVuID0gc0I2NEVuYy5sZW5ndGgsIAogICAgICAgIG5PdXRMZW4gPSBuQmxvY2tzU2l6ZSA/IE1hdGguY2VpbCgobkluTGVuICogMyArIDEgPj4gMikgLyBuQmxvY2tzU2l6ZSkgKiBuQmxvY2tzU2l6ZSA6IG5JbkxlbiAqIDMgKyAxID4+IDIsIAogICAgICAgIHRhQnl0ZXMgPSBuZXcgVWludDhBcnJheShuT3V0TGVuKTsKICAgICAgZm9yICh2YXIgbk1vZDMsIG5Nb2Q0LCBuVWludDI0ID0gMCwgbk91dElkeCA9IDAsIG5JbklkeCA9IDA7IG5JbklkeCA8IG5JbkxlbjsgbkluSWR4KyspIHsKICAgICAgICBuTW9kNCA9IG5JbklkeCAmIDM7CiAgICAgICAgblVpbnQyNCB8PSB0aGlzLmI2NFRvVWludDYoc0I2NEVuYy5jaGFyQ29kZUF0KG5JbklkeCkpIDw8IDYgKiAoMyAtIG5Nb2Q0KTsKICAgICAgICBpZiAobk1vZDQgPT09IDMgfHwgbkluTGVuIC0gbkluSWR4ID09PSAxKSB7CiAgICAgICAgICBmb3IgKG5Nb2QzID0gMDsgbk1vZDMgPCAzICYmIG5PdXRJZHggPCBuT3V0TGVuOyBuTW9kMysrLCBuT3V0SWR4KyspIHsKICAgICAgICAgICAgdGFCeXRlc1tuT3V0SWR4XSA9IG5VaW50MjQgPj4+ICgxNiA+Pj4gbk1vZDMgJiAyNCkgJiAyNTU7CiAgICAgICAgICB9CiAgICAgICAgICBuVWludDI0ID0gMDsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHRhQnl0ZXM7CiAgICB9OwogICAgLyoganNoaW50IGJpdHdpc2U6dHJ1ZSAqLwogICAgCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZ2V0QXJyYXlCdWZmZXIgPSBmdW5jdGlvbihiYXNlNjQpIHsKICAgICAgcmV0dXJuIHRoaXMuYmFzZTY0RGVjVG9BcnIoYmFzZTY0LCA0KS5idWZmZXI7CiAgICB9OwoKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5nZXRCdWZmZXJlZERhdGEgPSBmdW5jdGlvbih2KSB7CiAgICAgIHJldHVybiB0aGlzLnJlYWRBY2Nlc3NvcihwYXJzZUludCh2LCAxMCksIHRoaXMuc2NlbmUuYnVmZmVyKTsKICAgIH07CiAgICAKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5yZWFkQWNjZXNzb3IgPSBmdW5jdGlvbihhY2MsIGJ1ZikgewogICAgICB2YXIgdHlwZVNpZ25lZEJ5dGUgPSA1MTIwLCAKICAgICAgICAgIHR5cGVVbnNpZ25lZEJ5dGUgPSA1MTIxLCAKICAgICAgICAgIHR5cGVTaWduZWRTaG9ydCA9IDUxMjIsIAogICAgICAgICAgdHlwZVVuc2lnbmVkU2hvcnQgPSA1MTIzLCAKICAgICAgICAgIHR5cGVTaWduZWRJbnQgPSA1MTI0LCAKICAgICAgICAgIHR5cGVVbnNpZ25lZEludCA9IDUxMjUsIAogICAgICAgICAgdHlwZUZsb2F0ID0gNTEyNiwgCiAgICAgICAgICB0eXBlRG91YmxlID0gNTEzMCwgCiAgICAgICAgICBhY2Nlc3NvciA9IGJ1Zi5hY2Nlc3NvcnNbYWNjXSwgCiAgICAgICAgICBidWZmZXJWaWV3ID0gYnVmLmJ1ZmZlclZpZXdzW2FjY2Vzc29yLmJ1ZmZlclZpZXddLCAKICAgICAgICAgIGJ1ZmZlciA9IGJ1Zi5idWZmZXJzW2J1ZmZlclZpZXcuYnVmZmVyXSwgCiAgICAgICAgICBieXRlcywgCiAgICAgICAgICBsZW5zID0gewogICAgICAgICAgICBTQ0FMQVI6IDEsCiAgICAgICAgICAgIFZFQzI6IDIsCiAgICAgICAgICAgIFZFQzM6IDMsCiAgICAgICAgICAgIFZFQzQ6IDQsCiAgICAgICAgICAgIE1BVDI6IDQsCiAgICAgICAgICAgIE1BVDM6IDksCiAgICAgICAgICAgIE1BVDQ6IDE2CiAgICAgICAgICB9LCAKICAgICAgICAgIHJvd3NpemVzID0gewogICAgICAgICAgICBTQ0FMQVI6IDEsCiAgICAgICAgICAgIFZFQzI6IDIsCiAgICAgICAgICAgIFZFQzM6IDMsCiAgICAgICAgICAgIFZFQzQ6IDQsCiAgICAgICAgICAgIE1BVDI6IDIsCiAgICAgICAgICAgIE1BVDM6IDMsCiAgICAgICAgICAgIE1BVDQ6IDQKICAgICAgICAgIH0sIAogICAgICAgICAgb2Zmc2V0ID0gMCwgCiAgICAgICAgICBsZW4gPSBsZW5zW2FjY2Vzc29yLnR5cGVdLCAKICAgICAgICAgIHJvd3NpemUgPSByb3dzaXplc1thY2Nlc3Nvci50eXBlXSwgCiAgICAgICAgICBjb3VudCA9IGxlbiAqIGFjY2Vzc29yLmNvdW50LCAKICAgICAgICAgIG5yb3dzID0gY291bnQgLyByb3dzaXplLCAKICAgICAgICAgIHZhbHVlcywgYXJyID0gW10sIHJvdywgaSwgaiwgazsKICAgICAgICAgIAogICAgICBpZiAodHlwZW9mIGJ1ZmZlci5ieXRlcyA9PT0gInN0cmluZyIpIAogICAgICAgIGJ1ZmZlci5ieXRlcyA9IHRoaXMuZ2V0QXJyYXlCdWZmZXIoYnVmZmVyLmJ5dGVzKTsKICAgICAgICAKICAgICAgYnl0ZXMgPSBidWZmZXIuYnl0ZXM7CiAgICAgIAogICAgICBpZiAodHlwZW9mIGFjY2Vzc29yLmJ5dGVPZmZzZXQgIT09ICJ1bmRlZmluZWQiKSAKICAgICAgICBvZmZzZXQgKz0gYWNjZXNzb3IuYnl0ZU9mZnNldDsKICAgICAgICAKICAgICAgaWYgKHR5cGVvZiBidWZmZXJWaWV3LmJ5dGVPZmZzZXQgIT09ICJ1bmRlZmluZWQiKSAKICAgICAgICBvZmZzZXQgKz0gYnVmZmVyVmlldy5ieXRlT2Zmc2V0OwogICAgICAgIAogICAgICBzd2l0Y2ggKGFjY2Vzc29yLmNvbXBvbmVudFR5cGUpIHsKICAgICAgIGNhc2UgdHlwZVNpZ25lZEJ5dGU6CiAgICAgICAgdmFsdWVzID0gbmV3IEludDhBcnJheShidWZmZXIuYnl0ZXMsIG9mZnNldCwgY291bnQpOwogICAgICAgIGJyZWFrOwoKICAgICAgIGNhc2UgdHlwZVVuc2lnbmVkQnl0ZToKICAgICAgICB2YWx1ZXMgPSBuZXcgVWludDhBcnJheShidWZmZXIuYnl0ZXMsIG9mZnNldCwgY291bnQpOwogICAgICAgIGJyZWFrOwoKICAgICAgIGNhc2UgdHlwZVNpZ25lZFNob3J0OgogICAgICAgIHZhbHVlcyA9IG5ldyBJbnQxNkFycmF5KGJ1ZmZlci5ieXRlcywgb2Zmc2V0LCBjb3VudCk7CiAgICAgICAgYnJlYWs7CgogICAgICAgY2FzZSB0eXBlVW5zaWduZWRTaG9ydDoKICAgICAgICB2YWx1ZXMgPSBuZXcgVWludDE2QXJyYXkoYnVmZmVyLmJ5dGVzLCBvZmZzZXQsIGNvdW50KTsKICAgICAgICBicmVhazsKCiAgICAgICBjYXNlIHR5cGVTaWduZWRJbnQ6CiAgICAgICAgdmFsdWVzID0gbmV3IEludDMyQXJyYXkoYnVmZmVyLmJ5dGVzLCBvZmZzZXQsIGNvdW50KTsKICAgICAgICBicmVhazsKCiAgICAgICBjYXNlIHR5cGVVbnNpZ25lZEludDoKICAgICAgICB2YWx1ZXMgPSBuZXcgVWludDMyQXJyYXkoYnVmZmVyLmJ5dGVzLCBvZmZzZXQsIGNvdW50KTsKICAgICAgICBicmVhazsKCiAgICAgICBjYXNlIHR5cGVGbG9hdDoKICAgICAgICB2YWx1ZXMgPSBuZXcgRmxvYXQzMkFycmF5KGJ1ZmZlci5ieXRlcywgb2Zmc2V0LCBjb3VudCk7CiAgICAgICAgYnJlYWs7CgogICAgICAgY2FzZSB0eXBlRG91YmxlOgogICAgICAgIHZhbHVlcyA9IG5ldyBGbG9hdDY0QXJyYXkoYnVmZmVyLmJ5dGVzLCBvZmZzZXQsIGNvdW50KTsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgLyogVGhpcyBpcyBhbGwgdmVyeSBpbmVmZmljaWVudCwgYnV0IGlzIGNvbnZlbmllbnQKICAgICAgICAgICAgIHRvIHdvcmsgd2l0aCB0aGUgb2xkIGNvZGUuICovCiAgICAgIGsgPSAwOwogICAgICBmb3IgKGkgPSAwOyBpIDwgbnJvd3M7IGkrKykgewogICAgICAgIHJvdyA9IFtdOwogICAgICAgIGZvciAoaiA9IDA7IGogPCByb3dzaXplOyBqKyspIHsKICAgICAgICAgIGlmIChhY2Nlc3Nvci5ub3JtYWxpemVkKSB7CiAgICAgICAgICAgIHN3aXRjaChhY2Nlc3Nvci5jb21wb25lbnRUeXBlKSB7CiAgICAgICAgICAgICAgY2FzZSB0eXBlU2lnbmVkQnl0ZToKICAgICAgICAgICAgICAgIHJvdy5wdXNoKE1hdGgubWF4KHZhbHVlc1trKytdLzEyNywgLTEuMCkpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSB0eXBlU2lnbmVkU2hvcnQ6CiAgICAgICAgICAgICAgICByb3cucHVzaChNYXRoLm1heCh2YWx1ZXNbaysrXS8zMjc2NywgLTEuMCkpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSB0eXBlVW5zaWduZWRCeXRlOgogICAgICAgICAgICAgICAgcm93LnB1c2godmFsdWVzW2srK10vMjU1KTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgdHlwZVVuc2lnbmVkU2hvcnQ6CiAgICAgICAgICAgICAgICByb3cucHVzaCh2YWx1ZXNbaysrXS82NTUzNSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIHJvdy5wdXNoKHZhbHVlc1trKytdKTsKICAgICAgICB9CiAgICAgICAgYXJyLnB1c2gocm93KTsKICAgICAgfQogICAgICByZXR1cm4gYXJyOwogICAgfTsKICAgIAogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmV4cGFuZEJ1ZmZlcmVkRmllbGRzID0gZnVuY3Rpb24ob2JqKSB7CiAgICAgIC8qIHRoaXMgbGlzdCBuZWVkcyB0byBtYXRjaCB0aGUgb25lIGluIGNvbnZlcnRTY2VuZS5SICovCiAgICAgIHZhciBmaWVsZHMgPSBbInZlcnRpY2VzIiwgIm5vcm1hbHMiLCAiaW5kaWNlcyIsIAogICAgICAgICAgICAgICAgICAgICJ0ZXhjb29yZHMiLCAiY29sb3JzIiwgImNlbnRlcnMiXSwgaSwgZmllbGQ7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBmaWVsZCA9IG9ialtmaWVsZHNbaV1dOwogICAgICAgIGlmICh0aGlzLmlzQnVmZmVyZWQoZmllbGQpKQogICAgICAgICAgb2JqW2ZpZWxkc1tpXV0gPSB0aGlzLmdldEJ1ZmZlcmVkRGF0YShmaWVsZCk7CiAgICAgIH0KICAgIH07Cg=="></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,ICAgIC8qKgogICAgICogTWV0aG9kcyByZWxhdGVkIHRvIHN1YnNjZW5lcwogICAgICogQG5hbWUgX19fTUVUSE9EU19GT1JfU1VCU0NFTkVTX19fCiAgICAgKiBAbWVtYmVyb2Ygcmdsd2lkZ2V0Q2xhc3MKICAgICAqIEBraW5kIGZ1bmN0aW9uCiAgICAgKiBAaW5zdGFuY2UKICAgICAqLwoKICAgIC8qKgogICAgICogSXMgYSBwYXJ0aWN1bGFyIGlkIGluIGEgc3Vic2NlbmU/CiAgICAgKiBAcmV0dXJucyB7IGJvb2xlYW4gfQogICAgICogQHBhcmFtIHtudW1iZXJ9IGlkIFdoaWNoIGlkPwogICAgICogQHBhcmFtIHtudW1iZXJ9IHN1YnNjZW5lIFdoaWNoIHN1YnNjZW5lIGlkPwogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuaW5TdWJzY2VuZSA9IGZ1bmN0aW9uKGlkLCBzdWJzY2VuZSkgewogICAgICByZXR1cm4gdGhpcy5nZXRPYmooc3Vic2NlbmUpLm9iamVjdHMuaW5kZXhPZihpZCkgPiAtMTsKICAgIH07CgogICAgLyoqCiAgICAgKiBUcmFuc2xhdGUgZnJvbSB3aW5kb3cgY29vcmRpbmF0ZXMgdG8gdmlld3BvcnQgY29vcmRpbmF0ZXMKICAgICAqIEByZXR1cm5zIHsgT2JqZWN0IH0gdHJhbnNsYXRlZCBjb29yZGluYXRlcwogICAgICogQHBhcmFtIHsgbnVtYmVyIH0gc3Vic2NlbmVpZCAtIHdoaWNoIHN1YnNjZW5lIHRvIHVzZT8KICAgICAqIEBwYXJhbSB7IE9iamVjdCB9IGNvb3JkcyAtIHBvaW50IHRvIHRyYW5zbGF0ZQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUudHJhbnNsYXRlQ29vcmRzID0gZnVuY3Rpb24oc3Vic2NlbmVpZCwgY29vcmRzKSB7CiAgICAgIHZhciB2aWV3cG9ydCA9IHRoaXMuZ2V0T2JqKHN1YnNjZW5laWQpLnBhcjNkLnZpZXdwb3J0OwogICAgICByZXR1cm4ge3g6IGNvb3Jkcy54IC0gdmlld3BvcnQueCp0aGlzLmNhbnZhcy53aWR0aCwKICAgICAgICAgICAgICB5OiBjb29yZHMueSAtIHZpZXdwb3J0LnkqdGhpcy5jYW52YXMuaGVpZ2h0fTsKICAgIH07CgogICAgLyoqCiAgICAgKiBDaGVjayB3aGV0aGVyIHBvaW50IGlzIGluIHZpZXdwb3J0IG9mIHN1YnNjZW5lCiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0KICAgICAqIEBwYXJhbSB7IE9iamVjdCB9IGNvb3JkcyAtIHNjcmVlbiBjb29yZGluYXRlcyBvZiBwb2ludAogICAgICogQHBhcmFtIHsgbnVtYmVyIH0gc3Vic2NlbmVpZCAtIHN1YnNjZW5lIHRvIGNoZWNrCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5pblZpZXdwb3J0ID0gZnVuY3Rpb24oY29vcmRzLCBzdWJzY2VuZWlkKSB7CiAgICAgIHZhciB2aWV3cG9ydCA9IHRoaXMuZ2V0T2JqKHN1YnNjZW5laWQpLnBhcjNkLnZpZXdwb3J0LAogICAgICAgIHgwID0gY29vcmRzLnggLSB2aWV3cG9ydC54KnRoaXMuY2FudmFzLndpZHRoLAogICAgICAgIHkwID0gY29vcmRzLnkgLSB2aWV3cG9ydC55KnRoaXMuY2FudmFzLmhlaWdodDsKICAgICAgcmV0dXJuIDAgPD0geDAgJiYgeDAgPD0gdmlld3BvcnQud2lkdGgqdGhpcy5jYW52YXMud2lkdGggJiYKICAgICAgICAgICAgIDAgPD0geTAgJiYgeTAgPD0gdmlld3BvcnQuaGVpZ2h0KnRoaXMuY2FudmFzLmhlaWdodDsKICAgIH07CgogICAgLyoqCiAgICAgKiBGaW5kIHdoaWNoIHN1YnNjZW5lIGNvbnRhaW5zIGEgcG9pbnQKICAgICAqIEByZXR1cm5zIHsgbnVtYmVyIH0gc3Vic2NlbmUgaWQKICAgICAqIEBwYXJhbSB7IE9iamVjdCB9IGNvb3JkcyAtIGNvb3JkaW5hdGVzIG9mIHBvaW50CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS53aGljaFN1YnNjZW5lID0gZnVuY3Rpb24oY29vcmRzKSB7CiAgICAgIHZhciBzZWxmID0gdGhpcywKICAgICAgICAgIHJlY3Vyc2UgPSBmdW5jdGlvbihzdWJzY2VuZWlkKSB7CiAgICAgICAgICAgIHZhciBzdWJzY2VuZXMgPSBzZWxmLmdldENoaWxkU3Vic2NlbmVzKHN1YnNjZW5laWQpLCBpLCBpZDsKICAgICAgICAgICAgZm9yIChpPTA7IGkgPCBzdWJzY2VuZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICBpZCA9IHJlY3Vyc2Uoc3Vic2NlbmVzW2ldKTsKICAgICAgICAgICAgICBpZiAodHlwZW9mKGlkKSAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgICAgICAgICByZXR1cm4oaWQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChzZWxmLmluVmlld3BvcnQoY29vcmRzLCBzdWJzY2VuZWlkKSkKICAgICAgICAgICAgICByZXR1cm4oc3Vic2NlbmVpZCk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICAgICAgfSwKICAgICAgICAgIHJvb3RpZCA9IHRoaXMuc2NlbmUucm9vdFN1YnNjZW5lLAogICAgICAgICAgcmVzdWx0ID0gcmVjdXJzZShyb290aWQpOwogICAgICBpZiAodHlwZW9mKHJlc3VsdCkgPT09ICJ1bmRlZmluZWQiKQogICAgICAgIHJlc3VsdCA9IHJvb3RpZDsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgLyoqCiAgICAgKiBBZGQgYW4gaWQgdG8gYSBzdWJzY2VuZS4KICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpZCBXaGljaCBpZD8KICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdWJzY2VuZSBXaGljaCBzdWJzY2VuZSBpZD8KICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmFkZFRvU3Vic2NlbmUgPSBmdW5jdGlvbihpZCwgc3Vic2NlbmUpIHsKICAgICAgdmFyIHRoZWxpc3QsCiAgICAgICAgICB0aGVzdWIgPSB0aGlzLmdldE9iaihzdWJzY2VuZSksCiAgICAgICAgICBpZHMgPSBbaWRdLAogICAgICAgICAgb2JqID0gdGhpcy5nZXRPYmooaWQpLCBpOwogICAgICBpZiAodHlwZW9mIG9iaiAhPT0gInVuZGVmaW5lZCIgJiYgdHlwZW9mIChvYmoubmV3SWRzKSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICBpZHMgPSBpZHMuY29uY2F0KG9iai5uZXdJZHMpOwogICAgICB9CiAgICAgIHRoZXN1Yi5vYmplY3RzID0gW10uY29uY2F0KHRoZXN1Yi5vYmplY3RzKTsKICAgICAgZm9yIChpID0gMDsgaSA8IGlkcy5sZW5ndGg7IGkrKykgewogICAgICAgIGlkID0gaWRzW2ldOwogICAgICAgIGlmICh0aGVzdWIub2JqZWN0cy5pbmRleE9mKGlkKSA9PT0gLTEpIHsKICAgICAgICAgIHRoZWxpc3QgPSB0aGlzLndoaWNoTGlzdChpZCk7CiAgICAgICAgICB0aGVzdWIub2JqZWN0cy5wdXNoKGlkKTsKICAgICAgICAgIHRoZXN1Ylt0aGVsaXN0XS5wdXNoKGlkKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgLyoqCiAgICAgKiBEZWxldGUgYW4gaWQgZnJvbSBhIHN1YnNjZW5lCiAgICAgKiBAcGFyYW0geyBudW1iZXIgfSBpZCAtIHRoZSBpZCB0byBhZGQKICAgICAqIEBwYXJhbSB7IG51bWJlciB9IHN1YnNjZW5lIC0gdGhlIGlkIG9mIHRoZSBzdWJzY2VuZQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZGVsRnJvbVN1YnNjZW5lID0gZnVuY3Rpb24oaWQsIHN1YnNjZW5lKSB7CiAgICAgIHZhciB0aGVsaXN0LAogICAgICAgICAgdGhlc3ViID0gdGhpcy5nZXRPYmooc3Vic2NlbmUpLAogICAgICAgICAgb2JqID0gdGhpcy5nZXRPYmooaWQpLAogICAgICAgICAgaWRzID0gW2lkXSwgaSwgajsKICAgICAgaWYgKHR5cGVvZiBvYmogIT09ICJ1bmRlZmluZWQiICYmIHR5cGVvZiAob2JqLm5ld0lkcykgIT09ICJ1bmRlZmluZWQiKQogICAgICAgIGlkcyA9IGlkcy5jb25jYXQob2JqLm5ld0lkcyk7CiAgICAgIHRoZXN1Yi5vYmplY3RzID0gW10uY29uY2F0KHRoZXN1Yi5vYmplY3RzKTsgLy8gSXQgbWlnaHQgYmUgYSBzY2FsYXIKICAgICAgZm9yIChqPTA7IGo8aWRzLmxlbmd0aDtqKyspIHsKICAgICAgICBpZCA9IGlkc1tqXTsKICAgICAgICBpID0gdGhlc3ViLm9iamVjdHMuaW5kZXhPZihpZCk7CiAgICAgICAgaWYgKGkgPiAtMSkgewogICAgICAgICAgdGhlc3ViLm9iamVjdHMuc3BsaWNlKGksIDEpOwogICAgICAgICAgdGhlbGlzdCA9IHRoaXMud2hpY2hMaXN0KGlkKTsKICAgICAgICAgIGkgPSB0aGVzdWJbdGhlbGlzdF0uaW5kZXhPZihpZCk7CiAgICAgICAgICB0aGVzdWJbdGhlbGlzdF0uc3BsaWNlKGksIDEpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvKioKICAgICAqIFNldCB0aGUgaWRzIGluIGEgc3Vic2NlbmUKICAgICAqIEBwYXJhbSB7IG51bWJlcltdIH0gaWRzIC0gdGhlIGlkcyB0byBzZXQKICAgICAqIEBwYXJhbSB7IG51bWJlciB9IHN1YnNjZW5laWQgLSB0aGUgaWQgb2YgdGhlIHN1YnNjZW5lCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5zZXRTdWJzY2VuZUVudHJpZXMgPSBmdW5jdGlvbihpZHMsIHN1YnNjZW5laWQpIHsKICAgICAgdmFyIHN1YiA9IHRoaXMuZ2V0T2JqKHN1YnNjZW5laWQpOwogICAgICBzdWIub2JqZWN0cyA9IGlkczsKICAgICAgdGhpcy5pbml0U3Vic2NlbmUoc3Vic2NlbmVpZCk7CiAgICB9OwoKICAgIC8qKgogICAgICogR2V0IHRoZSBpZHMgaW4gYSBzdWJzY2VuZQogICAgICogQHJldHVybnMge251bWJlcltdfQogICAgICogQHBhcmFtIHsgbnVtYmVyIH0gc3Vic2NlbmUgLSB0aGUgaWQgb2YgdGhlIHN1YnNjZW5lCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5nZXRTdWJzY2VuZUVudHJpZXMgPSBmdW5jdGlvbihzdWJzY2VuZSkgewogICAgICByZXR1cm4gdGhpcy5nZXRPYmooc3Vic2NlbmUpLm9iamVjdHM7CiAgICB9OwoKICAgIC8qKgogICAgICogR2V0IHRoZSBpZHMgb2YgdGhlIHN1YnNjZW5lcyB3aXRoaW4gYSBzdWJzY2VuZQogICAgICogQHJldHVybnMgeyBudW1iZXJbXSB9CiAgICAgKiBAcGFyYW0geyBudW1iZXIgfSBzdWJzY2VuZSAtIHRoZSBpZCBvZiB0aGUgc3Vic2NlbmUKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmdldENoaWxkU3Vic2NlbmVzID0gZnVuY3Rpb24oc3Vic2NlbmUpIHsKICAgICAgcmV0dXJuIHRoaXMuZ2V0T2JqKHN1YnNjZW5lKS5zdWJzY2VuZXM7CiAgICB9OwoKICAgIC8qKgogICAgICogRmluZCBhIHBhcnRpY3VsYXIgc3Vic2NlbmUgYnkgaW5oZXJpdGFuY2UKICAgICAqIEByZXR1cm5zIHsgbnVtYmVyIH0gaWQgb2Ygc3Vic2NlbmUgdG8gdXNlCiAgICAgKiBAcGFyYW0geyBudW1iZXIgfSBzdWJzY2VuZWlkIC0gY2hpbGQgc3Vic2NlbmUKICAgICAqIEBwYXJhbSB7IHN0cmluZyB9IHR5cGUgLSB0eXBlIG9mIGluaGVyaXRhbmNlOiAgInByb2plY3Rpb24iIG9yICJtb2RlbCIKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLnVzZWlkID0gZnVuY3Rpb24oc3Vic2NlbmVpZCwgdHlwZSkgewogICAgICB2YXIgc3ViID0gdGhpcy5nZXRPYmooc3Vic2NlbmVpZCk7CiAgICAgIGlmIChzdWIuZW1iZWRkaW5nc1t0eXBlXSA9PT0gImluaGVyaXQiKQogICAgICAgIHJldHVybih0aGlzLnVzZWlkKHN1Yi5wYXJlbnQsIHR5cGUpKTsKICAgICAgZWxzZQogICAgICAgIHJldHVybiBzdWJzY2VuZWlkOwogICAgfTsKCiAgICAvKioKICAgICAqIEZpbmQgYmJveGRlY28gZm9yIGEgc3Vic2NlbmUKICAgICAqIEByZXR1cm5zIHsgbnVtYmVyIH0gaWQgb2YgYmJveGRlY28sIG9yIHVuZGVmaW5lZCBpZiBub25lCiAgICAgKiBAcGFyYW0geyBudW1iZXIgfSBzdWItIHN1YnNjZW5lCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5nZXRCQm94RGVjbyA9IGZ1bmN0aW9uKHN1YikgewogICAgICB2YXIgb2JqZWN0cyA9IHN1Yi5vYmplY3RzLCBpLCBvYmo7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBvYmplY3RzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgb2JqID0gdGhpcy5nZXRPYmoob2JqZWN0c1tpXSk7CiAgICAgICAgaWYgKG9iai50eXBlID09PSAiYmJveGRlY28iKQogICAgICAgICAgcmV0dXJuIG9iajsKICAgICAgfQogICAgICBpZiAoc3ViLnBhcmVudCkgCiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QkJveERlY28odGhpcy5nZXRPYmooc3ViLnBhcmVudCkpOwogICAgICBlbHNlCiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH07Cg=="></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,ICAgIC8qKgogICAgICogTWV0aG9kcyByZWxhdGVkIHRvIHNoYWRlcnMKICAgICAqIEBuYW1lIF9fX01FVEhPRFNfRk9SX1NIQURFUlNfX18KICAgICAqIEBtZW1iZXJvZiByZ2x3aWRnZXRDbGFzcwogICAgICogQGtpbmQgZnVuY3Rpb24KICAgICAqIEBpbnN0YW5jZQogICAgICovCiAgICAgCiAgICAvKioKICAgICAqIEdldCBmbGFncyB0aGF0IHdpbGwgZW5kIHVwIGFzIHNoYWRlciBkZWZpbmVzLgogICAgICogU3RhdGljIG1ldGhvZCBzbyBpdCBjYW4gYmUgY2FsbGVkIGZyb20gUgogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5nZXREZWZGbGFncyA9IGZ1bmN0aW9uKGZsYWdzLCB0eXBlLCBub3JtYWxzLCByb3VuZF9wb2ludHMpIHsKICAgICAgdmFyIGYgPSB7fTsKICAgICAgZi5mYXRfbGluZXMgPSByZ2x3aWRnZXRDbGFzcy5pc1NldChmbGFncywgcmdsd2lkZ2V0Q2xhc3MuZl9mYXRfbGluZXMpOwogICAgICBmLmZpeGVkX3F1YWRzID0gcmdsd2lkZ2V0Q2xhc3MuaXNTZXQoZmxhZ3MsIHJnbHdpZGdldENsYXNzLmZfZml4ZWRfcXVhZHMpOwogICAgICBmLmZpeGVkX3NpemUgPSByZ2x3aWRnZXRDbGFzcy5pc1NldChmbGFncywgcmdsd2lkZ2V0Q2xhc3MuZl9maXhlZF9zaXplKTsKICAgICAgZi5oYXNfZm9nID0gcmdsd2lkZ2V0Q2xhc3MuaXNTZXQoZmxhZ3MsIHJnbHdpZGdldENsYXNzLmZfaGFzX2ZvZyk7CiAgICAgIGYuaGFzX25vcm1hbHMgPSAodHlwZW9mIG5vcm1hbHMgIT09ICJ1bmRlZmluZWQiKSB8fAogICAgICAgICAgICAgICAgICAgICAgICB0eXBlID09PSAic3BoZXJlcyI7CiAgICAgIGYuaGFzX3RleHR1cmUgPSByZ2x3aWRnZXRDbGFzcy5pc1NldChmbGFncywgcmdsd2lkZ2V0Q2xhc3MuZl9oYXNfdGV4dHVyZSk7CiAgICAgIGYuaXNfYnJ1c2ggPSByZ2x3aWRnZXRDbGFzcy5pc1NldChmbGFncywgcmdsd2lkZ2V0Q2xhc3MuZl9pc19icnVzaCk7CiAgICAgIGYuaXNfbGluZXMgPSByZ2x3aWRnZXRDbGFzcy5pc1NldChmbGFncywgcmdsd2lkZ2V0Q2xhc3MuZl9pc19saW5lcyk7CiAgICAgIGYuaXNfbGl0ID0gcmdsd2lkZ2V0Q2xhc3MuaXNTZXQoZmxhZ3MsIHJnbHdpZGdldENsYXNzLmZfaXNfbGl0KTsKICAgICAgZi5pc19wb2ludHMgPSByZ2x3aWRnZXRDbGFzcy5pc1NldChmbGFncywgcmdsd2lkZ2V0Q2xhc3MuZl9pc19wb2ludHMpOwogICAgICBmLmlzX3RyYW5zcGFyZW50ID0gcmdsd2lkZ2V0Q2xhc3MuaXNTZXQoZmxhZ3MsIHJnbHdpZGdldENsYXNzLmZfaXNfdHJhbnNwYXJlbnQpOwogICAgICBmLmlzX3R3b3NpZGVkID0gcmdsd2lkZ2V0Q2xhc3MuaXNTZXQoZmxhZ3MsIHJnbHdpZGdldENsYXNzLmZfaXNfdHdvc2lkZWQpOwogICAgICBmLm5lZWRzX3Zub3JtYWwgPSAhcmdsd2lkZ2V0Q2xhc3MuaXNTZXQoZmxhZ3MsIHJnbHdpZGdldENsYXNzLmZfc3ByaXRlc18zZCkgJiYKICAgICAgICAoZi5pc19saXQgJiYgIWYuZml4ZWRfcXVhZHMgJiYgIWYuaXNfYnJ1c2gpIHx8IChmLmlzX3R3b3NpZGVkICYmIGYuaGFzX25vcm1hbHMpOwogICAgICBmLnJvdGF0aW5nID0gcmdsd2lkZ2V0Q2xhc3MuaXNTZXQoZmxhZ3MsIHJnbHdpZGdldENsYXNzLmZfcm90YXRpbmcpOwogICAgICBmLnJvdW5kX3BvaW50cyA9IHJvdW5kX3BvaW50czsKICAgICAgcmV0dXJuIGY7CiAgICB9OwogICAgIAogICAgCiAgICAvKioKICAgICAqIEdlbmVyYXRlIHRoZSBkZWZpbmVzIGZvciB0aGUgc2hhZGVyIGNvZGUgZm9yIGFuIG9iamVjdC4KICAgICAqIAogICAgICogVGhpcyBpcyBhIHN0YXRpYyBtZXRob2Qgc28gaXQgY2FuIGJlIGNhbGxlZCBmcm9tIFIuCiAgICAgKiAKICAgICAqIEByZXR1cm5zIHtzdHJpbmd9CiAgICAgKiBAcGFyYW0gIGlkIC0gaWQgb2Ygb2JqZWN0CiAgICAgKiBAcGFyYW0gIHR5cGUgLSB0eXBlIG9mIG9iamVjdAogICAgICogQHBhcmFtICBmbGFncyAtIG9iamVjdCBmbGFncwogICAgICogQHBhcmFtICBuY2xpcHBsYW5lcyAtIG51bWJlciBvZiBjbGlwcGluZyBwbGFuZXMgaW4gc2NlbmUgCiAgICAgKiAgICAgICAgIChtYXkgbm90IGFsbCBiZSBhY3RpdmUpCiAgICAgKiBAcGFyYW0gIG5saWdodHMgLSBudW1iZXIgb2YgbGlnaHRzIGluIHNjZW5lIChkaXR0bykKICAgICAqIEBwYXJhbSAgbm9ybWFscyAtIG5vcm1hbHMgZm9yIG9iamVjdAogICAgICogQHBhcmFtICBwb2ludFNpemUgLSBwb2ludCBzaXplIGZvciBvYmplY3QgCiAgICAgKiBAcGFyYW0gIHRleHR5cGUgLSB0ZXh0dXJlIHR5cGUgZm9yIG9iamVjdCAKICAgICAqIEBwYXJhbSAgYW50aWFsaWFzIC0gdXNlIGFudGlhbGlhc2luZz8KICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MuZ2V0RGVmaW5lcyA9IGZ1bmN0aW9uKGlkLCB0eXBlLCBmbGFncywKICAgICAgbmNsaXBwbGFuZXMsIG5saWdodHMsIG5vcm1hbHMsIHBvaW50U2l6ZSwgdGV4dHlwZSwKICAgICAgdGV4bW9kZSwgdGV4ZW52bWFwLCBhbnRpYWxpYXMsIGZsKSB7CiAgICAgIHZhcgogICAgICAgIHRpdGxlLCBkZWZpbmVzOwogICAgICAKICAgICAgaWYgKHR5cGVvZiBmbCA9PT0gInVuZGVmaW5lZCIpCiAgICAgICAgZmwgPSByZ2x3aWRnZXRDbGFzcy5nZXREZWZGbGFncyhmbGFncywgdHlwZSwgbm9ybWFscywgYW50aWFsaWFzKTsKICAgICAgICAKICAgICAgdGl0bGUgPSAiICAvKiAqKioqKiogIit0eXBlKyIgb2JqZWN0ICIraWQrIiBzaGFkZXIgKioqKioqICovXG4iOwogICAgICAKICAgICAgZGVmaW5lcyA9ICIjZGVmaW5lIE5DTElQUExBTkVTICIgKyBuY2xpcHBsYW5lcyArICJcbiIrCiAgICAgICAgICAgICAgICAiI2RlZmluZSBOTElHSFRTICIgKyBubGlnaHRzICsgIlxuIjsKICAgICAgCiAgICAgIGlmIChmbC5mYXRfbGluZXMpCiAgICAgICAgZGVmaW5lcyA9IGRlZmluZXMgKyAiI2RlZmluZSBGQVRfTElORVMgMVxuIjsKICAgICAgCiAgICAgIGlmIChmbC5maXhlZF9xdWFkcykKICAgICAgICBkZWZpbmVzID0gZGVmaW5lcyArICIjZGVmaW5lIEZJWEVEX1FVQURTIDFcbiI7CgogICAgICBpZiAoZmwuZml4ZWRfc2l6ZSkKICAgICAgICBkZWZpbmVzID0gZGVmaW5lcyArICIjZGVmaW5lIEZJWEVEX1NJWkUgMVxuIjsKCiAgICAgIGlmIChmbC5oYXNfZm9nKQogICAgICAgIGRlZmluZXMgPSBkZWZpbmVzICsgIiNkZWZpbmUgSEFTX0ZPRyAxXG4iOwogICAgICAgIAogICAgICBpZiAoZmwuaGFzX25vcm1hbHMpCiAgICAgICAgZGVmaW5lcyA9IGRlZmluZXMgKyAiI2RlZmluZSBIQVNfTk9STUFMUyAxXG4iOwogICAgICAgIAogICAgICBpZiAoZmwuaGFzX3RleHR1cmUpIHsKICAgICAgICBkZWZpbmVzID0gZGVmaW5lcyArICIjZGVmaW5lIEhBU19URVhUVVJFIDFcbiI7CiAgICAgICAgZGVmaW5lcyA9IGRlZmluZXMgKyAiI2RlZmluZSBURVhUVVJFXyIgKyB0ZXh0eXBlICsgIlxuIjsKICAgICAgICBkZWZpbmVzID0gZGVmaW5lcyArICIjZGVmaW5lIFRFWE1PREVfIiArIHRleG1vZGUgKyAiXG4iOwogICAgICAgIGlmICh0ZXhlbnZtYXApCiAgICAgICAgICBkZWZpbmVzID0gZGVmaW5lcyArICIjZGVmaW5lIFVTRV9FTlZNQVAgMVxuIjsKICAgICAgfQogICAgICAKICAgICAgaWYgKGZsLmlzX2JydXNoKQogICAgICAgIGRlZmluZXMgPSBkZWZpbmVzICsgIiNkZWZpbmUgSVNfQlJVU0ggMVxuIjsgIAoKICAgICAgaWYgKHR5cGUgPT09ICJsaW5lc3RyaXAiKQogICAgICAgIGRlZmluZXMgPSBkZWZpbmVzICsgIiNkZWZpbmUgSVNfTElORVNUUklQIDFcbiI7ICAgICAgICAgCgogICAgICBpZiAoZmwuaXNfbGl0KQogICAgICAgIGRlZmluZXMgPSBkZWZpbmVzICsgIiNkZWZpbmUgSVNfTElUIDFcbiI7IAogICAgICAKICAgICAgaWYgKGZsLmlzX3BvaW50cykgewogICAgICAgIGRlZmluZXMgPSBkZWZpbmVzICsgIiNkZWZpbmUgSVNfUE9JTlRTIDFcbiI7CiAgICAgICAgZGVmaW5lcyA9IGRlZmluZXMgKyAiI2RlZmluZSBQT0lOVFNJWkUgIiArIE51bWJlci5wYXJzZUZsb2F0KHBvaW50U2l6ZSkudG9GaXhlZCgxKSArICJcbiI7CiAgICAgIH0KICAgICAgICAKICAgICAgaWYgKHR5cGUgPT09ICJzcHJpdGVzIikKICAgICAgICBkZWZpbmVzID0gZGVmaW5lcyArICIjZGVmaW5lIElTX1NQUklURVMgMVxuIjsKICAgICAgICAKICAgICAgaWYgKHR5cGUgPT09ICJ0ZXh0IikKICAgICAgICBkZWZpbmVzID0gZGVmaW5lcyArICIjZGVmaW5lIElTX1RFWFQgMVxuIjsKCiAgICAgIGlmIChmbC5pc190cmFuc3BhcmVudCkKICAgICAgICBkZWZpbmVzID0gZGVmaW5lcyArICIjZGVmaW5lIElTX1RSQU5TUEFSRU5UIDFcbiI7IAogICAgICAgIAogICAgICBpZiAoZmwuaXNfdHdvc2lkZWQpCiAgICAgICAgZGVmaW5lcyA9IGRlZmluZXMgKyAiI2RlZmluZSBJU19UV09TSURFRCAxXG4iOwogICAgICAgIAogICAgICBpZiAoZmwubmVlZHNfdm5vcm1hbCkKICAgICAgICBkZWZpbmVzID0gZGVmaW5lcyArICIjZGVmaW5lIE5FRURTX1ZOT1JNQUwgMVxuIjsKCiAgICAgIGlmIChmbC5yb3RhdGluZykKICAgICAgICBkZWZpbmVzID0gZGVmaW5lcyArICIjZGVmaW5lIFJPVEFUSU5HIDFcbiI7CiAgICAgICAgCiAgICAgIGlmIChmbC5yb3VuZF9wb2ludHMpICAgICAgICAKICAgICAgICBkZWZpbmVzID0gZGVmaW5lcyArICIjZGVmaW5lIFJPVU5EX1BPSU5UUyAxXG4iOyAgIAoKICAgICAgLy8gY29uc29sZS5sb2cocmVzdWx0KTsKICAgICAgcmV0dXJuIHRpdGxlICsgZGVmaW5lczsKICAgIH07CgogICAgLyoqCiAgICAgKiBDcmVhdGUgY29kZSBmb3IgdmVydGV4IGFuZCBmcmFnbWVudCBzaGFkZXJzCiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fQogICAgICogQHBhcmFtIHsgbnVtYmVyIH0gc2hhZGVyVHlwZSAtIGdsIGNvZGUgZm9yIHNoYWRlciB0eXBlCiAgICAgKiBAcGFyYW0geyBzdHJpbmcgfSBjb2RlIC0gY29kZSBmb3IgdGhlIHNoYWRlcgogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZ2V0U2hhZGVycyA9IGZ1bmN0aW9uKG9iaikgewogICAgICB2YXIgaGVhZGVyLCAKICAgICAgICB2ZXJ0ZXggPSBvYmoudXNlclZlcnRleFNoYWRlciwgCiAgICAgICAgZnJhZ21lbnQgPSBvYmoudXNlckZyYWdtZW50U2hhZGVyOwogICAgICAKICAgICAgaGVhZGVyID0gcmdsd2lkZ2V0Q2xhc3MuZ2V0RGVmaW5lcygKICAgICAgICBvYmouaWQsIG9iai50eXBlLCBvYmouZmxhZ3MsIAogICAgICAgIHRoaXMuY291bnRDbGlwcGxhbmVzKCksIHRoaXMuY291bnRMaWdodHMoKSwgCiAgICAgICAgb2JqLm5vcm1hbHMsIAogICAgICAgIHRoaXMuZ2V0TWF0ZXJpYWwob2JqLCAic2l6ZSIpLCAKICAgICAgICB0aGlzLmdldE1hdGVyaWFsKG9iaiwgInRleHR5cGUiKSwKICAgICAgICB0aGlzLmdldE1hdGVyaWFsKG9iaiwgInRleG1vZGUiKSwKICAgICAgICB0aGlzLmdldE1hdGVyaWFsKG9iaiwgInRleGVudm1hcCIpLAogICAgICAgIHRoaXMuZ2V0TWF0ZXJpYWwob2JqLCAicG9pbnRfYW50aWFsaWFzIiksCiAgICAgICAgb2JqLmRlZkZsYWdzCiAgICAgICk7CgogICAgICBpZiAodHlwZW9mIHZlcnRleCA9PT0gInVuZGVmaW5lZCIpCiAgICAgICAgdmVydGV4ID0gcmdsd2lkZ2V0Q2xhc3MucmdsX3ZlcnRleF9zaGFkZXIoKTsKICAgICAgICAKICAgICAgaWYgKHR5cGVvZiBmcmFnbWVudCA9PT0gInVuZGVmaW5lZCIpIAogICAgICAgIGZyYWdtZW50ID0gcmdsd2lkZ2V0Q2xhc3MucmdsX2ZyYWdtZW50X3NoYWRlcigpOwoKLy8gICAgICBjb25zb2xlLmxvZygidmVydGV4OiIpOwovLyAgICAgIGNvbnNvbGUubG9nKGhlYWRlciArIHZlcnRleCk7Ci8vICAgICAgY29uc29sZS5sb2coImZyYWdtZW50OiIpOwovLyAgICAgIGNvbnNvbGUubG9nKGhlYWRlciArIGZyYWdtZW50KTsKICAgICAgCiAgICAgIHJldHVybiB7dmVydGV4OiBoZWFkZXIgKyB2ZXJ0ZXgsCiAgICAgICAgICAgICAgZnJhZ21lbnQ6IGhlYWRlciArIGZyYWdtZW50fTsKICAgIH07CiAgICAKICAgIAogICAgLyoqCiAgICAgKiBDYWxsIGdsIGZ1bmN0aW9ucyB0byBjcmVhdGUgYW5kIGNvbXBpbGUgc2hhZGVyIGZyb20gY29kZQogICAgICogQHJldHVybnMge09iamVjdH0KICAgICAqIEBwYXJhbSB7IG51bWJlciB9IHNoYWRlclR5cGUgLSBnbCBjb2RlIGZvciBzaGFkZXIgdHlwZQogICAgICogQHBhcmFtIHsgc3RyaW5nIH0gY29kZSAtIGNvZGUgZm9yIHRoZSBzaGFkZXIKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmdldFNoYWRlciA9IGZ1bmN0aW9uKHNoYWRlclR5cGUsIGNvZGUpIHsKICAgICAgICB2YXIgZ2wgPSB0aGlzLmdsLCBzaGFkZXI7CiAgICAgICAgc2hhZGVyID0gZ2wuY3JlYXRlU2hhZGVyKHNoYWRlclR5cGUpOwogICAgICAgIGdsLnNoYWRlclNvdXJjZShzaGFkZXIsIGNvZGUpOwogICAgICAgIGdsLmNvbXBpbGVTaGFkZXIoc2hhZGVyKTsKICAgICAgICBpZiAoIWdsLmdldFNoYWRlclBhcmFtZXRlcihzaGFkZXIsIGdsLkNPTVBJTEVfU1RBVFVTKSAmJiAhZ2wuaXNDb250ZXh0TG9zdCgpKQogICAgICAgICAgICBhbGVydChnbC5nZXRTaGFkZXJJbmZvTG9nKHNoYWRlcikpOwogICAgICAgIHJldHVybiBzaGFkZXI7CiAgICB9OwoK"></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,cmdsd2lkZ2V0Q2xhc3MucmdsX3ZlcnRleF9zaGFkZXIgPSBmdW5jdGlvbigpIHsKcmV0dXJuICAiI2xpbmUgMiAxXG4iKwoiLy8gRmlsZSAxIGlzIHRoZSB2ZXJ0ZXggc2hhZGVyXG4iKwoiI2lmZGVmIEdMX0VTXG4iKwoiI2lmZGVmIEdMX0ZSQUdNRU5UX1BSRUNJU0lPTl9ISUdIXG4iKwoicHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xuIisKIiNlbHNlXG4iKwoicHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7XG4iKwoiI2VuZGlmXG4iKwoiI2VuZGlmXG4iKwoiXG4iKwoiYXR0cmlidXRlIHZlYzMgYVBvcztcbiIrCiJhdHRyaWJ1dGUgdmVjNCBhQ29sO1xuIisKInVuaWZvcm0gbWF0NCBtdk1hdHJpeDtcbiIrCiJ1bmlmb3JtIG1hdDQgcHJNYXRyaXg7XG4iKwoidmFyeWluZyB2ZWM0IHZDb2w7XG4iKwoidmFyeWluZyB2ZWM0IHZQb3NpdGlvbjtcbiIrCiJcbiIrCiIjaWZkZWYgTkVFRFNfVk5PUk1BTFxuIisKImF0dHJpYnV0ZSB2ZWMzIGFOb3JtO1xuIisKInVuaWZvcm0gbWF0NCBub3JtTWF0cml4O1xuIisKInZhcnlpbmcgdmVjNCB2Tm9ybWFsO1xuIisKIiNlbmRpZlxuIisKIlxuIisKIiNpZiBkZWZpbmVkKEhBU19URVhUVVJFKSB8fCBkZWZpbmVkIChJU19URVhUKVxuIisKImF0dHJpYnV0ZSB2ZWMyIGFUZXhjb29yZDtcbiIrCiJ2YXJ5aW5nIHZlYzIgdlRleGNvb3JkO1xuIisKIiNlbmRpZlxuIisKIlxuIisKIiNpZmRlZiBGSVhFRF9TSVpFXG4iKwoidW5pZm9ybSB2ZWMzIHRleHRTY2FsZTtcbiIrCiIjZW5kaWZcbiIrCiJcbiIrCiIjaWZkZWYgRklYRURfUVVBRFNcbiIrCiJhdHRyaWJ1dGUgdmVjMyBhT2ZzO1xuIisKIiNlbmRpZlxuIisKIlxuIisKIiNpZmRlZiBJU19UV09TSURFRFxuIisKIiNpZmRlZiBIQVNfTk9STUFMU1xuIisKInZhcnlpbmcgZmxvYXQgbm9ybXo7XG4iKwoidW5pZm9ybSBtYXQ0IGludlByTWF0cml4O1xuIisKIiNlbHNlXG4iKwoiYXR0cmlidXRlIHZlYzMgYVBvczE7XG4iKwoiYXR0cmlidXRlIHZlYzMgYVBvczI7XG4iKwoidmFyeWluZyBmbG9hdCBub3JtejtcbiIrCiIjZW5kaWZcbiIrCiIjZW5kaWYgLy8gSVNfVFdPU0lERURcbiIrCiJcbiIrCiIjaWZkZWYgRkFUX0xJTkVTXG4iKwoiYXR0cmlidXRlIHZlYzMgYU5leHQ7XG4iKwoiYXR0cmlidXRlIHZlYzIgYVBvaW50O1xuIisKInZhcnlpbmcgdmVjMiB2UG9pbnQ7XG4iKwoidmFyeWluZyBmbG9hdCB2TGVuZ3RoO1xuIisKInVuaWZvcm0gZmxvYXQgdUFzcGVjdDtcbiIrCiJ1bmlmb3JtIGZsb2F0IHVMd2Q7XG4iKwoiI2VuZGlmXG4iKwoiXG4iKwoiI2lmZGVmIFVTRV9FTlZNQVBcbiIrCiJ2YXJ5aW5nIHZlYzMgdlJlZmxlY3Rpb247XG4iKwoiI2VuZGlmXG4iKwoiXG4iKwoidm9pZCBtYWluKHZvaWQpIHtcbiIrCiIgIFxuIisKIiNpZm5kZWYgSVNfQlJVU0hcbiIrCiIjaWYgZGVmaW5lZChOQ0xJUFBMQU5FUykgfHwgIWRlZmluZWQoRklYRURfUVVBRFMpIHx8IGRlZmluZWQoSEFTX0ZPRykgfHwgZGVmaW5lZChVU0VfRU5WTUFQKVxuIisKIiAgdlBvc2l0aW9uID0gbXZNYXRyaXggKiB2ZWM0KGFQb3MsIDEuKTtcbiIrCiIjZW5kaWZcbiIrCiIgIFxuIisKIiNpZm5kZWYgRklYRURfUVVBRFNcbiIrCiIgIGdsX1Bvc2l0aW9uID0gcHJNYXRyaXggKiB2UG9zaXRpb247XG4iKwoiI2VuZGlmXG4iKwoiI2VuZGlmIC8vICFJU19CUlVTSFxuIisKIiAgXG4iKwoiI2lmZGVmIElTX1BPSU5UU1xuIisKIiAgZ2xfUG9pbnRTaXplID0gUE9JTlRTSVpFO1xuIisKIiNlbmRpZlxuIisKIiAgXG4iKwoiICB2Q29sID0gYUNvbDtcbiIrCiIgIFxuIisKIi8vIFVTRV9FTlZNQVAgaW1wbGllcyBORUVEU19WTk9STUFMXG4iKwoiXG4iKwoiI2lmZGVmIE5FRURTX1ZOT1JNQUxcbiIrCiIgIHZOb3JtYWwgPSBub3JtTWF0cml4ICogdmVjNCgtYU5vcm0sIGRvdChhTm9ybSwgYVBvcykpO1xuIisKIiNlbmRpZlxuIisKIlxuIisKIiNpZmRlZiBVU0VfRU5WTUFQXG4iKwoiICB2UmVmbGVjdGlvbiA9IG5vcm1hbGl6ZShyZWZsZWN0KHZQb3NpdGlvbi54eXovdlBvc2l0aW9uLncsIFxuIisKIiAgICAgICAgICAgICAgICAgICAgICAgIG5vcm1hbGl6ZSh2Tm9ybWFsLnh5ei92Tm9ybWFsLncpKSk7XG4iKwoiI2VuZGlmXG4iKwoiICBcbiIrCiIjaWZkZWYgSVNfVFdPU0lERURcbiIrCiIjaWZkZWYgSEFTX05PUk1BTFNcbiIrCiIgIC8qIG5vcm16IHNob3VsZCBiZSBjYWxjdWxhdGVkICphZnRlciogcHJvamVjdGlvbiAqL1xuIisKIiAgbm9ybXogPSAoaW52UHJNYXRyaXgqdk5vcm1hbCkuejtcbiIrCiIjZWxzZVxuIisKIiAgdmVjNCBwb3MxID0gcHJNYXRyaXgqKG12TWF0cml4KnZlYzQoYVBvczEsIDEuKSk7XG4iKwoiICBwb3MxID0gcG9zMS9wb3MxLncgLSBnbF9Qb3NpdGlvbi9nbF9Qb3NpdGlvbi53O1xuIisKIiAgdmVjNCBwb3MyID0gcHJNYXRyaXgqKG12TWF0cml4KnZlYzQoYVBvczIsIDEuKSk7XG4iKwoiICBwb3MyID0gcG9zMi9wb3MyLncgLSBnbF9Qb3NpdGlvbi9nbF9Qb3NpdGlvbi53O1xuIisKIiAgbm9ybXogPSBwb3MxLngqcG9zMi55IC0gcG9zMS55KnBvczIueDtcbiIrCiIjZW5kaWZcbiIrCiIjZW5kaWYgLy8gSVNfVFdPU0lERURcbiIrCiIgIFxuIisKIiNpZmRlZiBORUVEU19WTk9STUFMXG4iKwoiICB2Tm9ybWFsID0gdmVjNChub3JtYWxpemUodk5vcm1hbC54eXopLCAxKTtcbiIrCiIjZW5kaWZcbiIrCiIgIFxuIisKIiNpZiBkZWZpbmVkKEhBU19URVhUVVJFKSB8fCBkZWZpbmVkKElTX1RFWFQpXG4iKwoiICB2VGV4Y29vcmQgPSBhVGV4Y29vcmQ7XG4iKwoiI2VuZGlmXG4iKwoiICBcbiIrCiIjaWYgZGVmaW5lZChGSVhFRF9TSVpFKSAmJiAhZGVmaW5lZChST1RBVElORylcbiIrCiIgIHZlYzQgcG9zID0gcHJNYXRyaXggKiBtdk1hdHJpeCAqIHZlYzQoYVBvcywgMS4pO1xuIisKIiAgcG9zID0gcG9zL3Bvcy53O1xuIisKIiAgZ2xfUG9zaXRpb24gPSBwb3MgKyB2ZWM0KGFPZnMqdGV4dFNjYWxlLCAwLik7XG4iKwoiI2VuZGlmXG4iKwoiICBcbiIrCiIjaWYgZGVmaW5lZChJU19TUFJJVEVTKSAmJiAhZGVmaW5lZChGSVhFRF9TSVpFKVxuIisKIiAgdmVjNCBwb3MgPSBtdk1hdHJpeCAqIHZlYzQoYVBvcywgMS4pO1xuIisKIiAgcG9zID0gcG9zL3Bvcy53ICsgdmVjNChhT2ZzLCAgMC4pO1xuIisKIiAgZ2xfUG9zaXRpb24gPSBwck1hdHJpeCpwb3M7XG4iKwoiI2VuZGlmXG4iKwoiICBcbiIrCiIjaWZkZWYgRkFUX0xJTkVTXG4iKwoiICAvKiBUaGlzIGNvZGUgd2FzIGluc3BpcmVkIGJ5IE1hdHQgRGVzbGF1cmllcnMnIGNvZGUgaW4gXG4iKwoiICAgaHR0cHM6Ly9tYXR0ZGVzbC5zdmJ0bGUuY29tL2RyYXdpbmctbGluZXMtaXMtaGFyZCAqL1xuIisKIiAgdmVjMiBhc3BlY3RWZWMgPSB2ZWMyKHVBc3BlY3QsIDEuMCk7XG4iKwoiICBtYXQ0IHByb2pWaWV3TW9kZWwgPSBwck1hdHJpeCAqIG12TWF0cml4O1xuIisKIiAgdmVjNCBjdXJyZW50UHJvamVjdGVkID0gcHJvalZpZXdNb2RlbCAqIHZlYzQoYVBvcywgMS4wKTtcbiIrCiIgIGN1cnJlbnRQcm9qZWN0ZWQgPSBjdXJyZW50UHJvamVjdGVkL2N1cnJlbnRQcm9qZWN0ZWQudztcbiIrCiIgIHZlYzQgbmV4dFByb2plY3RlZCA9IHByb2pWaWV3TW9kZWwgKiB2ZWM0KGFOZXh0LCAxLjApO1xuIisKIiAgdmVjMiBjdXJyZW50U2NyZWVuID0gY3VycmVudFByb2plY3RlZC54eSAqIGFzcGVjdFZlYztcbiIrCiIgIHZlYzIgbmV4dFNjcmVlbiA9IChuZXh0UHJvamVjdGVkLnh5IC8gbmV4dFByb2plY3RlZC53KSAqIGFzcGVjdFZlYztcbiIrCiIgIGZsb2F0IGxlbiA9IHVMd2Q7XG4iKwoiICB2ZWMyIGRpciA9IHZlYzIoMS4wLCAwLjApO1xuIisKIiAgdlBvaW50ID0gYVBvaW50O1xuIisKIiAgdkxlbmd0aCA9IGxlbmd0aChuZXh0U2NyZWVuIC0gY3VycmVudFNjcmVlbikvMi4wO1xuIisKIiAgdkxlbmd0aCA9IHZMZW5ndGgvKHZMZW5ndGggKyBsZW4pO1xuIisKIiAgaWYgKHZMZW5ndGggPiAwLjApIHtcbiIrCiIgICAgZGlyID0gbm9ybWFsaXplKG5leHRTY3JlZW4gLSBjdXJyZW50U2NyZWVuKTtcbiIrCiIgIH1cbiIrCiIgIHZlYzIgbm9ybWFsID0gdmVjMigtZGlyLnksIGRpci54KTtcbiIrCiIgIGRpci54IC89IHVBc3BlY3Q7XG4iKwoiICBub3JtYWwueCAvPSB1QXNwZWN0O1xuIisKIiAgdmVjNCBvZmZzZXQgPSB2ZWM0KGxlbioobm9ybWFsKmFQb2ludC54KmFQb2ludC55IC0gZGlyKSwgMC4wLCAwLjApO1xuIisKIiAgZ2xfUG9zaXRpb24gPSBjdXJyZW50UHJvamVjdGVkICsgb2Zmc2V0O1xuIisKIiNlbmRpZlxuIisKIiAgXG4iKwoiI2lmZGVmIElTX0JSVVNIXG4iKwoiICBnbF9Qb3NpdGlvbiA9IHZlYzQoYVBvcywgMS4pO1xuIisKIiNlbmRpZlxuIisKIn1cbiIgO307CnJnbHdpZGdldENsYXNzLnJnbF9mcmFnbWVudF9zaGFkZXIgPSBmdW5jdGlvbigpIHsKcmV0dXJuICAiI2xpbmUgMiAyXG4iKwoiLy8gRmlsZSAyIGlzIHRoZSBmcmFnbWVudCBzaGFkZXJcbiIrCiIjaWZkZWYgR0xfRVNcbiIrCiIjaWZkZWYgR0xfRlJBR01FTlRfUFJFQ0lTSU9OX0hJR0hcbiIrCiJwcmVjaXNpb24gaGlnaHAgZmxvYXQ7XG4iKwoiI2Vsc2VcbiIrCiJwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDtcbiIrCiIjZW5kaWZcbiIrCiIjZW5kaWZcbiIrCiJ2YXJ5aW5nIHZlYzQgdkNvbDsgLy8gY2FycmllcyBhbHBoYVxuIisKInZhcnlpbmcgdmVjNCB2UG9zaXRpb247XG4iKwoiI2lmIGRlZmluZWQoSEFTX1RFWFRVUkUpIHx8IGRlZmluZWQgKElTX1RFWFQpXG4iKwoidmFyeWluZyB2ZWMyIHZUZXhjb29yZDtcbiIrCiJ1bmlmb3JtIHNhbXBsZXIyRCB1U2FtcGxlcjtcbiIrCiIjZW5kaWZcbiIrCiJcbiIrCiIjaWZkZWYgSEFTX0ZPR1xuIisKInVuaWZvcm0gaW50IHVGb2dNb2RlO1xuIisKInVuaWZvcm0gdmVjMyB1Rm9nQ29sb3I7XG4iKwoidW5pZm9ybSB2ZWM0IHVGb2dQYXJtcztcbiIrCiIjZW5kaWZcbiIrCiJcbiIrCiIjaWYgZGVmaW5lZChJU19MSVQpICYmICFkZWZpbmVkKEZJWEVEX1FVQURTKVxuIisKInZhcnlpbmcgdmVjNCB2Tm9ybWFsO1xuIisKIiNlbmRpZlxuIisKIlxuIisKIiNpZiBOQ0xJUFBMQU5FUyA+IDBcbiIrCiJ1bmlmb3JtIHZlYzQgdkNsaXBwbGFuZVtOQ0xJUFBMQU5FU107XG4iKwoiI2VuZGlmXG4iKwoiXG4iKwoiI2lmIE5MSUdIVFMgPiAwXG4iKwoidW5pZm9ybSBtYXQ0IG12TWF0cml4O1xuIisKIiNlbmRpZlxuIisKIlxuIisKIiNpZmRlZiBJU19MSVRcbiIrCiJ1bmlmb3JtIHZlYzMgZW1pc3Npb247XG4iKwoidW5pZm9ybSBmbG9hdCBzaGluaW5lc3M7XG4iKwoiI2lmIE5MSUdIVFMgPiAwXG4iKwoidW5pZm9ybSB2ZWMzIGFtYmllbnRbTkxJR0hUU107XG4iKwoidW5pZm9ybSB2ZWMzIHNwZWN1bGFyW05MSUdIVFNdOyAvLyBsaWdodCptYXRlcmlhbFxuIisKInVuaWZvcm0gdmVjMyBkaWZmdXNlW05MSUdIVFNdO1xuIisKInVuaWZvcm0gdmVjMyBsaWdodERpcltOTElHSFRTXTtcbiIrCiJ1bmlmb3JtIGJvb2wgdmlld3BvaW50W05MSUdIVFNdO1xuIisKInVuaWZvcm0gYm9vbCBmaW5pdGVbTkxJR0hUU107XG4iKwoiI2VuZGlmXG4iKwoiI2VuZGlmIC8vIElTX0xJVFxuIisKIlxuIisKIiNpZmRlZiBJU19UV09TSURFRFxuIisKInVuaWZvcm0gYm9vbCBmcm9udDtcbiIrCiJ2YXJ5aW5nIGZsb2F0IG5vcm16O1xuIisKIiNlbmRpZlxuIisKIlxuIisKIiNpZmRlZiBGQVRfTElORVNcbiIrCiJ2YXJ5aW5nIHZlYzIgdlBvaW50O1xuIisKInZhcnlpbmcgZmxvYXQgdkxlbmd0aDtcbiIrCiIjZW5kaWZcbiIrCiJcbiIrCiIjaWZkZWYgVVNFX0VOVk1BUFxuIisKInZhcnlpbmcgdmVjMyB2UmVmbGVjdGlvbjtcbiIrCiIjZW5kaWZcbiIrCiJcbiIrCiJ2b2lkIG1haW4odm9pZCkge1xuIisKIiAgdmVjNCBmcmFnQ29sb3I7XG4iKwoiI2lmZGVmIEZBVF9MSU5FU1xuIisKIiAgdmVjMiBwb2ludCA9IHZQb2ludDtcbiIrCiIgIGJvb2wgbmVnID0gcG9pbnQueSA8IDAuMDtcbiIrCiIgIHBvaW50LnkgPSBuZWcgPyAocG9pbnQueSArIHZMZW5ndGgpLygxLjAgLSB2TGVuZ3RoKSA6XG4iKwoiICAgICAgICAgICAgICAgICAtKHBvaW50LnkgLSB2TGVuZ3RoKS8oMS4wIC0gdkxlbmd0aCk7XG4iKwoiI2lmIGRlZmluZWQoSVNfVFJBTlNQQVJFTlQpICYmIGRlZmluZWQoSVNfTElORVNUUklQKVxuIisKIiAgaWYgKG5lZyAmJiBsZW5ndGgocG9pbnQpIDw9IDEuMCkgZGlzY2FyZDtcbiIrCiIjZW5kaWZcbiIrCiIgIHBvaW50LnkgPSBtaW4ocG9pbnQueSwgMC4wKTtcbiIrCiIgIGlmIChsZW5ndGgocG9pbnQpID4gMS4wKSBkaXNjYXJkO1xuIisKIiNlbmRpZiAvLyBGQVRfTElORVNcbiIrCiIgIFxuIisKIiNpZmRlZiBST1VORF9QT0lOVFNcbiIrCiIgIHZlYzIgY29vcmQgPSBnbF9Qb2ludENvb3JkIC0gdmVjMigwLjUpO1xuIisKIiAgaWYgKGxlbmd0aChjb29yZCkgPiAwLjUpIGRpc2NhcmQ7XG4iKwoiI2VuZGlmXG4iKwoiICBcbiIrCiIjaWYgTkNMSVBQTEFORVMgPiAwXG4iKwoiICBmb3IgKGludCBpID0gMDsgaSA8IE5DTElQUExBTkVTOyBpKyspXG4iKwoiICAgIGlmIChkb3QodlBvc2l0aW9uLCB2Q2xpcHBsYW5lW2ldKSA8IDAuMCkgZGlzY2FyZDtcbiIrCiIjZW5kaWZcbiIrCiIgICAgXG4iKwoiI2lmZGVmIEZJWEVEX1FVQURTXG4iKwoiICAgIHZlYzMgbiA9IHZlYzMoMC4sIDAuLCAxLik7XG4iKwoiI2VsaWYgZGVmaW5lZChJU19MSVQpXG4iKwoiICAgIHZlYzMgbiA9IG5vcm1hbGl6ZSh2Tm9ybWFsLnh5eik7XG4iKwoiI2VuZGlmXG4iKwoiICAgIFxuIisKIiNpZmRlZiBJU19UV09TSURFRFxuIisKIiAgICBpZiAoKG5vcm16IDw9IDAuKSAhPSBmcm9udCkgZGlzY2FyZDtcbiIrCiIjZW5kaWZcbiIrCiJcbiIrCiIjaWZkZWYgSVNfTElUXG4iKwoiICAgIHZlYzMgZXllID0gbm9ybWFsaXplKC12UG9zaXRpb24ueHl6L3ZQb3NpdGlvbi53KTtcbiIrCiIgICAgdmVjMyBsaWdodGRpcjtcbiIrCiIgICAgdmVjNCBjb2xEaWZmO1xuIisKIiAgICB2ZWMzIGhhbGZWZWM7XG4iKwoiICAgIHZlYzQgbGlnaHRlZmZlY3QgPSB2ZWM0KGVtaXNzaW9uLCAwLik7XG4iKwoiICAgIHZlYzMgY29sO1xuIisKIiAgICBmbG9hdCBuRG90TDtcbiIrCiIjaWZkZWYgRklYRURfUVVBRFNcbiIrCiIgICAgbiA9IC1mYWNlZm9yd2FyZChuLCBuLCBleWUpO1xuIisKIiNlbmRpZlxuIisKIiAgICBcbiIrCiIjaWYgTkxJR0hUUyA+IDBcbiIrCiIgICAgLy8gU2ltdWxhdGUgdHdvLXNpZGVkIGxpZ2h0aW5nXG4iKwoiICAgIGlmIChuLnogPCAwLjApXG4iKwoiICAgICAgbiA9IC1uO1xuIisKIiAgICBmb3IgKGludCBpPTA7aTxOTElHSFRTO2krKykge1xuIisKIiAgICAgIGNvbERpZmYgPSB2ZWM0KHZDb2wucmdiICogZGlmZnVzZVtpXSwgdkNvbC5hKTtcbiIrCiIgICAgICBsaWdodGRpciA9IGxpZ2h0RGlyW2ldO1xuIisKIiAgICAgIGlmICghdmlld3BvaW50W2ldKSB7XG4iKwoiICAgICAgICBpZiAoZmluaXRlW2ldKSB7XG4iKwoiICAgICAgICAgIGxpZ2h0ZGlyID0gKG12TWF0cml4ICogdmVjNChsaWdodGRpciwgMS4pKS54eXo7XG4iKwoiICAgICAgICB9IGVsc2Uge1xuIisKIiAgICAgICAgICBsaWdodGRpciA9IChtdk1hdHJpeCAqIHZlYzQobGlnaHRkaXIsIDAuKSkueHl6O1xuIisKIiAgICAgICAgfVxuIisKIiAgICAgIH1cbiIrCiIgICAgICBpZiAoIWZpbml0ZVtpXSkge1xuIisKIiAgICAgICAgaGFsZlZlYyA9IG5vcm1hbGl6ZShsaWdodGRpciArIGV5ZSk7XG4iKwoiICAgICAgfSBlbHNlIHtcbiIrCiIgICAgICAgIGxpZ2h0ZGlyID0gbm9ybWFsaXplKGxpZ2h0ZGlyIC0gdlBvc2l0aW9uLnh5ei92UG9zaXRpb24udyk7XG4iKwoiICAgICAgICBoYWxmVmVjID0gbm9ybWFsaXplKGxpZ2h0ZGlyICsgZXllKTtcbiIrCiIgICAgICB9XG4iKwoiICAgICAgY29sID0gYW1iaWVudFtpXTtcbiIrCiIgICAgICBuRG90TCA9IGRvdChuLCBsaWdodGRpcik7XG4iKwoiICAgICAgY29sID0gY29sICsgbWF4KG5Eb3RMLCAwLikgKiBjb2xEaWZmLnJnYjtcbiIrCiIgICAgICBjb2wgPSBjb2wgKyBwb3cobWF4KGRvdChoYWxmVmVjLCBuKSwgMC4pLCBzaGluaW5lc3MpICogc3BlY3VsYXJbaV07XG4iKwoiICAgICAgbGlnaHRlZmZlY3QgPSBsaWdodGVmZmVjdCArIHZlYzQoY29sLCBjb2xEaWZmLmEpO1xuIisKIiAgICB9XG4iKwoiI2VuZGlmXG4iKwoiICAgIFxuIisKIiNlbHNlIC8vIG5vdCBJU19MSVRcbiIrCiIgICAgdmVjNCBjb2xEaWZmID0gdkNvbDtcbiIrCiIgICAgdmVjNCBsaWdodGVmZmVjdCA9IGNvbERpZmY7XG4iKwoiI2VuZGlmXG4iKwoiICAgIFxuIisKIiNpZmRlZiBJU19URVhUXG4iKwoiICAgIHZlYzQgdGV4dHVyZUNvbG9yID0gbGlnaHRlZmZlY3QqdGV4dHVyZTJEKHVTYW1wbGVyLCB2VGV4Y29vcmQpO1xuIisKIiNlbmRpZlxuIisKIiAgICBcbiIrCiIjaWZkZWYgSEFTX1RFWFRVUkVcbiIrCiJcbiIrCiIvLyBUaGVzZSBjYWxjdWxhdGlvbnMgdXNlIHRoZSBkZWZpbml0aW9ucyBmcm9tIFxuIisKIi8vIGh0dHBzOi8vZG9jcy5nbC9nbDMvZ2xUZXhFbnZcbiIrCiJcbiIrCiIjaWZkZWYgVVNFX0VOVk1BUFxuIisKIiAgICBmbG9hdCBtID0gMi4wICogc3FydChkb3QodlJlZmxlY3Rpb24sIHZSZWZsZWN0aW9uKSArIDIuMCp2UmVmbGVjdGlvbi56ICsgMS4wKTtcbiIrCiIgICAgdmVjNCB0ZXh0dXJlQ29sb3IgPSB0ZXh0dXJlMkQodVNhbXBsZXIsIHZSZWZsZWN0aW9uLnh5IC8gbSArIHZlYzIoMC41LCAwLjUpKTtcbiIrCiIjZWxzZVxuIisKIiAgICB2ZWM0IHRleHR1cmVDb2xvciA9IHRleHR1cmUyRCh1U2FtcGxlciwgdlRleGNvb3JkKTtcbiIrCiIjZW5kaWZcbiIrCiJcbiIrCiIjaWZkZWYgVEVYVFVSRV9yZ2JcbiIrCiJcbiIrCiIjaWYgZGVmaW5lZChURVhNT0RFX3JlcGxhY2UpIHx8IGRlZmluZWQoVEVYTU9ERV9kZWNhbClcbiIrCiIgICAgdGV4dHVyZUNvbG9yID0gdmVjNCh0ZXh0dXJlQ29sb3IucmdiLCBsaWdodGVmZmVjdC5hKTtcbiIrCiIjZW5kaWYgXG4iKwoiXG4iKwoiI2lmZGVmIFRFWE1PREVfbW9kdWxhdGVcbiIrCiIgICAgdGV4dHVyZUNvbG9yID0gbGlnaHRlZmZlY3QqdmVjNCh0ZXh0dXJlQ29sb3IucmdiLCAxLik7XG4iKwoiI2VuZGlmXG4iKwoiXG4iKwoiI2lmZGVmIFRFWE1PREVfYmxlbmRcbiIrCiIgICAgdGV4dHVyZUNvbG9yID0gdmVjNCgoMS4gLSB0ZXh0dXJlQ29sb3IucmdiKSAqIGxpZ2h0ZWZmZWN0LnJnYiwgbGlnaHRlZmZlY3QuYSk7XG4iKwoiI2VuZGlmXG4iKwoiXG4iKwoiI2lmZGVmIFRFWE1PREVfYWRkXG4iKwoiICAgIHRleHR1cmVDb2xvciA9IHZlYzQobGlnaHRlZmZlY3QucmdiICsgdGV4dHVyZUNvbG9yLnJnYiwgbGlnaHRlZmZlY3QuYSk7XG4iKwoiI2VuZGlmXG4iKwoiXG4iKwoiI2VuZGlmIC8vVEVYVFVSRV9yZ2JcbiIrCiIgICAgICAgIFxuIisKIiNpZmRlZiBURVhUVVJFX3JnYmFcbiIrCiJcbiIrCiIjaWZkZWYgVEVYTU9ERV9yZXBsYWNlXG4iKwoiLy8gYWxyZWFkeSBkb25lXG4iKwoiI2VuZGlmIFxuIisKIlxuIisKIiNpZmRlZiBURVhNT0RFX21vZHVsYXRlXG4iKwoiICAgIHRleHR1cmVDb2xvciA9IGxpZ2h0ZWZmZWN0KnRleHR1cmVDb2xvcjtcbiIrCiIjZW5kaWZcbiIrCiJcbiIrCiIjaWZkZWYgVEVYTU9ERV9kZWNhbFxuIisKIiAgICB0ZXh0dXJlQ29sb3IgPSB2ZWM0KCgxLiAtIHRleHR1cmVDb2xvci5hKSpsaWdodGVmZmVjdC5yZ2IpICtcbiIrCiIgICAgICAgICAgICAgICAgICAgICB0ZXh0dXJlQ29sb3IuYSp0ZXh0dXJlQ29sb3IucmdiLCBcbiIrCiIgICAgICAgICAgICAgICAgICAgICBsaWdodGVmZmVjdC5hKTtcbiIrCiIjZW5kaWZcbiIrCiJcbiIrCiIjaWZkZWYgVEVYTU9ERV9ibGVuZFxuIisKIiAgICB0ZXh0dXJlQ29sb3IgPSB2ZWM0KCgxLiAtIHRleHR1cmVDb2xvci5yZ2IpICogbGlnaHRlZmZlY3QucmdiLFxuIisKIiAgICAgICAgICAgICAgICAgICAgbGlnaHRlZmZlY3QuYSp0ZXh0dXJlQ29sb3IuYSk7XG4iKwoiI2VuZGlmXG4iKwoiXG4iKwoiI2lmZGVmIFRFWE1PREVfYWRkXG4iKwoiICAgIHRleHR1cmVDb2xvciA9IHZlYzQobGlnaHRlZmZlY3QucmdiICsgdGV4dHVyZUNvbG9yLnJnYixcbiIrCiIgICAgICAgICAgICAgICAgICAgIGxpZ2h0ZWZmZWN0LmEqdGV4dHVyZUNvbG9yLmEpO1xuIisKIiNlbmRpZlxuIisKIiAgICBcbiIrCiIjZW5kaWYgLy9URVhUVVJFX3JnYmFcbiIrCiIgICAgXG4iKwoiI2lmZGVmIFRFWFRVUkVfYWxwaGFcbiIrCiIgICAgZmxvYXQgbHVtaW5hbmNlID0gZG90KHZlYzMoMS4sMS4sMS4pLHRleHR1cmVDb2xvci5yZ2IpLzMuO1xuIisKIlxuIisKIiNpZiBkZWZpbmVkKFRFWE1PREVfcmVwbGFjZSkgfHwgZGVmaW5lZChURVhNT0RFX2RlY2FsKVxuIisKIiAgICB0ZXh0dXJlQ29sb3IgPSB2ZWM0KGxpZ2h0ZWZmZWN0LnJnYiwgbHVtaW5hbmNlKTtcbiIrCiIjZW5kaWYgXG4iKwoiXG4iKwoiI2lmIGRlZmluZWQoVEVYTU9ERV9tb2R1bGF0ZSkgfHwgZGVmaW5lZChURVhNT0RFX2JsZW5kKSB8fCBkZWZpbmVkKFRFWE1PREVfYWRkKVxuIisKIiAgICB0ZXh0dXJlQ29sb3IgPSB2ZWM0KGxpZ2h0ZWZmZWN0LnJnYiwgbGlnaHRlZmZlY3QuYSpsdW1pbmFuY2UpO1xuIisKIiNlbmRpZlxuIisKIiBcbiIrCiIjZW5kaWYgLy8gVEVYVFVSRV9hbHBoYVxuIisKIiAgICBcbiIrCiIvLyBUaGUgVEVYVFVSRV9sdW1pbmFuY2UgdmFsdWVzIGFyZSBub3QgZnJvbSB0aGF0IHJlZmVyZW5jZSAgICBcbiIrCiIjaWZkZWYgVEVYVFVSRV9sdW1pbmFuY2VcbiIrCiIgICAgZmxvYXQgbHVtaW5hbmNlID0gZG90KHZlYzMoMS4sMS4sMS4pLHRleHR1cmVDb2xvci5yZ2IpLzMuO1xuIisKIlxuIisKIiNpZiBkZWZpbmVkKFRFWE1PREVfcmVwbGFjZSkgfHwgZGVmaW5lZChURVhNT0RFX2RlY2FsKVxuIisKIiAgICB0ZXh0dXJlQ29sb3IgPSB2ZWM0KGx1bWluYW5jZSwgbHVtaW5hbmNlLCBsdW1pbmFuY2UsIGxpZ2h0ZWZmZWN0LmEpO1xuIisKIiNlbmRpZiBcbiIrCiJcbiIrCiIjaWZkZWYgVEVYTU9ERV9tb2R1bGF0ZVxuIisKIiAgICB0ZXh0dXJlQ29sb3IgPSB2ZWM0KGx1bWluYW5jZSpsaWdodGVmZmVjdC5yZ2IsIGxpZ2h0ZWZmZWN0LmEpO1xuIisKIiNlbmRpZlxuIisKIlxuIisKIiNpZmRlZiBURVhNT0RFX2JsZW5kXG4iKwoiICAgIHRleHR1cmVDb2xvciA9IHZlYzQoKDEuIC0gbHVtaW5hbmNlKSpsaWdodGVmZmVjdC5yZ2IsXG4iKwoiICAgICAgICAgICAgICAgICAgICAgICAgbGlnaHRlZmZlY3QuYSk7XG4iKwoiI2VuZGlmXG4iKwoiXG4iKwoiI2lmZGVmIFRFWE1PREVfYWRkXG4iKwoiICAgIHRleHR1cmVDb2xvciA9IHZlYzQobHVtaW5hbmNlICsgbGlnaHRlZmZlY3QucmdiLCBsaWdodGVmZmVjdC5hKTtcbiIrCiIjZW5kaWZcbiIrCiJcbiIrCiIjZW5kaWYgLy8gVEVYVFVSRV9sdW1pbmFuY2VcbiIrCiIgXG4iKwoiICAgIFxuIisKIiNpZmRlZiBURVhUVVJFX2x1bWluYW5jZV9hbHBoYVxuIisKIiAgICBmbG9hdCBsdW1pbmFuY2UgPSBkb3QodmVjMygxLiwxLiwxLiksdGV4dHVyZUNvbG9yLnJnYikvMy47XG4iKwoiXG4iKwoiI2lmIGRlZmluZWQoVEVYTU9ERV9yZXBsYWNlKSB8fCBkZWZpbmVkKFRFWE1PREVfZGVjYWwpXG4iKwoiICAgIHRleHR1cmVDb2xvciA9IHZlYzQobHVtaW5hbmNlLCBsdW1pbmFuY2UsIGx1bWluYW5jZSwgdGV4dHVyZUNvbG9yLmEpO1xuIisKIiNlbmRpZiBcbiIrCiJcbiIrCiIjaWZkZWYgVEVYTU9ERV9tb2R1bGF0ZVxuIisKIiAgICB0ZXh0dXJlQ29sb3IgPSB2ZWM0KGx1bWluYW5jZSpsaWdodGVmZmVjdC5yZ2IsIFxuIisKIiAgICAgICAgICAgICAgICAgICAgICAgIHRleHR1cmVDb2xvci5hKmxpZ2h0ZWZmZWN0LmEpO1xuIisKIiNlbmRpZlxuIisKIlxuIisKIiNpZmRlZiBURVhNT0RFX2JsZW5kXG4iKwoiICAgIHRleHR1cmVDb2xvciA9IHZlYzQoKDEuIC0gbHVtaW5hbmNlKSpsaWdodGVmZmVjdC5yZ2IsXG4iKwoiICAgICAgICAgICAgICAgICAgICAgICAgdGV4dHVyZUNvbG9yLmEqbGlnaHRlZmZlY3QuYSk7XG4iKwoiI2VuZGlmXG4iKwoiXG4iKwoiI2lmZGVmIFRFWE1PREVfYWRkXG4iKwoiICAgIHRleHR1cmVDb2xvciA9IHZlYzQobHVtaW5hbmNlICsgbGlnaHRlZmZlY3QucmdiLCBcbiIrCiIgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0dXJlQ29sb3IuYSpsaWdodGVmZmVjdC5hKTtcbiIrCiJcbiIrCiIjZW5kaWZcbiIrCiJcbiIrCiIjZW5kaWYgLy8gVEVYVFVSRV9sdW1pbmFuY2VfYWxwaGFcbiIrCiIgICAgXG4iKwoiICAgIGZyYWdDb2xvciA9IHRleHR1cmVDb2xvcjtcbiIrCiJcbiIrCiIjZWxpZiBkZWZpbmVkKElTX1RFWFQpXG4iKwoiICAgIGlmICh0ZXh0dXJlQ29sb3IuYSA8IDAuMSlcbiIrCiIgICAgICBkaXNjYXJkO1xuIisKIiAgICBlbHNlXG4iKwoiICAgICAgZnJhZ0NvbG9yID0gdGV4dHVyZUNvbG9yO1xuIisKIiNlbHNlXG4iKwoiICAgIGZyYWdDb2xvciA9IGxpZ2h0ZWZmZWN0O1xuIisKIiNlbmRpZiAvLyBIQVNfVEVYVFVSRVxuIisKIiAgICBcbiIrCiIjaWZkZWYgSEFTX0ZPR1xuIisKIiAgICAvLyB1Rm9nUGFybXMgZWxlbWVudHM6IHggPSBuZWFyLCB5ID0gZmFyLCB6ID0gZm9nc2NhbGUsIHcgPSAoMS1zaW4oRk9WLzIpKS8oMStzaW4oRk9WLzIpKVxuIisKIiAgICAvLyBJbiBFeHAgYW5kIEV4cDI6IHVzZSBkZW5zaXR5ID0gZGVuc2l0eS9mYXJcbiIrCiIgICAgLy8gZm9nRiB3aWxsIGJlIHRoZSBwcm9wb3J0aW9uIG9mIGZvZ1xuIisKIiAgICAvLyBJbml0aWFsaXplIGl0IHRvIHRoZSBsaW5lYXIgdmFsdWVcbiIrCiIgICAgZmxvYXQgZm9nRjtcbiIrCiIgICAgaWYgKHVGb2dNb2RlID4gMCkge1xuIisKIiAgICAgIGZvZ0YgPSAodUZvZ1Bhcm1zLnkgLSB2UG9zaXRpb24uei92UG9zaXRpb24udykvKHVGb2dQYXJtcy55IC0gdUZvZ1Bhcm1zLngpO1xuIisKIiAgICAgIGlmICh1Rm9nTW9kZSA+IDEpXG4iKwoiICAgICAgICBmb2dGID0gbWl4KHVGb2dQYXJtcy53LCAxLjAsIGZvZ0YpO1xuIisKIiAgICAgIGZvZ0YgPSBmb2dGKnVGb2dQYXJtcy56O1xuIisKIiAgICAgIGlmICh1Rm9nTW9kZSA9PSAyKVxuIisKIiAgICAgICAgZm9nRiA9IDEuMCAtIGV4cCgtZm9nRik7XG4iKwoiICAgICAgLy8gRG9jcyBhcmUgd3Jvbmc6IHVzZSAoZGVuc2l0eSpjKV4yLCBub3QgZGVuc2l0eSpjXjJcbiIrCiIgICAgICAvLyBodHRwczovL2dpdGxhYi5mcmVlZGVza3RvcC5vcmcvbWVzYS9tZXNhLy0vYmxvYi9tYXN0ZXIvc3JjL21lc2Evc3dyYXN0L3NfZm9nLmMjTDU4XG4iKwoiICAgICAgZWxzZSBpZiAodUZvZ01vZGUgPT0gMylcbiIrCiIgICAgICAgIGZvZ0YgPSAxLjAgLSBleHAoLWZvZ0YqZm9nRik7XG4iKwoiICAgICAgZm9nRiA9IGNsYW1wKGZvZ0YsIDAuMCwgMS4wKTtcbiIrCiIgICAgICBnbF9GcmFnQ29sb3IgPSB2ZWM0KG1peChmcmFnQ29sb3IucmdiLCB1Rm9nQ29sb3IsIGZvZ0YpLCBmcmFnQ29sb3IuYSk7XG4iKwoiICAgIH0gZWxzZSBnbF9GcmFnQ29sb3IgPSBmcmFnQ29sb3I7XG4iKwoiI2Vsc2VcbiIrCiIgICAgZ2xfRnJhZ0NvbG9yID0gZnJhZ0NvbG9yO1xuIisKIiNlbmRpZiAvLyBIQVNfRk9HXG4iKwoiICAgIFxuIisKIn1cbiIgO307Cg=="></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,ICAgIC8qKgogICAgICogTWV0aG9kcyByZWxhdGVkIHRvIHRleHR1cmVzCiAgICAgKiBAbmFtZSBfX19NRVRIT0RTX0ZPUl9URVhUVVJFU19fXwogICAgICogQG1lbWJlcm9mIHJnbHdpZGdldENsYXNzCiAgICAgKiBAa2luZCBmdW5jdGlvbgogICAgICogQGluc3RhbmNlCiAgICAgKi8KICAgICAKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5nZXRUZXhGaWx0ZXIgPSBmdW5jdGlvbihmaWx0ZXIpIHsKICAgICAgdmFyIGdsID0gdGhpcy5nbCB8fCB0aGlzLmluaXRHTCgpOwogICAgICBzd2l0Y2goZmlsdGVyKSB7CiAgICAgICAgY2FzZSAibmVhcmVzdCI6IHJldHVybiBnbC5ORUFSRVNUOwogICAgICAgIGNhc2UgImxpbmVhciI6IHJldHVybiBnbC5MSU5FQVI7CiAgICAgICAgY2FzZSAibmVhcmVzdC5taXBtYXAubmVhcmVzdCI6IHJldHVybiBnbC5ORUFSRVNUX01JUE1BUF9ORUFSRVNUOwogICAgICAgIGNhc2UgImxpbmVhci5taXBtYXAubmVhcmVzdCI6IHJldHVybiBnbC5MSU5FQVJfTUlQTUFQX05FQVJFU1Q7CiAgICAgICAgY2FzZSAibmVhcmVzdC5taXBtYXAubGluZWFyIjogcmV0dXJuIGdsLk5FQVJFU1RfTUlQTUFQX0xJTkVBUjsKICAgICAgICBjYXNlICJsaW5lYXIubWlwbWFwLmxpbmVhciI6IHJldHVybiBnbC5MSU5FQVJfTUlQTUFQX0xJTkVBUjsKICAgICAgICBkZWZhdWx0OiBjb25zb2xlLmVycm9yKCJVbmtub3duIGZpbHRlcjogIitmaWx0ZXIpOwogICAgICB9CiAgICB9OwogICAgIAogICAgLyoqCiAgICAgKiBIYW5kbGUgYSB0ZXh0dXJlIGFmdGVyIGl0cyBpbWFnZSBoYXMgYmVlbiBsb2FkZWQKICAgICAqIEBwYXJhbSB7IE9iamVjdCB9IHRleHR1cmUgLSB0aGUgZ2wgdGV4dHVyZSBvYmplY3QKICAgICAqIEBwYXJhbSB7IE9iamVjdCB9IHRleHR1cmVDYW52YXMgLSB0aGUgY2FudmFzIGhvbGRpbmcgdGhlIGltYWdlCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5oYW5kbGVMb2FkZWRUZXh0dXJlID0gZnVuY3Rpb24odGV4dHVyZSwgdGV4dHVyZUNhbnZhcykgewogICAgICB2YXIgZ2wgPSB0aGlzLmdsIHx8IHRoaXMuaW5pdEdMKCk7CiAgICAgIGdsLnBpeGVsU3RvcmVpKGdsLlVOUEFDS19GTElQX1lfV0VCR0wsIHRydWUpOwoKICAgICAgZ2wuYmluZFRleHR1cmUoZ2wuVEVYVFVSRV8yRCwgdGV4dHVyZSk7CiAgICAgIGdsLnRleEltYWdlMkQoZ2wuVEVYVFVSRV8yRCwgMCwgZ2wuUkdCQSwgZ2wuUkdCQSwgZ2wuVU5TSUdORURfQllURSwgdGV4dHVyZUNhbnZhcyk7CiAgICAgIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9NQUdfRklMVEVSLCBnbC5MSU5FQVIpOwogICAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfTUlOX0ZJTFRFUiwgZ2wuTElORUFSX01JUE1BUF9ORUFSRVNUKTsKICAgICAgZ2wuZ2VuZXJhdGVNaXBtYXAoZ2wuVEVYVFVSRV8yRCk7CgogICAgICBnbC5iaW5kVGV4dHVyZShnbC5URVhUVVJFXzJELCBudWxsKTsKICAgIH07CgogICAgLyoqCiAgICAgKiBHZXQgbWF4aW11bSBkaW1lbnNpb24gb2YgdGV4dHVyZSBpbiBjdXJyZW50IGJyb3dzZXIuCiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZ2V0TWF4VGV4U2l6ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZ2wgPSB0aGlzLmdsIHx8IHRoaXMuaW5pdEdMKCk7CQogICAgICByZXR1cm4gTWF0aC5taW4oNDA5NiwgZ2wuZ2V0UGFyYW1ldGVyKGdsLk1BWF9URVhUVVJFX1NJWkUpKTsKICAgIH07CiAgICAKICAgIC8qKgogICAgICogTG9hZCBhbiBpbWFnZSB0byBhIHRleHR1cmUKICAgICAqIEBwYXJhbSB7IHN0cmluZyB9IHVyaSAtIFRoZSBpbWFnZSBsb2NhdGlvbgogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gdGV4dHVyZSAtIHRoZSBnbCB0ZXh0dXJlIG9iamVjdAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUubG9hZEltYWdlVG9UZXh0dXJlID0gZnVuY3Rpb24odXJpLCB0ZXh0dXJlKSB7CiAgICAgIHZhciBjYW52YXMgPSB0aGlzLnRleHR1cmVDYW52YXMsCiAgICAgICAgICBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgiMmQiKSwKICAgICAgICAgIGltYWdlID0gbmV3IEltYWdlKCksCiAgICAgICAgICBzZWxmID0gdGhpczsKCiAgICAgICBpbWFnZS5vbmxvYWQgPSBmdW5jdGlvbigpIHsKCiAgICAgICAgIHZhciB3ID0gaW1hZ2Uud2lkdGgsCiAgICAgICAgICAgICBoID0gaW1hZ2UuaGVpZ2h0LAogICAgICAgICAgICAgY2FudmFzWCA9IHNlbGYuZ2V0UG93ZXJPZlR3byh3KSwKICAgICAgICAgICAgIGNhbnZhc1kgPSBzZWxmLmdldFBvd2VyT2ZUd28oaCksCiAgICAgICAgICAgICBtYXhUZXhTaXplID0gc2VsZi5nZXRNYXhUZXhTaXplKCk7CiAgICAgICAgIHdoaWxlIChjYW52YXNYID4gMSAmJiBjYW52YXNZID4gMSAmJiAoY2FudmFzWCA+IG1heFRleFNpemUgfHwgY2FudmFzWSA+IG1heFRleFNpemUpKSB7CiAgICAgICAgICAgY2FudmFzWCAvPSAyOwogICAgICAgICAgIGNhbnZhc1kgLz0gMjsKICAgICAgICAgfQogICAgICAgICBjYW52YXMud2lkdGggPSBjYW52YXNYOwogICAgICAgICBjYW52YXMuaGVpZ2h0ID0gY2FudmFzWTsKICAgICAgICAgY3R4LmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IHRydWU7CiAgICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1hZ2UsIDAsIDAsIGNhbnZhc1gsIGNhbnZhc1kpOwogICAgICAgICBzZWxmLmhhbmRsZUxvYWRlZFRleHR1cmUodGV4dHVyZSwgY2FudmFzKTsKICAgICAgICAgc2VsZi50ZXh0dXJlc0xvYWRpbmcgLT0gMTsKICAgICAgICAgaWYgKCFzZWxmLnRleHR1cmVzTG9hZGluZykKICAgICAgICAgICBzZWxmLmRyYXdTY2VuZSgpOwogICAgICAgfTsKICAgICAgIGlmICghc2VsZi50ZXh0dXJlc0xvYWRpbmcpCiAgICAgICAgIHNlbGYudGV4dHVyZXNMb2FkaW5nID0gMDsgLy8gbWF5IGhhdmUgYmVlbiB1bmRlZmluZWQKICAgICAgIHNlbGYudGV4dHVyZXNMb2FkaW5nICs9IDE7CiAgICAgICBpbWFnZS5zcmMgPSB1cmk7CiAgICAgfTsKCiAgICAvKioKICAgICAqIERyYXcgdGV4dCB0byB0aGUgdGV4dHVyZSBjYW52YXMKICAgICAqIEByZXR1cm5zIHsgT2JqZWN0IH0gb2JqZWN0IHdpdGggdGV4dCBtZWFzdXJlbWVudHMKICAgICAqIEBwYXJhbSB7IHN0cmluZyB9IHRleHQgLSB0aGUgdGV4dAogICAgICogQHBhcmFtIHsgbnVtYmVyIH0gY2V4IC0gZXhwYW5zaW9uCiAgICAgKiBAcGFyYW0geyBzdHJpbmcgfSBmYW1pbHkgLSBmb250IGZhbWlseQogICAgICogQHBhcmFtIHsgbnVtYmVyIH0gZm9udCAtIGZvbnQgbnVtYmVyCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5kcmF3VGV4dFRvQ2FudmFzID0gZnVuY3Rpb24odGV4dCwgY2V4LCBmYW1pbHksIGZvbnQpIHsKICAgICAgIHZhciBjYW52YXNYLCBjYW52YXNZLAogICAgICAgICAgIHNjYWxpbmcgPSAyMCwKICAgICAgICAgICB0ZXh0Q29sb3VyID0gIndoaXRlIiwKCiAgICAgICAgICAgYmFja2dyb3VuZENvbG91ciA9ICJyZ2JhKDAsMCwwLDApIiwKICAgICAgICAgICBjYW52YXMgPSB0aGlzLnRleHR1cmVDYW52YXMsCiAgICAgICAgICAgY3R4ID0gY2FudmFzLmdldENvbnRleHQoIjJkIiksCiAgICAgICAgICAgaSwgdGV4dEhlaWdodCA9IDAsIHRleHRIZWlnaHRzID0gW10sIHdpZHRoLCB3aWR0aHMgPSBbXSwgCiAgICAgICAgICAgb2Zmc2V0eCwgb2Zmc2V0eSA9IDAsIGxpbmUsIGxpbmVzID0gW10sIG9mZnNldHN4ID0gW10sCiAgICAgICAgICAgb2Zmc2V0c3kgPSBbXSwgbGluZW9mZnNldHN5ID0gW10sIGZvbnRTdHJpbmdzID0gW10sCiAgICAgICAgICAgbWF4VGV4U2l6ZSA9IHRoaXMuZ2V0TWF4VGV4U2l6ZSgpLAogICAgICAgICAgIGdldEZvbnRTdHJpbmcgPSBmdW5jdGlvbihpKSB7CiAgICAgICAgICAgICB0ZXh0SGVpZ2h0c1tpXSA9IHNjYWxpbmcqY2V4W2ldOwogICAgICAgICAgICAgdmFyIGZvbnRTdHJpbmcgPSB0ZXh0SGVpZ2h0c1tpXSArICJweCIsCiAgICAgICAgICAgICAgICAgZmFtaWx5MCA9IGZhbWlseVtpXSwKICAgICAgICAgICAgICAgICBmb250MCA9IGZvbnRbaV07CiAgICAgICAgICAgICBpZiAoZmFtaWx5MCA9PT0gInNhbnMiKQogICAgICAgICAgICAgICBmYW1pbHkwID0gInNhbnMtc2VyaWYiOwogICAgICAgICAgICAgZWxzZSBpZiAoZmFtaWx5MCA9PT0gIm1vbm8iKQogICAgICAgICAgICAgICBmYW1pbHkwID0gIm1vbm9zcGFjZSI7CiAgICAgICAgICAgICBmb250U3RyaW5nID0gZm9udFN0cmluZyArICIgIiArIGZhbWlseTA7CiAgICAgICAgICAgICBpZiAoZm9udDAgPT09IDIgfHwgZm9udDAgPT09IDQpCiAgICAgICAgICAgICAgIGZvbnRTdHJpbmcgPSAiYm9sZCAiICsgZm9udFN0cmluZzsKICAgICAgICAgICAgIGlmIChmb250MCA9PT0gMyB8fCBmb250MCA9PT0gNCkKICAgICAgICAgICAgICAgZm9udFN0cmluZyA9ICJpdGFsaWMgIiArIGZvbnRTdHJpbmc7CiAgICAgICAgICAgICByZXR1cm4gZm9udFN0cmluZzsKICAgICAgICAgICB9OwogICAgICAgY2V4ID0gcmdsd2lkZ2V0Q2xhc3MucmVwZWF0VG9MZW4oY2V4LCB0ZXh0Lmxlbmd0aCk7CiAgICAgICBmYW1pbHkgPSByZ2x3aWRnZXRDbGFzcy5yZXBlYXRUb0xlbihmYW1pbHksIHRleHQubGVuZ3RoKTsKICAgICAgIGZvbnQgPSByZ2x3aWRnZXRDbGFzcy5yZXBlYXRUb0xlbihmb250LCB0ZXh0Lmxlbmd0aCk7CgogICAgICAgY2FudmFzWCA9IDE7CiAgICAgICBsaW5lID0gLTE7CiAgICAgICBvZmZzZXR4ID0gbWF4VGV4U2l6ZTsKICAgICAgIGZvciAoaSA9IDA7IGkgPCB0ZXh0Lmxlbmd0aDsgaSsrKSAgewogICAgICAgICBjdHguZm9udCA9IGZvbnRTdHJpbmdzW2ldID0gZ2V0Rm9udFN0cmluZyhpKTsKICAgICAgICAgd2lkdGggPSB3aWR0aHNbaV0gPSBjdHgubWVhc3VyZVRleHQodGV4dFtpXSkud2lkdGg7CiAgICAgICAgIGlmIChvZmZzZXR4ICsgd2lkdGggPiBtYXhUZXhTaXplKSB7CiAgICAgICAgICAgb2Zmc2V0eSA9IG9mZnNldHkgKyAyKnRleHRIZWlnaHQ7CiAgICAgICAgICAgaWYgKGxpbmUgPj0gMCkKICAgICAgICAgICAgIGxpbmVvZmZzZXRzeVtsaW5lXSA9IG9mZnNldHk7CiAgICAgICAgICAgbGluZSArPSAxOwogICAgICAgICAgIGlmIChvZmZzZXR5ID4gbWF4VGV4U2l6ZSkKICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIlRvbyBtYW55IHN0cmluZ3MgZm9yIHRleHR1cmUuIik7CiAgICAgICAgICAgdGV4dEhlaWdodCA9IDA7CiAgICAgICAgICAgb2Zmc2V0eCA9IDA7CiAgICAgICAgIH0KICAgICAgICAgdGV4dEhlaWdodCA9IE1hdGgubWF4KHRleHRIZWlnaHQsIHRleHRIZWlnaHRzW2ldKTsKICAgICAgICAgb2Zmc2V0c3hbaV0gPSBvZmZzZXR4OwogICAgICAgICBvZmZzZXR4ICs9IHdpZHRoOwogICAgICAgICBjYW52YXNYID0gTWF0aC5tYXgoY2FudmFzWCwgb2Zmc2V0eCk7CiAgICAgICAgIGxpbmVzW2ldID0gbGluZTsKICAgICAgIH0KICAgICAgIG9mZnNldHkgPSBsaW5lb2Zmc2V0c3lbbGluZV0gPSBvZmZzZXR5ICsgMip0ZXh0SGVpZ2h0OwogICAgICAgZm9yIChpID0gMDsgaSA8IHRleHQubGVuZ3RoOyBpKyspIHsKICAgICAgIAkgb2Zmc2V0c3lbaV0gPSBsaW5lb2Zmc2V0c3lbbGluZXNbaV1dOwogICAgICAgfQogICAgICAgCiAgICAgICBjYW52YXNYID0gdGhpcy5nZXRQb3dlck9mVHdvKGNhbnZhc1gpOwogICAgICAgY2FudmFzWSA9IHRoaXMuZ2V0UG93ZXJPZlR3byhvZmZzZXR5KTsKCiAgICAgICBjYW52YXMud2lkdGggPSBjYW52YXNYOwogICAgICAgY2FudmFzLmhlaWdodCA9IGNhbnZhc1k7CgogICAgICAgY3R4LmZpbGxTdHlsZSA9IGJhY2tncm91bmRDb2xvdXI7CiAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgY3R4LmNhbnZhcy53aWR0aCwgY3R4LmNhbnZhcy5oZWlnaHQpOwoKICAgICAgIGN0eC50ZXh0QmFzZWxpbmUgPSAiYWxwaGFiZXRpYyI7CiAgICAgICBmb3IoaSA9IDA7IGkgPCB0ZXh0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgIGN0eC5mb250ID0gZm9udFN0cmluZ3NbaV07CiAgICAgICAgIGN0eC5maWxsU3R5bGUgPSB0ZXh0Q29sb3VyOwogICAgICAgICBjdHgudGV4dEFsaWduID0gImxlZnQiOwogICAgICAgICBjdHguZmlsbFRleHQodGV4dFtpXSwgb2Zmc2V0c3hbaV0sICBvZmZzZXRzeVtpXSk7CiAgICAgICB9CiAgICAgICByZXR1cm4ge2NhbnZhc1g6Y2FudmFzWCwgY2FudmFzWTpjYW52YXNZLAogICAgICAgICAgICAgICB3aWR0aHM6d2lkdGhzLCB0ZXh0SGVpZ2h0czp0ZXh0SGVpZ2h0cywKICAgICAgICAgICAgICAgb2Zmc2V0c3g6b2Zmc2V0c3gsIG9mZnNldHN5Om9mZnNldHN5fTsKICAgICB9OwoK"></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,ICAgIC8qKgogICAgICogTWV0aG9kcyByZWxhdGVkIHRvIHByb2plY3Rpb25zCiAgICAgKiBAbmFtZSBfX19NRVRIT0RTX0ZPUl9QUk9KRUNUSU9OU19fXwogICAgICogQG1lbWJlcm9mIHJnbHdpZGdldENsYXNzCiAgICAgKiBAa2luZCBmdW5jdGlvbgogICAgICogQGluc3RhbmNlCiAgICAgKi8KICAgICAKICAgIC8qKgogICAgICogR2V0IHRoZSB2aWV3cG9ydAogICAgICovCiAgICAgCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZ2V0Vmlld3BvcnQgPSBmdW5jdGlvbihpZCkgewogICAgICB2YXIgdnAgPSB0aGlzLmdldE9iaihpZCkucGFyM2Qudmlld3BvcnQsCiAgICAgICAgIHggPSB2cC54KnRoaXMuY2FudmFzLndpZHRoLAogICAgICAgICB5ID0gdnAueSp0aGlzLmNhbnZhcy5oZWlnaHQsCiAgICAgICAgIHdpZHRoID0gdnAud2lkdGgqdGhpcy5jYW52YXMud2lkdGgsCiAgICAgICAgIGhlaWdodCA9IHZwLmhlaWdodCp0aGlzLmNhbnZhcy5oZWlnaHQ7CiAgICAgICB0aGlzLnZwID0ge3g6eCwgeTp5LCB3aWR0aDp3aWR0aCwgaGVpZ2h0OmhlaWdodH07CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2wgdmlld3BvcnQgYW5kIHNjaXNzb3IgdGVzdAogICAgICogQHBhcmFtIHsgbnVtYmVyIH0gaWQgLSBpZCBvZiBzdWJzY2VuZQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuc2V0Vmlld3BvcnQgPSBmdW5jdGlvbihpZCkgewogICAgICAgdmFyIGdsID0gdGhpcy5nbCB8fCB0aGlzLmluaXRHTCgpOwogICAgICAgdGhpcy5nZXRWaWV3cG9ydChpZCk7CiAgICAgICBnbC52aWV3cG9ydCh0aGlzLnZwLngsIHRoaXMudnAueSwgdGhpcy52cC53aWR0aCwgdGhpcy52cC5oZWlnaHQpOwogICAgICAgZ2wuc2Npc3Nvcih0aGlzLnZwLngsIHRoaXMudnAueSwgdGhpcy52cC53aWR0aCwgdGhpcy52cC5oZWlnaHQpOwogICAgICAgZ2wuZW5hYmxlKGdsLlNDSVNTT1JfVEVTVCk7CiAgICAgfTsKCiAgICAvKioKICAgICAqIFNldCB0aGUgcHJvamVjdGlvbiBtYXRyaXggZm9yIGEgc3Vic2NlbmUKICAgICAqIEBwYXJhbSB7IG51bWJlciB9IGlkIC0gaWQgb2Ygc3Vic2NlbmUKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLnNldHByTWF0cml4ID0gZnVuY3Rpb24oaWQpIHsKICAgICAgIHZhciBzdWJzY2VuZSA9IHRoaXMuZ2V0T2JqKGlkKSwKICAgICAgICAgIGVtYmVkZGluZyA9IHN1YnNjZW5lLmVtYmVkZGluZ3MucHJvamVjdGlvbjsKICAgICAgIGlmIChlbWJlZGRpbmcgPT09ICJyZXBsYWNlIikKICAgICAgICAgdGhpcy5wck1hdHJpeC5tYWtlSWRlbnRpdHkoKTsKICAgICAgIGVsc2UKICAgICAgICAgdGhpcy5zZXRwck1hdHJpeChzdWJzY2VuZS5wYXJlbnQpOwogICAgICAgaWYgKGVtYmVkZGluZyA9PT0gImluaGVyaXQiKQogICAgICAgICByZXR1cm47CiAgICAgICAvLyBUaGlzIGlzIGJhc2VkIG9uIHRoZSBGcnVzdHVtOjplbmNsb3NlIGNvZGUgZnJvbSBnZW9tLmNwcAogICAgICAgdmFyIGJib3ggPSBzdWJzY2VuZS5wYXIzZC5iYm94LAogICAgICAgICAgIHNjYWxlID0gc3Vic2NlbmUucGFyM2Quc2NhbGUsCiAgICAgICAgICAgcmFuZ2VzID0gWyhiYm94WzFdLWJib3hbMF0pKnNjYWxlWzBdLzIsCiAgICAgICAgICAgICAgICAgICAgIChiYm94WzNdLWJib3hbMl0pKnNjYWxlWzFdLzIsCiAgICAgICAgICAgICAgICAgICAgIChiYm94WzVdLWJib3hbNF0pKnNjYWxlWzJdLzJdLAogICAgICAgICAgIHJhZGl1cyA9IE1hdGguc3FydCh0aGlzLnN1bXNxKHJhbmdlcykpKjEuMTsgLy8gQSBiaXQgYmlnZ2VyIHRvIGhhbmRsZSBsYWJlbHMKICAgICAgIGlmIChyYWRpdXMgPD0gMCkgcmFkaXVzID0gMTsKICAgICAgIHZhciBvYnNlcnZlciA9IHN1YnNjZW5lLnBhcjNkLm9ic2VydmVyLAogICAgICAgICAgIGRpc3RhbmNlID0gb2JzZXJ2ZXJbMl0sCiAgICAgICAgICAgRk9WID0gc3Vic2NlbmUucGFyM2QuRk9WLCBvcnRobyA9IEZPViA9PT0gMCwKICAgICAgICAgICB0ID0gb3J0aG8gPyAxIDogTWF0aC50YW4oRk9WKk1hdGguUEkvMzYwKSwKICAgICAgICAgICBuZWFyID0gZGlzdGFuY2UgLSByYWRpdXMsCiAgICAgICAgICAgZmFyID0gZGlzdGFuY2UgKyByYWRpdXMsCiAgICAgICAgICAgaGxlbiwKICAgICAgICAgICBhc3BlY3QgPSB0aGlzLnZwLndpZHRoL3RoaXMudnAuaGVpZ2h0LAogICAgICAgICAgIHogPSBzdWJzY2VuZS5wYXIzZC56b29tLAogICAgICAgICAgIHVzZXJQcm9qZWN0aW9uID0gc3Vic2NlbmUucGFyM2QudXNlclByb2plY3Rpb247CiAgICAgICBpZiAoZmFyIDwgMC4wKQogICAgICAgICBmYXIgPSAxLjA7CiAgICAgICBpZiAobmVhciA8IGZhci8xMDAuMCkKICAgICAgICAgbmVhciA9IGZhci8xMDAuMDsKICAgICAgIHRoaXMuZnJ1c3R1bSA9IHtuZWFyOm5lYXIsIGZhcjpmYXJ9OwogICAgICAgaGxlbiA9IHQqbmVhcjsKICAgICAgIGlmIChvcnRobykgewogICAgICAgICBpZiAoYXNwZWN0ID4gMSkKICAgICAgICAgICB0aGlzLnByTWF0cml4Lm9ydGhvKC1obGVuKmFzcGVjdCp6LCBobGVuKmFzcGVjdCp6LAogICAgICAgICAgICAgICAgICAgICAgICAgIC1obGVuKnosIGhsZW4qeiwgbmVhciwgZmFyKTsKICAgICAgICAgZWxzZQogICAgICAgICAgIHRoaXMucHJNYXRyaXgub3J0aG8oLWhsZW4qeiwgaGxlbip6LAogICAgICAgICAgICAgICAgICAgICAgICAgIC1obGVuKnovYXNwZWN0LCBobGVuKnovYXNwZWN0LAogICAgICAgICAgICAgICAgICAgICAgICAgIG5lYXIsIGZhcik7CiAgICAgICB9IGVsc2UgewogICAgICAgICBpZiAoYXNwZWN0ID4gMSkKICAgICAgICAgICB0aGlzLnByTWF0cml4LmZydXN0dW0oLWhsZW4qYXNwZWN0KnosIGhsZW4qYXNwZWN0KnosCiAgICAgICAgICAgICAgICAgICAgICAgICAgLWhsZW4qeiwgaGxlbip6LCBuZWFyLCBmYXIpOwogICAgICAgICBlbHNlCiAgICAgICAgICAgdGhpcy5wck1hdHJpeC5mcnVzdHVtKC1obGVuKnosIGhsZW4qeiwKICAgICAgICAgICAgICAgICAgICAgICAgICAtaGxlbip6L2FzcGVjdCwgaGxlbip6L2FzcGVjdCwKICAgICAgICAgICAgICAgICAgICAgICAgICBuZWFyLCBmYXIpOwogICAgICAgfQogICAgICAgdGhpcy5wck1hdHJpeC5tdWx0UmlnaHQodXNlclByb2plY3Rpb24pOwogICAgIH07CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIG1vZGVsLXZpZXcgbWF0cml4IGZvciBhIHN1YnNjZW5lCiAgICAgKiBAcGFyYW0geyBudW1iZXIgfSBpZCAtIGlkIG9mIHRoZSBzdWJzY2VuZQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuc2V0bXZNYXRyaXggPSBmdW5jdGlvbihpZCkgewogICAgICAgdmFyIG9ic2VydmVyID0gdGhpcy5nZXRPYmooaWQpLnBhcjNkLm9ic2VydmVyOwogICAgICAgdGhpcy5tdk1hdHJpeC5tYWtlSWRlbnRpdHkoKTsKICAgICAgIHRoaXMuc2V0bW9kZWxNYXRyaXgoaWQpOwogICAgICAgdGhpcy5tdk1hdHJpeC50cmFuc2xhdGUoLW9ic2VydmVyWzBdLCAtb2JzZXJ2ZXJbMV0sIC1vYnNlcnZlclsyXSk7CgogICAgIH07CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIG1vZGVsIG1hdHJpeCBmb3IgYSBzdWJzY2VuZQogICAgICogQHBhcmFtIHsgbnVtYmVyIH0gaWQgLSBpZCBvZiB0aGUgc3Vic2NlbmUKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLnNldG1vZGVsTWF0cml4ID0gZnVuY3Rpb24oaWQpIHsKICAgICAgdmFyIHN1YnNjZW5lID0gdGhpcy5nZXRPYmooaWQpLAogICAgICAgICAgZW1iZWRkaW5nID0gc3Vic2NlbmUuZW1iZWRkaW5ncy5tb2RlbDsKICAgICAgaWYgKGVtYmVkZGluZyA9PT0gInJlcGxhY2UiKSB7CiAgICAgICAgdmFyIGJib3ggPSBzdWJzY2VuZS5wYXIzZC5iYm94LAogICAgICAgICAgICBjZW50ZXIgPSBbKGJib3hbMF0rYmJveFsxXSkvMiwKICAgICAgICAgICAgICAgICAgICAgIChiYm94WzJdK2Jib3hbM10pLzIsCiAgICAgICAgICAgICAgICAgICAgICAoYmJveFs0XStiYm94WzVdKS8yXTsKICAgICAgICB0aGlzLm12TWF0cml4LnRyYW5zbGF0ZSgtY2VudGVyWzBdLCAtY2VudGVyWzFdLCAtY2VudGVyWzJdKTsKICAgICAgfQogICAgICBpZiAoZW1iZWRkaW5nICE9PSAiaW5oZXJpdCIpIHsKICAgICAgICB2YXIgc2NhbGUgPSBzdWJzY2VuZS5wYXIzZC5zY2FsZTsKICAgICAgICB0aGlzLm12TWF0cml4LnNjYWxlKHNjYWxlWzBdLCBzY2FsZVsxXSwgc2NhbGVbMl0pOwogICAgICAgIHRoaXMubXZNYXRyaXgubXVsdFJpZ2h0KCBzdWJzY2VuZS5wYXIzZC51c2VyTWF0cml4ICk7CiAgICAgIH0KICAgICAgaWYgKGVtYmVkZGluZyAhPT0gInJlcGxhY2UiKQogICAgICAgIHRoaXMuc2V0bW9kZWxNYXRyaXgoc3Vic2NlbmUucGFyZW50KTsKICAgICB9OwoKICAgIC8qKgogICAgICogU2V0IHRoZSBub3JtYWxzIG1hdHJpeCBmb3IgYSBzdWJzY2VuZQogICAgICogQHBhcmFtIHsgbnVtYmVyIH0gc3Vic2NlbmVpZCAtIGlkIG9mIHRoZSBzdWJzY2VuZQogICAgICovCiAgICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLnNldG5vcm1NYXRyaXgyID0gZnVuY3Rpb24oKSB7CiAgICAgICB0aGlzLm5vcm1NYXRyaXggPSBuZXcgQ2FudmFzTWF0cml4NCh0aGlzLm12TWF0cml4KTsKICAgICAgIHRoaXMubm9ybU1hdHJpeC5pbnZlcnQoKTsKICAgICAgIHRoaXMubm9ybU1hdHJpeC50cmFuc3Bvc2UoKTsKICAgICB9OwoKICAgIC8qKgogICAgICogU2V0IHRoZSBjb21iaW5lZCBwcm9qZWN0aW9uLW1vZGVsLXZpZXcgbWF0cml4CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5zZXRwcm12TWF0cml4ID0gZnVuY3Rpb24oKSB7CiAgICAgICB0aGlzLnBybXZNYXRyaXggPSBuZXcgQ2FudmFzTWF0cml4NCggdGhpcy5tdk1hdHJpeCApOwogICAgICAgdGhpcy5wcm12TWF0cml4Lm11bHRSaWdodCggdGhpcy5wck1hdHJpeCApOwogICAgIH07CgogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLnNldEludlByTWF0cml4ID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuaW52UHJNYXRyaXggPSBuZXcgQ2FudmFzTWF0cml4NCggdGhpcy5wck1hdHJpeCApOwogICAgICB0aGlzLmludlByTWF0cml4LmludmVydCgpOwogICAgICB0aGlzLmludlByTWF0cml4LnRyYW5zcG9zZSgpOwogICAgfTsK"></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,ICAgIC8qKgogICAgICogTWV0aG9kcyByZWxhdGVkIHRvIG1vdXNlIGhhbmRsaW5nCiAgICAgKiBAbmFtZSBfX19NRVRIT0RTX0ZPUl9NT1VTRV9IQU5ETElOR19fXwogICAgICogQG1lbWJlcm9mIHJnbHdpZGdldENsYXNzCiAgICAgKiBAa2luZCBmdW5jdGlvbgogICAgICogQGluc3RhbmNlCiAgICAgKi8KICAgICAKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5nZXRDdXJzb3IgPSBmdW5jdGlvbihtb2RlKSB7CiAgICAgIHN3aXRjaChtb2RlKSB7CiAgICAgICAgY2FzZSAibm9uZSI6IAogICAgICAgICAgcmV0dXJuICJub25lIjsKICAgICAgICBjYXNlICJ0cmFja2JhbGwiOgogICAgICAgIGNhc2UgInhBeGlzIjoKICAgICAgICBjYXNlICJ5QXhpcyI6CiAgICAgICAgY2FzZSAiekF4aXMiOgogICAgICAgIGNhc2UgInBvbGFyIjoKICAgICAgICAgIHJldHVybiAiZ3JhYiI7CiAgICAgICAgY2FzZSAic2VsZWN0aW5nIjoKICAgICAgICAgIHJldHVybiAiY3Jvc3NoYWlyIjsKICAgICAgICBjYXNlICJmb3YiOgogICAgICAgIGNhc2UgInpvb20iOgogICAgICAgICAgcmV0dXJuICJ6b29tLWluIjsKICAgICAgICBjYXNlICJ1c2VyIjoKICAgICAgICAgIHJldHVybiAiZGVmYXVsdCI7CiAgICAgIH0KICAgICAgcmV0dXJuICJkcmFnZ2luZyI7CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIFNldCBtb3VzZSBtb2RlIGZvciBhIHN1YnNjZW5lCiAgICAgKiBAcGFyYW0geyBzdHJpbmcgfSBtb2RlIC0gbmFtZSBvZiBtb2RlCiAgICAgKiBAcGFyYW0geyBudW1iZXIgfSBidXR0b24gLSBidXR0b24gbnVtYmVyICgwIHRvIDQpCiAgICAgKiBAcGFyYW0geyBudW1iZXIgfSBzdWJzY2VuZSAtIHN1YnNjZW5lIGlkIG51bWJlcgogICAgICogQHBhcmFtIHsgbnVtYmVyIH0gc3RheUFjdGl2ZSAtIGlmIHRydXRoeSwgZG9uJ3QgY2xlYXIgYnJ1c2gKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLnNldE1vdXNlTW9kZSA9IGZ1bmN0aW9uKG1vZGUsIGJ1dHRvbiwgc3Vic2NlbmUsIHN0YXlBY3RpdmUpIHsKICAgICAgdmFyIHN1YiA9IHRoaXMuZ2V0T2JqKHN1YnNjZW5lKSwKICAgICAgICAgIHdoaWNoID0gWyJub25lIiwgImxlZnQiLCAicmlnaHQiLCAibWlkZGxlIiwgIndoZWVsIl1bYnV0dG9uXTsKICAgICAgaWYgKCFzdGF5QWN0aXZlICYmIHN1Yi5wYXIzZC5tb3VzZU1vZGVbd2hpY2hdID09PSAic2VsZWN0aW5nIikKICAgICAgICB0aGlzLmNsZWFyQnJ1c2gobnVsbCk7CiAgICAgIHN1Yi5wYXIzZC5tb3VzZU1vZGVbd2hpY2hdID0gbW9kZTsKICAgICAgaWYgKGJ1dHRvbiA9PT0gMSB8fCAoYnV0dG9uID09PSAwICYmIG1vZGUgIT09ICJub25lIikpCiAgICAgICAgdGhpcy5jYW52YXMuc3R5bGUuY3Vyc29yID0gdGhpcy5nZXRDdXJzb3IobW9kZSk7CiAgICAgIGlmIChidXR0b24gPT09IDAgJiYgbW9kZSAhPT0gIm5vbmUiKQogICAgICAgIHN1Yi5uZWVkc0JlZ2luID0gbW9kZTsKICAgIH07CgogICAgLyoqCiAgICAgKiBDb21wdXRlIG1vdXNlIGNvb3JkaW5hdGVzIHJlbGF0aXZlIHRvIGN1cnJlbnQgY2FudmFzCiAgICAgKiBAcmV0dXJucyB7IE9iamVjdCB9CiAgICAgKiBAcGFyYW0geyBPYmplY3QgfSBldmVudCAtIGV2ZW50IG9iamVjdCBmcm9tIG1vdXNlIGNsaWNrCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5yZWxNb3VzZUNvb3JkcyA9IGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgIHZhciByZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIHJldHVybiB7eDpldmVudC5jbGllbnRYLXJlY3QubGVmdCwgeTpldmVudC5jbGllbnRZLXJlY3QudG9wfTsKICAgIH07CiAgICAKICAgIC8qKgogICAgICogU2VuZCBtb3VzZSBzZWxlY3Rpb24gdG8gU2hpbnkKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLnJlY29yZFNlbGVjdGlvbiA9IGZ1bmN0aW9uKHN1YmlkKSB7CiAgICAgIHZhciByZXN1bHQgPSB7fTsKICAgICAgaWYgKHR5cGVvZiB0aGlzLnNlbGVjdCAhPT0gInVuZGVmaW5lZCIgJiYgCiAgICAgICAgICB0eXBlb2YgdGhpcy5zZWxlY3Quc3RhdGUgIT09ICJ1bmRlZmluZWQiICYmCiAgICAgICAgICB0aGlzLnNlbGVjdC5zdGF0ZSAhPT0gImluYWN0aXZlIikgewogICAgICAgIHJlc3VsdCA9IHsgc3Vic2NlbmU6IHN1YmlkLAogICAgICAgICAgICAgICAgICAgc3RhdGU6IHRoaXMuc2VsZWN0LnN0YXRlLAogICAgICAgICAgICAgICAgICAgcmVnaW9uOiB0aGlzLnNlbGVjdC5yZWdpb24KICAgICAgICAgICAgICAgICB9OwogICAgICAgIHRoaXMuc2V0bXZNYXRyaXgoc3ViaWQpOwogICAgICAgIHJlc3VsdC5tb2RlbCA9IHRoaXMubXZNYXRyaXg7CiAgICAgICAgdGhpcy5zZXRwck1hdHJpeChzdWJpZCk7CiAgICAgICAgcmVzdWx0LnByb2ogPSB0aGlzLnByTWF0cml4OwogICAgICAgIHRoaXMuZ2V0Vmlld3BvcnQoc3ViaWQpOwogICAgICAgIHJlc3VsdC52aWV3ID0gdGhpcy52cDsKICAgICAgfSBlbHNlCiAgICAgICAgcmVzdWx0LnN0YXRlID0gImluYWN0aXZlIjsKICAgICAgU2hpbnkuc2V0SW5wdXRWYWx1ZSh0aGlzLnNjZW5lLnNlbGVjdGlvbklucHV0ICsgIjpzaGlueU1vdXNlM2QiLCByZXN1bHQpOwogICAgfTsgCgogICAgLyoqCiAgICAgKiBTZXQgbW91c2UgaGFuZGxlcnMgZm9yIHRoZSBzY2VuZQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuc2V0TW91c2VIYW5kbGVycyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIGFjdGl2ZVN1YnNjZW5lLCBoYW5kbGVyLAogICAgICAgICAgaGFuZGxlcnMgPSB7fSwgZHJhZyA9IDA7CgogICAgICBoYW5kbGVycy5yb3RCYXNlID0gMDsKCiAgICAgIHNlbGYuc2NyZWVuVG9WZWN0b3IgPSBmdW5jdGlvbih4LCB5KSB7CiAgICAgICAgdmFyIHZpZXdwb3J0ID0gc2VsZi5nZXRPYmooYWN0aXZlU3Vic2NlbmUpLnBhcjNkLnZpZXdwb3J0LAogICAgICAgICAgd2lkdGggPSB2aWV3cG9ydC53aWR0aCpzZWxmLmNhbnZhcy53aWR0aCwKICAgICAgICAgIGhlaWdodCA9IHZpZXdwb3J0LmhlaWdodCpzZWxmLmNhbnZhcy5oZWlnaHQsCiAgICAgICAgICByYWRpdXMgPSBNYXRoLm1heCh3aWR0aCwgaGVpZ2h0KS8yLjAsCiAgICAgICAgICBjeCA9IHdpZHRoLzIuMCwKICAgICAgICAgIGN5ID0gaGVpZ2h0LzIuMCwKICAgICAgICAgIHB4ID0gKHgtY3gpL3JhZGl1cywKICAgICAgICAgIHB5ID0gKHktY3kpL3JhZGl1cywKICAgICAgICAgIHBsZW4gPSBNYXRoLnNxcnQocHgqcHgrcHkqcHkpOwogICAgICAgIGlmIChwbGVuID4gMS5lLTYpIHsKICAgICAgICAgIHB4ID0gcHgvcGxlbjsKICAgICAgICAgIHB5ID0gcHkvcGxlbjsKICAgICAgICB9CiAgICAgICAgdmFyIGFuZ2xlID0gKE1hdGguU1FSVDIgLSBwbGVuKS9NYXRoLlNRUlQyKk1hdGguUEkvMiwKICAgICAgICAgIHogPSBNYXRoLnNpbihhbmdsZSksCiAgICAgICAgICB6bGVuID0gTWF0aC5zcXJ0KDEuMCAtIHoqeik7CiAgICAgICAgcHggPSBweCAqIHpsZW47CiAgICAgICAgcHkgPSBweSAqIHpsZW47CiAgICAgICAgcmV0dXJuIFtweCwgcHksIHpdOwogICAgICB9OwoKICAgICAgaGFuZGxlcnMudHJhY2tiYWxsZG93biA9IGZ1bmN0aW9uKHgseSkgewogICAgICAgIHZhciBhY3RpdmVTdWIgPSBzZWxmLmdldE9iaihhY3RpdmVTdWJzY2VuZSksCiAgICAgICAgICAgIGFjdGl2ZU1vZGVsID0gc2VsZi5nZXRPYmooc2VsZi51c2VpZChhY3RpdmVTdWIuaWQsICJtb2RlbCIpKSwKICAgICAgICAgICAgaSwgbCA9IGFjdGl2ZU1vZGVsLnBhcjNkLmxpc3RlbmVyczsKICAgICAgICBoYW5kbGVycy5yb3RCYXNlID0gc2VsZi5zY3JlZW5Ub1ZlY3Rvcih4LCB5KTsKICAgICAgICBzZWxmLnNhdmVNYXQgPSBbXTsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbC5sZW5ndGg7IGkrKykgewogICAgICAgICAgYWN0aXZlU3ViID0gc2VsZi5nZXRPYmoobFtpXSk7CiAgICAgICAgICBhY3RpdmVTdWIuc2F2ZU1hdCA9IG5ldyBDYW52YXNNYXRyaXg0KGFjdGl2ZVN1Yi5wYXIzZC51c2VyTWF0cml4KTsKICAgICAgICB9CiAgICAgICAgc2VsZi5jYW52YXMuc3R5bGUuY3Vyc29yID0gImdyYWJiaW5nIjsKICAgICAgfTsKCiAgICAgIGhhbmRsZXJzLnRyYWNrYmFsbG1vdmUgPSBmdW5jdGlvbih4LHkpIHsKICAgICAgICB2YXIgcm90Q3VycmVudCA9IHNlbGYuc2NyZWVuVG9WZWN0b3IoeCx5KSwKICAgICAgICAgICAgcm90QmFzZSA9IGhhbmRsZXJzLnJvdEJhc2UsCiAgICAgICAgICAgIGRvdCA9IHJvdEJhc2VbMF0qcm90Q3VycmVudFswXSArCiAgICAgICAgICAgICAgICAgIHJvdEJhc2VbMV0qcm90Q3VycmVudFsxXSArCiAgICAgICAgICAgICAgICAgIHJvdEJhc2VbMl0qcm90Q3VycmVudFsyXSwKICAgICAgICAgICAgYW5nbGUgPSBNYXRoLmFjb3MoIGRvdC9yZ2x3aWRnZXRDbGFzcy52bGVuKHJvdEJhc2UpL3JnbHdpZGdldENsYXNzLnZsZW4ocm90Q3VycmVudCkgKSoxODAuMC9NYXRoLlBJLAogICAgICAgICAgICBheGlzID0gcmdsd2lkZ2V0Q2xhc3MueHByb2Qocm90QmFzZSwgcm90Q3VycmVudCksCiAgICAgICAgICAgIG9iamVjdHMgPSBzZWxmLnNjZW5lLm9iamVjdHMsCiAgICAgICAgICAgIGFjdGl2ZVN1YiA9IHNlbGYuZ2V0T2JqKGFjdGl2ZVN1YnNjZW5lKSwKICAgICAgICAgICAgYWN0aXZlTW9kZWwgPSBzZWxmLmdldE9iaihzZWxmLnVzZWlkKGFjdGl2ZVN1Yi5pZCwgIm1vZGVsIikpLAogICAgICAgICAgICBsID0gYWN0aXZlTW9kZWwucGFyM2QubGlzdGVuZXJzLAogICAgICAgICAgICBpOwogICAgICAgIGlmIChhbmdsZSA9PT0gMC4wKQogICAgICAgICAgcmV0dXJuOyAgICAKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbC5sZW5ndGg7IGkrKykgewogICAgICAgICAgYWN0aXZlU3ViID0gc2VsZi5nZXRPYmoobFtpXSk7CiAgICAgICAgICBhY3RpdmVTdWIucGFyM2QudXNlck1hdHJpeC5sb2FkKG9iamVjdHNbbFtpXV0uc2F2ZU1hdCk7CiAgICAgICAgICBhY3RpdmVTdWIucGFyM2QudXNlck1hdHJpeC5yb3RhdGUoYW5nbGUsIGF4aXNbMF0sIGF4aXNbMV0sIGF4aXNbMl0pOwogICAgICAgIH0KICAgICAgICBzZWxmLmRyYXdTY2VuZSgpOwogICAgICB9OwogICAgICBoYW5kbGVycy50cmFja2JhbGxlbmQgPSAwOwoKICAgICAgc2VsZi5jbGFtcCA9IGZ1bmN0aW9uKHgsIGxvLCBoaSkgewogICAgICAJcmV0dXJuIE1hdGgubWF4KGxvLCBNYXRoLm1pbih4LCBoaSkpOwogICAgICB9OwoKICAgICAgc2VsZi5zY3JlZW5Ub1BvbGFyID0gZnVuY3Rpb24oeCx5KSB7CiAgICAgICAgdmFyIHZpZXdwb3J0ID0gc2VsZi5nZXRPYmooYWN0aXZlU3Vic2NlbmUpLnBhcjNkLnZpZXdwb3J0LAogICAgICAgICAgd2lkdGggPSB2aWV3cG9ydC53aWR0aCpzZWxmLmNhbnZhcy53aWR0aCwKICAgICAgICAgIGhlaWdodCA9IHZpZXdwb3J0LmhlaWdodCpzZWxmLmNhbnZhcy5oZWlnaHQsCiAgICAJICByID0gTWF0aC5taW4od2lkdGgsIGhlaWdodCkvMiwKICAgIAkgIGR4ID0gc2VsZi5jbGFtcCh4IC0gd2lkdGgvMiwgLXIsIHIpLAogICAgCSAgZHkgPSBzZWxmLmNsYW1wKHkgLSBoZWlnaHQvMiwgLXIsIHIpOwogICAgCSAgcmV0dXJuIFtNYXRoLmFzaW4oZHgvciksIE1hdGguYXNpbigtZHkvcildOwogICAgICB9OwoKICAgICAgaGFuZGxlcnMucG9sYXJkb3duID0gZnVuY3Rpb24oeCx5KSB7CiAgICAgICAgdmFyIGFjdGl2ZVN1YiA9IHNlbGYuZ2V0T2JqKGFjdGl2ZVN1YnNjZW5lKSwKICAgICAgICAgICAgYWN0aXZlTW9kZWwgPSBzZWxmLmdldE9iaihzZWxmLnVzZWlkKGFjdGl2ZVN1Yi5pZCwgIm1vZGVsIikpLAogICAgICAgICAgICBpLCBsID0gYWN0aXZlTW9kZWwucGFyM2QubGlzdGVuZXJzOwogICAgICAgIGhhbmRsZXJzLmRyYWdCYXNlID0gc2VsZi5zY3JlZW5Ub1BvbGFyKHgsIHkpOwogICAgICAgIHNlbGYuc2F2ZU1hdCA9IFtdOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBhY3RpdmVTdWIgPSBzZWxmLmdldE9iaihsW2ldKTsKICAgICAgICAgIGFjdGl2ZVN1Yi5zYXZlTWF0ID0gbmV3IENhbnZhc01hdHJpeDQoYWN0aXZlU3ViLnBhcjNkLnVzZXJNYXRyaXgpOwogICAgICAgICAgYWN0aXZlU3ViLmNhbUJhc2UgPSBbLU1hdGguYXRhbjIoYWN0aXZlU3ViLnNhdmVNYXQubTEzLCBhY3RpdmVTdWIuc2F2ZU1hdC5tMTEpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hdGFuMihhY3RpdmVTdWIuc2F2ZU1hdC5tMzIsIGFjdGl2ZVN1Yi5zYXZlTWF0Lm0yMildOwogICAgICAgIH0KICAgICAgICBzZWxmLmNhbnZhcy5zdHlsZS5jdXJzb3IgPSAiZ3JhYmJpbmciOwogICAgICB9OwoKICAgICAgaGFuZGxlcnMucG9sYXJtb3ZlID0gZnVuY3Rpb24oeCx5KSB7CiAgICAgICAgdmFyIGRyYWdDdXJyZW50ID0gc2VsZi5zY3JlZW5Ub1BvbGFyKHgseSksCiAgICAgICAgICAgIGFjdGl2ZVN1YiA9IHNlbGYuZ2V0T2JqKGFjdGl2ZVN1YnNjZW5lKSwKICAgICAgICAgICAgYWN0aXZlTW9kZWwgPSBzZWxmLmdldE9iaihzZWxmLnVzZWlkKGFjdGl2ZVN1Yi5pZCwgIm1vZGVsIikpLAogICAgICAgICAgICBvYmplY3RzID0gc2VsZi5zY2VuZS5vYmplY3RzLAogICAgICAgICAgICBsID0gYWN0aXZlTW9kZWwucGFyM2QubGlzdGVuZXJzLAogICAgICAgICAgICBpLCBqLCBjaGFuZ2Vwb3MgPSBbXTsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbC5sZW5ndGg7IGkrKykgewogICAgICAgICAgYWN0aXZlU3ViID0gc2VsZi5nZXRPYmoobFtpXSk7CiAgICAgICAgICBmb3IgKGo9MDsgajwyOyBqKyspCiAgICAgICAgICAgIGNoYW5nZXBvc1tqXSA9IC0oZHJhZ0N1cnJlbnRbal0gLSBoYW5kbGVycy5kcmFnQmFzZVtqXSk7CiAgICAgICAgICBhY3RpdmVTdWIucGFyM2QudXNlck1hdHJpeC5tYWtlSWRlbnRpdHkoKTsKICAgICAgICAgIGFjdGl2ZVN1Yi5wYXIzZC51c2VyTWF0cml4LnJvdGF0ZShjaGFuZ2Vwb3NbMF0qMTgwL01hdGguUEksIDAsLTEsMCk7CiAgICAgICAgICBhY3RpdmVTdWIucGFyM2QudXNlck1hdHJpeC5tdWx0UmlnaHQob2JqZWN0c1tsW2ldXS5zYXZlTWF0KTsKICAgICAgICAgIGFjdGl2ZVN1Yi5wYXIzZC51c2VyTWF0cml4LnJvdGF0ZShjaGFuZ2Vwb3NbMV0qMTgwL01hdGguUEksIC0xLDAsMCk7CiAgICAgICAgfQogICAgICAgIHNlbGYuZHJhd1NjZW5lKCk7CiAgICAgIH07CiAgICAgIGhhbmRsZXJzLnBvbGFyZW5kID0gMDsKCiAgICAgIGhhbmRsZXJzLmF4aXNkb3duID0gZnVuY3Rpb24oeCkgewogICAgICAgIGhhbmRsZXJzLnJvdEJhc2UgPSBzZWxmLnNjcmVlblRvVmVjdG9yKHgsIHNlbGYuY2FudmFzLmhlaWdodC8yKTsKICAgICAgICB2YXIgYWN0aXZlU3ViID0gc2VsZi5nZXRPYmooYWN0aXZlU3Vic2NlbmUpLAogICAgICAgICAgICBhY3RpdmVNb2RlbCA9IHNlbGYuZ2V0T2JqKHNlbGYudXNlaWQoYWN0aXZlU3ViLmlkLCAibW9kZWwiKSksCiAgICAgICAgICAgIGksIGwgPSBhY3RpdmVNb2RlbC5wYXIzZC5saXN0ZW5lcnM7CiAgICAgICAgZm9yIChpID0gMDsgaSA8IGwubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGFjdGl2ZVN1YiA9IHNlbGYuZ2V0T2JqKGxbaV0pOwogICAgICAgICAgYWN0aXZlU3ViLnNhdmVNYXQgPSBuZXcgQ2FudmFzTWF0cml4NChhY3RpdmVTdWIucGFyM2QudXNlck1hdHJpeCk7CiAgICAgICAgfQogICAgICAgIHNlbGYuY2FudmFzLnN0eWxlLmN1cnNvciA9ICJncmFiYmluZyI7CiAgICAgIH07CgogICAgICBoYW5kbGVycy5heGlzbW92ZSA9IGZ1bmN0aW9uKHgpIHsKICAgICAgICB2YXIgcm90Q3VycmVudCA9IHNlbGYuc2NyZWVuVG9WZWN0b3IoeCwgc2VsZi5jYW52YXMuaGVpZ2h0LzIpLAogICAgICAgICAgICByb3RCYXNlID0gaGFuZGxlcnMucm90QmFzZSwKICAgICAgICAgICAgYW5nbGUgPSAocm90Q3VycmVudFswXSAtIHJvdEJhc2VbMF0pKjE4MC9NYXRoLlBJLAogICAgICAgICAgICByb3RNYXQgPSBuZXcgQ2FudmFzTWF0cml4NCgpOwogICAgICAgIHJvdE1hdC5yb3RhdGUoYW5nbGUsIGhhbmRsZXJzLmF4aXNbMF0sIGhhbmRsZXJzLmF4aXNbMV0sIGhhbmRsZXJzLmF4aXNbMl0pOwogICAgICAgIHZhciBhY3RpdmVTdWIgPSBzZWxmLmdldE9iaihhY3RpdmVTdWJzY2VuZSksCiAgICAgICAgICAgIGFjdGl2ZU1vZGVsID0gc2VsZi5nZXRPYmooc2VsZi51c2VpZChhY3RpdmVTdWIuaWQsICJtb2RlbCIpKSwKICAgICAgICAgICAgaSwgbCA9IGFjdGl2ZU1vZGVsLnBhcjNkLmxpc3RlbmVyczsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbC5sZW5ndGg7IGkrKykgewogICAgICAgICAgYWN0aXZlU3ViID0gc2VsZi5nZXRPYmoobFtpXSk7CiAgICAgICAgICBhY3RpdmVTdWIucGFyM2QudXNlck1hdHJpeC5sb2FkKGFjdGl2ZVN1Yi5zYXZlTWF0KTsKICAgICAgICAgIGFjdGl2ZVN1Yi5wYXIzZC51c2VyTWF0cml4Lm11bHRMZWZ0KHJvdE1hdCk7CiAgICAgICAgfQogICAgICAgIHNlbGYuZHJhd1NjZW5lKCk7CiAgICAgIH07CiAgICAgIGhhbmRsZXJzLmF4aXNlbmQgPSAwOwoKICAgICAgaGFuZGxlcnMueTB6b29tID0gMDsKICAgICAgaGFuZGxlcnMuem9vbWRvd24gPSBmdW5jdGlvbih4LCB5KSB7CiAgICAgICAgdmFyIGFjdGl2ZVN1YiA9IHNlbGYuZ2V0T2JqKGFjdGl2ZVN1YnNjZW5lKSwKICAgICAgICAgIGFjdGl2ZVByb2plY3Rpb24gPSBzZWxmLmdldE9iaihzZWxmLnVzZWlkKGFjdGl2ZVN1Yi5pZCwgInByb2plY3Rpb24iKSksCiAgICAgICAgICBpLCBsID0gYWN0aXZlUHJvamVjdGlvbi5wYXIzZC5saXN0ZW5lcnM7CiAgICAgICAgaGFuZGxlcnMueTB6b29tID0geTsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbC5sZW5ndGg7IGkrKykgewogICAgICAgICAgYWN0aXZlU3ViID0gc2VsZi5nZXRPYmoobFtpXSk7CiAgICAgICAgICBhY3RpdmVTdWIuem9vbTAgPSBNYXRoLmxvZyhhY3RpdmVTdWIucGFyM2Quem9vbSk7CiAgICAgICAgfQogICAgICAgIHNlbGYuY2FudmFzLnN0eWxlLmN1cnNvciA9ICJ6b29tLWluIjsKICAgICAgfTsKICAgICAgaGFuZGxlcnMuem9vbW1vdmUgPSBmdW5jdGlvbih4LCB5KSB7CiAgICAgICAgdmFyIGFjdGl2ZVN1YiA9IHNlbGYuZ2V0T2JqKGFjdGl2ZVN1YnNjZW5lKSwKICAgICAgICAgICAgYWN0aXZlUHJvamVjdGlvbiA9IHNlbGYuZ2V0T2JqKHNlbGYudXNlaWQoYWN0aXZlU3ViLmlkLCAicHJvamVjdGlvbiIpKSwKICAgICAgICAgICAgaSwgbCA9IGFjdGl2ZVByb2plY3Rpb24ucGFyM2QubGlzdGVuZXJzOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBhY3RpdmVTdWIgPSBzZWxmLmdldE9iaihsW2ldKTsKICAgICAgICAgIGFjdGl2ZVN1Yi5wYXIzZC56b29tID0gTWF0aC5leHAoYWN0aXZlU3ViLnpvb20wICsgKHktaGFuZGxlcnMueTB6b29tKS9zZWxmLmNhbnZhcy5oZWlnaHQpOwogICAgICAgIH0KICAgICAgICBzZWxmLmRyYXdTY2VuZSgpOwogICAgICB9OwogICAgICBoYW5kbGVycy56b29tZW5kID0gMDsKCiAgICAgIGhhbmRsZXJzLnkwZm92ID0gMDsKICAgICAgaGFuZGxlcnMuZm92ZG93biA9IGZ1bmN0aW9uKHgsIHkpIHsKICAgICAgICBoYW5kbGVycy55MGZvdiA9IHk7CiAgICAgICAgdmFyIGFjdGl2ZVN1YiA9IHNlbGYuZ2V0T2JqKGFjdGl2ZVN1YnNjZW5lKSwKICAgICAgICAgIGFjdGl2ZVByb2plY3Rpb24gPSBzZWxmLmdldE9iaihzZWxmLnVzZWlkKGFjdGl2ZVN1Yi5pZCwgInByb2plY3Rpb24iKSksCiAgICAgICAgICBpLCBsID0gYWN0aXZlUHJvamVjdGlvbi5wYXIzZC5saXN0ZW5lcnM7CiAgICAgICAgZm9yIChpID0gMDsgaSA8IGwubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGFjdGl2ZVN1YiA9IHNlbGYuZ2V0T2JqKGxbaV0pOwogICAgICAgICAgYWN0aXZlU3ViLmZvdjAgPSBhY3RpdmVTdWIucGFyM2QuRk9WOwogICAgICAgIH0KICAgICAgICBzZWxmLmNhbnZhcy5zdHlsZS5jdXJzb3IgPSAiem9vbS1pbiI7CiAgICAgIH07CiAgICAgIGhhbmRsZXJzLmZvdm1vdmUgPSBmdW5jdGlvbih4LCB5KSB7CiAgICAgICAgdmFyIGFjdGl2ZVN1YiA9IHNlbGYuZ2V0T2JqKGFjdGl2ZVN1YnNjZW5lKSwKICAgICAgICAgICAgYWN0aXZlUHJvamVjdGlvbiA9IHNlbGYuZ2V0T2JqKHNlbGYudXNlaWQoYWN0aXZlU3ViLmlkLCAicHJvamVjdGlvbiIpKSwKICAgICAgICAgICAgaSwgbCA9IGFjdGl2ZVByb2plY3Rpb24ucGFyM2QubGlzdGVuZXJzOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBhY3RpdmVTdWIgPSBzZWxmLmdldE9iaihsW2ldKTsKICAgICAgICAgIGFjdGl2ZVN1Yi5wYXIzZC5GT1YgPSBNYXRoLm1heCgxLCBNYXRoLm1pbigxNzksIGFjdGl2ZVN1Yi5mb3YwICsKICAgICAgICAgICAgIDE4MCooeS1oYW5kbGVycy55MGZvdikvc2VsZi5jYW52YXMuaGVpZ2h0KSk7CiAgICAgICAgfQogICAgICAgIHNlbGYuZHJhd1NjZW5lKCk7CiAgICAgIH07CiAgICAgIGhhbmRsZXJzLmZvdmVuZCA9IDA7CiAgICAgIAogICAgICBoYW5kbGVycy5zZWxlY3Rpbmdkb3duID0gZnVuY3Rpb24oeCwgeSkgewogICAgICAJdmFyIHZpZXdwb3J0ID0gc2VsZi5nZXRPYmooYWN0aXZlU3Vic2NlbmUpLnBhcjNkLnZpZXdwb3J0LAogICAgICAJICB3aWR0aCA9IHZpZXdwb3J0LndpZHRoKnNlbGYuY2FudmFzLndpZHRoLAogICAgICAJICBoZWlnaHQgPSB2aWV3cG9ydC5oZWlnaHQqc2VsZi5jYW52YXMuaGVpZ2h0LCAKICAgICAgICAgIHAgPSB7eDogMi4wKngvd2lkdGggLSAxLjAsIHk6IDIuMCp5L2hlaWdodCAtIDEuMH07CiAgICAgIAlzZWxmLnNlbGVjdC5yZWdpb24gPSB7cDE6IHAsIHAyOiBwfTsKICAgICAgCWlmIChzZWxmLnNlbGVjdC5zdWJzY2VuZSAmJiBzZWxmLnNlbGVjdC5zdWJzY2VuZSAhPT0gYWN0aXZlU3Vic2NlbmUpCiAgICAgIAkgIHNlbGYuZGVsRnJvbVN1YnNjZW5lKHNlbGYuc2NlbmUuYnJ1c2hJZCwgc2VsZi5zZWxlY3Quc3Vic2NlbmUpOwogICAgICAJc2VsZi5zZWxlY3Quc3Vic2NlbmUgPSBhY3RpdmVTdWJzY2VuZTsKICAgICAgCXNlbGYuYWRkVG9TdWJzY2VuZShzZWxmLnNjZW5lLmJydXNoSWQsIGFjdGl2ZVN1YnNjZW5lKTsKICAgICAgCXNlbGYuc2VsZWN0LnN0YXRlID0gImNoYW5naW5nIjsKICAgICAgCWlmICh0eXBlb2Ygc2VsZi5zY2VuZS5icnVzaElkICE9PSAidW5kZWZpbmVkIikKICAgICAgCSAgc2VsZi5nZXRPYmooc2VsZi5zY2VuZS5icnVzaElkKS5pbml0aWFsaXplZCA9IGZhbHNlOwogICAgICAJaWYgKHR5cGVvZiBzZWxmLnNjZW5lLnNlbGVjdGlvbklucHV0ICE9PSAidW5kZWZpbmVkIikKICAgICAgCSAgc2VsZi5yZWNvcmRTZWxlY3Rpb24oYWN0aXZlU3Vic2NlbmUpOyAKICAgICAgCXNlbGYuZHJhd1NjZW5lKCk7CiAgICAgIAlzZWxmLmNhbnZhcy5zdHlsZS5jdXJzb3IgPSAiY3Jvc3NoYWlyIjsKICAgICAgfTsKICAgICAgCiAgICAgIGhhbmRsZXJzLnNlbGVjdGluZ21vdmUgPSBmdW5jdGlvbih4LCB5KSB7CiAgICAgIAl2YXIgdmlld3BvcnQgPSBzZWxmLmdldE9iaihhY3RpdmVTdWJzY2VuZSkucGFyM2Qudmlld3BvcnQsCiAgICAgIAkgIHdpZHRoID0gdmlld3BvcnQud2lkdGgqc2VsZi5jYW52YXMud2lkdGgsCiAgICAgIAkgIGhlaWdodCA9IHZpZXdwb3J0LmhlaWdodCpzZWxmLmNhbnZhcy5oZWlnaHQ7CiAgICAgIAlpZiAoc2VsZi5zZWxlY3Quc3RhdGUgPT09ICJpbmFjdGl2ZSIpIAogICAgICAJICByZXR1cm47CiAgICAgIAlzZWxmLnNlbGVjdC5yZWdpb24ucDIgPSB7eDogMi4wKngvd2lkdGggLSAxLjAsIHk6IDIuMCp5L2hlaWdodCAtIDEuMH07CiAgICAgIAlpZiAodHlwZW9mIHNlbGYuc2NlbmUuYnJ1c2hJZCAhPT0gInVuZGVmaW5lZCIpCiAgICAgIAkgIHNlbGYuZ2V0T2JqKHNlbGYuc2NlbmUuYnJ1c2hJZCkuaW5pdGlhbGl6ZWQgPSBmYWxzZTsKICAgICAgCWlmICh0eXBlb2Ygc2VsZi5zY2VuZS5zZWxlY3Rpb25JbnB1dCAhPT0gInVuZGVmaW5lZCIpCiAgICAgIAkgIHNlbGYucmVjb3JkU2VsZWN0aW9uKGFjdGl2ZVN1YnNjZW5lKTsKICAgICAgCXNlbGYuZHJhd1NjZW5lKCk7CiAgICAgIH07CiAgICAgIAogICAgICBoYW5kbGVycy5zZWxlY3RpbmdlbmQgPSAwOwogICAgICAvKiBqc2hpbnQgZXZpbDp0cnVlICovCiAgICAgIGhhbmRsZXJzLnVzZXJkb3duID0gZnVuY3Rpb24oeCwgeSkgewogICAgICAgIHZhciBzdWIgPSBzZWxmLmdldE9iaihhY3RpdmVTdWJzY2VuZSksCiAgICAgICAgICAgIGNvZGUgPSBzdWIuY2FsbGJhY2tzW2RyYWddLmJlZ2luOwogICAgICAgIGlmIChjb2RlKSB7CiAgICAgICAgICB2YXIgZm4gPSBGdW5jdGlvbignInVzZSBzdHJpY3QiO3JldHVybiAoJyArIGNvZGUgKyAnKScpKCk7CiAgICAgICAgICBmbi5jYWxsKHNlbGYsIHgsIHkpOwogICAgICAgIH0KICAgICAgfTsKICAgICAgCiAgICAgIGhhbmRsZXJzLnVzZXJtb3ZlID0gZnVuY3Rpb24oeCwgeSkgewogICAgICAgIHZhciBzdWIgPSBzZWxmLmdldE9iaihhY3RpdmVTdWJzY2VuZSksCiAgICAgICAgICAgIGNvZGUgPSBzdWIuY2FsbGJhY2tzW2RyYWddLnVwZGF0ZTsKICAgICAgICBpZiAoY29kZSkgewogICAgICAgICAgdmFyIGZuID0gRnVuY3Rpb24oJyJ1c2Ugc3RyaWN0IjtyZXR1cm4gKCcgKyBjb2RlICsgJyknKSgpOwogICAgICAgICAgZm4uY2FsbChzZWxmLCB4LCB5KTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIAogICAgICBoYW5kbGVycy51c2VyZW5kID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIHN1YiA9IHNlbGYuZ2V0T2JqKGFjdGl2ZVN1YnNjZW5lKSwKICAgICAgICAgICAgY29kZSA9IHN1Yi5jYWxsYmFja3NbZHJhZ10uZW5kOwogICAgICAgIGlmIChjb2RlKSB7CiAgICAgICAgICB2YXIgZm4gPSBGdW5jdGlvbignInVzZSBzdHJpY3QiO3JldHVybiAoJyArIGNvZGUgKyAnKScpKCk7CiAgICAgICAgICBmbi5jYWxsKHNlbGYpOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHNlbGYuY2FudmFzLm9ucG9pbnRlcmRvd24gPSBmdW5jdGlvbiAoIGV2ICl7CiAgICAgICAgLy8gcG9pbnRlcnMgYW5kIG1pY2UgZGlmZmVyIGluIGNhcHR1cmUgcnVsZXM7IAogICAgICAgIC8vIGFjdCBsaWtlIGEgbW91c2UuCiAgICAgICAgaWYgKGV2LnRhcmdldC5oYXNQb2ludGVyQ2FwdHVyZShldi5wb2ludGVySWQpKQogICAgICAgICAgZXYudGFyZ2V0LnJlbGVhc2VQb2ludGVyQ2FwdHVyZShldi5wb2ludGVySWQpOwogICAgICAgICAgCiAgICAgICAgaWYgKCFldi53aGljaCkgLy8gVXNlIHczYyBkZWZucyBpbiBwcmVmZXJlbmNlIHRvIE1TCiAgICAgICAgc3dpdGNoIChldi5idXR0b24pIHsKICAgICAgICAgIGNhc2UgMDogZXYud2hpY2ggPSAxOyBicmVhazsKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgIGNhc2UgNDogZXYud2hpY2ggPSAyOyBicmVhazsKICAgICAgICAgIGNhc2UgMjogZXYud2hpY2ggPSAzOwogICAgICAgIH0KICAgICAgICBkcmFnID0gWyJub25lIiwgImxlZnQiLCAibWlkZGxlIiwgInJpZ2h0IiwgIndoZWVsIl1bZXYud2hpY2hdOwogICAgICAgIHZhciBjb29yZHMgPSBzZWxmLnJlbE1vdXNlQ29vcmRzKGV2KTsKICAgICAgICBjb29yZHMueSA9IHNlbGYuY2FudmFzLmhlaWdodC1jb29yZHMueTsKICAgICAgICBhY3RpdmVTdWJzY2VuZSA9IHNlbGYud2hpY2hTdWJzY2VuZShjb29yZHMpOwogICAgICAgIHZhciBzdWIgPSBzZWxmLmdldE9iaihhY3RpdmVTdWJzY2VuZSksIGY7CiAgICAgICAgaGFuZGxlciA9IHN1Yi5wYXIzZC5tb3VzZU1vZGVbZHJhZ107CiAgICAgICAgc3dpdGNoIChoYW5kbGVyKSB7CiAgICAgICAgY2FzZSAieEF4aXMiOgogICAgICAgICAgaGFuZGxlciA9ICJheGlzIjsKICAgICAgICAgIGhhbmRsZXJzLmF4aXMgPSBbMS4wLCAwLjAsIDAuMF07CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJ5QXhpcyI6CiAgICAgICAgICBoYW5kbGVyID0gImF4aXMiOwogICAgICAgICAgaGFuZGxlcnMuYXhpcyA9IFswLjAsIDEuMCwgMC4wXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgInpBeGlzIjoKICAgICAgICAgIGhhbmRsZXIgPSAiYXhpcyI7CiAgICAgICAgICBoYW5kbGVycy5heGlzID0gWzAuMCwgMC4wLCAxLjBdOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGYgPSBoYW5kbGVyc1toYW5kbGVyICsgImRvd24iXTsKICAgICAgICBpZiAoZikgewogICAgICAgICAgY29vcmRzID0gc2VsZi50cmFuc2xhdGVDb29yZHMoYWN0aXZlU3Vic2NlbmUsIGNvb3Jkcyk7CiAgICAgICAgICBmLmNhbGwoc2VsZiwgY29vcmRzLngsIGNvb3Jkcy55KTsKICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgICBjb25zb2xlLndhcm4oIk1vdXNlIGhhbmRsZXIgJyIgKyBoYW5kbGVyICsgIicgaXMgbm90IGltcGxlbWVudGVkLiIpOwoKICAgICAgfTsKCiAgICAgIHNlbGYuY2FudmFzLm9ucG9pbnRlcnVwID0gZnVuY3Rpb24gKCBldiApewogICAgICAgIGlmICggIWRyYWcgKSByZXR1cm47CiAgICAgICAgdmFyIGYgPSBoYW5kbGVyc1toYW5kbGVyICsgImVuZCJdOwogICAgICAgIGlmIChmKSB7CiAgICAgICAgICBmLmNhbGwoc2VsZik7CiAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIH0KICAgICAgICBkcmFnID0gMDsKICAgICAgICBoYW5kbGVycy5vbnBvaW50ZXJtb3ZlKCBldiApOwogICAgICB9OwoKICAgICAgc2VsZi5jYW52YXMub25wb2ludGVyb3V0ID0gc2VsZi5jYW52YXMub25wb2ludGVydXA7CgogICAgICBoYW5kbGVycy5vbnBvaW50ZXJtb3ZlID0gZnVuY3Rpb24gKCBldiApIHsKICAgICAgICB2YXIgY29vcmRzID0gc2VsZi5yZWxNb3VzZUNvb3JkcyhldiksIHN1YiwgZjsKICAgICAgICBjb29yZHMueSA9IHNlbGYuY2FudmFzLmhlaWdodCAtIGNvb3Jkcy55OwogICAgICAgIGlmIChldi5idXR0b25zID09PSAwKSB7CiAgICAgICAgICBhY3RpdmVTdWJzY2VuZSA9IHNlbGYud2hpY2hTdWJzY2VuZShjb29yZHMpOwogICAgICAgICAgZHJhZyA9ICJub25lIjsKICAgICAgICAgIHN1YiA9IHNlbGYuZ2V0T2JqKGFjdGl2ZVN1YnNjZW5lKTsKICAgICAgICAgIGhhbmRsZXIgPSBzdWIucGFyM2QubW91c2VNb2RlLm5vbmU7CiAgICAgICAgICBpZiAoaGFuZGxlciAhPT0gIm5vbmUiKSB7CiAgICAgICAgICAgIGlmIChzdWIubmVlZHNCZWdpbikgewogICAgICAgICAgICAgIGYgPSBoYW5kbGVyc1toYW5kbGVyICsgImRvd24iXTsKICAgICAgICAgICAgICBpZiAoZikgewogICAgICAgICAgICAgICAgY29vcmRzID0gc2VsZi50cmFuc2xhdGVDb29yZHMoYWN0aXZlU3Vic2NlbmUsIGNvb3Jkcyk7CiAgICAgICAgICAgICAgICBmLmNhbGwoc2VsZiwgY29vcmRzLngsIGNvb3Jkcy55KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgc3ViLm5lZWRzQmVnaW4gPSAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbGYuY2FudmFzLnN0eWxlLmN1cnNvciA9IHNlbGYuZ2V0Q3Vyc29yKHN1Yi5wYXIzZC5tb3VzZU1vZGUubm9uZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZWxmLmNhbnZhcy5zdHlsZS5jdXJzb3IgPSBzZWxmLmdldEN1cnNvcihzdWIucGFyM2QubW91c2VNb2RlLmxlZnQpOyAgCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZiA9IGhhbmRsZXJzW2hhbmRsZXIgKyAibW92ZSJdOwogICAgICAgIGlmIChmKSB7CiAgICAgICAgICBjb29yZHMgPSBzZWxmLnRyYW5zbGF0ZUNvb3JkcyhhY3RpdmVTdWJzY2VuZSwgY29vcmRzKTsKICAgICAgICAgIGYuY2FsbChzZWxmLCBjb29yZHMueCwgY29vcmRzLnkpOwogICAgICAgIH0KICAgICAgfTsKICAgICAgCgogICAgICBzZWxmLmNhbnZhcy5vbnBvaW50ZXJlbnRlciA9IGZ1bmN0aW9uKCkgewogICAgICAgIHNlbGYuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoInBvaW50ZXJtb3ZlIiwgICAgICAgICAgICAgICBoYW5kbGVycy5vbnBvaW50ZXJtb3ZlKTsKICAgICAgfTsKICAgICAgCiAgICAgIHNlbGYuY2FudmFzLm9ucG9pbnRlcmxlYXZlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgc2VsZi5jYW52YXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigicG9pbnRlcm1vdmUiLAogICAgICAgICAgaGFuZGxlcnMub25wb2ludGVybW92ZSk7CiAgICAgIH07CgogICAgICBoYW5kbGVycy5zZXRab29tID0gZnVuY3Rpb24oZHMpIHsKICAgICAgICB2YXIgaTsKICAgICAgICBpZiAodHlwZW9mIGFjdGl2ZVN1YnNjZW5lID09PSAidW5kZWZpbmVkIikKICAgICAgICAgIGFjdGl2ZVN1YnNjZW5lID0gc2VsZi5zY2VuZS5yb290U3Vic2NlbmU7CiAgICAgICAgdmFyIGFjdGl2ZVN1YiA9IHNlbGYuZ2V0T2JqKGFjdGl2ZVN1YnNjZW5lKSwKICAgICAgICAgICAgYWN0aXZlUHJvamVjdGlvbiA9IHNlbGYuZ2V0T2JqKHNlbGYudXNlaWQoYWN0aXZlU3ViLmlkLCAicHJvamVjdGlvbiIpKSwKICAgICAgICAgICAgbCA9IGFjdGl2ZVByb2plY3Rpb24ucGFyM2QubGlzdGVuZXJzOwoKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbC5sZW5ndGg7IGkrKykgewogICAgICAgICAgYWN0aXZlU3ViID0gc2VsZi5nZXRPYmoobFtpXSk7CiAgICAgICAgICBhY3RpdmVTdWIucGFyM2Quem9vbSAqPSBkczsKICAgICAgICB9CiAgICAgICAgc2VsZi5kcmF3U2NlbmUoKTsKICAgICAgfTsKICAgICAgCiAgICAgIGhhbmRsZXJzLnB1c2h3aGVlbCA9IGZ1bmN0aW9uKGV2KSB7CiAgICAgICAgZXYuZGVsdGFZID0gLWV2LmRlbHRhWTsKICAgICAgICBoYW5kbGVycy5wdWxsd2hlZWwoZXYpOwogICAgICB9OwogICAgICAKICAgICAgaGFuZGxlcnMucHVsbHdoZWVsID0gZnVuY3Rpb24oZXYpIHsKICAgICAgICB2YXIgZGVsID0gMS4wNTsKICAgICAgICBpZiAoZXYuc2hpZnRLZXkpIGRlbCA9IDEuMDA1OwogICAgICAgIHZhciBkcyA9IGV2LmRlbHRhWSA8IDAgPyBkZWwgOiAoMSAvIGRlbCk7CiAgICAgICAgaGFuZGxlcnMuc2V0Wm9vbShkcyk7CiAgICAgIH07CiAgICAgIAogICAgICBoYW5kbGVycy51c2VyMndoZWVsID0gZnVuY3Rpb24oZXYpIHsKICAgICAgICB2YXIgc3ViID0gc2VsZi5nZXRPYmooYWN0aXZlU3Vic2NlbmUpLAogICAgICAgICAgICBjb2RlID0gc3ViLmNhbGxiYWNrcy53aGVlbC5yb3RhdGU7CiAgICAgICAgaWYgKGNvZGUpIHsKICAgICAgICAgIHZhciBmbiA9IEZ1bmN0aW9uKCcidXNlIHN0cmljdCI7cmV0dXJuICgnICsgY29kZSArICcpJykoKTsKICAgICAgICAgIC8qIGpzaGludCBldmlsOmZhbHNlICovCiAgICAgICAgICBmbi5jYWxsKHNlbGYsIGV2LmRlbHRhWSA8IDAgPyAxIDogMik7CiAgICAgICAgfSAgICAgICAgCiAgICAgIH07CiAgICAgICAgCiAgICAgIGhhbmRsZXJzLndoZWVsSGFuZGxlciA9IGZ1bmN0aW9uKGV2KSB7CiAgICAgICAgdmFyIGNvb3JkcyA9IHNlbGYucmVsTW91c2VDb29yZHMoZXYpOwogICAgICAgIGNvb3Jkcy55ID0gc2VsZi5jYW52YXMuaGVpZ2h0IC0gY29vcmRzLnk7CiAgICAgICAgYWN0aXZlU3Vic2NlbmUgPSBzZWxmLndoaWNoU3Vic2NlbmUoY29vcmRzKTsKICAgICAgICB2YXIgc3ViID0gc2VsZi5nZXRPYmooYWN0aXZlU3Vic2NlbmUpLCBmLAogICAgICAgICAgICBoYW5kbGVyID0gc3ViLnBhcjNkLm1vdXNlTW9kZS53aGVlbCwKICAgICAgICAgICAgZXZsb2NhbDsKICAgICAgICAgICAgCiAgICAgICAgZXYuZGVsdGFZID0gZXYuZGVsdGFZIHx8IGV2LmRldGFpbCB8fCBldi5kZWx0YVggfHwgZXYud2hlZWxEZWx0YTsKICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIHN3aXRjaChoYW5kbGVyKSB7CiAgICAgICAgICBjYXNlICJub25lIjogYnJlYWs7CiAgICAgICAgICBjYXNlICJwdXNoIjoKICAgICAgICAgIGNhc2UgInB1bGwiOgogICAgICAgICAgY2FzZSAidXNlcjIiOgogICAgICAgICAgICBmID0gaGFuZGxlcnNbaGFuZGxlciArICJ3aGVlbCJdOwogICAgICAgICAgICBpZiAoZikgewogICAgICAgICAgICAgIGV2bG9jYWwgPSB7fTsKICAgICAgICAgICAgICBldmxvY2FsLmRlbHRhWSA9IGV2LmRlbHRhWTsKICAgICAgICAgICAgICBldmxvY2FsLnNoaWZ0S2V5ID0gZXYuc2hpZnRLZXk7CiAgICAgICAgICAgICAgZXZsb2NhbC5wcmV2ZW50RGVmYXVsdCA9IGZ1bmN0aW9uKCkgeyBldi5wcmV2ZW50RGVmYXVsdCgpOyB9OwogICAgICAgICAgICAgIGYuY2FsbChzZWxmLCBldmxvY2FsKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGRlZmF1bHQ6IAogICAgICAgICAgICBldmxvY2FsID0ge307CiAgICAgICAgICAgIGV2bG9jYWwucHJldmVudERlZmF1bHQgPSBmdW5jdGlvbigpIHsgZXYucHJldmVudERlZmF1bHQoKTsgfTsKICAgICAgICAgICAgZXZsb2NhbC53aGljaCA9IDQ7CiAgICAgICAgICAgIGV2bG9jYWwuY2xpZW50WCA9IHNlbGYuY2FudmFzLndpZHRoLzI7CiAgICAgICAgICAgIGV2bG9jYWwuY2xpZW50WSA9IHNlbGYuY2FudmFzLmhlaWdodC8yOwogICAgICAgICAgICBzZWxmLmNhbnZhcy5vbnBvaW50ZXJkb3duKGV2bG9jYWwpOwogICAgICAgICAgICBldmxvY2FsLmNsaWVudFggKz0gZXYuZGVsdGFYOwogICAgICAgICAgICBldmxvY2FsLmNsaWVudFkgKz0gZXYuZGVsdGFZOwogICAgICAgICAgICBoYW5kbGVycy5vbnBvaW50ZXJtb3ZlKGV2bG9jYWwpOwogICAgICAgICAgICBzZWxmLmNhbnZhcy5vbnBvaW50ZXJ1cChldmxvY2FsKTsKICAgICAgICB9CiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTsKICAgICAgfTsKICAgICAgCiAgICAgIGhhbmRsZXJzLmdldF9maW5nZXJfZGlzdCA9IGZ1bmN0aW9uKGV2KSB7CiAgICAgICAgdmFyIGRpZmZYID0gZXYudG91Y2hlc1swXS5jbGllbnRYIC0gZXYudG91Y2hlc1sxXS5jbGllbnRYLAogICAgICAgICAgICBkaWZmWSA9IGV2LnRvdWNoZXNbMF0uY2xpZW50WSAtIGV2LnRvdWNoZXNbMV0uY2xpZW50WTsKICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KGRpZmZYICogZGlmZlggKyBkaWZmWSAqIGRpZmZZKTsgCiAgICAgIH07CiAgICAgIAogICAgICBoYW5kbGVycy50b3VjaHN0YXJ0ID0gZnVuY3Rpb24oZXYpIHsKICAgICAgICB2YXIgdG91Y2ggPSBldi50b3VjaGVzWzBdLAogICAgICAgICAgbW91c2VFdmVudCA9IG5ldyBNb3VzZUV2ZW50KCJwb2ludGVyZG93biIsCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjbGllbnRYOiB0b3VjaC5jbGllbnRYLAogICAgICAgICAgICAgIGNsaWVudFk6IHRvdWNoLmNsaWVudFkKICAgICAgICAgICAgfSk7CiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTsKICAgICAgICBpZiAoZXYudG91Y2hlcy5sZW5ndGggPT09IDIpIHsKICAgICAgICAgIHZhciBjb29yZHMgPSBzZWxmLnJlbE1vdXNlQ29vcmRzKHRvdWNoKTsKICAgICAgICAgIGNvb3Jkcy55ID0gc2VsZi5jYW52YXMuaGVpZ2h0LWNvb3Jkcy55OwogICAgICAgICAgYWN0aXZlU3Vic2NlbmUgPSBzZWxmLndoaWNoU3Vic2NlbmUoY29vcmRzKTsKICAgICAgICAgIGhhbmRsZXJzLmZpbmdlcl9kaXN0MCA9IGhhbmRsZXJzLmdldF9maW5nZXJfZGlzdChldik7CiAgICAgICAgICBoYW5kbGVycy56b29tZG93bihjb29yZHMueCwgY29vcmRzLnkpOwogICAgICAgIH0KICAgICAgICBzZWxmLmRpc3BhdGNoRXZlbnQobW91c2VFdmVudCk7CiAgICAgIH07CiAgICAgIAogICAgICBoYW5kbGVycy50b3VjaGVuZCA9IGZ1bmN0aW9uKGV2KSB7CiAgICAgICAgdmFyIG1vdXNlRXZlbnQ7CiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTsKICAgICAgICBpZiAoZXYudG91Y2hlcy5sZW5ndGggPT09IDEpIHsKICAgICAgICAgIG1vdXNlRXZlbnQgPSBuZXcgTW91c2VFdmVudCgicG9pbnRlcnVwIiwge30pOwogICAgICAgICAgc2VsZi5kaXNwYXRjaEV2ZW50KG1vdXNlRXZlbnQpOwogICAgICAgIH0KICAgICAgfTsKICAgICAgCiAgICAgIGhhbmRsZXJzLnRvdWNobW92ZSA9IGZ1bmN0aW9uKGV2KSB7CiAgICAgICAgdmFyIHRvdWNoID0gZXYudG91Y2hlc1swXSwKICAgICAgICAgIG1vdXNlRXZlbnQ7CiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTsKICAgICAgICBpZiAoZXYudG91Y2hlcy5sZW5ndGggPiAxKSB7CiAgICAgICAgICB2YXIgY29vcmRzID0gc2VsZi5yZWxNb3VzZUNvb3Jkcyh0b3VjaCksCiAgICAgICAgICAgICAgbmV3X2Rpc3QgPSBoYW5kbGVycy5nZXRfZmluZ2VyX2Rpc3QoZXYpOwogICAgICAgICAgY29vcmRzLnkgPSBzZWxmLmNhbnZhcy5oZWlnaHQqTWF0aC5sb2coaGFuZGxlcnMuZmluZ2VyX2Rpc3QwL25ld19kaXN0KSArIGhhbmRsZXJzLnkwem9vbTsKICAgICAgICAgIGhhbmRsZXJzLnpvb21tb3ZlKGNvb3Jkcy54LCBjb29yZHMueSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG1vdXNlRXZlbnQgPSBuZXcgTW91c2VFdmVudCgicG9pbnRlcm1vdmUiLAogICAgICAgICAgewogICAgICAgICAgICBjbGllbnRYOiB0b3VjaC5jbGllbnRYLAogICAgICAgICAgICBjbGllbnRZOiB0b3VjaC5jbGllbnRZCiAgICAgICAgICB9KTsKICAgICAgICAgIHNlbGYuZGlzcGF0Y2hFdmVudChtb3VzZUV2ZW50KTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBzZWxmLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCJET01Nb3VzZVNjcm9sbCIsIGhhbmRsZXJzLndoZWVsSGFuZGxlciwgZmFsc2UpOwogICAgICBzZWxmLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCJtb3VzZXdoZWVsIiwgaGFuZGxlcnMud2hlZWxIYW5kbGVyLCBmYWxzZSk7CiAgICAgIHNlbGYuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoInRvdWNoc3RhcnQiLCBoYW5kbGVycy50b3VjaHN0YXJ0LCB7cGFzc2l2ZTogZmFsc2V9KTsKICAgICAgc2VsZi5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigidG91Y2hlbmQiLCBoYW5kbGVycy50b3VjaGVuZCwge3Bhc3NpdmU6IGZhbHNlfSk7CiAgICAgIHNlbGYuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoInRvdWNobW92ZSIsIGhhbmRsZXJzLnRvdWNobW92ZSwge3Bhc3NpdmU6IGZhbHNlfSk7CgkgIH07Cg=="></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,ICAgIC8qKgogICAgICogTWV0aG9kcyByZWxhdGVkIHRvIGluaXRpYWxpemF0aW9uCiAgICAgKiBAbmFtZSBfX19NRVRIT0RTX0ZPUl9JTklUSUFMSVpBVElPTl9fXwogICAgICogQG1lbWJlcm9mIHJnbHdpZGdldENsYXNzCiAgICAgKiBAa2luZCBmdW5jdGlvbgogICAgICogQGluc3RhbmNlCiAgICAgKi8KICAgICAKICAgIC8qKgogICAgICogSW5pdGlhbCB0ZXN0IGZvciBXZWJHTAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuaW5pdEdMMCA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIXdpbmRvdy5XZWJHTFJlbmRlcmluZ0NvbnRleHQpewogICAgICAgIHRoaXMuYWxlcnRPbmNlKCJZb3VyIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBXZWJHTC4gU2VlIGh0dHA6Ly9nZXQud2ViZ2wub3JnIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9OwoKICAgIC8qKgogICAgICogSW5pdGlhbGl6ZSBXZWJHTAogICAgICogQHJldHVybnMgeyBPYmplY3QgfSB0aGUgV2ViR0wgY29udGV4dAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuaW5pdEdMID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpcywgc3VjY2VzcyA9IGZhbHNlOwogICAgICBpZiAodGhpcy5nbCkgewogICAgICAJaWYgKCF0aGlzLmRyYXdpbmcgJiYgdGhpcy5nbC5pc0NvbnRleHRMb3N0KCkpCiAgICAgICAgICB0aGlzLnJlc3RhcnRDYW52YXMoKTsKICAgICAgICBlbHNlCiAgICAgICAgICByZXR1cm4gdGhpcy5nbDsKICAgICAgfQogICAgICAvLyBpZiAoIXRoaXMuaXNJbkJyb3dzZXJWaWV3cG9ydCgpKSByZXR1cm47IFJldHVybiB3aGF0Pz8/IEF0IHRoaXMgcG9pbnQgd2Uga25vdyB0aGlzLmdsIGlzIG51bGwuCiAgICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoIndlYmdsY29udGV4dHJlc3RvcmVkIiwKICAgICAgICB0aGlzLm9uQ29udGV4dFJlc3RvcmVkLCBmYWxzZSk7CiAgICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoIndlYmdsY29udGV4dGxvc3QiLAogICAgICAgIHRoaXMub25Db250ZXh0TG9zdCwgZmFsc2UpOwogICAgICB0aGlzLmdsID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgid2ViZ2wiLCB0aGlzLndlYkdMb3B0aW9ucykgfHwKICAgICAgICAgICAgICAgdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgiZXhwZXJpbWVudGFsLXdlYmdsIiwgdGhpcy53ZWJHTG9wdGlvbnMpOwogICAgICBzdWNjZXNzID0gISEodGhpcy5nbCAmJiB0aGlzLmdsIGluc3RhbmNlb2YgV2ViR0xSZW5kZXJpbmdDb250ZXh0KTsKICAgICAgaWYgKCFzdWNjZXNzKQogICAgICAgIHRoaXMuYWxlcnRPbmNlKCJZb3VyIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBXZWJHTC4gU2VlIGh0dHA6Ly9nZXQud2ViZ2wub3JnIik7IAogICAgICB0aGlzLmluZGV4X3VpbnQgPSB0aGlzLmdsLmdldEV4dGVuc2lvbigiT0VTX2VsZW1lbnRfaW5kZXhfdWludCIpOwogICAgICB2YXIgc2F2ZSA9IHRoaXMuc3RhcnREcmF3aW5nKCk7CiAgICAgIE9iamVjdC5rZXlzKHRoaXMuc2NlbmUub2JqZWN0cykuZm9yRWFjaChmdW5jdGlvbihrZXkpewogICAgICAgIHNlbGYuaW5pdE9iaklkKHBhcnNlSW50KGtleSwgMTApKTsKICAgICAgICB9KTsKICAgICAgdGhpcy5zdG9wRHJhd2luZyhzYXZlKTsKICAgICAgcmV0dXJuIHRoaXMuZ2w7CiAgICB9OwoKICAgIC8qKgogICAgICogUmVzaXplIHRoZSBkaXNwbGF5IHRvIG1hdGNoIGVsZW1lbnQKICAgICAqIEBwYXJhbSB7IE9iamVjdCB9IGVsIC0gRE9NIGVsZW1lbnQgdG8gbWF0Y2gKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKGVsKSB7CiAgICAgIHRoaXMuY2FudmFzLndpZHRoID0gZWwud2lkdGg7CiAgICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IGVsLmhlaWdodDsKICAgIH07CgogICAgLyoqCiAgICAgKiBJbml0aWFsaXplIHRoZSBzcGhlcmUgb2JqZWN0CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5pbml0U3BoZXJlID0gZnVuY3Rpb24oc2VjdGlvbnMsIHNlZ21lbnRzKSB7CiAgICAgIHZhciB2ID0gW10sIHBoaSA9IFtdLCB0aGV0YSA9IFtdLCBpdCA9IFtdLCBjZW50ZXJzID0gW10sCiAgICAgICAgICAgaSwgaiwgaywgaW5kLCByZXN1bHQgPSB7fTsKICAgICAgIAogICAgICBmb3IgKGkgPSAwOyBpIDw9IHNlY3Rpb25zOyBpKyspIHsKICAgICAgICBwaGkucHVzaChpL3NlY3Rpb25zIC0gMC41KTsKICAgICAgfQoKICAgICAgZm9yIChqID0gMDsgaiA8PSBzZWdtZW50czsgaisrKSB7CiAgICAgICAgdGhldGEucHVzaCgyKmovc2VnbWVudHMpOwogICAgICAgIGZvciAoaSA9IDA7IGkgPD0gc2VjdGlvbnM7IGkrKykgewogICAgICAgICAgLyogVGhlc2UgYXJlIFt4LHkseixzLHRdOiAqLwogICAgICAgICAgdi5wdXNoKFtNYXRoLnNpbihNYXRoLlBJKnRoZXRhW2pdKSAqIE1hdGguY29zKE1hdGguUEkqcGhpW2ldKSwKICAgICAgICAgICAgICAgICAgTWF0aC5zaW4oTWF0aC5QSSpwaGlbaV0pLAogICAgICAgICAgICAgICAgICBNYXRoLmNvcyhNYXRoLlBJKnRoZXRhW2pdKSAqIE1hdGguY29zKE1hdGguUEkqcGhpW2ldKSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgIHRoZXRhW2pdLzIsCiAgICAgICAgICAgICAgICAgIHBoaVtpXSArIDAuNV0pOwogICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCJ4eXpzdD0iK3Zbdi5sZW5ndGgtMV0pOwogICAgICAgIH0KICAgICAgfQogICAgICByZXN1bHQudmFsdWVzID0gbmV3IEZsb2F0MzJBcnJheShyZ2x3aWRnZXRDbGFzcy5mbGF0dGVuKHYpKTsKICAgICAgcmVzdWx0LnZlcnRleENvdW50ID0gdi5sZW5ndGg7CiAgICAgIAogICAgICBmb3IgKGogPSAwOyBqIDwgc2VnbWVudHM7IGorKykgewogICAgICAgIGZvciAoaSA9IDA7IGkgPCBzZWN0aW9uczsgaSsrKSB7CiAgICAgICAgICBpbmQgPSBpICsgKHNlY3Rpb25zICsgMSkqajsKICAgICAgICAgIGlmIChpID4gMCkgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBzb3V0aCBwb2xlCiAgICAgICAgICAgIGl0LnB1c2goW2luZCwgCiAgICAgICAgICAgICAgICAgICAgIGluZCArIHNlY3Rpb25zICsgMSwKICAgICAgICAgICAgICAgICAgICAgaW5kICsgMV0pOwogICAgICAgICAgaWYgKGkgPCBzZWN0aW9ucyAtIDEpICAgICAgICAgICAgIC8vIE5vdCBub3J0aCBwb2xlCiAgICAgICAgICAgIGl0LnB1c2goW2luZCArIHNlY3Rpb25zICsgMSwgCiAgICAgICAgICAgICAgICAgICAgIGluZCArIHNlY3Rpb25zICsgMiwKICAgICAgICAgICAgICAgICAgICAgaW5kICsgMV0pOwogICAgICAgIH0KICAgICAgfQogICAgICByZXN1bHQuaXQgPSBuZXcgVWludDE2QXJyYXkocmdsd2lkZ2V0Q2xhc3MuZmxhdHRlbihpdCkpOwogICAgICAKICAgICAgZm9yIChpID0gMDsgaSA8IGl0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY2VudGVycy5wdXNoKFswLDAsMF0pOwogICAgICAgIGZvciAoaiA9IDA7IGogPCAzOyBqKyspIHsgLy8geCx5LHoKICAgICAgICAgIGZvciAoayA9IDA7IGsgPCAzOyBrKyspIHsvLyB2ZXJ0aWNlcwogICAgICAgICAgICBjZW50ZXJzW2ldW2pdICs9IHZbaXRbaV1ba11dW2pdLzM7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJlc3VsdC5jZW50ZXJzID0gY2VudGVyczsKICAgICAgCiAgICAgIHJlc3VsdC52T2Zmc2V0cyA9IHt2b2ZzOjAsIGNvZnM6LTEsIG5vZnM6MCwgcmFkb2ZzOi0xLCBvb2ZzOi0xLAogICAgICAgICAgICAgICAgICAgICAgICAgdG9mczozLCBuZXh0b2ZzOi0xLCBwb2ludG9mczotMSwgc3RyaWRlOjV9OwoKICAgICAgcmVzdWx0LmYgPSBbXTsKICAgICAgcmVzdWx0LmluZGljZXMgPSB7fTsKCiAgICAgIHJlc3VsdC5jb2xvckNvdW50ID0gMTsKICAgICAgcmVzdWx0LnR5cGUgPSAic3BoZXJlIjsKICAgICAgdGhpcy5zcGhlcmUgPSByZXN1bHQ7CiAgICAgIHRoaXMuaW5pdFNoYXBlR0wodGhpcy5zcGhlcmUpOwogICAgfTsKCiAgICAvKioKICAgICAqIEluaXRpYWxpemUgdGhlIGN1YmUgb2JqZWN0CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5pbml0Q3ViZSA9IGZ1bmN0aW9uKCkgewogICB2YXIgdiA9IFtbMCwgMCwgMF0sIFsxLCAwLCAwXSwgCiAgICAgICAgICAgIFswLCAxLCAwXSwgWzEsIDEsIDBdLCAKICAgICAgICAgICAgWzAsIDAsIDFdLCBbMSwgMCwgMV0sCiAgICAgICAgICAgIFswLCAxLCAxXSwgWzEsIDEsIDFdXSwKICAgICAgICAgIGliID0gW1swLCAyLCAzLCAxXSwgCiAgICAgICAgICAgICAgICBbMiwgNiwgNywgM10sIAogICAgICAgICAgICAgICAgWzEsIDMsIDcsIDVdLCAKICAgICAgICAgICAgICAgIFswLCA0LCA2LCAyXSwgCiAgICAgICAgICAgICAgICBbMCwgMSwgNSwgNF0sIAogICAgICAgICAgICAgICAgWzQsIDUsIDcsIDZdXSwgCiAgICAgICAgICBjZW50ZXJzID0gW10sIGksIGosIGssIAogICAgICAgICAgaTAsIGkxLCBpMiwKICAgICAgICAgIG5vcm1hbCwgcmVzdWx0ID0ge307CiAgICAgICAKICAgICAgZm9yIChpID0gMDsgaSA8IGliLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY2VudGVycy5wdXNoKFswLDAsMF0pOwogICAgICAgIGZvciAoaiA9IDA7IGogPCAzOyBqKyspIHsgLy8geCx5LHoKICAgICAgICAgIGZvciAoayA9IDA7IGsgPCA0OyBrKyspIHsvLyB2ZXJ0aWNlcwogICAgICAgICAgICBjZW50ZXJzW2ldW2pdICs9IHZbaWJbaV1ba11dW2pdLzQ7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJlc3VsdC5jZW50ZXJzID0gY2VudGVyczsgCiAgICAgIHJlc3VsdC52YWx1ZXMgPSBuZXcgRmxvYXQzMkFycmF5KDYqNCozKjIpOwogICAgICByZXN1bHQudmVydGV4Q291bnQgPSAyNDsKICAgICAgcmVzdWx0LnZlcnRpY2VzID0gbmV3IEFycmF5KDI0KTsKICAgICAgcmVzdWx0Lm5vcm1hbHMgPSBuZXcgQXJyYXkoMjQpOwogICAgICBmb3IgKGk9MDsgaSA8IDY7IGkrKykgewogICAgICAgIGZvciAoaj0wOyBqIDwgNDsgaisrKSB7CiAgICAgICAgICBpMCA9IGliW2ldW2pdOwogICAgICAgICAgcmVzdWx0LnZlcnRpY2VzWzQqaSArIGpdID0gdltpMF07CiAgICAgICAgICBpMSA9IGliW2ldWyhqICsgMSkgJSA0XTsKICAgICAgICAgIGkyID0gaWJbaV1bKGogKyAyKSAlIDRdOwogICAgICAgICAgaWYgKGogPT09IDApCiAgICAgICAgICAgIG5vcm1hbCA9IHJnbHdpZGdldENsYXNzLm5vcm1hbGl6ZShyZ2x3aWRnZXRDbGFzcy54cHJvZChyZ2x3aWRnZXRDbGFzcy52ZGlmZih2W2kxXSwgdltpMF0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmdsd2lkZ2V0Q2xhc3MudmRpZmYodltpMl0sIHZbaTBdKSkpOwogICAgICAgICAgcmVzdWx0Lm5vcm1hbHNbNCppICsgal0gPSBub3JtYWw7CiAgICAgICAgICBmb3IgKGs9MDsgayA8IDM7IGsrKykgewogICAgICAgICAgICByZXN1bHQudmFsdWVzW2kqMjQgKyBqKjYgKyBrXSA9IHZbaTBdW2tdOwogICAgICAgICAgICByZXN1bHQudmFsdWVzW2kqMjQgKyBqKjYgKyAzICsga10gPSBub3JtYWxba107CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZvciAoaj0wOyBqPDQ7IGorKykKICAgICAgICAgIGliW2ldW2pdID0gNCppICsgajsKICAgICAgfQogICAgICByZXN1bHQuaWIgPSBuZXcgVWludDE2QXJyYXkocmdsd2lkZ2V0Q2xhc3MuZmxhdHRlbihpYikpOwogICAgICAKICAgICAgcmVzdWx0LnZPZmZzZXRzID0ge3ZvZnM6MCwgY29mczotMSwgbm9mczozLCByYWRvZnM6LTEsIG9vZnM6LTEsCiAgICAgICAgICAgICAgICAgICAgICAgICB0b2ZzOi0xLCBuZXh0b2ZzOi0xLCBwb2ludG9mczotMSwgc3RyaWRlOjZ9OwoKICAgICAgcmVzdWx0LmYgPSBbXTsKICAgICAgcmVzdWx0LmluZGljZXMgPSB7fTsKCiAgICAgIHJlc3VsdC5jb2xvckNvdW50ID0gMTsKICAgICAgcmVzdWx0LnR5cGUgPSAicXVhZHMiOwogICAgICB0aGlzLmN1YmUgPSByZXN1bHQ7CiAgICAgIHRoaXMuaW5pdFNoYXBlR0wodGhpcy5jdWJlKTsKICAgIH07CiAgICAKCiAgICAvKioKICAgICAqIERvIHRoZSBnbCBwYXJ0IG9mIGluaXRpYWxpemluZyB0aGUgc3BoZXJlIGFuZCBjdWJlCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5pbml0U2hhcGVHTCA9IGZ1bmN0aW9uKHNoYXBlKSB7CiAgICAgIHZhciBnbCA9IHRoaXMuZ2wgfHwgdGhpcy5pbml0R0woKTsKICAgICAgaWYgKGdsLmlzQ29udGV4dExvc3QoKSkgcmV0dXJuOwogICAgICBzaGFwZS5idWYgPSBnbC5jcmVhdGVCdWZmZXIoKTsKICAgICAgZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIHNoYXBlLmJ1Zik7CiAgICAgIGdsLmJ1ZmZlckRhdGEoZ2wuQVJSQVlfQlVGRkVSLCBzaGFwZS52YWx1ZXMsIGdsLlNUQVRJQ19EUkFXKTsKICAgICAgc2hhcGUuaWJ1ZiA9IFtnbC5jcmVhdGVCdWZmZXIoKSwgZ2wuY3JlYXRlQnVmZmVyKCldOwogICAgICByZXR1cm47CiAgICB9OwoKICAgIC8qIEluaXRpYWxpemUgY29tbW9uIHNwaGVyZSBvYmplY3QgZnJvbSBzcGhlcmVzIG9iamVjdAogICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5pbml0U2hhcGVGcm9tT2JqID0gZnVuY3Rpb24oc2hhcGUsIG9iaikgewogICAgICB2YXIgaSwgcGFzcywgZiwgbW9kZSwgc2VsZiA9IHRoaXMsCiAgICAgICAgLyogVGhpcyBmdW5jdGlvbiBzZWxlY3RzIHRoaW5ncyB0aGF0IHdvdWxkIGJlCiAgICAgICAgICAgdGhlIGJhY2ssIGlnbm9yaW5nIHBlcnNwZWN0aXZlIC0tIHRoaXMgaXMgd2hhdCAKICAgICAgICAgICB3ZSB3YW50IGZvciB0aGUgYm91bmRpbmcgYm94IGRlY29yYXRpb24uICovCiAgICAgICAgaXNfYmFjayA9IGZ1bmN0aW9uKGkpIHsKICAgICAgICAgICAgICAgIHZhciBub3JtYWwgPSBbXS5jb25jYXQoc2hhcGUubm9ybWFsc1tpXSksCiAgICAgICAgICAgICAgICAgIHB0ID0gc2hhcGUudmVydGljZXNbaV07CiAgICAgICAgICAgICAgICBub3JtYWwucHVzaCgtcmdsd2lkZ2V0Q2xhc3MuZG90cHJvZChub3JtYWwsIHB0KSk7CiAgICAgICAgICAgICAgICBub3JtYWwgPSByZ2x3aWRnZXRDbGFzcy5tdWx0Vk0obm9ybWFsLCBzZWxmLm5vcm1NYXRyaXgpOwogICAgICAgICAgICAgICAgcmV0dXJuIG5vcm1hbFsyXSA8IDAgfHwgKG5vcm1hbFsyXSA9PT0gMCAmJiBub3JtYWxbMF0gPCAwKTsKICAgICAgICAgICAgICB9OyAKICAgICAgc2hhcGUub2ZzTG9jID0gb2JqLm9mc0xvYzsKICAgICAgc2hhcGUudGV4TG9jID0gb2JqLnRleExvYzsKICAgICAgc2hhcGUudGV4dHVyZSA9IG9iai50ZXh0dXJlOwogICAgICBzaGFwZS5zYW1wbGVyID0gb2JqLnNhbXBsZXI7CiAgICAgIHNoYXBlLnVGb2dNb2RlID0gb2JqLnVGb2dNb2RlOwogICAgICBzaGFwZS51Rm9nQ29sb3IgPSBvYmoudUZvZ0NvbG9yOwogICAgICBzaGFwZS51Rm9nUGFybXMgPSBvYmoudUZvZ1Bhcm1zOwogICAgICBzaGFwZS51c2VyQXR0cmliTG9jYXRpb25zID0gb2JqLnVzZXJBdHRyaWJMb2NhdGlvbnM7CiAgICAgIHNoYXBlLnVzZXJVbmlmb3JtTG9jYXRpb25zID0gb2JqLnVzZXJVbmlmb3JtTG9jYXRpb25zOwogICAgICBzaGFwZS5ub3JtTG9jID0gb2JqLm5vcm1Mb2M7CiAgICAgIHNoYXBlLmludlByTWF0TG9jID0gb2JqLmludlByTWF0TG9jOwogICAgICBzaGFwZS5jbGlwTG9jID0gb2JqLmNsaXBMb2M7CiAgICAgIHNoYXBlLm5leHRMb2MgPSBvYmoubmV4dExvYzsKICAgICAgc2hhcGUucG9pbnRMb2MgPSBvYmoucG9pbnRMb2M7CiAgICAgIHNoYXBlLmFzcGVjdExvYyA9IG9iai5hc3BlY3RMb2M7CiAgICAgIHNoYXBlLmx3ZExvYyA9IG9iai5sd2RMb2M7CiAgICAgIHNoYXBlLnByb2cgPSBvYmoucHJvZzsKICAgICAgc2hhcGUubWF0ZXJpYWwgPSBvYmoubWF0ZXJpYWw7CiAgICAgIHNoYXBlLmZsYWdzID0gb2JqLmZsYWdzOwogICAgICBzaGFwZS5kZWZGbGFncyA9IG9iai5kZWZGbGFnczsKICAgICAgc2hhcGUuc29tZUhpZGRlbiA9IG9iai5zb21lSGlkZGVuOwogICAgICBzaGFwZS5mYXN0VHJhbnNwYXJlbmN5ID0gb2JqLmZhc3RUcmFuc3BhcmVuY3k7CiAgICAgIHNoYXBlLm5saWdodHMgPSBvYmoubmxpZ2h0czsKICAgICAgc2hhcGUuZW1pc3Npb24gPSBvYmouZW1pc3Npb247CiAgICAgIHNoYXBlLmVtaXNzaW9uTG9jID0gb2JqLmVtaXNzaW9uTG9jOwogICAgICBzaGFwZS5zaGluaW5lc3MgPSBvYmouc2hpbmluZXNzOwogICAgICBzaGFwZS5zaGluaW5lc3NMb2MgPSBvYmouc2hpbmluZXNzTG9jOwogICAgICBzaGFwZS5hbWJpZW50ID0gb2JqLmFtYmllbnQ7CiAgICAgIHNoYXBlLmFtYmllbnRMb2MgPSBvYmouYW1iaWVudExvYzsKICAgICAgc2hhcGUuc3BlY3VsYXIgPSBvYmouc3BlY3VsYXI7CiAgICAgIHNoYXBlLnNwZWN1bGFyTG9jID0gb2JqLnNwZWN1bGFyTG9jOwogICAgICBzaGFwZS5kaWZmdXNlID0gb2JqLmRpZmZ1c2U7CiAgICAgIHNoYXBlLmRpZmZ1c2VMb2MgPSBvYmouZGlmZnVzZUxvYzsKICAgICAgc2hhcGUubGlnaHREaXIgPSBvYmoubGlnaHREaXI7CiAgICAgIHNoYXBlLmxpZ2h0RGlyTG9jID0gb2JqLmxpZ2h0RGlyTG9jOwogICAgICBzaGFwZS52aWV3cG9pbnQgPSBvYmoudmlld3BvaW50OwogICAgICBzaGFwZS52aWV3cG9pbnRMb2MgPSBvYmoudmlld3BvaW50TG9jOwogICAgICBzaGFwZS5maW5pdGUgPSBvYmouZmluaXRlOwogICAgICBzaGFwZS5maW5pdGVMb2MgPSBvYmouZmluaXRlTG9jOwogICAgICBzaGFwZS5wck1hdExvYyA9IG9iai5wck1hdExvYzsKICAgICAgc2hhcGUubXZNYXRMb2MgPSBvYmoubXZNYXRMb2M7CiAgICAgIHNoYXBlLm5vcm1NYXRMb2MgPSBvYmoubm9ybU1hdExvYzsKICAgICAgc2hhcGUuZnJvbnRMb2MgPSBvYmouZnJvbnRMb2M7CiAgICAgIHNoYXBlLmluZGV4X3VpbnQgPSBmYWxzZTsKICAgICAgc2hhcGUuaXNfdHJhbnNwYXJlbnQgPSBvYmouaXNfdHJhbnNwYXJlbnQ7CiAgICAgIHNoYXBlLmlnbm9yZUV4dGVudCA9IG9iai5pZ25vcmVFeHRlbnQ7CiAgICAgIGlmIChzaGFwZS5wYXNzZXMgIT09IG9iai5wYXNzZXMgfHwKICAgICAgICAgIEpTT04uc3RyaW5naWZ5KCBzaGFwZS5wbW9kZSkgIT09IEpTT04uc3RyaW5naWZ5KG9iai5wbW9kZSkpIHsKICAgICAgICBzaGFwZS5wYXNzZXMgPSBvYmoucGFzc2VzOwogICAgICAgIHNoYXBlLnBtb2RlID0gb2JqLnBtb2RlOwogICAgICAgIGZvciAocGFzcyA9IDA7IHBhc3MgPCBvYmoucGFzc2VzOyBwYXNzKyspIHsKICAgICAgICAgIG1vZGUgPSAgc2hhcGUucG1vZGVbcGFzc107CiAgICAgICAgICBpZiAodHlwZW9mICBzaGFwZS5pbmRpY2VzW21vZGVdID09PSAidW5kZWZpbmVkIikgewogICAgICAgICAgICBmID0gW107CiAgICAgICAgICAgIHN3aXRjaCAobW9kZSkgewogICAgICAgICAgICBjYXNlICJjdWxsZWQiOiBicmVhazsKICAgICAgICAgICAgY2FzZSAicG9pbnRzIjoKICAgICAgICAgICAgICBmLmxlbmd0aCA9ICBzaGFwZS52ZXJ0ZXhDb3VudDsKICAgICAgICAgICAgICBmb3IgKGk9MDsgaSA8IGYubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBmW2ldID0gaTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAibGluZXMiOgogICAgICAgICAgICAgIGlmICh0eXBlb2Ygc2hhcGUuaXQgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgICAgICBmLmxlbmd0aCA9IDIqIHNoYXBlLml0Lmxlbmd0aDsKICAgICAgCSAgICAgICAgZm9yIChpPTA7IGkgPCAgc2hhcGUuaXQubGVuZ3RoLzM7IGkrKykgewogICAgICAJICAgICAgICAgIGZbNippXSA9ICBzaGFwZS5pdFszKmldOwogICAgICAJICAgICAgICAgIGZbNippICsgMV0gPSAgc2hhcGUuaXRbMyppICsgMV07CiAgICAgIAkgICAgICAgICAgZls2KmkgKyAyXSA9ICBzaGFwZS5pdFszKmkgKyAxXTsKICAgICAgCSAgICAgICAgICBmWzYqaSArIDNdID0gIHNoYXBlLml0WzMqaSArIDJdOwogICAgICAJICAgICAgICAgIGZbNippICsgNF0gPSAgc2hhcGUuaXRbMyppICsgMl07CiAgICAgIAkgICAgICAgICAgZls2KmkgKyA1XSA9ICBzaGFwZS5pdFszKmldOwogICAgICAJICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGYubGVuZ3RoID0gMipzaGFwZS5pYi5sZW5ndGg7CiAgICAgICAgICAgICAgICBmb3IgKGk9MDsgaSA8IHNoYXBlLmliLmxlbmd0aC80OyBpKyspIHsKICAgICAgICAgICAgICAgICAgZls4KmldID0gc2hhcGUuaWJbNCppXTsKICAgICAgICAgICAgICAgICAgZls4KmkgKyAxXSA9IHNoYXBlLmliWzQqaSArIDFdOwogICAgICAgICAgICAgICAgICBmWzgqaSArIDJdID0gc2hhcGUuaWJbNCppICsgMV07CiAgICAgICAgICAgICAgICAgIGZbOCppICsgM10gPSBzaGFwZS5pYls0KmkgKyAyXTsKICAgICAgICAgICAgICAgICAgZls4KmkgKyA0XSA9IHNoYXBlLmliWzQqaSArIDJdOwogICAgICAgICAgICAgICAgICBmWzgqaSArIDVdID0gc2hhcGUuaWJbNCppICsgM107CiAgICAgICAgICAgICAgICAgIGZbOCppICsgNl0gPSBzaGFwZS5pYls0KmkgKyAzXTsKICAgICAgICAgICAgICAgICAgZls4KmkgKyA3XSA9IHNoYXBlLmliWzQqaV07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAJICAgICAgYnJlYWs7CiAgICAgIAkgICAgY2FzZSAiZmlsbGVkIjoKICAgICAgCSAgICAgIGlmICh0eXBlb2Ygc2hhcGUuaXQgIT09ICJ1bmRlZmluZWQiKQogICAgICAJICAgICAgICBmID0gIHNoYXBlLml0OwogICAgICAJICAgICAgZWxzZSBpZiAodHlwZW9mIHNoYXBlLmliICE9PSAidW5kZWZpbmVkIikgewogICAgICAJICAgICAgICBmLmxlbmd0aCA9IDEuNSpzaGFwZS5pYi5sZW5ndGg7CiAgICAgICAgICAgICAgICBmb3IgKGk9MDsgaSA8IHNoYXBlLmliLmxlbmd0aC80OyBpKyspIHsKICAgICAgICAgICAgICAgICAgZls2KmldID0gc2hhcGUuaWJbNCppXTsKICAgICAgICAgICAgICAgICAgZls2KmkrMV0gPSBzaGFwZS5pYls0KmkgKyAxXTsKICAgICAgICAgICAgICAgICAgZls2KmkrMl0gPSBzaGFwZS5pYls0KmkgKyAyXTsKICAgICAgICAgICAgICAgICAgZls2KmkrM10gPSBzaGFwZS5pYls0KmldOwogICAgICAgICAgICAgICAgICBmWzYqaSs0XSA9IHNoYXBlLmliWzQqaSArIDJdOwogICAgICAgICAgICAgICAgICBmWzYqaSs1XSA9IHNoYXBlLmliWzQqaSArIDNdOwogICAgICAgICAgICAgICAgfSAgICAgIAkgICAgICAgIAogICAgICAJICAgICAgfQogICAgICAJICAgICAgYnJlYWs7CiAgICAgIAkgICAgfSAgICAgICAgICAgICAgCiAgICAgICAgICAgIHNoYXBlLmluZGljZXNbbW9kZV0gPSBuZXcgVWludDE2QXJyYXkoZik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9ICAgICAgIAogICAgICBmb3IgKHBhc3MgPSAwOyBwYXNzIDwgb2JqLnBhc3NlczsgcGFzcysrKSB7CiAgICAgICAgbW9kZSA9ICBzaGFwZS5wbW9kZVtwYXNzXTsKICAgICAgICBzaGFwZS5mW3Bhc3NdID0gIHNoYXBlLmluZGljZXNbbW9kZV07CiAgICAgICAgaWYgKHR5cGVvZiBvYmouZHJhd19mcm9udCAhPT0gInVuZGVmaW5lZCIgJiYKICAgICAgICAgICAgIW9iai5kcmF3X2Zyb250KSB7CiAgICAgICAgICBzaGFwZS5mW3Bhc3NdID0gc2hhcGUuZltwYXNzXS5maWx0ZXIoaXNfYmFjayk7ICAgCiAgICAgICAgfQogICAgICB9CiAgICAgIC8vIGNvbnNvbGUubG9nKCJOYW1lcyBpbiAgc2hhcGVzIG5vdCBpbiAgc2hhcGU6IitKU09OLnN0cmluZ2lmeShyZ2x3aWRnZXRDbGFzcy5rZXlkaWZmKG9iaiwgIHNoYXBlKSkpOwogICAgICAgc2hhcGUuaW5pdGlhbGl6ZWQgPSB0cnVlOwogICAgfTsKCiAgICAvKioKICAgICAqIEluaXRpYWxpemUgYSBzdWJzY2VuZQogICAgICogQHBhcmFtIHsgbnVtYmVyIH0gaWQgLSBpZCBvZiBzdWJzY2VuZS4KICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmluaXRTdWJzY2VuZSA9IGZ1bmN0aW9uKGlkKSB7CiAgICAgIHZhciBzdWIgPSB0aGlzLmdldE9iaihpZCksCiAgICAgICAgICBpLCBvYmo7CgogICAgICBpZiAoc3ViLnR5cGUgIT09ICJzdWJzY2VuZSIpCiAgICAgICAgcmV0dXJuOwoKICAgICAgc3ViLnBhcjNkLnVzZXJNYXRyaXggPSB0aGlzLnRvQ2FudmFzTWF0cml4NChzdWIucGFyM2QudXNlck1hdHJpeCk7CiAgICAgIHN1Yi5wYXIzZC51c2VyUHJvamVjdGlvbiA9IHRoaXMudG9DYW52YXNNYXRyaXg0KHN1Yi5wYXIzZC51c2VyUHJvamVjdGlvbik7CiAgICAgIHN1Yi5wYXIzZC51c2VyUHJvamVjdGlvbi50cmFuc3Bvc2UoKTsKICAgICAgc3ViLnBhcjNkLmxpc3RlbmVycyA9IFtdLmNvbmNhdChzdWIucGFyM2QubGlzdGVuZXJzKTsKICAgICAgc3ViLmJhY2tncm91bmRJZCA9IHVuZGVmaW5lZDsKICAgICAgc3ViLnN1YnNjZW5lcyA9IFtdOwogICAgICBzdWIuY2xpcHBsYW5lcyA9IFtdOwogICAgICBzdWIudHJhbnNwYXJlbnQgPSBbXTsKICAgICAgc3ViLm9wYXF1ZSA9IFtdOwogICAgICBzdWIubGlnaHRzID0gW107CiAgICAgIHN1Yi5uZWVkc0JlZ2luID0gdHJ1ZTsKICAgICAgaWYgKHR5cGVvZiBzdWIub2JqZWN0cyAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgc3ViLm9iamVjdHMgPSBbXS5jb25jYXQoc3ViLm9iamVjdHMpOyAvKiBtYWtlIHN1cmUgaXQncyBhbiBhcnJheSAqLwogICAgICBmb3IgKGk9MDsgaSA8IHN1Yi5vYmplY3RzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgb2JqID0gdGhpcy5nZXRPYmooc3ViLm9iamVjdHNbaV0pOwogICAgICAgIGlmICh0eXBlb2Ygb2JqID09PSAidW5kZWZpbmVkIikgewogICAgICAgICAgc3ViLm9iamVjdHMuc3BsaWNlKGksIDEpOwogICAgICAgICAgaS0tOwogICAgICAgIH0gZWxzZSBpZiAob2JqLnR5cGUgPT09ICJiYWNrZ3JvdW5kIikKICAgICAgICAgIHN1Yi5iYWNrZ3JvdW5kSWQgPSBvYmouaWQ7CiAgICAgICAgZWxzZQogICAgICAgICAgc3ViW3RoaXMud2hpY2hMaXN0KG9iai5pZCldLnB1c2gob2JqLmlkKTsKICAgICAgfQogICAgfTsKICAgIAogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmluaXRCQm94ID0gZnVuY3Rpb24ob2JqKSB7CiAgICAgIGlmICghdGhpcy5jdWJlKQogICAgICAgIHRoaXMuaW5pdEN1YmUoKTsKICAgICAgb2JqLmN1YmUgPSB7aWQ6IG9iai5pZCArIDAuMSwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAicXVhZHMiLAogICAgICAgICAgICAgICAgICAgIGZsYWdzOiBvYmouZmxhZ3MsCiAgICAgICAgICAgICAgICAgICAgbWF0ZXJpYWw6IG9iai5tYXRlcmlhbCwKICAgICAgICAgICAgICAgICAgICBjb2xvcnM6IFtvYmouY29sb3JzWzBdXSwKICAgICAgICAgICAgICAgICAgICB2ZXJ0aWNlczogdGhpcy5jdWJlLnZlcnRpY2VzLAogICAgICAgICAgICAgICAgICAgIG5vcm1hbHM6IHRoaXMuY3ViZS5ub3JtYWxzLAogICAgICAgICAgICAgICAgICAgIGRyYXdfZnJvbnQ6IG9iai5kcmF3X2Zyb250LAogICAgICAgICAgICAgICAgICAgIGluaXRpYWxpemVkOiBmYWxzZQogICAgICAgIH07CiAgICAgIGlmICh0aGlzLmdldE1hdGVyaWFsKG9iai5jdWJlLCAiZnJvbnQiKSAhPT0KICAgICAgICAgIHRoaXMuZ2V0TWF0ZXJpYWwob2JqLmN1YmUsICJiYWNrIikpCiAgICAgICAgLyoganNoaW50IGJpdHdpc2U6IGZhbHNlICovICAKICAgICAgICBvYmouY3ViZS5mbGFncyB8PSByZ2x3aWRnZXRDbGFzcy5mX2lzX3R3b3NpZGVkOwogICAgICAgIC8qIGpzaGludCBiaXR3aXNlOiB0cnVlICovCiAgICAgIHRoaXMuc2NlbmUub2JqZWN0c1tvYmouY3ViZS5pZF0gPSBvYmouY3ViZTsKICAgICAgb2JqLnRpY2tzID0ge2lkOiBvYmouaWQgKyAwLjIsCiAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJsaW5lcyIsCiAgICAgICAgICAgICAgICAgICAgIGZsYWdzOiByZ2x3aWRnZXRDbGFzcy5mX2hhc19mb2csCiAgICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsOiBvYmoubWF0ZXJpYWwsCiAgICAgICAgICAgICAgICAgICAgIGNvbG9yczogKG9iai5jb2xvcnMubGVuZ3RoID4gMSA/IFtvYmouY29sb3JzWzFdXSA6IFtvYmouY29sb3JzWzBdXSksCiAgICAgICAgICAgICAgICAgICAgIGF4ZXM6IG9iai5heGVzLAogICAgICAgICAgICAgICAgICAgICBpbml0aWFsaXplZDogZmFsc2UKICAgICAgfTsKICAgICAgdGhpcy5zY2VuZS5vYmplY3RzW29iai50aWNrcy5pZF0gPSBvYmoudGlja3M7CiAgICAgIG9iai5sYWJlbHMgPSB7aWQ6IG9iai5pZCArIDAuMywKICAgICAgICAgICAgICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAgICAgICAgICAgICAgICBmbGFnczogcmdsd2lkZ2V0Q2xhc3MuZl9oYXNfZm9nICsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZ2x3aWRnZXRDbGFzcy5mX2ZpeGVkX3NpemUgKyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJnbHdpZGdldENsYXNzLmZfZml4ZWRfcXVhZHMsCiAgICAgICAgICAgICAgICAgICAgIG1hdGVyaWFsOiB7bGl0OiBmYWxzZX0sCiAgICAgICAgICAgICAgICAgICAgIGNvbG9yczogKG9iai5jb2xvcnMubGVuZ3RoID4gMSA/IFtvYmouY29sb3JzWzFdXSA6IFtvYmouY29sb3JzWzBdXSksCiAgICAgICAgICAgICAgICAgICAgIGNleDogW1sxXV0sCiAgICAgICAgICAgICAgICAgICAgIGZhbWlseTogW1sic2FucyJdXSwKICAgICAgICAgICAgICAgICAgICAgZm9udDogW1sxXV0sCiAgICAgICAgICAgICAgICAgICAgIGFkajogW1swLjUsIDAuNSwgMC41XV0sCiAgICAgICAgICAgICAgICAgICAgIGlnbm9yZUV4dGVudDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgaW5pdGlhbGl6ZWQ6IGZhbHNlCiAgICAgIH07CiAgICAgIHRoaXMuc2NlbmUub2JqZWN0c1tvYmoubGFiZWxzLmlkXSA9IG9iai5sYWJlbHM7CiAgICAgIG9iai5pbml0aWFsaXplZCA9IHRydWU7CiAgICB9OwogICAgCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuaW5pdEJhY2tncm91bmQgPSBmdW5jdGlvbihvYmopIHsKICAgICAgdmFyIG1hdGVyaWFsLCBmbCA9IG9iai5kZWZGbGFnczsKICAgICAgaWYgKHR5cGVvZiBvYmouaWRzICE9PSAidW5kZWZpbmVkIikKICAgICAgICBvYmoucXVhZCA9IHJnbHdpZGdldENsYXNzLmZsYXR0ZW4oW10uY29uY2F0KG9iai5pZHMpKTsKICAgICAgZWxzZSBpZiAob2JqLnNwaGVyZSkgewogICAgICAgIGZsLmhhc19ub3JtYWxzID0gdHJ1ZTsKICAgICAgICBmbC5uZWVkc192bm9ybWFsID0gdHJ1ZTsKICAgICAgICBvYmouZGVmRmxhZ3MgPSBmbDsKICAgICAgICBtYXRlcmlhbCA9IG9iai5tYXRlcmlhbDsKICAgICAgICBtYXRlcmlhbC5mcm9udCA9ICJjdWxsZWQiOwogICAgICAgIG9iai52ZXJ0aWNlcyA9IFtbMCwwLDBdXTsKICAgICAgICBvYmoudGV4Y29vcmRzID0gW1swLDBdXTsKICAgICAgfSAgCiAgICB9OwoKICAgIC8qKgogICAgICogSW5pdGlhbGl6ZSBvYmplY3QgZm9yIGRpc3BsYXkKICAgICAqIEBwYXJhbSB7IG51bWJlciB9IGlkIC0gaWQgb2Ygb2JqZWN0IHRvIGluaXRpYWxpemUKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmluaXRPYmpJZCA9IGZ1bmN0aW9uKGlkKSB7CiAgICAgIGlmICh0eXBlb2YgaWQgIT09ICJudW1iZXIiKSB7CiAgICAgICAgdGhpcy5hbGVydE9uY2UoImluaXRPYmogaWQgaXMgIit0eXBlb2YgaWQpOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmluaXRPYmoodGhpcy5nZXRPYmooaWQpKTsKICAgIH07CgogICAgLyoqCiAgICAgKiBJbml0aWFsaXplIG9iamVjdCBmb3IgZGlzcGxheQogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gb2JqIC0gb2JqZWN0IHRvIGluaXRpYWxpemUKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmluaXRPYmogPSBmdW5jdGlvbihvYmopIHsKICAgICAgdmFyIHR5cGUgPSBvYmoudHlwZSwgCiAgICAgICAgICBmbGFncyA9IG9iai5mbGFncywKICAgICAgICAgIG5vcm1hbHMgPSBvYmoubm9ybWFscywKICAgICAgICAgIHJvdW5kX3BvaW50cyA9ICh0eXBlb2Ygb2JqLm1hdGVyaWFsID09PSAidW5kZWZpbmVkIikgPwogICAgICAgICAgICBmYWxzZSA6IHRoaXMuZ2V0TWF0ZXJpYWwob2JqLCAicG9pbnRfYW50aWFsaWFzIiksCiAgICAgICAgICBoYXNfaW5kaWNlcyA9IHR5cGVvZiBvYmouaW5kaWNlcyAhPT0gInVuZGVmaW5lZCIsCiAgICAgICAgICBoYXNfc3BoZXJlcyA9IHR5cGUgPT09ICJzcGhlcmVzIiB8fCAKICAgICAgICAgICAgICAgICAgICAgICAgKHR5cGUgPT09ICJiYWNrZ3JvdW5kIiAmJiBvYmouc3BoZXJlKSwKICAgICAgICAgIHNwcml0ZXNfM2QgPSByZ2x3aWRnZXRDbGFzcy5pc1NldChmbGFncywgcmdsd2lkZ2V0Q2xhc3MuZl9zcHJpdGVzXzNkKSwKICAgICAgICAgIGRlcHRoX3NvcnQgPSByZ2x3aWRnZXRDbGFzcy5pc1NldChmbGFncywgcmdsd2lkZ2V0Q2xhc3MuZl9kZXB0aF9zb3J0KSwKICAgICAgICAgIGdsID0gdGhpcy5nbCB8fCB0aGlzLmluaXRHTCgpLAogICAgICAgICAgZmwsIHBvbHlnb25fb2Zmc2V0LAogICAgICAgICAgdGV4aW5mbywgZHJhd3R5cGUsIG5jbGlwcGxhbmVzLCBmLCBucm93cywgb2xkcm93cywKICAgICAgICAgIGksaix2LHYxLHYyLCBtYXQsIHVyaSwgbWF0b2JqLCBwYXNzLCBwbW9kZSwKICAgICAgICAgIGRpbSwgbngsIG56LCBucm93LCBzaGFkZXJzOwoKICAgIG9iai5pbml0aWFsaXplZCA9IHRydWU7CiAgICAKICAgIG9iai5zb21lSGlkZGVuID0gZmFsc2U7IC8vIHVzZWQgaW4gc2VsZWN0aW9uCiAgICAKICAgIHRoaXMuZXhwYW5kQnVmZmVyZWRGaWVsZHMob2JqKTsKICAgIAogICAgaWYgKHR5cGUgPT09ICJzdWJzY2VuZSIpCiAgICAgIHJldHVybjsKICAgICAgCiAgICBvYmouZGVmRmxhZ3MgPSBmbCA9IHJnbHdpZGdldENsYXNzLmdldERlZkZsYWdzKGZsYWdzLCB0eXBlLCBub3JtYWxzLCByb3VuZF9wb2ludHMpOwogIAogICAgb2JqLmlzX3RyYW5zcGFyZW50ID0gZmwuaXNfdHJhbnNwYXJlbnQ7CiAgCiAgICBpZiAodHlwZSA9PT0gImJib3hkZWNvIikKICAgICAgcmV0dXJuIHRoaXMuaW5pdEJCb3gob2JqKTsKICAgICAgCiAgICBpZiAoaGFzX3NwaGVyZXMgJiYgdHlwZW9mIHRoaXMuc3BoZXJlID09PSAidW5kZWZpbmVkIikKICAgICAgdGhpcy5pbml0U3BoZXJlKDE2LCAxNik7CgogICAgaWYgKHR5cGUgPT09ICJsaWdodCIpIHsKICAgICAgb2JqLmFtYmllbnQgPSBuZXcgRmxvYXQzMkFycmF5KG9iai5jb2xvcnNbMF0uc2xpY2UoMCwzKSk7CiAgICAgIG9iai5kaWZmdXNlID0gbmV3IEZsb2F0MzJBcnJheShvYmouY29sb3JzWzFdLnNsaWNlKDAsMykpOwogICAgICBvYmouc3BlY3VsYXIgPSBuZXcgRmxvYXQzMkFycmF5KG9iai5jb2xvcnNbMl0uc2xpY2UoMCwzKSk7CiAgICAgIG9iai5saWdodERpciA9IG5ldyBGbG9hdDMyQXJyYXkob2JqLnZlcnRpY2VzWzBdKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICh0eXBlID09PSAiY2xpcHBsYW5lcyIpIHsKICAgICAgb2JqLnZDbGlwcGxhbmUgPSByZ2x3aWRnZXRDbGFzcy5mbGF0dGVuKHJnbHdpZGdldENsYXNzLmNiaW5kKG9iai5ub3JtYWxzLCBvYmoub2Zmc2V0cykpOwogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKHR5cGUgPT09ICJiYWNrZ3JvdW5kIikgewogICAgICB0aGlzLmluaXRCYWNrZ3JvdW5kKG9iaik7CiAgICAgIGlmICghb2JqLnNwaGVyZSkKICAgICAgICByZXR1cm47CiAgICB9CgogICAgcG9seWdvbl9vZmZzZXQgPSB0aGlzLmdldE1hdGVyaWFsKG9iaiwgInBvbHlnb25fb2Zmc2V0Iik7CiAgICBpZiAocG9seWdvbl9vZmZzZXRbMF0gIT09IDAgfHwgcG9seWdvbl9vZmZzZXRbMV0gIT09IDApCiAgICAgIG9iai5wb2x5Z29uX29mZnNldCA9IHBvbHlnb25fb2Zmc2V0OwoKICAgIGlmIChmbC5pc190cmFuc3BhcmVudCkgewogICAgICBkZXB0aF9zb3J0ID0gWyJ0cmlhbmdsZXMiLCAicXVhZHMiLCAic3VyZmFjZSIsCiAgICAgICAgICAgICAgICAgICAgInNwaGVyZXMiLCAic3ByaXRlcyIsICJ0ZXh0IiwKICAgICAgICAgICAgICAgICAgICAicGxhbmVzIl0uaW5kZXhPZih0eXBlKSA+PSAwOwogICAgfQogICAgCiAgICBpZiAoZmwuaXNfYnJ1c2gpCiAgICAgIHRoaXMuaW5pdFNlbGVjdGlvbihvYmouaWQpOwoKICAgIGlmICh0eXBlb2Ygb2JqLnZlcnRpY2VzID09PSAidW5kZWZpbmVkIikKICAgICAgb2JqLnZlcnRpY2VzID0gW107CgogICAgdiA9IG9iai52ZXJ0aWNlczsKICAgIGlmIChoYXNfaW5kaWNlcykKICAgICAgb2JqLnZlcnRleENvdW50ID0gb2JqLmluZGljZXMubGVuZ3RoOwogICAgZWxzZQogICAgICBvYmoudmVydGV4Q291bnQgPSB2Lmxlbmd0aDsKICAgICAgCiAgICBpZiAoIW9iai52ZXJ0ZXhDb3VudCkgcmV0dXJuOwoKICAgIGlmIChmbC5pc190d29zaWRlZCAmJiAhZmwuaGFzX25vcm1hbHMgJiYgdHlwZSAhPT0gImJhY2tncm91bmQiKSB7CiAgICAgIGlmICh0eXBlb2Ygb2JqLnVzZXJBdHRyaWJ1dGVzID09PSAidW5kZWZpbmVkIikKICAgICAgICBvYmoudXNlckF0dHJpYnV0ZXMgPSB7fTsKICAgICAgdjEgPSBBcnJheSh2Lmxlbmd0aCk7CiAgICAgIHYyID0gQXJyYXkodi5sZW5ndGgpOwogICAgICBpZiAob2JqLnR5cGUgPT09ICJ0cmlhbmdsZXMiIHx8IG9iai50eXBlID09PSAicXVhZHMiKSB7CiAgICAgIAlpZiAob2JqLnR5cGUgPT09ICJ0cmlhbmdsZXMiKQogICAgICAJICBucm93ID0gMzsKICAgICAgCWVsc2UKICAgICAgCSAgbnJvdyA9IDQ7CiAgICAgICAgZm9yIChpPTA7IGk8TWF0aC5mbG9vcih2Lmxlbmd0aC9ucm93KTsgaSsrKQogICAgICAgICAgZm9yIChqPTA7IGo8bnJvdzsgaisrKSB7CiAgICAgICAgICAgIHYxW25yb3cqaSArIGpdID0gdltucm93KmkgKyAoKGorMSkgJSBucm93KV07CiAgICAgICAgICAgIHYyW25yb3cqaSArIGpdID0gdltucm93KmkgKyAoKGorMikgJSBucm93KV07CiAgICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAob2JqLnR5cGUgPT09ICJzdXJmYWNlIikgewogICAgICAgIGRpbSA9IG9iai5kaW1bMF07CiAgICAgICAgbnggPSBkaW1bMF07CiAgICAgICAgbnogPSBkaW1bMV07CiAgICAgICAgZm9yIChqPTA7IGo8bng7IGorKykgewogICAgICAgICAgZm9yIChpPTA7IGk8bno7IGkrKykgewogICAgICAgICAgICBpZiAoaSsxIDwgbnogJiYgaisxIDwgbngpIHsKICAgICAgICAgICAgICB2MltqICsgbngqaV0gPSB2W2ogKyBueCooaSsxKV07CiAgICAgICAgICAgICAgdjFbaiArIG54KmldID0gdltqKzEgKyBueCooaSsxKV07CiAgICAgICAgICAgIH0gZWxzZSBpZiAoaSsxIDwgbnopIHsKICAgICAgICAgICAgICB2MltqICsgbngqaV0gPSB2W2otMSArIG54KmldOwogICAgICAgICAgICAgIHYxW2ogKyBueCppXSA9IHZbaiArIG54KihpKzEpXTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB2MltqICsgbngqaV0gPSB2W2ogKyBueCooaS0xKV07CiAgICAgICAgICAgICAgdjFbaiArIG54KmldID0gdltqLTEgKyBueCooaS0xKV07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgb2JqLnVzZXJBdHRyaWJ1dGVzLmFQb3MxID0gdjE7CiAgICAgIG9iai51c2VyQXR0cmlidXRlcy5hUG9zMiA9IHYyOwogICAgfQoKICAgIGlmICghc3ByaXRlc18zZCkgewogICAgICBpZiAoZ2wuaXNDb250ZXh0TG9zdCgpKSByZXR1cm47CiAgICAgIGlmICh0eXBlb2Ygb2JqLnByb2cgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgZ2wuZGVsZXRlUHJvZ3JhbShvYmoucHJvZyk7CiAgICAgICAgb2JqLnByb2cgPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgICAgCiAgICAgIHNoYWRlcnMgPSB0aGlzLmdldFNoYWRlcnMob2JqKTsKICAgICAgCiAgICAgIG9iai5wcm9nID0gZ2wuY3JlYXRlUHJvZ3JhbSgpOwogICAgICBnbC5hdHRhY2hTaGFkZXIob2JqLnByb2csIHRoaXMuZ2V0U2hhZGVyKCBnbC5WRVJURVhfU0hBREVSLAogICAgICAgICAgICAgICAgICAgICAgc2hhZGVycy52ZXJ0ZXggKSk7CiAgICAgIGdsLmF0dGFjaFNoYWRlcihvYmoucHJvZywgdGhpcy5nZXRTaGFkZXIoIGdsLkZSQUdNRU5UX1NIQURFUiwKICAgICAgICAgICAgICAgICAgICAgIHNoYWRlcnMuZnJhZ21lbnQgKSk7CiAgICAgIC8vICBGb3JjZSBhUG9zIHRvIGxvY2F0aW9uIDAsIGFDb2wgdG8gbG9jYXRpb24gMQogICAgICBnbC5iaW5kQXR0cmliTG9jYXRpb24ob2JqLnByb2csIDAsICJhUG9zIik7CiAgICAgIGdsLmJpbmRBdHRyaWJMb2NhdGlvbihvYmoucHJvZywgMSwgImFDb2wiKTsKICAgICAgZ2wubGlua1Byb2dyYW0ob2JqLnByb2cpOwogICAgICB2YXIgbGlua2VkID0gZ2wuZ2V0UHJvZ3JhbVBhcmFtZXRlcihvYmoucHJvZywgZ2wuTElOS19TVEFUVVMpOwogICAgICBpZiAoIWxpbmtlZCkgewoKICAgICAgICAvLyBBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBsaW5raW5nCiAgICAgICAgdmFyIGxhc3RFcnJvciA9IGdsLmdldFByb2dyYW1JbmZvTG9nKG9iai5wcm9nKTsKICAgICAgICBjb25zb2xlLndhcm4oIkVycm9yIGluIHByb2dyYW0gbGlua2luZzoiICsgbGFzdEVycm9yKTsKCiAgICAgICAgZ2wuZGVsZXRlUHJvZ3JhbShvYmoucHJvZyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9CgogICAgaWYgKHR5cGUgPT09ICJ0ZXh0IikgewogICAgICB0ZXhpbmZvID0gdGhpcy5kcmF3VGV4dFRvQ2FudmFzKG9iai50ZXh0cywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZ2x3aWRnZXRDbGFzcy5mbGF0dGVuKG9iai5jZXgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJnbHdpZGdldENsYXNzLmZsYXR0ZW4ob2JqLmZhbWlseSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmdsd2lkZ2V0Q2xhc3MuZmxhdHRlbihvYmouZmFtaWx5KSk7CiAgICB9CgogICAgaWYgKGZsLmZpeGVkX3F1YWRzICYmICFzcHJpdGVzXzNkKSB7CiAgICAgIG9iai5vZnNMb2MgPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihvYmoucHJvZywgImFPZnMiKTsKICAgIH0KCiAgICBpZiAoZmwuaGFzX3RleHR1cmUgfHwgdHlwZSA9PT0gInRleHQiKSB7CiAgICAgIGlmICghb2JqLnRleHR1cmUpIHsKICAgICAgICBvYmoudGV4dHVyZSA9IGdsLmNyZWF0ZVRleHR1cmUoKTsKICAgICAgICAvLyBUaGlzIGlzIGEgdHJpY2sgZnJvbSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTk3NDg5MDUvMjU1NDMzMCB0byBhdm9pZCB3YXJuaW5ncwogICAgICAgIGdsLmJpbmRUZXh0dXJlKGdsLlRFWFRVUkVfMkQsIG9iai50ZXh0dXJlKTsKICAgICAgICBnbC50ZXhJbWFnZTJEKGdsLlRFWFRVUkVfMkQsIDAsIGdsLlJHQkEsIDEsIDEsIDAsIGdsLlJHQkEsIGdsLlVOU0lHTkVEX0JZVEUsCiAgICAgICAgICAgICAgbmV3IFVpbnQ4QXJyYXkoWzI1NSwyNTUsMjU1LCAyNTVdKSk7IC8vIHdoaXRlCiAgICAgIH0KICAgICAgb2JqLnRleExvYyA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKG9iai5wcm9nLCAiYVRleGNvb3JkIik7CiAgICAgIG9iai5zYW1wbGVyID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKG9iai5wcm9nLCAidVNhbXBsZXIiKTsKICAgIH0KICAgIAogICAgaWYgKGZsLmhhc19mb2cgJiYgIXNwcml0ZXNfM2QpIHsKICAgICAgb2JqLnVGb2dNb2RlID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKG9iai5wcm9nLCAidUZvZ01vZGUiKTsKICAgICAgb2JqLnVGb2dDb2xvciA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihvYmoucHJvZywgInVGb2dDb2xvciIpOwogICAgICBvYmoudUZvZ1Bhcm1zID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKG9iai5wcm9nLCAidUZvZ1Bhcm1zIik7CiAgICB9CgogICAgaWYgKGZsLmhhc190ZXh0dXJlKSB7CiAgICAgIG1hdCA9IG9iai5tYXRlcmlhbDsKICAgICAgaWYgKHR5cGVvZiBtYXQudXJpICE9PSAidW5kZWZpbmVkIikKICAgICAgICB1cmkgPSBtYXQudXJpOwogICAgICBlbHNlIGlmICh0eXBlb2YgbWF0LnVyaUVsZW1lbnRJZCA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICBtYXRvYmogPSB0aGlzLmdldE9iaihtYXQudXJpSWQpOwogICAgICAgIGlmICh0eXBlb2YgbWF0b2JqICE9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgdXJpID0gbWF0b2JqLm1hdGVyaWFsLnVyaTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdXJpID0gIiI7CiAgICAgICAgfQogICAgICB9IGVsc2UKICAgICAgICB1cmkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChtYXQudXJpRWxlbWVudElkKS5yZ2xpbnN0YW5jZS5nZXRPYmoobWF0LnVyaUlkKS5tYXRlcmlhbC51cmk7CgogICAgICB0aGlzLmxvYWRJbWFnZVRvVGV4dHVyZSh1cmksIG9iai50ZXh0dXJlKTsKICAgIH0KCiAgICBpZiAodHlwZSA9PT0gInRleHQiKSB7CiAgICAgIHRoaXMuaGFuZGxlTG9hZGVkVGV4dHVyZShvYmoudGV4dHVyZSwgdGhpcy50ZXh0dXJlQ2FudmFzKTsKICAgIH0KCiAgICB2YXIgc3RyaWRlID0gMywgbmMsIGNvZnMsIG5vZnMsIHJhZG9mcywgb29mcywgdG9mcywgdm5ldywgZm5ldywKICAgICAgICBuZXh0b2ZzID0gLTEsIHBvaW50b2ZzID0gLTEsIGFsaWFzLCBjb2xvcnMsIGtleSwgc2VsZWN0aW9uLAogICAgICAgIGZpbHRlciwgYWRqLCBvZmZzZXQsIGF0dHIsIGxhc3QsIG9wdGlvbnMsIAogICAgICAgIGxlbiwgY3VycmVudDsKCiAgICBvYmouYWxpYXMgPSB1bmRlZmluZWQ7CiAgICAKICAgIGNvbG9ycyA9IG9iai5jb2xvcnM7CgogICAgaiA9IHRoaXMuc2NlbmUuY3Jvc3N0YWxrLmlkLmluZGV4T2Yob2JqLmlkKTsKICAgIGlmIChqID49IDApIHsKICAgICAga2V5ID0gdGhpcy5zY2VuZS5jcm9zc3RhbGsua2V5W2pdOwogICAgICBvcHRpb25zID0gdGhpcy5zY2VuZS5jcm9zc3RhbGsub3B0aW9uc1tqXTsKICAgICAgY29sb3JzID0gY29sb3JzLnNsaWNlKDApOyAKICAgICAgZm9yIChpID0gMDsgaSA8IHYubGVuZ3RoOyBpKyspCiAgICAgICAgY29sb3JzW2ldID0gb2JqLmNvbG9yc1tpICUgb2JqLmNvbG9ycy5sZW5ndGhdLnNsaWNlKDApOwogICAgICBpZiAoIChzZWxlY3Rpb24gPSB0aGlzLnNjZW5lLmNyb3NzdGFsay5zZWxlY3Rpb24pICYmCiAgICAgICAgICAgKHNlbGVjdGlvbi5sZW5ndGggfHwgIW9wdGlvbnMuc2VsZWN0ZWRJZ25vcmVOb25lKSApCiAgICAgICAgZm9yIChpID0gMDsgaSA8IHYubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGlmICghc2VsZWN0aW9uLmluY2x1ZGVzKGtleVtpXSkpIHsKICAgICAgICAgICAgaWYgKG9wdGlvbnMuZGVzZWxlY3RlZENvbG9yKQogICAgICAgICAgICAgIGNvbG9yc1tpXSA9IG9wdGlvbnMuZGVzZWxlY3RlZENvbG9yLnNsaWNlKDApOwogICAgICAgICAgICBjb2xvcnNbaV1bM10gPSBjb2xvcnNbaV1bM10qb3B0aW9ucy5kZXNlbGVjdGVkRmFkZTsgICAvKiBkZWZhdWx0OiBtb3N0bHkgdHJhbnNwYXJlbnQgaWYgbm90IHNlbGVjdGVkICovCiAgICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMuc2VsZWN0ZWRDb2xvcikKICAgICAgICAgICAgY29sb3JzW2ldID0gb3B0aW9ucy5zZWxlY3RlZENvbG9yLnNsaWNlKDApOwogICAgICAgIH0KICAgICAgaWYgKCAoZmlsdGVyID0gdGhpcy5zY2VuZS5jcm9zc3RhbGsuZmlsdGVyKSApCiAgICAgICAgZm9yIChpID0gMDsgaSA8IHYubGVuZ3RoOyBpKyspIAogICAgICAgICAgaWYgKCFmaWx0ZXIuaW5jbHVkZXMoa2V5W2ldKSkgewogICAgICAgICAgICBpZiAob3B0aW9ucy5maWx0ZXJlZENvbG9yKQogICAgICAgICAgICAgIGNvbG9yc1tpXSA9IG9wdGlvbnMuZmlsdGVyZWRDb2xvci5zbGljZSgwKTsKICAgICAgICAgICAgY29sb3JzW2ldWzNdID0gY29sb3JzW2ldWzNdKm9wdGlvbnMuZmlsdGVyZWRGYWRlOyAgIC8qIGRlZmF1bHQ6IGNvbXBsZXRlbHkgaGlkZGVuIGlmIGZpbHRlcmVkICovCiAgICAgICAgICB9CiAgICB9ICAKICAgIAogICAgbmMgPSBvYmouY29sb3JDb3VudCA9IGNvbG9ycy5sZW5ndGg7CiAgICBpZiAobmMgPiAxKSB7CiAgICAgIGNvZnMgPSBzdHJpZGU7CiAgICAgIHN0cmlkZSA9IHN0cmlkZSArIDQ7CiAgICAgIHYgPSByZ2x3aWRnZXRDbGFzcy5jYmluZCh2LCBjb2xvcnMpOwogICAgfSBlbHNlIHsKICAgICAgY29mcyA9IC0xOwogICAgICBvYmoub25lY29sb3IgPSByZ2x3aWRnZXRDbGFzcy5mbGF0dGVuKGNvbG9ycyk7CiAgICB9CgogICAgaWYgKGZsLmhhc19ub3JtYWxzICYmICFoYXNfc3BoZXJlcykgewogICAgICBub2ZzID0gc3RyaWRlOwogICAgICBzdHJpZGUgPSBzdHJpZGUgKyAzOwogICAgICB2ID0gcmdsd2lkZ2V0Q2xhc3MuY2JpbmQodiwgdHlwZW9mIG9iai5wbm9ybWFscyAhPT0gInVuZGVmaW5lZCIgPyBvYmoucG5vcm1hbHMgOiBvYmoubm9ybWFscyk7CiAgICB9IGVsc2UKICAgICAgbm9mcyA9IC0xOwoKICAgIGlmICh0eXBlb2Ygb2JqLnJhZGlpICE9PSAidW5kZWZpbmVkIikgewogICAgICByYWRvZnMgPSBzdHJpZGU7CiAgICAgIHN0cmlkZSA9IHN0cmlkZSArIDE7CiAgICAgIC8vIEZJWE1FOiAgYWx3YXlzIGNvbmNhdCB0aGUgcmFkaWk/CiAgICAgIGlmIChvYmoucmFkaWkubGVuZ3RoID09PSB2Lmxlbmd0aCkgewogICAgICAgIHYgPSByZ2x3aWRnZXRDbGFzcy5jYmluZCh2LCBvYmoucmFkaWkpOwogICAgICB9IGVsc2UgaWYgKG9iai5yYWRpaS5sZW5ndGggPT09IDEpIHsKICAgICAgICB2ID0gdi5tYXAoZnVuY3Rpb24ocm93KSB7IHJldHVybiByb3cuY29uY2F0KG9iai5yYWRpaVswXSk7fSk7CiAgICAgIH0KICAgIH0gZWxzZQogICAgICByYWRvZnMgPSAtMTsKICAgICAgCiAgICAvLyBBZGQgZGVmYXVsdCBpbmRpY2VzCiAgICBpZiAoaGFzX2luZGljZXMpIHsKICAgICAgZiA9IEFycmF5KG9iai5pbmRpY2VzLmxlbmd0aCk7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBmLmxlbmd0aDsgaSsrKQogICAgICAgIGZbaV0gPSBvYmouaW5kaWNlc1tpXSAtIDE7CiAgICB9IGVsc2UgewogICAgICBmID0gQXJyYXkodi5sZW5ndGgpOwogICAgICBmb3IgKGkgPSAwOyBpIDwgdi5sZW5ndGg7IGkrKykKICAgICAgICBmW2ldID0gaTsKICAgIH0KICAgIG9iai5mID0gW2YsZl07CgogICAgaWYgKHR5cGUgPT09ICJzcHJpdGVzIiAmJiAhc3ByaXRlc18zZCkgewogICAgICB0b2ZzID0gc3RyaWRlOwogICAgICBzdHJpZGUgKz0gMjsKICAgICAgb29mcyA9IHN0cmlkZTsKICAgICAgc3RyaWRlICs9IDM7CiAgICAgIHZuZXcgPSBuZXcgQXJyYXkoNCp2Lmxlbmd0aCk7CiAgICAgIGZuZXcgPSBuZXcgQXJyYXkoNCp2Lmxlbmd0aCk7CiAgICAgIGFsaWFzID0gbmV3IEFycmF5KHYubGVuZ3RoKTsKICAgICAgdmFyIHJlc2NhbGUgPSBmbC5maXhlZF9zaXplID8gNzIgOiAxLAogICAgICAgICAgc2l6ZSA9IG9iai5yYWRpaSwgcyA9IHJlc2NhbGUqc2l6ZVswXS8yOwogICAgICBsYXN0ID0gdi5sZW5ndGg7CiAgICAgIGYgPSBvYmouZlswXTsKICAgICAgb2JqLmFkaiA9IHJnbHdpZGdldENsYXNzLmZsYXR0ZW4ob2JqLmFkaik7CiAgICAgIGlmICh0eXBlb2Ygb2JqLnBvcyAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICBvYmoucG9zID0gcmdsd2lkZ2V0Q2xhc3MuZmxhdHRlbihvYmoucG9zKTsKICAgICAgICBvZmZzZXQgPSBvYmouYWRqWzBdOwogICAgICB9IGVsc2UKICAgICAgICBvZmZzZXQgPSAwOwogICAgICBmb3IgKGk9MDsgaSA8IHYubGVuZ3RoOyBpKyspIHsKICAgICAgICBhZGogPSB0aGlzLmdldEFkaihvYmosIGksIG9mZnNldCk7CiAgICAgICAgaWYgKHNpemUubGVuZ3RoID4gMSkKICAgICAgICAgIHMgPSByZXNjYWxlKnNpemVbaV0vMjsKICAgICAgICBhZGpbMF0gPSAyKnMqKGFkalswXSAtIDAuNSk7CiAgICAgICAgYWRqWzFdID0gMipzKihhZGpbMV0gLSAwLjUpOwogICAgICAgIGFkalsyXSA9IDIqcyooYWRqWzJdIC0gMC41KTsKICAgICAgICB2bmV3W2ldICA9IHZbaV0uY29uY2F0KFswLDBdKS5jb25jYXQoWy1zLWFkalswXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1zLWFkalsxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1hZGpbMl1dKTsKICAgICAgICBmbmV3WzQqaV0gPSBmW2ldOwogICAgICAgIHZuZXdbbGFzdF09IHZbaV0uY29uY2F0KFsxLDBdKS5jb25jYXQoW3MtYWRqWzBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLXMtYWRqWzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLWFkalsyXV0pOwogICAgICAgIGZuZXdbNCppKzFdID0gbGFzdCsrOwogICAgICAgIHZuZXdbbGFzdF09IHZbaV0uY29uY2F0KFsxLDFdKS5jb25jYXQoW3MtYWRqWzBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHMtYWRqWzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC1hZGpbMl1dKTsKICAgICAgICBmbmV3WzQqaSsyXSA9IGxhc3QrKzsKICAgICAgICB2bmV3W2xhc3RdPSB2W2ldLmNvbmNhdChbMCwxXSkuY29uY2F0KFstcy1hZGpbMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHMtYWRqWzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtYWRqWzJdXSk7CiAgICAgICAgZm5ld1s0KmkrM10gPSBsYXN0Kys7CiAgICAgICAgYWxpYXNbaV0gPSBbbGFzdC0zLCBsYXN0LTIsIGxhc3QtMV07CiAgICAgIH0KICAgICAgdiA9IHZuZXc7CiAgICAgIG9iai52ZXJ0ZXhDb3VudCA9IHYubGVuZ3RoOwogICAgICBvYmouZiA9IFtmbmV3LCBmbmV3XTsKICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gInRleHQiKSB7CiAgICAgIHRvZnMgPSBzdHJpZGU7CiAgICAgIHN0cmlkZSArPSAyOwogICAgICBvb2ZzID0gc3RyaWRlOwogICAgICBzdHJpZGUgKz0gMzsKICAgICAgdm5ldyA9IG5ldyBBcnJheSg0KnYubGVuZ3RoKTsKICAgICAgZiA9IG9iai5mWzBdOwogICAgICBmbmV3ID0gbmV3IEFycmF5KDQqZi5sZW5ndGgpOwogICAgICBhbGlhcyA9IG5ldyBBcnJheSh2Lmxlbmd0aCk7CiAgICAgIGxhc3QgPSB2Lmxlbmd0aDsKICAgICAgYWRqID0gcmdsd2lkZ2V0Q2xhc3MuZmxhdHRlbihvYmouYWRqKTsKICAgICAgaWYgKHR5cGVvZiBvYmoucG9zICE9PSAidW5kZWZpbmVkIikgewogICAgICAgIG9iai5wb3MgPSByZ2x3aWRnZXRDbGFzcy5mbGF0dGVuKG9iai5wb3MpOwogICAgICAgIG9mZnNldCA9IGFkalswXTsKICAgICAgfSBlbHNlCiAgICAgICAgb2Zmc2V0ID0gMDsKICAgICAgZm9yIChpPTA7IGkgPCB2Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgYWRqID0gdGhpcy5nZXRBZGoob2JqLCBpLCBvZmZzZXQsIG9iai50ZXh0c1tpXSk7CiAgICAgICAgdm5ld1tpXSAgPSB2W2ldLmNvbmNhdChbMCwtMC41XSkuY29uY2F0KGFkaik7CiAgICAgICAgZm5ld1s0KmldID0gZltpXTsKICAgICAgICB2bmV3W2xhc3RdID0gdltpXS5jb25jYXQoWzEsLTAuNV0pLmNvbmNhdChhZGopOwogICAgICAgIGZuZXdbNCppKzFdID0gbGFzdCsrOwogICAgICAgIHZuZXdbbGFzdF0gPSB2W2ldLmNvbmNhdChbMSwgMS41XSkuY29uY2F0KGFkaik7CiAgICAgICAgZm5ld1s0KmkrMl0gPSBsYXN0Kys7CiAgICAgICAgdm5ld1tsYXN0XSA9IHZbaV0uY29uY2F0KFswLCAxLjVdKS5jb25jYXQoYWRqKTsKICAgICAgICBmbmV3WzQqaSszXSA9IGxhc3QrKzsKICAgICAgICBhbGlhc1tpXSA9IFtsYXN0LTMsIGxhc3QtMiwgbGFzdC0xXTsKICAgICAgICBmb3IgKGo9MDsgaiA8IDQ7IGorKykgewogICAgICAgICAgdjEgPSB2bmV3W2ZuZXdbNCppK2pdXTsKICAgICAgICAgIHYxW29vZnNdID0gMioodjFbdG9mc10tdjFbb29mc10pKnRleGluZm8ud2lkdGhzW2ldOwogICAgICAgICAgdjFbb29mcysxXSA9IDIqKHYxW3RvZnMrMV0tdjFbb29mcysxXSkqdGV4aW5mby50ZXh0SGVpZ2h0c1tpXTsKICAgICAgICAgIHYxW29vZnMrMl0gPSAyKigwLjUtdjFbb29mcysyXSkqdGV4aW5mby50ZXh0SGVpZ2h0c1tpXS8xMDAwLjA7CiAgICAgICAgICB2MVt0b2ZzXSA9ICh0ZXhpbmZvLm9mZnNldHN4W2ldICsgdjFbdG9mc10qdGV4aW5mby53aWR0aHNbaV0pL3RleGluZm8uY2FudmFzWDsKICAgICAgICAgIHYxW3RvZnMrMV0gPSAxLjAtKHRleGluZm8ub2Zmc2V0c3lbaV0gLQogICAgICAgICAgICAgIHYxW3RvZnMrMV0qdGV4aW5mby50ZXh0SGVpZ2h0c1tpXSkvdGV4aW5mby5jYW52YXNZOwogICAgICAgICAgdm5ld1tmbmV3WzQqaStqXV0gPSB2MTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdiA9IHZuZXc7CiAgICAgIG9iai52ZXJ0ZXhDb3VudCA9IHYubGVuZ3RoOwogICAgICBvYmouZiA9IFtmbmV3LCBmbmV3XTsKICAgIH0gZWxzZSBpZiAodHlwZW9mIG9iai50ZXhjb29yZHMgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIHRvZnMgPSBzdHJpZGU7CiAgICAgIHN0cmlkZSArPSAyOwogICAgICBvb2ZzID0gLTE7CiAgICAgIHYgPSByZ2x3aWRnZXRDbGFzcy5jYmluZCh2LCBvYmoudGV4Y29vcmRzKTsKICAgIH0gZWxzZSB7CiAgICAgIHRvZnMgPSAtMTsKICAgICAgb29mcyA9IC0xOwogICAgfQogICAgCiAgICBvYmouYWxpYXMgPSBhbGlhczsKICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIGlmICh0eXBlb2Ygb2JqLnVzZXJBdHRyaWJ1dGVzICE9PSAidW5kZWZpbmVkIikgewogICAgICBvYmoudXNlckF0dHJpYk9mZnNldHMgPSB7fTsKICAgICAgb2JqLnVzZXJBdHRyaWJMb2NhdGlvbnMgPSB7fTsKICAgICAgb2JqLnVzZXJBdHRyaWJTaXplcyA9IHt9OwogICAgICBmb3IgKGF0dHIgaW4gb2JqLnVzZXJBdHRyaWJ1dGVzKSB7CiAgICAgIAlvYmoudXNlckF0dHJpYkxvY2F0aW9uc1thdHRyXSA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKG9iai5wcm9nLCBhdHRyKTsKICAgICAgCWlmIChvYmoudXNlckF0dHJpYkxvY2F0aW9uc1thdHRyXSA+PSAwKSB7IC8vIEF0dHJpYnV0ZSBtYXkgbm90IGhhdmUgYmVlbiB1c2VkCiAgICAgIAkgIG9iai51c2VyQXR0cmliT2Zmc2V0c1thdHRyXSA9IHN0cmlkZTsKICAgICAgCSAgdiA9IHJnbHdpZGdldENsYXNzLmNiaW5kKHYsIG9iai51c2VyQXR0cmlidXRlc1thdHRyXSk7CiAgICAgIAkgIHN0cmlkZSA9IHZbMF0ubGVuZ3RoOwogICAgICAJICBvYmoudXNlckF0dHJpYlNpemVzW2F0dHJdID0gc3RyaWRlIC0gb2JqLnVzZXJBdHRyaWJPZmZzZXRzW2F0dHJdOwogICAgICAJfSBlbHNlCiAgICAgIAkgIGNvbnNvbGUud2FybigiYXR0cmlidXRlICciK2F0dHIrIicgbm90IGZvdW5kIGluIG9iamVjdCAiK29iai5pZCsiLiIpOwogICAgICB9CiAgICB9CgogICAgaWYgKHR5cGVvZiBvYmoudXNlclVuaWZvcm1zICE9PSAidW5kZWZpbmVkIiB8fAogICAgICAgIHR5cGVvZiBvYmoudXNlclRleHR1cmVzICE9PSAidW5kZWZpbmVkIikgewogICAgICBvYmoudXNlclVuaWZvcm1Mb2NhdGlvbnMgPSB7fTsKICAgICAgZm9yIChhdHRyIGluIG9iai51c2VyVW5pZm9ybXMpIHsKICAgICAgICBvYmoudXNlclVuaWZvcm1Mb2NhdGlvbnNbYXR0cl0gPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ob2JqLnByb2csIGF0dHIpOwogICAgICAgIGlmIChvYmoudXNlclVuaWZvcm1Mb2NhdGlvbnNbYXR0cl0gPT09IG51bGwpCiAgICAgICAgICBjb25zb2xlLndhcm4oInVuaWZvcm0gJyIrYXR0cisiJyBub3QgZm91bmQgaW4gb2JqZWN0ICIrb2JqLmlkKyIuIik7CiAgICAgIH0KICAgICAgZm9yIChhdHRyIGluIG9iai51c2VyVGV4dHVyZXMpIHsKICAgICAgICB2YXIgdGV4dHVyZSA9IG9iai51c2VyVGV4dHVyZXNbYXR0cl07CiAgICAgICAgdGV4dHVyZS50ZXh0dXJlID0gZ2wuY3JlYXRlVGV4dHVyZSgpOwogICAgICAgIC8vIFRoaXMgaXMgYSB0cmljayBmcm9tIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xOTc0ODkwNS8yNTU0MzMwIHRvIGF2b2lkIHdhcm5pbmdzCiAgICAgICAgZ2wuYmluZFRleHR1cmUoZ2wuVEVYVFVSRV8yRCwgdGV4dHVyZS50ZXh0dXJlKTsKICAgICAgICBnbC50ZXhJbWFnZTJEKGdsLlRFWFRVUkVfMkQsIDAsIGdsLlJHQkEsIDEsIDEsIDAsIGdsLlJHQkEsIGdsLlVOU0lHTkVEX0JZVEUsCiAgICAgICAgICAgICAgbmV3IFVpbnQ4QXJyYXkoWzI1NSwyNTUsMjU1LCAyNTVdKSk7IC8vIHdoaXRlCiAgICAgICAgdGV4dHVyZS5zYW1wbGVyID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKG9iai5wcm9nLCBhdHRyKTsKICAgICAgICBpZiAodGV4dHVyZS5zYW1wbGVyID09PSBudWxsKQogICAgICAgICAgY29uc29sZS53YXJuKCJzYW1wbGVyICciK2F0dHIrIicgbm90IGZvdW5kIGluIG9iamVjdCAiK29iai5pZCsiLiIpOwogICAgICAgIHVyaSA9IHRleHR1cmUudXJpOwogICAgICAgIHRoaXMubG9hZEltYWdlVG9UZXh0dXJlKHVyaSwgdGV4dHVyZS50ZXh0dXJlKTsKICAgICAgfQogICAgfQoKICAgIGlmIChzcHJpdGVzXzNkKSB7CiAgICAgIG9iai51c2VyTWF0cml4ID0gbmV3IENhbnZhc01hdHJpeDQoKTsKICAgICAgb2JqLnVzZXJNYXRyaXgubG9hZChyZ2x3aWRnZXRDbGFzcy5mbGF0dGVuKG9iai51c2VybWF0cml4KSk7CiAgICAgIG9iai5vYmplY3RzID0gcmdsd2lkZ2V0Q2xhc3MuZmxhdHRlbihbXS5jb25jYXQob2JqLmlkcykpOwogICAgICBmbC5pc19saXQgPSBmYWxzZTsKICAgICAgb2JqLmFkaiA9IHJnbHdpZGdldENsYXNzLmZsYXR0ZW4ob2JqLmFkaik7CiAgICAgIAogICAgICBpZiAodHlwZW9mIG9iai5wb3MgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgb2JqLnBvcyA9IHJnbHdpZGdldENsYXNzLmZsYXR0ZW4ob2JqLnBvcyk7CiAgICAgICAgb2JqLm9mZnNldCA9IG9iai5hZGpbMF07CiAgICAgIH0gZWxzZQogICAgICAgIG9iai5vZmZzZXQgPSAwOwogICAgICAgIAogICAgICB2YXIgc2hhcGVudW0gPSByZ2x3aWRnZXRDbGFzcy5mbGF0dGVuKG9iai5zaGFwZW51bSk7CiAgICAgIG9iai5zaGFwZWxlbnMgPSBbXTsKICAgICAgb2JqLnNoYXBlZmlyc3QgPSBbXTsKICAgICAgb2JqLnNoYXBlZmlyc3QucHVzaCgwKTsKICAgICAgbGVuID0gMDsKICAgICAgY3VycmVudCA9IDA7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBzaGFwZW51bS5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChzaGFwZW51bVtpXSA9PT0gc2hhcGVudW1bY3VycmVudF0pIHsKICAgICAgICAgIGxlbisrOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBvYmouc2hhcGVsZW5zLnB1c2gobGVuKTsKICAgICAgICAgIGxlbiA9IDE7CiAgICAgICAgICBjdXJyZW50ID0gaTsKICAgICAgICAgIG9iai5zaGFwZWZpcnN0LnB1c2goaSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIG9iai5zaGFwZWxlbnMucHVzaChsZW4pOwogICAgICAgIAogICAgICBmb3IgKGk9MDsgaSA8IG9iai5vYmplY3RzLmxlbmd0aDsgaSsrKQogICAgICAgIHRoaXMuaW5pdE9iaklkKG9iai5vYmplY3RzW2ldKTsKICAgIH0KCiAgICBuY2xpcHBsYW5lcyA9IHRoaXMuY291bnRDbGlwcGxhbmVzKCk7CiAgICBpZiAobmNsaXBwbGFuZXMgJiYgIXNwcml0ZXNfM2QpIHsKICAgICAgb2JqLmNsaXBMb2MgPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ob2JqLnByb2csInZDbGlwcGxhbmUiKTsKICAgIH0KCiAgICBpZiAoZmwuaXNfbGl0KSB7CiAgICAgIG9iai5lbWlzc2lvbkxvYyA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihvYmoucHJvZywgImVtaXNzaW9uIik7CiAgICAgIG9iai5lbWlzc2lvbiA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5zdHJpbmdUb1JnYih0aGlzLmdldE1hdGVyaWFsKG9iaiwgImVtaXNzaW9uIikpKTsKICAgICAgb2JqLnNoaW5pbmVzc0xvYyA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihvYmoucHJvZywgInNoaW5pbmVzcyIpOwogICAgICBvYmouc2hpbmluZXNzID0gdGhpcy5nZXRNYXRlcmlhbChvYmosICJzaGluaW5lc3MiKTsKICAgICAgb2JqLm5saWdodHMgPSB0aGlzLmNvdW50TGlnaHRzKCk7CiAgICAgIGlmIChvYmoubmxpZ2h0cyA+IDApIHsKICAgICAgICBvYmouYW1iaWVudCA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5zdHJpbmdUb1JnYih0aGlzLmdldE1hdGVyaWFsKG9iaiwgImFtYmllbnQiKSkpOwogICAgICAgIG9iai5zcGVjdWxhciA9IG5ldyBGbG9hdDMyQXJyYXkodGhpcy5zdHJpbmdUb1JnYih0aGlzLmdldE1hdGVyaWFsKG9iaiwgInNwZWN1bGFyIikpKTsKICAgICAgICBvYmouYW1iaWVudExvYyA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihvYmoucHJvZywgImFtYmllbnQiKTsKICAgICAgICBvYmouc3BlY3VsYXJMb2MgPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ob2JqLnByb2csICJzcGVjdWxhciIpOwogICAgICAgIG9iai5kaWZmdXNlTG9jID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKG9iai5wcm9nLCAiZGlmZnVzZSIgKTsKICAgICAgICBvYmoubGlnaHREaXJMb2MgPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ob2JqLnByb2csICJsaWdodERpciIpOwogICAgICAgIG9iai52aWV3cG9pbnRMb2MgPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ob2JqLnByb2csICJ2aWV3cG9pbnQiKTsKICAgICAgICBvYmouZmluaXRlTG9jID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKG9iai5wcm9nLCAiZmluaXRlIiApOwogICAgICB9CiAgICB9CiAgICAKICAgIG9iai5wYXNzZXMgPSBmbC5pc190d29zaWRlZCArIDE7CiAgICBvYmoucG1vZGUgPSBuZXcgQXJyYXkob2JqLnBhc3Nlcyk7CiAgICBmb3IgKHBhc3MgPSAwOyBwYXNzIDwgb2JqLnBhc3NlczsgcGFzcysrKSB7CiAgICAgIGlmICh0eXBlID09PSAidHJpYW5nbGVzIiB8fCB0eXBlID09PSAicXVhZHMiIHx8IHR5cGUgPT09ICJzdXJmYWNlIiB8fCBoYXNfc3BoZXJlcykKICAgICAgCXBtb2RlID0gdGhpcy5nZXRNYXRlcmlhbChvYmosIChwYXNzID09PSAwKSA/ICJmcm9udCIgOiAiYmFjayIpOwogICAgICBlbHNlIHBtb2RlID0gImZpbGxlZCI7CiAgICAgIG9iai5wbW9kZVtwYXNzXSA9IHBtb2RlOwogICAgfQogICAgaWYgKCFoYXNfc3BoZXJlcykgewogICAgICBvYmouZi5sZW5ndGggPSBvYmoucGFzc2VzOwogICAgICBmb3IgKHBhc3MgPSAwOyBwYXNzIDwgb2JqLnBhc3NlczsgcGFzcysrKSB7CiAgICAgIAlmID0gZm5ldyA9IG9iai5mW3Bhc3NdOwogICAgICAgIHBtb2RlID0gb2JqLnBtb2RlW3Bhc3NdOwogICAgICAJaWYgKHBtb2RlID09PSAiY3VsbGVkIikKICAgICAgCSAgZm5ldyA9IFtdOwogICAgICAgIGVsc2UgaWYgKHBtb2RlID09PSAicG9pbnRzIikgewogICAgICAgICAgLy8gc3RheSB3aXRoIGRlZmF1bHQKICAgICAgICB9IGVsc2UgaWYgKCh0eXBlID09PSAicXVhZHMiIHx8IHR5cGUgPT09ICJ0ZXh0IiB8fAogICAgICAgICAgICAgdHlwZSA9PT0gInNwcml0ZXMiKSAmJiAhc3ByaXRlc18zZCkgewogICAgICAgICAgbnJvd3MgPSBNYXRoLmZsb29yKG9iai52ZXJ0ZXhDb3VudC80KTsKICAgICAgICAgIGlmIChwbW9kZSA9PT0gImZpbGxlZCIpIHsKICAgICAgICAgICAgZm5ldyA9IEFycmF5KDYqbnJvd3MpOwogICAgICAgICAgICBmb3IgKGk9MDsgaSA8IG5yb3dzOyBpKyspIHsKICAgICAgICAgICAgICBmbmV3WzYqaV0gPSBmWzQqaV07CiAgICAgICAgICAgICAgZm5ld1s2KmkrMV0gPSBmWzQqaSArIDFdOwogICAgICAgICAgICAgIGZuZXdbNippKzJdID0gZls0KmkgKyAyXTsKICAgICAgICAgICAgICBmbmV3WzYqaSszXSA9IGZbNCppXTsKICAgICAgICAgICAgICBmbmV3WzYqaSs0XSA9IGZbNCppICsgMl07CiAgICAgICAgICAgICAgZm5ld1s2KmkrNV0gPSBmWzQqaSArIDNdOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmbmV3ID0gQXJyYXkoOCpucm93cyk7CiAgICAgICAgICAgIGZvciAoaT0wOyBpIDwgbnJvd3M7IGkrKykgewogICAgICAgICAgICAgIGZuZXdbOCppXSA9IGZbNCppXTsKICAgICAgICAgICAgICBmbmV3WzgqaSsxXSA9IGZbNCppICsgMV07CiAgICAgICAgICAgICAgZm5ld1s4KmkrMl0gPSBmWzQqaSArIDFdOwogICAgICAgICAgICAgIGZuZXdbOCppKzNdID0gZls0KmkgKyAyXTsKICAgICAgICAgICAgICBmbmV3WzgqaSs0XSA9IGZbNCppICsgMl07CiAgICAgICAgICAgICAgZm5ld1s4KmkrNV0gPSBmWzQqaSArIDNdOwogICAgICAgICAgICAgIGZuZXdbOCppKzZdID0gZls0KmkgKyAzXTsKICAgICAgICAgICAgICBmbmV3WzgqaSs3XSA9IGZbNCppXTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gInRyaWFuZ2xlcyIpIHsKICAgICAgICAgIG5yb3dzID0gTWF0aC5mbG9vcihvYmoudmVydGV4Q291bnQvMyk7CiAgICAgICAgICBpZiAocG1vZGUgPT09ICJmaWxsZWQiKSB7CiAgICAgICAgICAgIGZuZXcgPSBBcnJheSgzKm5yb3dzKTsKICAgICAgICAgICAgZm9yIChpPTA7IGkgPCBmbmV3Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgZm5ld1tpXSA9IGZbaV07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAocG1vZGUgPT09ICJsaW5lcyIpIHsKICAgICAgICAgICAgZm5ldyA9IEFycmF5KDYqbnJvd3MpOwogICAgICAJICAgIGZvciAoaT0wOyBpIDwgbnJvd3M7IGkrKykgewogICAgICAJICAgICAgZm5ld1s2KmldID0gZlszKmldOwogICAgICAJICAgICAgZm5ld1s2KmkgKyAxXSA9IGZbMyppICsgMV07CiAgICAgIAkgICAgICBmbmV3WzYqaSArIDJdID0gZlszKmkgKyAxXTsKICAgICAgCSAgICAgIGZuZXdbNippICsgM10gPSBmWzMqaSArIDJdOwogICAgICAJICAgICAgZm5ld1s2KmkgKyA0XSA9IGZbMyppICsgMl07CiAgICAgIAkgICAgICBmbmV3WzYqaSArIDVdID0gZlszKmldOwogICAgICAJICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGhhc19zcGhlcmVzKSB7CiAgICAgICAgICAvLyBkZWZhdWx0CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAic3VyZmFjZSIpIHsKICAgICAgICAgIGRpbSA9IG9iai5kaW1bMF07CiAgICAgICAgICBueCA9IGRpbVswXTsKICAgICAgICAgIG56ID0gZGltWzFdOwogICAgICAgICAgaWYgKHBtb2RlID09PSAiZmlsbGVkIikgewogICAgICAgICAgICBmbmV3ID0gW107CiAgICAgICAgICAgIGZvciAoaj0wOyBqPG54LTE7IGorKykgewogICAgICAgICAgICAgIGZvciAoaT0wOyBpPG56LTE7IGkrKykgewogICAgICAgICAgICAgICAgZm5ldy5wdXNoKGZbaiArIG54KmldLAogICAgICAgICAgICAgICAgICAgICAgIGZbaiArIG54KihpKzEpXSwKICAgICAgICAgICAgICAgICAgICAgICBmW2ogKyAxICsgbngqKGkrMSldLAogICAgICAgICAgICAgICAgICAgICAgIGZbaiArIG54KmldLAogICAgICAgICAgICAgICAgICAgICAgIGZbaiArIDEgKyBueCooaSsxKV0sCiAgICAgICAgICAgICAgICAgICAgICAgZltqICsgMSArIG54KmldKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAocG1vZGUgPT09ICJsaW5lcyIpIHsKICAgICAgICAgICAgZm5ldyA9IFtdOwogICAgICAgICAgICBmb3IgKGo9MDsgajxueDsgaisrKSB7CiAgICAgICAgICAgICAgZm9yIChpPTA7IGk8bno7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKGkrMSA8IG56KQogICAgICAgICAgICAgICAgICBmbmV3LnB1c2goZltqICsgbngqaV0sCiAgICAgICAgICAgICAgICAgICAgICAgICBmW2ogKyBueCooaSsxKV0pOwogICAgICAgICAgICAgICAgaWYgKGorMSA8IG54KQogICAgICAgICAgICAgICAgICBmbmV3LnB1c2goZltqICsgbngqaV0sCiAgICAgICAgICAgICAgICAgICAgICAgICBmW2orMSArIG54KmldKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgb2JqLmZbcGFzc10gPSBmbmV3OwogICAgICAgIGlmIChkZXB0aF9zb3J0KSB7CiAgICAgICAgICBkcmF3dHlwZSA9ICJEWU5BTUlDX0RSQVciOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkcmF3dHlwZSA9ICJTVEFUSUNfRFJBVyI7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAKICAgIGlmIChmbC5mYXRfbGluZXMpIHsKICAgICAgYWxpYXMgPSB1bmRlZmluZWQ7CiAgICAgIG9iai5uZXh0TG9jID0gZ2wuZ2V0QXR0cmliTG9jYXRpb24ob2JqLnByb2csICJhTmV4dCIpOwogICAgICBvYmoucG9pbnRMb2MgPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihvYmoucHJvZywgImFQb2ludCIpOwogICAgICBvYmouYXNwZWN0TG9jID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKG9iai5wcm9nLCAidUFzcGVjdCIpOwogICAgICBvYmoubHdkTG9jID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKG9iai5wcm9nLCAidUx3ZCIpOwogICAgICAvLyBFeHBhbmQgdmVydGljZXMgdG8gdHVybiBlYWNoIHNlZ21lbnQgaW50byBhIHBhaXIgb2YgdHJpYW5nbGVzCiAgICAgICAgCiAgICAgIAlmb3IgKHBhc3MgPSAwOyBwYXNzIDwgb2JqLnBhc3NlczsgcGFzcysrKSB7CiAgICAgIAkgIGYgPSBvYmouZltwYXNzXTsJCiAgICAgICAgICBvbGRyb3dzID0gZi5sZW5ndGg7CiAgICAgIAkgIGlmIChvYmoucG1vZGVbcGFzc10gPT09ICJsaW5lcyIpIAogICAgICAJICAgIGJyZWFrOwogICAgICAJfQogICAgICAKICAgICAgaWYgKHR5cGUgPT09ICJsaW5lc3RyaXAiKSAKICAgICAgICBucm93cyA9IDQqKG9sZHJvd3MgLSAxKTsgCiAgICAgIGVsc2UKICAgICAgICBucm93cyA9IDIqb2xkcm93czsKICAgICAgdm5ldyA9IG5ldyBBcnJheShucm93cyk7CiAgICAgIGZuZXcgPSBuZXcgQXJyYXkoMS41Km5yb3dzKTsKICAgICAgCiAgICAgIC8vIFdlJ3JlIGdvaW5nIHRvIHR1cm4gZWFjaCBwYWlyIG9mIHZlcnRpY2VzIGludG8gNCBuZXcgb25lcywgd2l0aCB0aGUgIm5leHQiIGFuZCAicHQiIGF0dHJpYnV0ZXMKICAgICAgLy8gYWRkZWQuCiAgICAgIC8vIFdlIGRvIHRoaXMgYnkgY29weWluZyB0aGUgb3JpZ2luYWxzIGluIHRoZSBmaXJzdCBwYXNzLCBhZGRpbmcgdGhlIG5ldyBhdHRyaWJ1dGVzLCB0aGVuIGluIGEgCiAgICAgIC8vIHNlY29uZCBwYXNzIGFkZCBuZXcgdmVydGljZXMgYXQgdGhlIGVuZC4KCiAgICAgIGZvciAoaSA9IDA7IGkgPCB2Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdm5ld1tpXSA9IHZbaV0uY29uY2F0KFswLDAsMCwwLDBdKTsgCiAgICAgIH0KCiAgICAgIG5leHRvZnMgPSBzdHJpZGU7CiAgICAgIHBvaW50b2ZzID0gc3RyaWRlICsgMzsKICAgICAgc3RyaWRlID0gc3RyaWRlICsgNTsKICAgICAgICAgICAgCiAgICAgIC8vIE5vdyBhZGQgdGhlIGV4dHJhcwogICAgICB2YXIgaW5kLCBrOwogICAgICBsYXN0ID0gdi5sZW5ndGggLSAxOwogICAgICBpbmQgPSAwOwogICAgICBhbGlhcyA9IG5ldyBBcnJheShmLmxlbmd0aCk7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBmLmxlbmd0aDsgaSsrKQogICAgICAgIGFsaWFzW2ldID0gW107CiAgICAgIGZvciAoaSA9IDA7IGkgPCBmLmxlbmd0aCAtIDE7IGkrKykgewogICAgICAJaWYgKHR5cGUgIT09ICJsaW5lc3RyaXAiICYmIGkgJSAyID09PSAxKQogICAgICAJICBjb250aW51ZTsKICAgICAgCWsgPSArK2xhc3Q7CiAgICAgIAl2bmV3W2tdID0gdm5ld1tmW2ldXS5zbGljZSgpOwogICAgICAJZm9yIChqPTA7IGo8MzsgaisrKQogICAgICAJICB2bmV3W2tdW25leHRvZnMgKyBqXSA9IHZuZXdbZltpKzFdXVtqXTsKICAgICAgCXZuZXdba11bcG9pbnRvZnNdID0gLTE7CiAgICAgIAl2bmV3W2tdW3BvaW50b2ZzKzFdID0gLTE7CiAgICAgIAlmbmV3W2luZF0gPSBrOwogICAgICAJbGFzdCsrOwogICAgICAJdm5ld1tsYXN0XSA9IHZuZXdba10uc2xpY2UoKTsKICAgICAgCXZuZXdbbGFzdF1bcG9pbnRvZnNdID0gMTsKICAgICAgCWZuZXdbaW5kKzFdID0gbGFzdDsKICAgICAgCWFsaWFzW2ZbaV1dLnB1c2gobGFzdC0xLCBsYXN0KTsKICAgICAgCWxhc3QrKzsKICAgICAgCWsgPSBsYXN0OwogICAgICAJdm5ld1trXSA9IHZuZXdbZltpKzFdXS5zbGljZSgpOwogICAgICAJZm9yIChqPTA7IGo8MzsgaisrKQogICAgICAJICB2bmV3W2tdW25leHRvZnMgKyBqXSA9IHZuZXdbZltpXV1bal07CiAgICAgIAl2bmV3W2tdW3BvaW50b2ZzXSA9IC0xOwogICAgICAJdm5ld1trXVtwb2ludG9mcysxXSA9IDE7CiAgICAgIAlmbmV3W2luZCsyXSA9IGs7CiAgICAgIAlmbmV3W2luZCszXSA9IGZuZXdbaW5kKzFdOwogICAgICAJbGFzdCsrOwogICAgICAJdm5ld1tsYXN0XSA9IHZuZXdba10uc2xpY2UoKTsKICAgICAgCXZuZXdbbGFzdF1bcG9pbnRvZnNdID0gMTsKICAgICAgCWZuZXdbaW5kKzRdID0gbGFzdDsKICAgICAgCWZuZXdbaW5kKzVdID0gZm5ld1tpbmQrMl07CiAgICAgIAlpbmQgKz0gNjsKICAgICAgCWFsaWFzW2ZbaSsxXV0ucHVzaChsYXN0LTEsIGxhc3QpOwogICAgICB9CiAgICAgIHZuZXcubGVuZ3RoID0gbGFzdCsxOwogICAgICB2ID0gdm5ldzsKICAgICAgb2JqLnZlcnRleENvdW50ID0gdi5sZW5ndGg7CiAgICAgIGlmICh0eXBlb2YgYWxpYXMgIT09ICJ1bmRlZmluZWQiICYmIHR5cGVvZiBvYmouYWxpYXMgIT09ICJ1bmRlZmluZWQiKSB7ICAvLyBBbHJlYWR5IGhhdmUgYWxpYXNlcyBmcm9tIHByZXZpb3VzIHNlY3Rpb24/CiAgICAgICAgdmFyIG9sZGFsaWFzID0gb2JqLmFsaWFzLCBuZXdhbGlhcyA9IEFycmF5KG9iai5hbGlhcy5sZW5ndGgpOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBuZXdhbGlhcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgbmV3YWxpYXNbaV0gPSBvbGRhbGlhc1tpXS5zbGljZSgpOwogICAgICAgICAgZm9yIChqID0gMDsgaiA8IG9sZGFsaWFzW2ldLmxlbmd0aDsgaisrKQogICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShuZXdhbGlhc1tpXSwgYWxpYXNbb2xkYWxpYXNbal1dKTsgLy8gcHVzaGVzIGVhY2ggZWxlbWVudCAKICAgICAgICB9CiAgICAgICAgb2JqLmFsaWFzID0gbmV3YWxpYXM7CiAgICAgIH0gZWxzZQogICAgICAgIG9iai5hbGlhcyA9IGFsaWFzOwogICAgICAKICAgICAgZm9yIChwYXNzID0gMDsgcGFzcyA8IG9iai5wYXNzZXM7IHBhc3MrKykKICAgICAgCWlmICh0eXBlID09PSAibGluZXMiIHx8IHR5cGUgPT09ICJsaW5lc3RyaXAiIHx8IG9iai5wbW9kZVtwYXNzXSA9PT0gImxpbmVzIikgewogICAgICAgICAgb2JqLmZbcGFzc10gPSBmbmV3OwogICAgICAgIH0KICAgICAgCiAgICAgIGlmIChkZXB0aF9zb3J0KSAKICAgICAgICBkcmF3dHlwZSA9ICJEWU5BTUlDX0RSQVciOwogICAgICBlbHNlCiAgICAgICAgZHJhd3R5cGUgPSAiU1RBVElDX0RSQVciOwogICAgfQogICAgCiAgICAgIGZvciAocGFzcyA9IDA7IHBhc3MgPCBvYmoucGFzc2VzOyBwYXNzKyspIHsKICAgICAgICBpZiAob2JqLnZlcnRleENvdW50ID4gNjU1MzUpIHsKICAgICAgICAgIGlmICh0aGlzLmluZGV4X3VpbnQpIHsKICAgICAgICAgICAgb2JqLmZbcGFzc10gPSBuZXcgVWludDMyQXJyYXkob2JqLmZbcGFzc10pOwogICAgICAgICAgICBvYmouaW5kZXhfdWludCA9IHRydWU7CiAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgdGhpcy5hbGVydE9uY2UoIk9iamVjdCBoYXMgIitvYmoudmVydGV4Q291bnQrIiB2ZXJ0aWNlcywgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGJyb3dzZXIuIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG9iai5mW3Bhc3NdID0gbmV3IFVpbnQxNkFycmF5KG9iai5mW3Bhc3NdKTsKICAgICAgICAgIG9iai5pbmRleF91aW50ID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICAKICAgIGlmIChzdHJpZGUgIT09IHZbMF0ubGVuZ3RoKSB7CiAgICAgIHRoaXMuYWxlcnRPbmNlKCJwcm9ibGVtIGluIHN0cmlkZSBjYWxjdWxhdGlvbiIpOwogICAgfQoKICAgIG9iai52T2Zmc2V0cyA9IHt2b2ZzOjAsIGNvZnM6Y29mcywgbm9mczpub2ZzLCByYWRvZnM6cmFkb2ZzLCBvb2ZzOm9vZnMsIHRvZnM6dG9mcywKICAgICAgICAgICAgICAgICAgICBuZXh0b2ZzOm5leHRvZnMsIHBvaW50b2ZzOnBvaW50b2ZzLCBzdHJpZGU6c3RyaWRlfTsKCiAgICBvYmoudmFsdWVzID0gbmV3IEZsb2F0MzJBcnJheShyZ2x3aWRnZXRDbGFzcy5mbGF0dGVuKHYpKTsKCiAgICBpZiAoIWhhc19zcGhlcmVzICYmICFzcHJpdGVzXzNkKSB7CiAgICAgIG9iai5idWYgPSBnbC5jcmVhdGVCdWZmZXIoKTsKICAgICAgZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIG9iai5idWYpOwogICAgICBnbC5idWZmZXJEYXRhKGdsLkFSUkFZX0JVRkZFUiwgb2JqLnZhbHVlcywgZ2wuU1RBVElDX0RSQVcpOyAvLwogICAgICBvYmouaWJ1ZiA9IEFycmF5KG9iai5wYXNzZXMpOwogICAgICBvYmouaWJ1ZlswXSA9IGdsLmNyZWF0ZUJ1ZmZlcigpOwogICAgICBnbC5iaW5kQnVmZmVyKGdsLkVMRU1FTlRfQVJSQVlfQlVGRkVSLCBvYmouaWJ1ZlswXSk7CiAgICAgIGdsLmJ1ZmZlckRhdGEoZ2wuRUxFTUVOVF9BUlJBWV9CVUZGRVIsIG9iai5mWzBdLCBnbFtkcmF3dHlwZV0pOwogICAgICBpZiAoZmwuaXNfdHdvc2lkZWQpIHsKICAgICAgCW9iai5pYnVmWzFdID0gZ2wuY3JlYXRlQnVmZmVyKCk7CiAgICAgIAlnbC5iaW5kQnVmZmVyKGdsLkVMRU1FTlRfQVJSQVlfQlVGRkVSLCBvYmouaWJ1ZlsxXSk7CiAgICAgIAlnbC5idWZmZXJEYXRhKGdsLkVMRU1FTlRfQVJSQVlfQlVGRkVSLCBvYmouZlsxXSwgZ2xbZHJhd3R5cGVdKTsKICAgICAgfQogICAgfQoKICAgIGlmICghc3ByaXRlc18zZCkgewogICAgICBvYmoubXZNYXRMb2MgPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ob2JqLnByb2csICJtdk1hdHJpeCIpOwogICAgICBvYmoucHJNYXRMb2MgPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ob2JqLnByb2csICJwck1hdHJpeCIpOwoKICAgICAgaWYgKGZsLmZpeGVkX3NpemUpIHsKICAgICAgICBvYmoudGV4dFNjYWxlTG9jID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKG9iai5wcm9nLCAidGV4dFNjYWxlIik7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoZmwubmVlZHNfdm5vcm1hbCkgewogICAgICBvYmoubm9ybUxvYyA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKG9iai5wcm9nLCAiYU5vcm0iKTsKICAgICAgb2JqLm5vcm1NYXRMb2MgPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ob2JqLnByb2csICJub3JtTWF0cml4Iik7CiAgICB9CgogICAgaWYgKGZsLmlzX3R3b3NpZGVkKSB7CiAgICAgIG9iai5mcm9udExvYyA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihvYmoucHJvZywgImZyb250Iik7CiAgICAgIGlmIChmbC5oYXNfbm9ybWFscykKICAgICAgICBvYmouaW52UHJNYXRMb2MgPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ob2JqLnByb2csICJpbnZQck1hdHJpeCIpOwogICAgfQogIH07CiAgICAKICAgIC8qKgogICAgICogSW5pdGlhbGl6ZSB0aGUgRE9NIG9iamVjdAogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gZWwgLSB0aGUgRE9NIG9iamVjdAogICAgICogQHBhcmFtIHsgT2JqZWN0IH0geCAtIHRoZSBzY2VuZSBkYXRhIHNlbnQgYnkgSlNPTiBmcm9tIFIKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbihlbCwgeCkgewogICAgICB0aGlzLnRleHR1cmVDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKTsKICAgICAgdGhpcy50ZXh0dXJlQ2FudmFzLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOwogICAgICB0aGlzLnNjZW5lID0geDsKICAgICAgdGhpcy5ub3JtTWF0cml4ID0gbmV3IENhbnZhc01hdHJpeDQoKTsKICAgICAgdGhpcy5pbnZQck1hdHJpeCA9IG5ldyBDYW52YXNNYXRyaXg0KCk7CiAgICAgIHRoaXMuc2F2ZU1hdCA9IHt9OwogICAgICB0aGlzLmRpc3RhbmNlID0gbnVsbDsKICAgICAgdGhpcy5wb3NMb2MgPSAwOwogICAgICB0aGlzLmNvbExvYyA9IDE7CiAgICAgIGlmIChlbCkgewogICAgICAgIGVsLnJnbGluc3RhbmNlID0gdGhpczsKICAgICAgICB0aGlzLmVsID0gZWw7CiAgICAgICAgdGhpcy53ZWJHTG9wdGlvbnMgPSBlbC5yZ2xpbnN0YW5jZS5zY2VuZS53ZWJHTG9wdGlvbnM7CiAgICAgICAgdGhpcy5pbml0Q2FudmFzKCk7CiAgICAgIH0KICAgICAgaWYgKHR5cGVvZiBTaGlueSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgU2hpbnkuYWRkQ3VzdG9tTWVzc2FnZUhhbmRsZXIoInNoaW55R2V0UGFyM2QiLAogICAgICAgICAgZnVuY3Rpb24obWVzc2FnZSkgewogICAgICAgICAgICB2YXIgaSwgcGFyYW0sIAogICAgICAgICAgICAgICAgc3Vic2NlbmUgPSBzZWxmLmdldE9iaihtZXNzYWdlLnN1YnNjZW5lKSwKICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMgPSBbXS5jb25jYXQobWVzc2FnZS5wYXJhbWV0ZXJzKSwKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHt0YWc6IG1lc3NhZ2UudGFnLCBzdWJzY2VuZTogbWVzc2FnZS5zdWJzY2VuZX07CiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3Vic2NlbmUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHBhcmFtZXRlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIHBhcmFtID0gcGFyYW1ldGVyc1tpXTsKICAgICAgICAgICAgICAgIHJlc3VsdFtwYXJhbV0gPSBzdWJzY2VuZS5wYXIzZFtwYXJhbV07CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJzdWJzY2VuZSAiK21lc3NhZ2Uuc3Vic2NlbmUrIiB1bmRlZmluZWQuIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgU2hpbnkuc2V0SW5wdXRWYWx1ZSgicGFyM2Q6c2hpbnlQYXIzZCIsIHJlc3VsdCwge3ByaW9yaXR5OiAiZXZlbnQifSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIAogICAgICAgIFNoaW55LmFkZEN1c3RvbU1lc3NhZ2VIYW5kbGVyKCJzaGlueVNldFBhcjNkIiwKICAgICAgICAgIGZ1bmN0aW9uKG1lc3NhZ2UpIHsKICAgICAgICAgICAgdmFyIHBhcmFtID0gbWVzc2FnZS5wYXJhbWV0ZXIsIAogICAgICAgICAgICAgICAgc3Vic2NlbmUgPSBzZWxmLmdldE9iaihtZXNzYWdlLnN1YnNjZW5lKTsKICAgICAgICAgICAgaWYgKHR5cGVvZiBzdWJzY2VuZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgICBzdWJzY2VuZS5wYXIzZFtwYXJhbV0gPSBtZXNzYWdlLnZhbHVlOwogICAgICAgICAgICAgIHN1YnNjZW5lLmluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICAgICAgICAgc2VsZi5kcmF3U2NlbmUoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygic3Vic2NlbmUgIittZXNzYWdlLnN1YnNjZW5lKyIgdW5kZWZpbmVkLiIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIAogICAgICAgIFNoaW55LmFkZEN1c3RvbU1lc3NhZ2VIYW5kbGVyKCJyZXNldEJydXNoIiwKICAgICAgICAgIGZ1bmN0aW9uKG1lc3NhZ2UpIHsKICAgICAgICAgICAgaWYgKG1lc3NhZ2UgPT09IHNlbGYuc2NlbmUuc2VsZWN0aW9uSW5wdXQpIHsKICAgICAgICAgICAgICBzZWxmLmNsZWFyQnJ1c2gobnVsbCk7CiAgICAgICAgICAgICAgc2VsZi5yZWNvcmRTZWxlY3Rpb24oMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICB9CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIFJlc3RhcnQgdGhlIFdlYkdMIGNhbnZhcwogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUucmVzdGFydENhbnZhcyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgbmV3Y2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIiksCiAgICAgICAgICBzZWxmID0gdGhpcywgCiAgICAgICAgICBsYWJlbGlkID0gdGhpcy5lbC5nZXRBdHRyaWJ1dGUoImFyaWEtbGFiZWxsZWRieSIpOwogICAgICBuZXdjYW52YXMud2lkdGggPSB0aGlzLmVsLndpZHRoOwogICAgICBuZXdjYW52YXMuaGVpZ2h0ID0gdGhpcy5lbC5oZWlnaHQ7CiAgICAgIG5ld2NhbnZhcy5zZXRBdHRyaWJ1dGUoImFyaWEtbGFiZWxsZWRieSIsIAogICAgICAgIGxhYmVsaWQpOwogICAgICAgIAogICAgICBpZiAodHlwZW9mIHRoaXMuc2NlbmUuYWx0VGV4dCAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAvLyBXZSdyZSBpbiBTaGlueSwgc28gYWx0ZXIgdGhlIGxhYmVsCiAgICAgICAgdmFyIGxhYmVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobGFiZWxpZCk7CiAgICAgICAgaWYgKGxhYmVsKQogICAgICAgICAgbGFiZWwuaW5uZXJIVE1MID0gdGhpcy5zY2VuZS5hbHRUZXh0OwogICAgICB9CiAgICAgIG5ld2NhbnZhcy5hZGRFdmVudExpc3RlbmVyKCJ3ZWJnbGNvbnRleHRyZXN0b3JlZCIsCiAgICAgICAgdGhpcy5vbkNvbnRleHRSZXN0b3JlZCwgZmFsc2UpOwogICAgICBuZXdjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigid2ViZ2xjb250ZXh0bG9zdCIsCiAgICAgICAgdGhpcy5vbkNvbnRleHRMb3N0LCBmYWxzZSk7CiAgICAgIHdoaWxlICh0aGlzLmVsLmZpcnN0Q2hpbGQpIHsKICAgICAgICB0aGlzLmVsLnJlbW92ZUNoaWxkKHRoaXMuZWwuZmlyc3RDaGlsZCk7CiAgICAgIH0KICAgICAgdGhpcy5lbC5hcHBlbmRDaGlsZChuZXdjYW52YXMpOwogICAgICB0aGlzLmNhbnZhcyA9IG5ld2NhbnZhczsKICAgICAgaWYgKHRoaXMuc2NlbmUuamF2YXNjcmlwdCkgewogICAgICAgIC8qIGpzaGludCBldmlsOnRydWUgKi8KICAgICAgICBGdW5jdGlvbignInVzZSBzdHJpY3QiOycgKyB0aGlzLnNjZW5lLmphdmFzY3JpcHQpKCk7CiAgICAgICAgLyoganNoaW50IGV2aWw6ZmFsc2UgKi8KICAgICAgfQogICAgICB0aGlzLnNldE1vdXNlSGFuZGxlcnMoKTsKICAgICAgaWYgKHRoaXMuZ2wpIAogICAgICAgIE9iamVjdC5rZXlzKHRoaXMuc2NlbmUub2JqZWN0cykuZm9yRWFjaChmdW5jdGlvbihrZXkpewogICAgICAgICAgc2VsZi5nZXRPYmoocGFyc2VJbnQoa2V5LCAxMCkpLnRleHR1cmUgPSB1bmRlZmluZWQ7IAogICAgICAgICAgfSk7CiAgICAgIHRoaXMuZ2wgPSBudWxsOwogICAgfTsKCiAgICAvKioKICAgICAqIEluaXRpYWxpemUgdGhlIFdlYkdMIGNhbnZhcwogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuaW5pdENhbnZhcyA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnJlc3RhcnRDYW52YXMoKTsKICAgICAgdmFyIG9ianMgPSB0aGlzLnNjZW5lLm9iamVjdHMsCiAgICAgICAgICBzZWxmID0gdGhpczsKICAgICAgICAgIAogICAgICAvKiBUaGVzZSBob2xkIGNvbnRleHQgc3BlY2lmaWMgZGF0YS4gIEluIFNoaW55LCB0aGV5ICAgCiAgICAgICAgIG5lZWQgdG8gYmUgZGVsZXRlZC4gIEVsc2V3aGVyZSwgdGhleSBkb24ndCBleGlzdAogICAgICAgICBhbmQgdGhlc2UgYXJlIG5vLW9wcy4gKi8KICAgICAgICAgCiAgICAgIGRlbGV0ZSB0aGlzLmN1YmU7CiAgICAgIGRlbGV0ZSB0aGlzLnNwaGVyZTsKICAgICAgCiAgICAgIE9iamVjdC5rZXlzKG9ianMpLmZvckVhY2goZnVuY3Rpb24oa2V5KXsKICAgICAgICBzZWxmLmluaXRTdWJzY2VuZShwYXJzZUludChrZXksIDEwKSk7CiAgICAgIH0pOwoKICAgICAgdGhpcy5vbkNvbnRleHRSZXN0b3JlZCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHNlbGYuaW5pdEdMKCk7CiAgICAgICAgc2VsZi5kcmF3U2NlbmUoKTsKICAgICAgfTsKCiAgICAgIHRoaXMub25Db250ZXh0TG9zdCA9IGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgaWYgKCFzZWxmLmRyYXdpbmcpCiAgICAgICAgICB0aGlzLmdsID0gbnVsbDsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICB9OwoKICAgICAgdGhpcy5pbml0R0wwKCk7CiAgICAgIHRoaXMubGF6eUxvYWRTY2VuZSA9IGZ1bmN0aW9uKCkgewogICAgICAJaWYgKHR5cGVvZiBzZWxmLnNsaWRlID09PSAidW5kZWZpbmVkIikKICAgICAgCSAgc2VsZi5zbGlkZSA9IHNlbGYuZ2V0U2xpZGUoKTsKICAgICAgCWlmIChzZWxmLmlzSW5Ccm93c2VyVmlld3BvcnQoKSkgewogICAgICAJICBpZiAoIXNlbGYuZ2wgfHwgc2VsZi5nbC5pc0NvbnRleHRMb3N0KCkpCiAgICAgIAkgICAgc2VsZi5pbml0R0woKTsKICAgICAgCSAgc2VsZi5kcmF3U2NlbmUoKTsKICAgICAgCX0KICAgICAgfTsKICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCB0aGlzLmxhenlMb2FkU2NlbmUsIGZhbHNlKTsKICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLCB0aGlzLmxhenlMb2FkU2NlbmUsIGZhbHNlKTsKICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsIHRoaXMubGF6eUxvYWRTY2VuZSwgZmFsc2UpOwogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigic2Nyb2xsIiwgdGhpcy5sYXp5TG9hZFNjZW5lLCBmYWxzZSk7CiAgICAgIHRoaXMuc2xpZGUgPSB0aGlzLmdldFNsaWRlKCk7CiAgICAgIGlmICh0aGlzLnNsaWRlKSB7CiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnNsaWRlLnJnbCA9PT0gInVuZGVmaW5lZCIpCiAgICAgICAgICB0aGlzLnNsaWRlLnJnbCA9IFt0aGlzXTsKICAgICAgICBlbHNlCiAgICAgICAgICB0aGlzLnNsaWRlLnJnbC5wdXNoKHRoaXMpOwogICAgICAgIGlmICh0aGlzLnNjZW5lLmNvbnRleHQucm1hcmtkb3duKSAKICAgICAgICAgIGlmICh0aGlzLnNjZW5lLmNvbnRleHQucm1hcmtkb3duID09PSAiaW9zbGlkZXNfcHJlc2VudGF0aW9uIikgewogICAgICAgICAgICB0aGlzLnNsaWRlLnNldEF0dHJpYnV0ZSgic2xpZGVlbnRlciIsICJ0aGlzLnJnbC5mb3JFYWNoKGZ1bmN0aW9uKHNjZW5lKSB7IHNjZW5lLmxhenlMb2FkU2NlbmUuY2FsbCh3aW5kb3cpO30pIik7CiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc2NlbmUuY29udGV4dC5ybWFya2Rvd24gPT09ICJzbGlkeV9wcmVzZW50YXRpb24iKSB7CiAgICAgICAgICAgIC8vIFRoaXMgbWV0aG9kIHdvdWxkIGFsc28gd29yayBpbiBpb3NsaWRlcywgYnV0IGl0IGdldHMgdHJpZ2dlcmVkCiAgICAgICAgICAgIC8vIHNvbWV0aGluZyBsaWtlIDUgdGltZXMgcGVyIHNsaWRlIGZvciBldmVyeSBzbGlkZSBjaGFuZ2UsIHNvCiAgICAgICAgICAgIC8vIHlvdSdkIG5lZWQgYSBxdWlja2VyIGZ1bmN0aW9uIHRoYW4gbGF6eUxvYWRTY2VuZS4KICAgICAgICAgICAgdmFyIE11dGF0aW9uT2JzZXJ2ZXIgPSB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuTW96TXV0YXRpb25PYnNlcnZlciwKICAgICAgICAgICAgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihtdXRhdGlvbnMpIHsKICAgICAgICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHNlbGYuc2xpZGUucmdsLmZvckVhY2goZnVuY3Rpb24oc2NlbmUpIHsgc2NlbmUubGF6eUxvYWRTY2VuZS5jYWxsKHdpbmRvdyk7IH0pO30pO30pOwogICAgICAgICAgICBvYnNlcnZlci5vYnNlcnZlKHRoaXMuc2xpZGUsIHsgYXR0cmlidXRlczogdHJ1ZSwgYXR0cmlidXRlRmlsdGVyOlsiY2xhc3MiXSB9KTsKICAgICAgICAgIH0KICAgICAgfQogICAgfTsK"></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,LyoqCiAqIE1ldGhvZHMgcmVsYXRlZCB0byBkcmF3aW5nIHRyYW5zcGFyZW50IG9iamVjdHMKICogQG5hbWUgX19fTUVUSE9EU19GT1JfVFJBTlNQQVJFTkNZX19fCiAqIEBtZW1iZXJvZiByZ2x3aWRnZXRDbGFzcwogKiBAa2luZCBmdW5jdGlvbgogKiBAaW5zdGFuY2UKCiAqIFRoZXNlIGZ1bmN0aW9ucyBvcmRlciB0aGUgY2VudGVycyBvZiBkaXNwbGF5ZWQgb2JqZWN0cyBzbyB0aGV5CiAqIGNhbiBiZSBkcmF3biB1c2luZyB0aGUgcGFpbnRlcnMgYWxnb3JpdGhtLCBuZWNlc3NhcnkgdG8gc3VwcG9ydAogKiB0cmFuc3BhcmVuY3kuICAKCiAqIE5vdGUgdGhhdCBvYmppZCBpcyBub3Qgb2JqLmlkIHdoZW4gZHJhd2luZyBzcGhlcmVzLgogKi8KCi8qKgogKiBCcmVhayBvYmplY3RzIGludG8gcGllY2VzCiAqIEByZXR1cm5zIHsgYXJyYXkgfSBBcnJheSBvZiBwaWVjZXMKICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZ2V0UGllY2VzID0gZnVuY3Rpb24oY29udGV4dCwgb2JqaWQsIHN1YmlkLCBvYmopIHsKICAgICAgdmFyIG4gPSBvYmouY2VudGVycy5sZW5ndGgsCiAgICAgICAgICBkZXB0aCwKICAgICAgICAgIHJlc3VsdCA9IG5ldyBBcnJheShuKSwKICAgICAgICAgIHosIHcsIGksCiAgICAgICAgICBtZWFuZGVwdGggPSAwOwogICAgICBjb250ZXh0ID0gY29udGV4dC5zbGljZSgpOwogICAgICAgICAgCiAgICAgIGZvcihpPTA7IGk8bjsgaSsrKSB7CiAgICAgICAgeiA9IHRoaXMucHJtdk1hdHJpeC5tMTMqb2JqLmNlbnRlcnNbaV1bMF0gKwogICAgICAgICAgICB0aGlzLnBybXZNYXRyaXgubTIzKm9iai5jZW50ZXJzW2ldWzFdICsKICAgICAgICAgICAgdGhpcy5wcm12TWF0cml4Lm0zMypvYmouY2VudGVyc1tpXVsyXSArCiAgICAgICAgICAgIHRoaXMucHJtdk1hdHJpeC5tNDM7CiAgICAgICAgdyA9IHRoaXMucHJtdk1hdHJpeC5tMTQqb2JqLmNlbnRlcnNbaV1bMF0gKwogICAgICAgICAgICB0aGlzLnBybXZNYXRyaXgubTI0Km9iai5jZW50ZXJzW2ldWzFdICsKICAgICAgICAgICAgdGhpcy5wcm12TWF0cml4Lm0zNCpvYmouY2VudGVyc1tpXVsyXSArCiAgICAgICAgICAgIHRoaXMucHJtdk1hdHJpeC5tNDQ7CiAgICAgICAgZGVwdGggPSB6L3c7CiAgICAgICAgbWVhbmRlcHRoICs9IGRlcHRoOwogICAgICAgIHJlc3VsdFtpXSA9IHtjb250ZXh0OiBjb250ZXh0LCAKICAgICAgICAgICAgICAgICAgICAgb2JqaWQ6IG9iamlkLAogICAgICAgICAgICAgICAgICAgICBzdWJpZDogc3ViaWQsCiAgICAgICAgICAgICAgICAgICAgIGluZGV4OiBpLCAKICAgICAgICAgICAgICAgICAgICAgZGVwdGg6IGRlcHRoLAogICAgICAgICAgICAgICAgICAgICBtZWFuZGVwdGg6IDB9OwogICAgICB9CiAgICAgIG1lYW5kZXB0aCAvPSBuOwogICAgICBmb3IgKGk9MDsgaTxuOyBpKyspCiAgICAgICAgcmVzdWx0W2ldLm1lYW5kZXB0aCA9IG1lYW5kZXB0aDsKICAgICAgcmV0dXJuIHJlc3VsdDsgICAgCiAgICB9OwogICAgCiAgICAvKioKICAgICAqIEdldCBwaWVjZXMgZnJvbSBzcGhlcmUKICAgICAqIEByZXR1cm5zIHsgb2JqZWN0IH0KICAgICAqIEBwYXJhbSB7IGFycmF5IH0gY29udGV4dCAtIAogICAgICogQHBhcmFtIHsgbnVtZXJpYyB9IHN1YmlkIC0gc3Vic2NlbmUKICAgICAqIEBwYXJhbSB7IG9iamVjdCB9IG9iaiAtIHNwaGVyZXMgb2JqZWN0CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5nZXRTcGhlcmVQaWVjZXMgPSBmdW5jdGlvbihjb250ZXh0LCBzdWJpZCwgb2JqKQogICAgewogICAgICBpZiAob2JqLmZhc3RUcmFuc3BhcmVuY3kpIAogICAgICAgIGlmIChzdWJpZCA9PT0gMCkgLy8gT25seSBjb21wdXRlIHBpZWNlcyBvbmNlCiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRQaWVjZXMoY29udGV4dCwgb2JqLmlkLCAtMSwgb2JqKTsKICAgICAgICBlbHNlCiAgICAgICAgICByZXR1cm4gW107CiAgICAgIGVsc2UKICAgICAgICByZXR1cm4gdGhpcy5nZXRQaWVjZXMoY29udGV4dCwgb2JqLmlkLCBzdWJpZCwgdGhpcy5zcGhlcmUpOwogICAgfTsKICAgIAogICAvKioKICAgICAqIEdldCBwaWVjZXMgZnJvbSBjdWJlCiAgICAgKiBAcmV0dXJucyB7IG9iamVjdCB9CiAgICAgKiBAcGFyYW0geyBhcnJheSB9IGNvbnRleHQgLSAKICAgICAqIEBwYXJhbSB7IG51bWVyaWMgfSBzdWJpZCAtIHN1YnNjZW5lCiAgICAgKiBAcGFyYW0geyBvYmplY3QgfSBvYmogLSBzcGhlcmVzIG9iamVjdAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZ2V0Q3ViZVBpZWNlcyA9IGZ1bmN0aW9uKGNvbnRleHQsIG9iaikKICAgIHsKICAgICAgcmV0dXJuIHRoaXMuZ2V0UGllY2VzKGNvbnRleHQsIG9iai5pZCwgMCwgdGhpcy5jdWJlKTsKICAgIH07CiAgICAKICAgIC8qKgogICAgICogTWVyZ2UgcGllY2VzIHRoYXQgY2FuIGJlIGRyYXduIGluIG9uZSBjYWxsCiAgICAgKiBAcmV0dXJucyB7IG9iamVjdCB9CiAgICAgKiBAcGFyYW0geyBhcnJheSB9IHBpZWNlcyAtIFRoZSBwaWVjZXMgdG8gbWVyZ2UKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLm1lcmdlUGllY2VzID0gZnVuY3Rpb24ocGllY2VzKSB7CiAgICAgIHZhciByZXN1bHQgPSBbXTsKICAgICAgaWYgKHBpZWNlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgdmFyIGksCiAgICAgICAgICB0aGlzY29udGV4dCA9IHBpZWNlc1swXS5jb250ZXh0LCAKICAgICAgICAgIHRoaXNvYmppZCA9IHBpZWNlc1swXS5vYmppZCwgCiAgICAgICAgICB0aGlzc3ViaWQgPSBwaWVjZXNbMF0uc3ViaWQsCiAgICAgICAgICBpbmRpY2VzID0gW107CiAgICAgICAgZm9yIChpPSAwOyBpIDwgcGllY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBpZiAocGllY2VzW2ldLmNvbnRleHQgIT09IHRoaXNjb250ZXh0IHx8IAogICAgICAgICAgICAgIHBpZWNlc1tpXS5vYmppZCAhPT0gdGhpc29iamlkIHx8CiAgICAgICAgICAgICAgcGllY2VzW2ldLnN1YmlkICE9PSB0aGlzc3ViaWQpIHsKICAgICAgICAgICAgcmVzdWx0LnB1c2goe2NvbnRleHQ6IHRoaXNjb250ZXh0LCBvYmppZDogdGhpc29iamlkLAogICAgICAgICAgICAgICAgICAgICAgICAgc3ViaWQ6IHRoaXNzdWJpZCwgaW5kaWNlczogaW5kaWNlc30pOwogICAgICAgICAgICB0aGlzY29udGV4dCA9IHBpZWNlc1tpXS5jb250ZXh0OwogICAgICAgICAgICB0aGlzb2JqaWQgPSBwaWVjZXNbaV0ub2JqaWQ7CiAgICAgICAgICAgIHRoaXNzdWJpZCA9IHBpZWNlc1tpXS5zdWJpZDsKICAgICAgICAgICAgaW5kaWNlcyA9IFtdOwogICAgICAgICAgfQogICAgICAgICAgaW5kaWNlcy5wdXNoKHBpZWNlc1tpXS5pbmRleCk7CiAgICAgICAgfQogICAgICAgIHJlc3VsdC5wdXNoKHtjb250ZXh0OiB0aGlzY29udGV4dCwgb2JqaWQ6IHRoaXNvYmppZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJpZDogdGhpc3N1YmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGljZXM6IGluZGljZXN9KTsKICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKCiAgICAvKioKICAgICAqIFNvcnQgcGllY2VzIGJ5IGRlcHRoCiAgICAgKiBAcmV0dXJucyB7IGFycmF5IH0KICAgICAqIEBwYXJhbSB7IGFycmF5IH0gcGllY2VzIC0gYXJyYXkgb2YgcGllY2VzIAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuc29ydFBpZWNlcyA9IGZ1bmN0aW9uKHBpZWNlcykgewogICAgICB2YXIgZmFzdFRyYW5zcGFyZW5jeSA9IHRoaXMuc2NlbmUuZmFzdFRyYW5zcGFyZW5jeSwKICAgICAgICAgIGNvbXBhcmUgPSBmdW5jdGlvbihpLGopIHsKICAgICAgICAgIHZhciBjMSwgYzIsCiAgICAgICAgICAgICAgZGlmZiA9IGZhc3RUcmFuc3BhcmVuY3kgPyBqLm1lYW5kZXB0aCAtIGkubWVhbmRlcHRoIDogai5kZXB0aCAtIGkuZGVwdGg7CiAgICAgICAgICAgICAgCiAgICAgICAgLy8gQ2hlY2sgZm9yIGRpZmZlcmVudCBvYmplY3QgZGVwdGhzICAgICAKICAgICAgICBpZiAoZGlmZiAhPT0gMC4wKQogICAgICAgICAgcmV0dXJuIGRpZmY7CiAgICAgICAgICAKICAgICAgICAvLyBBdCB0aGlzIHBvaW50IHdlIGFyZSBlaXRoZXIgb24gdGhlIHNhbWUgb2JqZWN0IG9yCiAgICAgICAgLy8gdHdvIGRpZmZlcmVudCBvYmplY3RzIHRoYXQgYXJlIGF0IHRoZSBzYW1lIG1lYW4KICAgICAgICAvLyBkZXB0aC4gIENvbnRleHQgY2hhbmdlcyBhcmUgZXhwZW5zaXZlIHNvIGFyYml0cmFyaWx5CiAgICAgICAgLy8gc3BsaXQgdGhlIHR3byBvYmplY3RzLgogICAgICAgIAogICAgICAgIC8vIENoZWNrIGZvciBkaWZmZXJlbnQgb2JqZWN0cwogICAgICAgIGRpZmYgPSBqLm9iamlkIC0gaS5vYmppZDsKICAgICAgICBpZiAoZGlmZiAhPT0gMCkKICAgICAgICAgIHJldHVybiBkaWZmOwogICAgICAgICAgCiAgICAgICAgLy8gQ2hlY2sgZm9yIGRpZmZlcmVudCBuZXN0ZWQgb2JqZWN0cyAKICAgICAgICBjMSA9IGouY29udGV4dC5zbGljZSgpOwogICAgICAgIGMyID0gaS5jb250ZXh0LnNsaWNlKCk7CiAgICAgICAgZGlmZiA9IGMxLmxlbmd0aCAtIGMyLmxlbmd0aDsgCiAgICAgICAgd2hpbGUgKGRpZmYgPT09IDAgJiYgYzEubGVuZ3RoID4gMCkgewogICAgICAgICAgZGlmZiA9IGMxLnBvcCgpIC0gYzIucG9wKCk7CiAgICAgICAgfQogICAgICAgIGlmIChkaWZmICE9PSAwKQogICAgICAgICAgcmV0dXJuIGRpZmY7CiAgICAgICAgICAKICAgICAgICAvLyBCb3RoIHBpZWNlcyBhcmUgaW4gdGhlIHNhbWUgb2JqZWN0LCBzbwogICAgICAgIC8vIGNoZWNrIGZvciBkaWZmZXJlbnQgcGllY2UgZGVwdGhzCiAgICAgICAgLy8gSWYgZmFzdFRyYW5zcGFyZW5jeSBpcyBub3Qgc2V0LCB0aGlzIGlzIHJlZHVuZGFudCwKICAgICAgICAvLyBidXQgYSB0ZXN0IHdvdWxkIHByb2JhYmx5IGJlIHNsb3dlci4KICAgICAgICAKICAgICAgICBkaWZmID0gai5kZXB0aCAtIGkuZGVwdGg7CgogICAgICAgIHJldHVybiBkaWZmOwogICAgICAgIAogICAgICB9LCByZXN1bHQgPSBbXTsKICAgICAgaWYgKHBpZWNlcy5sZW5ndGgpIAogICAgICAgIHJlc3VsdCA9IHBpZWNlcy5zb3J0KGNvbXBhcmUpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsK"></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,ICAgIC8qKgogICAgICogTWV0aG9kcyByZWxhdGVkIHRvIGRyYXdpbmcKICAgICAqIEBuYW1lIF9fX01FVEhPRFNfRk9SX0RSQVdJTkdfX18KICAgICAqIEBtZW1iZXJvZiByZ2x3aWRnZXRDbGFzcwogICAgICogQGtpbmQgZnVuY3Rpb24KICAgICAqIEBpbnN0YW5jZQogICAgICovCiAgICAgCiAgICAvKioKICAgICAqIFN0YXJ0IGRyYXdpbmcKICAgICAqIEByZXR1cm5zIHsgYm9vbGVhbiB9IFByZXZpb3VzIHN0YXRlCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5zdGFydERyYXdpbmcgPSBmdW5jdGlvbigpIHsKICAgIAl2YXIgdmFsdWUgPSB0aGlzLmRyYXdpbmc7CiAgICAJdGhpcy5kcmF3aW5nID0gdHJ1ZTsKICAgIAlyZXR1cm4gdmFsdWU7CiAgICB9OwoKICAgIC8qKgogICAgICogU3RvcCBkcmF3aW5nIGFuZCBjaGVjayBmb3IgY29udGV4dCBsb3NzCiAgICAgKiBAcGFyYW0geyBib29sZWFuIH0gc2F2ZWQgLSBQcmV2aW91cyBzdGF0ZQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuc3RvcERyYXdpbmcgPSBmdW5jdGlvbihzYXZlZCkgewogICAgICB0aGlzLmRyYXdpbmcgPSBzYXZlZDsKICAgICAgaWYgKCFzYXZlZCAmJiB0aGlzLmdsICYmIHRoaXMuZ2wuaXNDb250ZXh0TG9zdCgpKQogICAgICAgIHRoaXMucmVzdGFydENhbnZhcygpOwogICAgfTsKCiAgICAvKioKICAgICAqIFVwZGF0ZSB0aGUgdHJpYW5nbGVzIHVzZWQgdG8gZGlzcGxheSBhIHBsYW5lCiAgICAgKiBAcGFyYW0geyBudW1iZXIgfSBpZCAtIGlkIG9mIHRoZSBwbGFuZQogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gYmJveCAtIGJvdW5kaW5nIGJveCBpbiB3aGljaCB0byBkaXNwbGF5IHRoZSBwbGFuZQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUucGxhbmVVcGRhdGVUcmlhbmdsZXMgPSBmdW5jdGlvbihvYmosIGJib3gpIHsKICAgICAgdmFyIHBlcm1zID0gW1swLDAsMV0sIFsxLDIsMl0sIFsyLDEsMF1dLAogICAgICAgICAgeCwgeHJvdywgZWxlbSwgQSwgZCwgbmhpdHMsIGksIGosIGssIHUsIHYsIHcsIGludGVyc2VjdCwgd2hpY2gsIHYwLCB2MiwgdngsIHJldmVyc2UsCiAgICAgICAgICBmYWNlMSA9IFtdLCBmYWNlMiA9IFtdLCBub3JtYWxzID0gW10sCiAgICAgICAgICBuUGxhbmVzID0gb2JqLm5vcm1hbHMubGVuZ3RoLCBpZHgsIGNlbnRlcjsKICAgICAgb2JqLmJib3ggPSBiYm94OwogICAgICBvYmoudmVydGljZXMgPSBbXTsKICAgICAgb2JqLmNlbnRlcnMgPSBbXTsKICAgICAgb2JqLmluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgIGZvciAoZWxlbSA9IDA7IGVsZW0gPCBuUGxhbmVzOyBlbGVtKyspIHsKLy8gICAgVmVydGV4IEF2ID0gbm9ybWFsLmdldFJlY3ljbGVkKGVsZW0pOwogICAgICAgIHggPSBbXTsKICAgICAgICBBID0gb2JqLm5vcm1hbHNbZWxlbV07CiAgICAgICAgZCA9IG9iai5vZmZzZXRzW2VsZW1dWzBdOwogICAgICAgIG5oaXRzID0gMDsKICAgICAgICBmb3IgKGk9MDsgaTwzOyBpKyspCiAgICAgICAgICBmb3IgKGo9MDsgajwyOyBqKyspCiAgICAgICAgICAgIGZvciAoaz0wOyBrPDI7IGsrKykgewogICAgICAgICAgICAgIHUgPSBwZXJtc1swXVtpXTsKICAgICAgICAgICAgICB2ID0gcGVybXNbMV1baV07CiAgICAgICAgICAgICAgdyA9IHBlcm1zWzJdW2ldOwogICAgICAgICAgICAgIGlmIChBW3ddICE9PSAwLjApIHsKICAgICAgICAgICAgICAgIGludGVyc2VjdCA9IC0oZCArIEFbdV0qYmJveFtqKzIqdV0gKyBBW3ZdKmJib3hbaysyKnZdKS9BW3ddOwogICAgICAgICAgICAgICAgaWYgKGJib3hbMip3XSA8IGludGVyc2VjdCAmJiBpbnRlcnNlY3QgPCBiYm94WzErMip3XSkgewogICAgICAgICAgICAgICAgICB4cm93ID0gW107CiAgICAgICAgICAgICAgICAgIHhyb3dbdV0gPSBiYm94W2orMip1XTsKICAgICAgICAgICAgICAgICAgeHJvd1t2XSA9IGJib3hbaysyKnZdOwogICAgICAgICAgICAgICAgICB4cm93W3ddID0gaW50ZXJzZWN0OwogICAgICAgICAgICAgICAgICB4LnB1c2goeHJvdyk7CiAgICAgICAgICAgICAgICAgIGZhY2UxW25oaXRzXSA9IGogKyAyKnU7CiAgICAgICAgICAgICAgICAgIGZhY2UyW25oaXRzXSA9IGsgKyAyKnY7CiAgICAgICAgICAgICAgICAgIG5oaXRzKys7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobmhpdHMgPiAzKSB7CiAgICAgICAgICAgIC8qIFJlLW9yZGVyIHRoZSBpbnRlcnNlY3Rpb25zIHNvIHRoZSB0cmlhbmdsZXMgd29yayAqLwogICAgICAgICAgICAgIGZvciAoaT0wOyBpPG5oaXRzLTI7IGkrKykgewogICAgICAgICAgICAgICAgd2hpY2ggPSAwOyAvKiBpbml0aWFsaXplIHRvIHN1cHByZXNzIHdhcm5pbmcgKi8KICAgICAgICAgICAgICAgIGZvciAoaj1pKzE7IGo8bmhpdHM7IGorKykgewogICAgICAgICAgICAgICAgICBpZiAoZmFjZTFbaV0gPT09IGZhY2UxW2pdIHx8IGZhY2UxW2ldID09PSBmYWNlMltqXSB8fAogICAgICAgICAgICAgICAgICAgICAgZmFjZTJbaV0gPT09IGZhY2UxW2pdIHx8IGZhY2UyW2ldID09PSBmYWNlMltqXSApIHsKICAgICAgICAgICAgICAgICAgICB3aGljaCA9IGo7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICh3aGljaCA+IGkrMSkgewogICAgICAgICAgICAgICAgICByZ2x3aWRnZXRDbGFzcy5zd2FwKHgsIGkrMSwgd2hpY2gpOwogICAgICAgICAgICAgICAgICByZ2x3aWRnZXRDbGFzcy5zd2FwKGZhY2UxLCBpKzEsIHdoaWNoKTsKICAgICAgICAgICAgICAgICAgcmdsd2lkZ2V0Q2xhc3Muc3dhcChmYWNlMiwgaSsxLCB3aGljaCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChuaGl0cyA+PSAzKSB7CiAgICAgIC8qIFB1dCBpbiBvcmRlciBzbyB0aGF0IHRoZSBub3JtYWwgcG9pbnRzIG91dCB0aGUgRlJPTlQgb2YgdGhlIGZhY2VzICovCiAgICAgICAgICAgICAgdjAgPSBbeFswXVswXSAtIHhbMV1bMF0gLCB4WzBdWzFdIC0geFsxXVsxXSwgeFswXVsyXSAtIHhbMV1bMl1dOwogICAgICAgICAgICAgIHYyID0gW3hbMl1bMF0gLSB4WzFdWzBdICwgeFsyXVsxXSAtIHhbMV1bMV0sIHhbMl1bMl0gLSB4WzFdWzJdXTsKICAgICAgICAgICAgICAvKiBjcm9zcy1wcm9kdWN0ICovCiAgICAgICAgICAgICAgdnggPSByZ2x3aWRnZXRDbGFzcy54cHJvZCh2MCwgdjIpOwogICAgICAgICAgICAgIHJldmVyc2UgPSByZ2x3aWRnZXRDbGFzcy5kb3Rwcm9kKHZ4LCBBKSA+IDA7CgogICAgICAgICAgICAgIGZvciAoaT0wOyBpPG5oaXRzLTI7IGkrKykgewogICAgICAgICAgICAgICAgb2JqLnZlcnRpY2VzLnB1c2goeFswXSk7CiAgICAgICAgICAgICAgICBjZW50ZXIgPSBbXTsKICAgICAgICAgICAgICAgIGZvciAoayA9IDA7IGs8MzsgaysrKQogICAgICAgICAgICAgICAgICBjZW50ZXIucHVzaCh4WzBdW2tdLzMpOwogICAgICAgICAgICAgICAgbm9ybWFscy5wdXNoKEEpOwogICAgICAgICAgICAgICAgZm9yIChqPTE7IGo8MzsgaisrKSB7CiAgICAgICAgICAgICAgICAgIGlkeCA9IGkgKyAocmV2ZXJzZSA/IDMtaiA6IGopOwogICAgICAgICAgICAgICAgICBvYmoudmVydGljZXMucHVzaCh4W2lkeF0pOwogICAgICAgICAgICAgICAgICBmb3IgKGs9MDsgazwzOyBrKyspCiAgICAgICAgICAgICAgICAgICAgY2VudGVyW2tdICs9IHhbaWR4XVtrXS8zOwogICAgICAgICAgICAgICAgICBub3JtYWxzLnB1c2goQSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBvYmouY2VudGVycy5wdXNoKGNlbnRlcik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgIH0KICAgICAgb2JqLnBub3JtYWxzID0gbm9ybWFsczsKICAgIH07CiAgICAKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5tb2RlNHR5cGUgPSB7cG9pbnRzIDogIlBPSU5UUyIsCiAgICAgICAgICAgICAgICAgICAgIGxpbmVzdHJpcCA6ICJMSU5FX1NUUklQIiwKICAgICAgICAgICAgICAgICAgICAgYWJjbGluZXMgOiAiTElORVMiLAogICAgICAgICAgICAgICAgICAgICBsaW5lcyA6ICJMSU5FUyIsCiAgICAgICAgICAgICAgICAgICAgIHNwcml0ZXMgOiAiVFJJQU5HTEVTIiwKICAgICAgICAgICAgICAgICAgICAgcGxhbmVzIDogIlRSSUFOR0xFUyIsCiAgICAgICAgICAgICAgICAgICAgIHRleHQgOiAiVFJJQU5HTEVTIiwKICAgICAgICAgICAgICAgICAgICAgcXVhZHMgOiAiVFJJQU5HTEVTIiwKICAgICAgICAgICAgICAgICAgICAgc3VyZmFjZSA6ICJUUklBTkdMRVMiLAogICAgICAgICAgICAgICAgICAgICB0cmlhbmdsZXMgOiAiVFJJQU5HTEVTIiwKICAgICAgICAgICAgICAgICAgICAgc3BoZXJlIDogIlRSSUFOR0xFUyIKICAgIH07CiAgICAKICAgIC8qKgogICAgICogRGlzYWJsZSB1bnVzZWQgYXJyYXlzCiAgICAgKiBAcGFyYW0geyBPYmplY3QgfSBvYmogLSBPYmplY3QgdG8gd29yayB3aXRoCiAgICAgKiBAcGFyYW0geyBBcnJheSB9IGVuYWJsZWQgLSBBcnJheSBpbmRpY2F0aW5nIHdoaWNoIGFyZSBlbmFibGVkCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5kaXNhYmxlQXJyYXlzID0gZnVuY3Rpb24ob2JqLCBlbmFibGVkKSB7CiAgICAgIHZhciBnbCA9IHRoaXMuZ2wgfHwgdGhpcy5pbml0R0woKSwKICAgICAgICAgIG9iakxvY3MgPSBbIm5vcm1Mb2MiLCAidGV4TG9jIiwgIm9mc0xvYyIsICJwb2ludExvYyIsICJuZXh0TG9jIl0sCiAgICAgICAgICB0aGlzTG9jcyA9IFsicG9zTG9jIiwgImNvbExvYyJdLCBpLCBhdHRyOwogICAgICBmb3IgKGkgPSAwOyBpIDwgb2JqTG9jcy5sZW5ndGg7IGkrKykgCiAgICAgICAgaWYgKGVuYWJsZWRbb2JqTG9jc1tpXV0pIGdsLmRpc2FibGVWZXJ0ZXhBdHRyaWJBcnJheShvYmpbb2JqTG9jc1tpXV0pOwogICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpc0xvY3MubGVuZ3RoOyBpKyspCiAgICAgICAgaWYgKGVuYWJsZWRbdGhpc0xvY3NbaV1dKSBnbC5kaXNhYmxlVmVydGV4QXR0cmliQXJyYXkodGhpc1tvYmpMb2NzW2ldXSk7CiAgICAgIGlmICh0eXBlb2Ygb2JqLnVzZXJBdHRyaWJ1dGVzICE9PSAidW5kZWZpbmVkIikgewogICAgICAJZm9yIChhdHRyIGluIG9iai51c2VyQXR0cmliU2l6ZXMpIHsgIC8vIE5vdCBhbGwgYXR0cmlidXRlcyBtYXkgaGF2ZSBiZWVuIHVzZWQKICAgICAgCSAgZ2wuZGlzYWJsZVZlcnRleEF0dHJpYkFycmF5KCBvYmoudXNlckF0dHJpYkxvY2F0aW9uc1thdHRyXSApOwogICAgICAJfQogICAgICB9CiAgICB9OwoKICAgIC8qKgogICAgICogU3RhcnQgZHJhd2luZyB0aGUgc2NlbmUKICAgICAqLyAgICAKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5kb1N0YXJ0U2NlbmUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGdsID0gdGhpcy5nbCB8fCB0aGlzLmluaXRHTCgpOwogICAgICBnbC5lbmFibGUoZ2wuREVQVEhfVEVTVCk7CiAgICAgIGdsLmRlcHRoRnVuYyhnbC5MRVFVQUwpOwogICAgICBnbC5jbGVhckRlcHRoKDEuMCk7CiAgICAgIGdsLmNsZWFyQ29sb3IoMSwxLDEsMSk7CiAgICAgIGdsLmRlcHRoTWFzayh0cnVlKTsgLy8gTXVzdCBiZSB0cnVlIGJlZm9yZSBjbGVhcmluZyBkZXB0aCBidWZmZXIKICAgICAgLyoganNoaW50IGJpdHdpc2U6IGZhbHNlICovCiAgICAgIGdsLmNsZWFyKGdsLkNPTE9SX0JVRkZFUl9CSVQgfCBnbC5ERVBUSF9CVUZGRVJfQklUKTsKICAgICAgLyoganNoaW50IGJpdHdpc2U6IHRydWUgKi8KICAgIH07CiAgICAKICAgIC8qKgogICAgICogU2V0IGdsIGRlcHRoIHRlc3QgYmFzZWQgb24gb2JqZWN0J3MgbWF0ZXJpYWwKICAgICAqIEBwYXJhbSB7IE9iamVjdCB9IG9iaiAtIG9iamVjdCB0byB1c2UKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmRvRGVwdGhUZXN0ID0gZnVuY3Rpb24ob2JqKSB7CiAgICAgIHZhciBnbCA9IHRoaXMuZ2wsCiAgICAgICAgICB0ZXN0cyA9IHtuZXZlcjogZ2wuTkVWRVIsCiAgICAgICAgICAgICAgICAgICBsZXNzOiAgZ2wuTEVTUywKICAgICAgICAgICAgICAgICAgIGVxdWFsOiBnbC5FUVVBTCwKICAgICAgICAgICAgICAgICAgIGxlcXVhbDpnbC5MRVFVQUwsCiAgICAgICAgICAgICAgICAgICBncmVhdGVyOiBnbC5HUkVBVEVSLAogICAgICAgICAgICAgICAgICAgbm90ZXF1YWw6IGdsLk5PVEVRVUFMLAogICAgICAgICAgICAgICAgICAgZ2VxdWFsOiBnbC5HRVFVQUwsCiAgICAgICAgICAgICAgICAgICBhbHdheXM6IGdsLkFMV0FZU30sCiAgICAgICAgICAgdGVzdCA9IHRlc3RzW3RoaXMuZ2V0TWF0ZXJpYWwob2JqLCAiZGVwdGhfdGVzdCIpXTsKICAgICAgZ2wuZGVwdGhGdW5jKHRlc3QpOwogICAgfTsgICAgCiAgICAKICAgIC8qKgogICAgICogU2V0IHBvbHlnb24gb2Zmc2V0IGZvciBhbiBvYmoKICAgICAqIEBwYXJhbSB7IG9iamVjdCB9IG9iaiAtIG9iamVjdCB0byB1c2UKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmRvUG9seWdvbk9mZnNldCA9IGZ1bmN0aW9uKG9iaikgeyAKICAgICAgdmFyIGdsID0gdGhpcy5nbDsKICAgICAgaWYgKHR5cGVvZiBvYmoucG9seWdvbl9vZmZzZXQgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgZ2wucG9seWdvbk9mZnNldChvYmoucG9seWdvbl9vZmZzZXRbMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLnBvbHlnb25fb2Zmc2V0WzFdKTsKICAgICAgICBnbC5lbmFibGUoZ2wuUE9MWUdPTl9PRkZTRVRfRklMTCk7CiAgICAgIH0gZWxzZQogICAgICAgIGdsLmRpc2FibGUoZ2wuUE9MWUdPTl9PRkZTRVRfRklMTCk7CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIERvIGNvZGUgZm9yIGNsaXBwaW5nCiAgICAgKiBAcGFyYW0geyBvYmplY3QgfSBvYmogLSBPYmplY3QgdG8gd29yayB3aXRoCiAgICAgKiBAcGFyYW0geyBvYmplY3QgfSBzdWJzY2VuZSAtIFN1YnNjZW5lIHRvIHdvcmsgd2l0aAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZG9DbGlwcGluZyA9IGZ1bmN0aW9uKG9iaiwgc3Vic2NlbmUpIHsKICAgICAgdmFyIGdsID0gdGhpcy5nbCwKICAgICAgICAgIGNsaXBjaGVjayA9IDAsCiAgICAgICAgICBjbGlwcGxhbmVpZHMgPSBzdWJzY2VuZS5jbGlwcGxhbmVzLAogICAgICAgICAgY2xpcCwgaSxqLCBuID0gdGhpcy5jb3VudENsaXBwbGFuZXMoKSwKICAgICAgICAgIGNsaXBwbGFuZWRhdGE7IAogICAgICAgICAgCiAgICAgIGlmIChuID4gMCkgewogICAgICAgIGNsaXBwbGFuZWRhdGEgPSBuZXcgRmxvYXQzMkFycmF5KDQqbik7CiAgICAgICAgZm9yIChpPTA7IGkgPCBjbGlwcGxhbmVpZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNsaXAgPSB0aGlzLmdldE9iaihjbGlwcGxhbmVpZHNbaV0pOwogICAgICAgICAgZm9yIChqPTA7IGogPCBjbGlwLm9mZnNldHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgY2xpcHBsYW5lZGF0YS5zZXQoY2xpcC5JTVZDbGlwW2pdLCBjbGlwY2hlY2spOwogICAgICAgICAgICBjbGlwY2hlY2sgKz0gNDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIAogICAgICAgIC8vIExlZnRvdmVycyBhcmUgaW5pdGlhbGl6ZWQgdG8gemVybywgd2hpY2ggaXMgZmluZQogICAgICAgIGdsLnVuaWZvcm00ZnYob2JqLmNsaXBMb2MsIGNsaXBwbGFuZWRhdGEpOwogICAgICB9CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIERvIGNvZGUgZm9yIGxpZ2h0aW5nCiAgICAgKiBAcGFyYW0geyBvYmplY3QgfSBvYmogLSBPYmplY3QgdG8gd29yayB3aXRoCiAgICAgKiBAcGFyYW0geyBvYmplY3QgfSBzdWJzY2VuZSAtIFN1YnNjZW5lIHRvIHdvcmsgd2l0aAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZG9MaWdodGluZyA9IGZ1bmN0aW9uKG9iaiwgc3Vic2NlbmUpIHsKICAgIHZhciBnbCA9IHRoaXMuZ2wsIGksIGosIG4sIGxpZ2h0LAogICAgICBhbWJpZW50LCBzcGVjdWxhciwgZGlmZnVzZSwgbGlnaHREaXIsIHZpZXdwb2ludCwgZmluaXRlLAogICAgICBhbWJpZW50MCwgc3BlY3VsYXIwOwoKICAgICAgZ2wudW5pZm9ybTNmdiggb2JqLmVtaXNzaW9uTG9jLCBvYmouZW1pc3Npb24pOwogICAgICBnbC51bmlmb3JtMWYoIG9iai5zaGluaW5lc3NMb2MsIG9iai5zaGluaW5lc3MpOwogICAgICB3aGlsZSAoKHR5cGVvZiBzdWJzY2VuZS5saWdodHMgPT09ICJ1bmRlZmluZWQiIHx8CiAgICAgICAgICAgICAgc3Vic2NlbmUubGlnaHRzLmxlbmd0aCA9PT0gMCkgJiYgCiAgICAgICAgICAgICB0eXBlb2Ygc3Vic2NlbmUucGFyZW50ICE9PSAidW5kZWZpbmVkIikKICAgICAgICBzdWJzY2VuZSA9IHRoaXMuZ2V0T2JqKHN1YnNjZW5lLnBhcmVudCk7CgogICAgICBpZiAodHlwZW9mIHN1YnNjZW5lLmxpZ2h0cyA9PT0gInVuZGVmaW5lZCIpCiAgICAgICAgcmV0dXJuOwogICAgICAgIAogICAgICBuID0gc3Vic2NlbmUubGlnaHRzLmxlbmd0aDsKICAgICAgICAKICAgICAgYW1iaWVudCA9IG5ldyBGbG9hdDMyQXJyYXkoMypuKTsKICAgICAgc3BlY3VsYXIgPSBuZXcgRmxvYXQzMkFycmF5KDMqbik7CiAgICAgIGRpZmZ1c2UgPSBuZXcgRmxvYXQzMkFycmF5KDMqbik7CiAgICAgIGxpZ2h0RGlyID0gbmV3IEZsb2F0MzJBcnJheSgzKm4pOwogICAgICB2aWV3cG9pbnQgPSBuZXcgSW50MzJBcnJheShuKTsKICAgICAgZmluaXRlID0gbmV3IEludDMyQXJyYXkobik7CiAgICAgICAgICAKICAgICAgZm9yIChpPTA7IGkgPCBuOyBpKyspIHsKICAgICAgICBsaWdodCA9IHRoaXMuZ2V0T2JqKHN1YnNjZW5lLmxpZ2h0c1tpXSk7CiAgICAgICAgaWYgKCFsaWdodC5pbml0aWFsaXplZCkgdGhpcy5pbml0T2JqKGxpZ2h0KTsKICAgICAgICBhbWJpZW50MCA9IHRoaXMuY29tcG9uZW50UHJvZHVjdChsaWdodC5hbWJpZW50LCBvYmouYW1iaWVudCk7CiAgICAgICAgc3BlY3VsYXIwID0gdGhpcy5jb21wb25lbnRQcm9kdWN0KGxpZ2h0LnNwZWN1bGFyLCBvYmouc3BlY3VsYXIpOwogICAgICAgIGZvciAoaj0wOyBqIDwgMzsgaisrKSB7CiAgICAgICAgICBhbWJpZW50WzMqaSArIGpdID0gYW1iaWVudDBbal07CiAgICAgICAgICBzcGVjdWxhclszKmkgKyBqXSA9IHNwZWN1bGFyMFtqXTsKICAgICAgICAgIGRpZmZ1c2VbMyppICsgal0gPSBsaWdodC5kaWZmdXNlW2pdOwogICAgICAgICAgbGlnaHREaXJbMyppICsgal0gPSBsaWdodC5saWdodERpcltqXTsKICAgICAgICB9CiAgICAgICAgdmlld3BvaW50W2ldID0gbGlnaHQudmlld3BvaW50OwogICAgICAgIGZpbml0ZVtpXSA9IGxpZ2h0LmZpbml0ZTsKICAgICAgfQogICAgICAgIAogICAgICBmb3IgKGkgPSBuOyBpIDwgb2JqLm5saWdodHM7IGkrKykgewogICAgICAgIGZvciAoaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICAgIGFtYmllbnRbMyppICsgal0gPSAwLjA7CiAgICAgICAgICBzcGVjdWxhclszKmkgKyBqXSA9IDAuMDsKICAgICAgICAgIGRpZmZ1c2VbMyppICsgal0gPSAwLjA7CiAgICAgICAgfQogICAgICB9CiAgICAgICAgCiAgICAgIGdsLnVuaWZvcm0zZnYoIG9iai5hbWJpZW50TG9jLCBhbWJpZW50KTsKICAgICAgZ2wudW5pZm9ybTNmdiggb2JqLnNwZWN1bGFyTG9jLCBzcGVjdWxhcik7CiAgICAgIGdsLnVuaWZvcm0zZnYoIG9iai5kaWZmdXNlTG9jLCBkaWZmdXNlKTsKICAgICAgZ2wudW5pZm9ybTNmdiggb2JqLmxpZ2h0RGlyTG9jLCBsaWdodERpcik7CiAgICAgIGdsLnVuaWZvcm0xaXYoIG9iai52aWV3cG9pbnRMb2MsIHZpZXdwb2ludCk7CiAgICAgIGdsLnVuaWZvcm0xaXYoIG9iai5maW5pdGVMb2MsIGZpbml0ZSk7CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIERvIGNvZGUgZm9yIGNvbG9ycwogICAgICogQHBhcmFtIHsgb2JqZWN0IH0gb2JqIC0gT2JqZWN0IHRvIHdvcmsgd2l0aAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZG9Db2xvcnMgPSBmdW5jdGlvbihvYmopIHsKICAgICAgdmFyIGdsID0gdGhpcy5nbDsKICAgICAgaWYgKG9iai5jb2xvckNvdW50ID09PSAxKSB7CiAgICAgICAgZ2wuZGlzYWJsZVZlcnRleEF0dHJpYkFycmF5KCB0aGlzLmNvbExvYyApOwogICAgICAgIGdsLnZlcnRleEF0dHJpYjRmdiggdGhpcy5jb2xMb2MsIG5ldyBGbG9hdDMyQXJyYXkob2JqLm9uZWNvbG9yKSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIGdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KCB0aGlzLmNvbExvYyApOwogICAgICAgIGdsLnZlcnRleEF0dHJpYlBvaW50ZXIodGhpcy5jb2xMb2MsIDQsIGdsLkZMT0FULCBmYWxzZSwgNCpvYmoudk9mZnNldHMuc3RyaWRlLCA0Km9iai52T2Zmc2V0cy5jb2ZzKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfTsKICAgIAogICAgLyoqCiAgICAgKiBEbyBjb2RlIGZvciBub3JtYWxzCiAgICAgKiBAcGFyYW0geyBvYmplY3QgfSBvYmogLSBPYmplY3QgdG8gd29yayB3aXRoCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5kb05vcm1hbHMgPSBmdW5jdGlvbihvYmopIHsKICAgICAgdmFyIGdsID0gdGhpcy5nbDsKICAgICAgaWYgKG9iai52T2Zmc2V0cy5ub2ZzID49IDApIHsKICAgICAgICBnbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheSggb2JqLm5vcm1Mb2MgKTsKICAgICAgICBnbC52ZXJ0ZXhBdHRyaWJQb2ludGVyKG9iai5ub3JtTG9jLCAzLCBnbC5GTE9BVCwgZmFsc2UsIDQqb2JqLnZPZmZzZXRzLnN0cmlkZSwgNCpvYmoudk9mZnNldHMubm9mcyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH07CiAgICAKICAgIC8qKgogICAgICogRG8gY29kZSBmb3Igdk5vcm1hbAogICAgICogQHBhcmFtIHsgb2JqZWN0IH0gb2JqIC0gT2JqZWN0IHRvIHdvcmsgd2l0aAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZG9Ob3JtTWF0ID0gZnVuY3Rpb24ob2JqKSB7CiAgICAgIHZhciBnbCA9IHRoaXMuZ2w7CiAgICAgICAgCiAgICAgIGdsLnVuaWZvcm1NYXRyaXg0ZnYoIG9iai5ub3JtTWF0TG9jLCBmYWxzZSwgbmV3IEZsb2F0MzJBcnJheSh0aGlzLm5vcm1NYXRyaXguZ2V0QXNBcnJheSgpKSApOwogICAgfTsKICAgIAogICAgLyoqCiAgICAgKiBEbyBjb2RlIGZvciB0ZXh0dXJlcwogICAgICogQHBhcmFtIHsgb2JqZWN0IH0gb2JqIC0gT2JqZWN0IHRvIHdvcmsgd2l0aAogICAgICovICAgIAogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmRvVGV4dHVyZSA9IGZ1bmN0aW9uKG9iaikgewogICAgICB2YXIgZ2wgPSB0aGlzLmdsLCAKICAgICAgICAgIGlzX3NwaGVyZSA9IG9iai50eXBlID09PSAic3BoZXJlIjsKICAgICAgICBnbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheSggb2JqLnRleExvYyApOwogICAgICAgIGlmIChpc19zcGhlcmUpCiAgICAgICAgICBnbC52ZXJ0ZXhBdHRyaWJQb2ludGVyKG9iai50ZXhMb2MsIDIsIGdsLkZMT0FULCBmYWxzZSwgNCp0aGlzLnNwaGVyZS52T2Zmc2V0cy5zdHJpZGUsIDQqdGhpcy5zcGhlcmUudk9mZnNldHMudG9mcyk7CiAgICAgICAgZWxzZQogICAgICAgICAgZ2wudmVydGV4QXR0cmliUG9pbnRlcihvYmoudGV4TG9jLCAyLCBnbC5GTE9BVCwgZmFsc2UsIDQqb2JqLnZPZmZzZXRzLnN0cmlkZSwgNCpvYmoudk9mZnNldHMudG9mcyk7CiAgICAgICAgZ2wuYWN0aXZlVGV4dHVyZShnbC5URVhUVVJFMCk7CiAgICAgICAgZ2wuYmluZFRleHR1cmUoZ2wuVEVYVFVSRV8yRCwgb2JqLnRleHR1cmUpOwogICAgICAgIGdsLnVuaWZvcm0xaSggb2JqLnNhbXBsZXIsIDApOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfTsKICAgIAogICAgLyoqCiAgICAgKiBEbyBjb2RlIGZvciB1c2VyIGF0dHJpYnV0ZXMKICAgICAqIEBwYXJhbSB7IG9iamVjdCB9IG9iaiAtIE9iamVjdCB0byB3b3JrIHdpdGgKICAgICAqLyAgICAKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5kb1VzZXJBdHRyaWJ1dGVzID0gZnVuY3Rpb24ob2JqKSB7CiAgICAgIGlmICh0eXBlb2Ygb2JqLnVzZXJBdHRyaWJ1dGVzICE9PSAidW5kZWZpbmVkIikgewogICAgICAgIHZhciBnbCA9IHRoaXMuZ2w7CiAgICAgIAlmb3IgKHZhciBhdHRyIGluIG9iai51c2VyQXR0cmliU2l6ZXMpIHsgIC8vIE5vdCBhbGwgYXR0cmlidXRlcyBtYXkgaGF2ZSBiZWVuIHVzZWQKICAgICAgCSAgZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkoIG9iai51c2VyQXR0cmliTG9jYXRpb25zW2F0dHJdICk7CiAgICAgIAkgIGdsLnZlcnRleEF0dHJpYlBvaW50ZXIoIG9iai51c2VyQXR0cmliTG9jYXRpb25zW2F0dHJdLCBvYmoudXNlckF0dHJpYlNpemVzW2F0dHJdLAogICAgICAJICAJCQkgIGdsLkZMT0FULCBmYWxzZSwgNCpvYmoudk9mZnNldHMuc3RyaWRlLCA0Km9iai51c2VyQXR0cmliT2Zmc2V0c1thdHRyXSk7CiAgICAgIAl9CiAgICAgIH0KICAgIH07CgogICAgLyoqCiAgICAgKiBEbyBjb2RlIGZvciB1c2VyIHVuaWZvcm1zCiAgICAgKiBAcGFyYW0geyBvYmplY3QgfSBvYmogLSBPYmplY3QgdG8gd29yayB3aXRoCiAgICAgKi8gICAgCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZG9Vc2VyVW5pZm9ybXMgPSBmdW5jdGlvbihvYmopIHsKICAgICAgdmFyIGdsID0gdGhpcy5nbCwgYXR0cjsKICAgICAgaWYgKHR5cGVvZiBvYmoudXNlclVuaWZvcm1zICE9PSAidW5kZWZpbmVkIikgewogICAgICAJZm9yIChhdHRyIGluIG9iai51c2VyVW5pZm9ybUxvY2F0aW9ucykgewogICAgICAJICB2YXIgbG9jID0gb2JqLnVzZXJVbmlmb3JtTG9jYXRpb25zW2F0dHJdOwogICAgICAJICBpZiAobG9jICE9PSBudWxsKSB7CiAgICAgIAkgICAgdmFyIHVuaWZvcm0gPSBvYmoudXNlclVuaWZvcm1zW2F0dHJdOwogICAgICAJICAgIGlmICh0eXBlb2YgdW5pZm9ybSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgCSAgICAgIHZhciBkaW0gPSByZ2x3aWRnZXRDbGFzcy5hcnJheURpbSh1bmlmb3JtKTsKICAgICAgCSAgICAgIGlmIChkaW0ubGVuZ3RoID09PSAwKQogICAgICAJICAgICAgICBnbC51bmlmb3JtMWYobG9jLCB1bmlmb3JtKTsKICAgICAgCSAgICAgIGVsc2UgaWYgKGRpbS5sZW5ndGggPT09IDEpIHsKICAgICAgCSAgICAgICAgdW5pZm9ybSA9IG5ldyBGbG9hdDMyQXJyYXkodW5pZm9ybSk7CiAgICAgIAkgICAgICAgIHN3aXRjaCh1bmlmb3JtLmxlbmd0aCkgewogICAgICAJICAgICAgCSAgY2FzZSAyOiBnbC51bmlmb3JtMmZ2KGxvYywgdW5pZm9ybSk7IGJyZWFrOwogICAgICAJICAgICAgCSAgY2FzZSAzOiBnbC51bmlmb3JtM2Z2KGxvYywgdW5pZm9ybSk7IGJyZWFrOwogICAgICAJICAgICAgCSAgY2FzZSA0OiBnbC51bmlmb3JtNGZ2KGxvYywgdW5pZm9ybSk7IGJyZWFrOwogICAgICAJICAgICAgCSAgZGVmYXVsdDogY29uc29sZS53YXJuKCJiYWQgdW5pZm9ybSBsZW5ndGgiKTsKICAgICAgCSAgICAgICAgfQogICAgICAJICAgICAgfSBlbHNlIGlmIChkaW0ubGVuZ3RoID09PSAyICYmIGRpbVswXSA9PT0gNCAmJiBkaW1bMV0gPT09IDQpCiAgICAgIAkgICAgICAgIGdsLnVuaWZvcm1NYXRyaXg0ZnYobG9jLCBmYWxzZSwgbmV3IEZsb2F0MzJBcnJheShyZ2x3aWRnZXRDbGFzcy5mbGF0dGVuKHVuaWZvcm0pKSk7CiAgICAgIAkgICAgICBlbHNlIGlmIChkaW0ubGVuZ3RoID09PSAyKSB7CiAgICAgIAkgICAgICAgIHVuaWZvcm0gPSBuZXcgRmxvYXQzMkFycmF5KHJnbHdpZGdldENsYXNzLmZsYXR0ZW4odW5pZm9ybSkpOwogICAgICAJICAgICAgICBzd2l0Y2goZGltW1sxXV0pIHsKICAgICAgCSAgICAgICAgICBjYXNlIDE6IGdsLnVuaWZvcm0xZnYobG9jLCB1bmlmb3JtKTsgYnJlYWs7CiAgICAgIAkgICAgICAgICAgY2FzZSAyOiBnbC51bmlmb3JtMmZ2KGxvYywgdW5pZm9ybSk7IGJyZWFrOwogICAgICAJICAgICAgICAgIGNhc2UgMzogZ2wudW5pZm9ybTNmdihsb2MsIHVuaWZvcm0pOyBicmVhazsKICAgICAgCSAgICAgICAgICBjYXNlIDQ6IGdsLnVuaWZvcm00ZnYobG9jLCB1bmlmb3JtKTsgYnJlYWs7CiAgICAgIAkgICAgICAgICAgZGVmYXVsdDogY29uc29sZS53YXJuKCJiYWQgdW5pZm9ybSBjb2x1bW4gY291bnQiKTsKICAgICAgCSAgICAgICAgfQogICAgICAJICAgICAgfSBlbHNlCiAgICAgIAkgICAgICAgIGNvbnNvbGUud2FybigidW5zdXBwb3J0ZWQgdW5pZm9ybSBzaGFwZSIpOwogICAgICAJICAgIH0KICAgICAgCSAgfQogICAgICAJfQogICAgICB9CiAgICAgIGlmICh0eXBlb2Ygb2JqLnVzZXJUZXh0dXJlcyAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICB2YXIgaGFzX3RleHR1cmUgPSByZ2x3aWRnZXRDbGFzcy5pc1NldChvYmouZmxhZ3MsIHJnbHdpZGdldENsYXNzLmZfaGFzX3RleHR1cmUpLAogICAgICAgICAgICAgIHRleG51bSA9IGhhc190ZXh0dXJlIC0gMTsKICAgICAgICBmb3IgKGF0dHIgaW4gb2JqLnVzZXJUZXh0dXJlcykgewogICAgICAJICB2YXIgdGV4dHVyZSA9IG9iai51c2VyVGV4dHVyZXNbYXR0cl07CiAgICAgIAkgIGlmICh0ZXh0dXJlLnNhbXBsZXIgIT09IG51bGwpIHsKICAgICAgCSAgICB0ZXhudW0gKz0gMTsKICAgICAgCSAgICBnbC5hY3RpdmVUZXh0dXJlKGdsLlRFWFRVUkUwICsgdGV4bnVtKTsKICAgICAgICAgICAgZ2wuYmluZFRleHR1cmUoZ2wuVEVYVFVSRV8yRCwgdGV4dHVyZS50ZXh0dXJlKTsKICAgICAgICAgICAgZ2wudW5pZm9ybTFpKCB0ZXh0dXJlLnNhbXBsZXIsIHRleG51bSk7CiAgICAgIAkgIH0KICAgICAgCX0KICAgICAgfQogICAgfTsKCiAgICAvKioKICAgICAqIExvYWQgaW5kaWNlcyBmb3IgY29tcGxleCBkcmF3aW5nCiAgICAgKiBAcGFyYW0geyBvYmplY3QgfSBvYmogLSBPYmplY3QgdG8gd29yayB3aXRoCiAgICAgKiBAcGFyYW0geyBudW1lcmljIH0gcGFzcyAtIFdoaWNoIHBhc3Mgb2YgZHJhd2luZz8KICAgICAqIEBwYXJhbSB7IGFycmF5IH0gaW5kaWNlcyAtIEluZGljZXMgdG8gZHJhdwogICAgICovICAgIAogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmRvTG9hZEluZGljZXMgPSBmdW5jdGlvbihvYmosIHBhc3MsIGluZGljZXMpIHsKICAgICAgdmFyIGdsID0gdGhpcy5nbCwKICAgICAgICAgIGYgPSBvYmouZltwYXNzXSwKICAgICAgICAgIHR5cGUgPSBvYmoudHlwZSwKICAgICAgICAgIGZhdF9saW5lcyA9IHJnbHdpZGdldENsYXNzLmlzU2V0KG9iai5mbGFncywgcmdsd2lkZ2V0Q2xhc3MuZl9mYXRfbGluZXMpLAogICAgICAgICAgZm5ldywgc3RlcDsKICAgICAgc3dpdGNoKHR5cGUpewogICAgICAgIGNhc2UgInBvaW50cyI6CiAgICAgICAgICBzdGVwID0gMTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgImFiY2xpbmVzIjoKICAgICAgICBjYXNlICJsaW5lcyI6CiAgICAgICAgICBpZiAoZmF0X2xpbmVzKQogICAgICAgICAgICBzdGVwID0gNjsKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgc3RlcCA9IDI7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJsaW5lc3RyaXAiOgogICAgICAgICAgaWYgKGZhdF9saW5lcykKICAgICAgICAgICAgc3RlcCA9IDY7CiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHN0ZXAgPSAxOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAic3BoZXJlIjoKICAgICAgICBjYXNlICJwbGFuZXMiOgogICAgICAgIGNhc2UgInRyaWFuZ2xlcyI6CiAgICAgICAgICBzdGVwID0gMzsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgInRleHQiOgogICAgICAgIGNhc2UgInNwcml0ZXMiOgogICAgICAgIGNhc2UgInF1YWRzIjoKICAgICAgICBjYXNlICJzdXJmYWNlIjoKICAgICAgICAgIHN0ZXAgPSA2OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoImxvYWRJbmRpY2VzIGZvciAiK3R5cGUpOwogICAgICAgICAgcmV0dXJuIDA7CiAgICAgIH0KICAgICAgaWYgKG9iai5pbmRleF91aW50KQogICAgICAgIGZuZXcgPSBuZXcgVWludDMyQXJyYXkoc3RlcCAqIGluZGljZXMubGVuZ3RoKTsKICAgICAgZWxzZQogICAgICAgIGZuZXcgPSBuZXcgVWludDE2QXJyYXkoc3RlcCAqIGluZGljZXMubGVuZ3RoKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbmRpY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzdGVwOyBqKyspIHsKICAgICAgICAgIGZuZXdbc3RlcCppICsgal0gPSBmW3N0ZXAqaW5kaWNlc1tpXSArIGpdOwogICAgICAgIH0KICAgICAgfQogICAgICBnbC5idWZmZXJEYXRhKGdsLkVMRU1FTlRfQVJSQVlfQlVGRkVSLCBmbmV3LCBnbC5EWU5BTUlDX0RSQVcpOwogICAgICByZXR1cm4gZm5ldy5sZW5ndGg7CiAgICB9OwoKICAgIC8qKgogICAgICogRG8gY29kZSBmb3IgZGVwdGggbWFza2luZwogICAgICogQHBhcmFtIHsgYm9vbGVhbiB9IG1hc2sgLSB3aGV0aGVyIHRvIG1hc2sKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmRvTWFza2luZyA9IGZ1bmN0aW9uKG1hc2spIHsKICAgICAgdmFyIGdsID0gdGhpcy5nbDsKICAgICAgZ2wuZGVwdGhNYXNrKG1hc2spOwogICAgfTsKCiAgICAvKioKICAgICAqIERvIGNvZGUgZm9yIGFscGhhIGJsZW5kaW5nCiAgICAgKiBAcGFyYW0geyBib29sZWFuIH0gIGJsZW5kIC0gV2hldGhlciB0byBibGVuZC4KICAgICAqIEBwYXJhbSB7IGludGVnZXIgfSAgb2JqaWQgLSBPYmplY3QgaWQKICAgICAqLyAgICAKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5kb0JsZW5kaW5nID0gZnVuY3Rpb24oYmxlbmQsIG9iamlkKSB7CiAgICAgIHZhciBnbCA9IHRoaXMuZ2wsIGJsZW5kZnVuYywgb2JqLCAKICAgICAgICBibGVuZHMgPSAge3plcm86IGdsLlpFUk8sCiAgICAgICAgICAgICAgICAgICBvbmU6ICBnbC5PTkUsCiAgICAgICAgICAgICAgICAgICBzcmNfY29sb3I6IGdsLlNSQ19DT0xPUiwKICAgICAgICAgICAgICAgICAgIG9uZV9taW51c19zcmNfY29sb3I6IGdsLk9ORV9NSU5VU19TUkNfQ09MT1IsCiAgICAgICAgICAgICAgICAgICBkc3RfY29sb3I6IGdsLkRTVF9DT0xPUiwKICAgICAgICAgICAgICAgICAgIG9uZV9taW51c19kc3RfY29sb3I6IGdsLk9ORV9NSU5VU19EU1RfQ09MT1IsCiAgICAgICAgICAgICAgICAgICBzcmNfYWxwaGE6IGdsLlNSQ19BTFBIQSwKICAgICAgICAgICAgICAgICAgIG9uZV9taW51c19zcmNfYWxwaGE6IGdsLk9ORV9NSU5VU19TUkNfQUxQSEEsCiAgICAgICAgICAgICAgICAgICBkc3RfYWxwaGE6IGdsLkRTVF9BTFBIQSwKICAgICAgICAgICAgICAgICAgIG9uZV9taW51c19kc3RfYWxwaGE6IGdsLk9ORV9NSU5VU19EU1RfQUxQSEEsCiAgICAgICAgICAgICAgICAgICBjb25zdGFudF9jb2xvcjogZ2wuQ09OU1RBTlRfQ09MT1IsCiAgICAgICAgICAgICAgICAgICBvbmVfbWludXNfY29uc3RhbnRfY29sb3I6IGdsLk9ORV9NSU5VU19DT05TVEFOVF9DT0xPUiwKICAgICAgICAgICAgICAgICAgIGNvbnN0YW50X2FscGhhOiBnbC5DT05TVEFOVF9BTFBIQSwKICAgICAgICAgICAgICAgICAgIG9uZV9taW51c19jb25zdGFudF9hbHBoYTogZ2wuT05FX01JTlVTX0NPTlNUQU5UX0FMUEhBLAogICAgICAgICAgICAgICAgICAgc3JjX2FscGhhX3NhdHVyYXRlOiBnbC5TUkNfQUxQSEFfU0FUVVJBVEV9OwogICAgICBpZiAoYmxlbmQpIHsKICAgICAgICBvYmogPSB0aGlzLmdldE9iaihvYmppZCk7CiAgICAgICAgYmxlbmRmdW5jID0gdGhpcy5nZXRNYXRlcmlhbChvYmosICJibGVuZCIpOwogICAgICAgIGdsLmJsZW5kRnVuY1NlcGFyYXRlKGJsZW5kc1tibGVuZGZ1bmNbMF1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsZW5kc1tibGVuZGZ1bmNbMV1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdsLk9ORSwgZ2wuT05FKTsKICAgICAgICBnbC5lbmFibGUoZ2wuQkxFTkQpOwogICAgICB9IGVsc2UgewogICAgICAgIGdsLmRpc2FibGUoZ2wuQkxFTkQpOwogICAgICB9CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIFNldCB1cCBmb3IgZm9nIGluIHRoZSBzdWJzY2VuZQogICAgICogQHBhcmFtIHsgb2JqZWN0IH0gb2JqIC0gYmFja2dyb3VuZCBvYmplY3QKICAgICAqIEBwYXJhbSB7IG9iamVjdCB9IHN1YnNjZW5lIC0gd2hpY2ggc3Vic2NlbmUKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmRvRm9nID0gZnVuY3Rpb24ob2JqLCBzdWJzY2VuZSkgewogICAgICB2YXIgZ2wgPSB0aGlzLmdsLCBmb2dtb2RlLCBjb2xvciwgCiAgICAgICAgICBvYnNlcnZlciA9IHN1YnNjZW5lLnBhcjNkLm9ic2VydmVyWzJdLAogICAgICAgICAgc2ludGhldGEgPSBNYXRoLnNpbihzdWJzY2VuZS5wYXIzZC5GT1YqTWF0aC5QSS8xODAvMiksCiAgICAgICAgICBwYXJtcyA9IFt0aGlzLmZydXN0dW0ubmVhciAtIDIqb2JzZXJ2ZXIsCiAgICAgICAgICAgICAgICAgICB0aGlzLmZydXN0dW0uZmFyIC0gMipvYnNlcnZlciwKICAgICAgICAgICAgICAgICAgIHRoaXMuZm9nU2NhbGUsCiAgICAgICAgICAgICAgICAgICAoMS1zaW50aGV0YSkvKDErc2ludGhldGEpXTsKICAgICAgaWYgKHR5cGVvZiB0aGlzLmZvZ1R5cGUgPT09ICJ1bmRlZmluZWQiKQogICAgICAgIHRoaXMuZm9nVHlwZSA9ICJub25lIjsKICAgICAgaWYgKHR5cGVvZiB0aGlzLmZvZ1NjYWxlID09PSAidW5kZWZpbmVkIikKICAgICAgICBwYXJtc1syXSA9IDE7CiAgICAgIGlmIChzaW50aGV0YSA9PT0gMCkKICAgICAgICBwYXJtc1szXSA9IDEvMzsKICAgICAgc3dpdGNoKHRoaXMuZm9nVHlwZSl7CiAgICAgICAgY2FzZSAibm9uZSI6IGZvZ21vZGUgPSAwOyBicmVhazsKICAgICAgICBjYXNlICJsaW5lYXIiOiAKICAgICAgICAgIGZvZ21vZGUgPSAxOyBicmVhazsKICAgICAgICBjYXNlICJleHAiOiAgCiAgICAgICAgICBmb2dtb2RlID0gMjsgYnJlYWs7CiAgICAgICAgY2FzZSAiZXhwMiI6IAogICAgICAgICAgZm9nbW9kZSA9IDM7CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OiBjb25zb2xlLmVycm9yKCJVbmtub3duIGZvZ3R5cGUgIit0aGlzLmZvZ1R5cGUpOwogICAgICB9CiAgICAgIGdsLnVuaWZvcm0xaShvYmoudUZvZ01vZGUsIGZvZ21vZGUpOwogICAgICBjb2xvciA9IHRoaXMuZm9nQ29sb3I7CiAgICAgIGdsLnVuaWZvcm0zZihvYmoudUZvZ0NvbG9yLCBjb2xvclswXSwgY29sb3JbMV0sIGNvbG9yWzJdKTsKICAgICAgZ2wudW5pZm9ybTRmKG9iai51Rm9nUGFybXMsIHBhcm1zWzBdLCBwYXJtc1sxXSwgcGFybXNbMl0sIHBhcm1zWzNdKTsKICAgIH07CgogICAgLyogVGhlIGRyYXcgbWV0aG9kcyBhcmUgY2FsbGVkIHR3aWNlLiAgV2hlbiAKICAgICAgIHRoaXMub3BhcXVlUGFzcyBpcyB0cnVlLCB0aGV5IHNob3VsZCBkcmF3IG9wYXF1ZSBwYXJ0cwogICAgICAgb2YgdGhlIHNjZW5lLCBhbmQgcmV0dXJuIHRoZSBsaXN0IG9mIHRyYW5zcGFyZW50CiAgICAgICBwaWVjZXMuICBIZXJlIGNvbnRleHQgaXMgdGhlIGNvbnRleHQgYXJyYXkgb24gaW5wdXQsCiAgICAgICBtb2RpZmllZCB3aGVuIHRoZSBtYXRyaWNlcyBhcmUgY2hhbmdlZC4KICAgICAgIFdoZW4gdGhpcy5vcGFxdWVQYXNzIGlzIGZhbHNlLCB0aGUgY29udGV4dCBhcmd1bWVudAogICAgICAgY29udGFpbnMgYSAicGllY2UiLCBpLmUuIGFuIG9yZGVyZWQgbGlzdCBvZiBwYXJ0cwogICAgICAgb2YgdGhlIG9iamVjdCB0byBkcmF3LiAqLwoKICAgIC8qKgogICAgICogRHJhdyBzaW1wbGUgb2JqZWN0CiAgICAgKiBAcGFyYW0geyBvYmplY3QgfSBvYmogLSBPYmplY3QgdG8gZHJhdwogICAgICogQHBhcmFtIHsgb2JqZWN0IH0gc3Vic2NlbmUgLSB3aGljaCBzdWJzY2VuZQogICAgICogQHBhcmFtIHsgYXJyYXkgfSBjb250ZXh0IC0gV2hpY2ggY29udGV4dCBhcmUgd2UgaW4/CiAgICAgKi8gICAgICAgCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZHJhd1NpbXBsZSA9IGZ1bmN0aW9uKG9iaiwgc3Vic2NlbmUsIGNvbnRleHQpIHsKICAgICAgdmFyIAogICAgICAgICAgZmwsCiAgICAgICAgICBpc190cmFuc3BhcmVudCwKICAgICAgICAgIHR5cGUgPSBvYmoudHlwZSwKICAgICAgICAgIGdsID0gdGhpcy5nbCB8fCB0aGlzLmluaXRHTCgpLAogICAgICAgICAgY291bnQsCiAgICAgICAgICBwYXNzLCBtb2RlLCBwbW9kZSwKICAgICAgICAgIGVuYWJsZWQgPSB7fTsKICAgICAgICAKICAgICAgaWYgKCFvYmouaW5pdGlhbGl6ZWQpCiAgICAgICAgdGhpcy5pbml0T2JqKG9iaik7CiAgICAgICAgCiAgICAgIGlmICh0aGlzLnRleHR1cmVzTG9hZGluZykKICAgICAgICByZXR1cm5bXTsKCiAgICAgIGNvdW50ID0gb2JqLnZlcnRleENvdW50OwogICAgICBpZiAoIWNvdW50KQogICAgICAgIHJldHVybiBbXTsKICAgIAogICAgICBmbCA9IG9iai5kZWZGbGFnczsKICAgICAgaXNfdHJhbnNwYXJlbnQgPSBmbC5pc190cmFuc3BhcmVudCB8fCBvYmouc29tZUhpZGRlbjsKICAgICAgCiAgICAgIGlmIChpc190cmFuc3BhcmVudCAmJiB0aGlzLm9wYXF1ZVBhc3MpCiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UGllY2VzKGNvbnRleHQsIG9iai5pZCwgMCwgb2JqKTsKCiAgICAgIHRoaXMuZG9EZXB0aFRlc3Qob2JqKTsKICAgICAgCiAgICAgIHRoaXMuZG9NYXNraW5nKHRoaXMuZ2V0TWF0ZXJpYWwob2JqLCAiZGVwdGhfbWFzayIpKTsKICAgICAgICAgICAgCiAgICAgIGdsLnVzZVByb2dyYW0ob2JqLnByb2cpOwoKICAgICAgdGhpcy5kb1BvbHlnb25PZmZzZXQob2JqKTsKCiAgICAgIGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCBvYmouYnVmKTsKCiAgICAgIGdsLnVuaWZvcm1NYXRyaXg0ZnYoIG9iai5wck1hdExvYywgZmFsc2UsIG5ldyBGbG9hdDMyQXJyYXkodGhpcy5wck1hdHJpeC5nZXRBc0FycmF5KCkpICk7CiAgICAgIGdsLnVuaWZvcm1NYXRyaXg0ZnYoIG9iai5tdk1hdExvYywgZmFsc2UsIG5ldyBGbG9hdDMyQXJyYXkodGhpcy5tdk1hdHJpeC5nZXRBc0FycmF5KCkpICk7CgogICAgICB0aGlzLmRvQ2xpcHBpbmcob2JqLCBzdWJzY2VuZSk7CgogICAgICBpZiAoZmwubmVlZHNfdm5vcm1hbCkKICAgICAgICB0aGlzLmRvTm9ybU1hdChvYmopOwogICAgICAgIAogICAgICBpZiAoZmwuaXNfbGl0KQogICAgICAgIHRoaXMuZG9MaWdodGluZyhvYmosIHN1YnNjZW5lKTsKCiAgICAgIGlmIChmbC5oYXNfZm9nKQogICAgICAgIHRoaXMuZG9Gb2cob2JqLCBzdWJzY2VuZSk7CgogICAgICB0aGlzLmRvVXNlckF0dHJpYnV0ZXMob2JqKTsKCiAgICAgIHRoaXMuZG9Vc2VyVW5pZm9ybXMob2JqKTsKIAogICAgICBnbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheSggdGhpcy5wb3NMb2MgKTsKICAgICAgZW5hYmxlZC5wb3NMb2MgPSB0cnVlOwogICAgICAgIAogICAgICBpZiAoZmwuaGFzX3RleHR1cmUgfHwgb2JqLnR5cGUgPT09ICJ0ZXh0IikKICAgICAgICBlbmFibGVkLnRleExvYyA9IHRoaXMuZG9UZXh0dXJlKG9iaik7CgogICAgICBlbmFibGVkLmNvbExvYyA9IHRoaXMuZG9Db2xvcnMob2JqKTsKICAgICAgZW5hYmxlZC5ub3JtTG9jID0gdGhpcy5kb05vcm1hbHMob2JqKTsKCiAgICAgIGlmIChmbC5maXhlZF9zaXplKSB7CiAgICAgICAgZ2wudW5pZm9ybTNmKCBvYmoudGV4dFNjYWxlTG9jLCAwLjc1L3RoaXMudnAud2lkdGgsIDAuNzUvdGhpcy52cC5oZWlnaHQsIDEuMCk7CiAgICAgIH0KICAgICAgCiAgICAgIGlmIChmbC5maXhlZF9xdWFkcykgewogICAgICAgIGdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KCBvYmoub2ZzTG9jICk7CiAgICAgICAgZW5hYmxlZC5vZnNMb2MgPSB0cnVlOwogICAgICAgIGdsLnZlcnRleEF0dHJpYlBvaW50ZXIob2JqLm9mc0xvYywgMywgZ2wuRkxPQVQsIGZhbHNlLCA0Km9iai52T2Zmc2V0cy5zdHJpZGUsIDQqb2JqLnZPZmZzZXRzLm9vZnMpOwogICAgICB9CgogICAgICBmb3IgKHBhc3MgPSAwOyBwYXNzIDwgb2JqLnBhc3NlczsgcGFzcysrKSB7CiAgICAgIAlwbW9kZSA9IG9iai5wbW9kZVtwYXNzXTsKICAgICAgICBpZiAocG1vZGUgPT09ICJjdWxsZWQiKQogICAgICAgICAgY29udGludWU7CgogICAgICAJbW9kZSA9IGZsLmZhdF9saW5lcyAmJiAoZmwuaXNfbGluZXMgfHwgcG1vZGUgPT09ICJsaW5lcyIpID8gIlRSSUFOR0xFUyIgOiB0aGlzLm1vZGU0dHlwZVt0eXBlXTsKCiAgICAgIAlpZiAoZmwuaXNfdHdvc2lkZWQpIHsKICAgICAgCSAgZ2wudW5pZm9ybTFpKG9iai5mcm9udExvYywgcGFzcyAhPT0gMCk7CiAgICAgIAkgIGlmIChmbC5oYXNfbm9ybWFscykgewogICAgICAJICAgIGdsLnVuaWZvcm1NYXRyaXg0ZnYob2JqLmludlByTWF0TG9jLCBmYWxzZSwgbmV3IEZsb2F0MzJBcnJheSh0aGlzLmludlByTWF0cml4LmdldEFzQXJyYXkoKSkpOwogICAgICAJICB9CiAgICAgIAl9CgogICAgICAgIGdsLmJpbmRCdWZmZXIoZ2wuRUxFTUVOVF9BUlJBWV9CVUZGRVIsIG9iai5pYnVmW3Bhc3NdKTsKICAgICAgICBpZiAoIXRoaXMub3BhcXVlUGFzcykgewogICAgICAgICAgaWYgKHR5cGUgPT09ICJzcGhlcmUiICYmIG9iai5mYXN0VHJhbnNwYXJlbmN5KQogICAgICAgICAgICBjb3VudCA9IHRoaXMuZG9Mb2FkSW5kaWNlcyhvYmosIHBhc3MsIHRoaXMuc3BoZXJlLmZhc3RwaWVjZXNbMF0uaW5kaWNlcyk7CiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIGNvdW50ID0gdGhpcy5kb0xvYWRJbmRpY2VzKG9iaiwgcGFzcywgY29udGV4dC5pbmRpY2VzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY291bnQgPSBvYmouZltwYXNzXS5sZW5ndGg7CiAgICAgICAgICBnbC5idWZmZXJEYXRhKGdsLkVMRU1FTlRfQVJSQVlfQlVGRkVSLCBvYmouZltwYXNzXSwgZ2wuU1RBVElDX0RSQVcpOwogICAgICAgIH0KICAgICAgCWlmICghZmwuaXNfbGluZXMgJiYgcG1vZGUgPT09ICJsaW5lcyIgJiYgIWZsLmZhdF9saW5lcykgewogICAgICAgICAgbW9kZSA9ICJMSU5FUyI7CiAgICAgICAgfSBlbHNlIGlmIChwbW9kZSA9PT0gInBvaW50cyIpIHsKICAgICAgICAgIG1vZGUgPSAiUE9JTlRTIjsKICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgaWYgKChmbC5pc19saW5lcyB8fCBwbW9kZSA9PT0gImxpbmVzIikgJiYgZmwuZmF0X2xpbmVzKSB7CiAgICAgICAgICBnbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShvYmoucG9pbnRMb2MpOwogICAgICAgICAgZW5hYmxlZC5wb2ludExvYyA9IHRydWU7CiAgICAgICAgICBnbC52ZXJ0ZXhBdHRyaWJQb2ludGVyKG9iai5wb2ludExvYywgMiwgZ2wuRkxPQVQsIGZhbHNlLCA0Km9iai52T2Zmc2V0cy5zdHJpZGUsIDQqb2JqLnZPZmZzZXRzLnBvaW50b2ZzKTsKICAgICAgICAgIGdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KG9iai5uZXh0TG9jICk7CiAgICAgICAgICBlbmFibGVkLm5leHRMb2MgPSB0cnVlOwogICAgICAgICAgZ2wudmVydGV4QXR0cmliUG9pbnRlcihvYmoubmV4dExvYywgMywgZ2wuRkxPQVQsIGZhbHNlLCA0Km9iai52T2Zmc2V0cy5zdHJpZGUsIDQqb2JqLnZPZmZzZXRzLm5leHRvZnMpOwogICAgICAgICAgZ2wudW5pZm9ybTFmKG9iai5hc3BlY3RMb2MsIHRoaXMudnAud2lkdGgvdGhpcy52cC5oZWlnaHQpOwogICAgICAgICAgZ2wudW5pZm9ybTFmKG9iai5sd2RMb2MsIHRoaXMuZ2V0TWF0ZXJpYWwob2JqLCAibHdkIikvdGhpcy52cC5oZWlnaHQpOwogICAgICAgIH0KCiAgICAgICAgZ2wudmVydGV4QXR0cmliUG9pbnRlcih0aGlzLnBvc0xvYywgIDMsIGdsLkZMT0FULCBmYWxzZSwgNCpvYmoudk9mZnNldHMuc3RyaWRlLCAgNCpvYmoudk9mZnNldHMudm9mcyk7CgogICAgICAgIGdsLmRyYXdFbGVtZW50cyhnbFttb2RlXSwgY291bnQsIG9iai5pbmRleF91aW50ID8gZ2wuVU5TSUdORURfSU5UIDogZ2wuVU5TSUdORURfU0hPUlQsIDApOwogICAgICB9CiAgICAgIHRoaXMuZGlzYWJsZUFycmF5cyhvYmosIGVuYWJsZWQpOwogICAgICByZXR1cm4gW107CiAgICB9OwoKICAgIC8qKgogICAgICogRHJhdyBwbGFuZXMgb2JqZWN0CiAgICAgKiBAcGFyYW0geyBvYmplY3QgfSBvYmogLSBPYmplY3QgdG8gZHJhdwogICAgICogQHBhcmFtIHsgb2JqZWN0IH0gc3Vic2NlbmUgLSB3aGljaCBzdWJzY2VuZQogICAgICogQHBhcmFtIHsgYXJyYXkgfSBjb250ZXh0IC0gV2hpY2ggY29udGV4dCBhcmUgd2UgaW4/CiAgICAgKi8gICAgICAKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5kcmF3UGxhbmVzID0gZnVuY3Rpb24ob2JqLCBzdWJzY2VuZSwgY29udGV4dCkgewogICAgICBpZiAodGhpcy5vcGFxdWVQYXNzICYmIChvYmouYmJveCAhPT0gc3Vic2NlbmUucGFyM2QuYmJveCB8fCAhb2JqLmluaXRpYWxpemVkKSkgewogICAgICAgICAgdGhpcy5wbGFuZVVwZGF0ZVRyaWFuZ2xlcyhvYmosIHN1YnNjZW5lLnBhcjNkLmJib3gpOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmRyYXdTaW1wbGUob2JqLCBzdWJzY2VuZSwgY29udGV4dCk7CiAgIH07CgogICAgLyoqCiAgICAgKiBAcGFyYW0geyBvYmplY3QgfSBvYmogLSBvYmplY3QgdG8gZHJhdwogICAgICogQHBhcmFtIHsgb2JqZWN0IH0gc3Vic2NlbmUgCiAgICAgKiBAcGFyYW0geyBhcnJheSB9IGNvbnRleHQgCiAgICAgKiBAZGVzY3JpcHRpb24KICAgICAqIERyYXcgc3BoZXJlcyBpbiBhIHN1YnNjZW5lPGJyPgogICAgICogCiAgICAgKiBEcmF3aW5nIHNwaGVyZXMgaGFwcGVucyBpbiBzaXggd2F5czo8YnI+CiAgICAgKiAxIG9wYXF1ZXBhc3MsIG5vdCB0cmFuc3BhcmVudDogIHRyYW5zZm9ybSBhbmQgZHJhdyB0aGlzLnNwaGVyZSBjb3VudCB0aW1lczxicj4KICAgICAqIDIgb3BhcXVlcGFzcywgdHJhbnNwYXJlbnQsIG5vdCBmYXN0OiB0cmFuc2Zvcm0gJiBjb2xsZWN0IHNwaGVyZSBwaWVjZXMgY291bnQgdGltZXM8YnI+CiAgICAgKiAzIG9wYXF1ZXBhc3MsIHRyYW5zcGFyZW50LCBmYXN0OiAgb3JkZXIgdGhlIGNlbnRyZXMgaW50byBzZXBhcmF0ZSBwaWVjZXMsIG9yZGVyIHRoaXMuc3BoZXJlIG9uY2U8YnI+CiAgICAgKiA0IG5vdCBvcGFxdWVwYXNzLCBub3QgdHJhbnNwYXJlbnQ6ICBkbyBub3RoaW5nPGJyPgogICAgICogNSBub3Qgb3BhcXVlcGFzcywgdHJhbnNwYXJlbnQsIG5vdCBmYXN0OiAgdHJhbnNmb3JtIGZvciBvbmUgc3BoZXJlLCBkcmF3IG9uZSBtZXJnZWQgcGllY2U8YnI+CiAgICAgKiA2IG5vdCBvcGFxdWVwYXNzLCB0cmFuc3BhcmVudCwgZmFzdDogIHRyYW5zZm9ybSBmb3Igb25lIHNwaGVyZSwgZHJhdyB0aGlzLnNwaGVyZSBpbiBmaXhlZCBvcmRlci48YnI+CiAgICAgKiovCgogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmRyYXdTcGhlcmVzID0gZnVuY3Rpb24ob2JqLCBzdWJzY2VuZSwgY29udGV4dCkgewogICAgICB2YXIgZmxhZ3MgPSBvYmouZmxhZ3MsCiAgICAgICAgICBpc190cmFuc3BhcmVudCA9IHJnbHdpZGdldENsYXNzLmlzU2V0KGZsYWdzLCByZ2x3aWRnZXRDbGFzcy5mX2lzX3RyYW5zcGFyZW50KSwKICAgICAgICAgIHNwaGVyZU1WLCBiYXNlb2ZzLCBvZnMsIHNzY2FsZSwgaSwKICAgICAgICAgIGNvdW50LCBuYywgc2NvdW50LCBzY2FsZSwgaW5kaWNlcywgc3BoZXJlTm9ybSwKICAgICAgICAgIGVuYWJsZWQgPSB7fSwgZHJhd2luZywKICAgICAgICAgIHNhdmVOb3JtID0gbmV3IENhbnZhc01hdHJpeDQodGhpcy5ub3JtTWF0cml4KSwKICAgICAgICAgIHNhdmVNViA9IG5ldyBDYW52YXNNYXRyaXg0KHRoaXMubXZNYXRyaXgpLAogICAgICAgICAgc2F2ZVBSTVYgPSBudWxsLAogICAgICAgICAgcmVzdWx0ID0gW10sIGlkeCwgbWFyZ2luID0gb2JqLm1hdGVyaWFsLm1hcmdpbjsKIAogICAgICBpZiAodHlwZW9mIG1hcmdpbiAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgaWYgKCF0aGlzLm1hcmdpblZlY1RvRGF0YVZlYyhvYmosIHN1YnNjZW5lKSkKICAgICAgICAgIHJldHVybiBbXTsKCiAgICAgIGlmICghb2JqLmluaXRpYWxpemVkKQogICAgICAgIHRoaXMuaW5pdE9iaihvYmopOwoKICAgICAgY291bnQgPSBvYmoudmVydGV4Q291bnQ7CiAgICAgIGlmICghY291bnQpIAogICAgICAgIHJldHVybiBbXTsKICAgICAgICAKICAgICAgaXNfdHJhbnNwYXJlbnQgPSBpc190cmFuc3BhcmVudCB8fCBvYmouc29tZUhpZGRlbjsKCiAgICAgIGlmICghdGhpcy5vcGFxdWVQYXNzICYmICFpc190cmFuc3BhcmVudCkKICAgICAgICByZXR1cm4gW107CiAgICAgICAgCiAgICAgIGlmICh0aGlzLnBybXZNYXRyaXggIT09IG51bGwpCiAgICAgICAgc2F2ZVBSTVYgPSBuZXcgQ2FudmFzTWF0cml4NCh0aGlzLnBybXZNYXRyaXgpOwogICAgICAKICAgICAgc2NhbGUgPSBzdWJzY2VuZS5wYXIzZC5zY2FsZTsgICAgICAgIAogICAgICBzcGhlcmVOb3JtID0gbmV3IENhbnZhc01hdHJpeDQoKTsKICAgICAgc3BoZXJlTm9ybS5zY2FsZShzY2FsZVswXSwgc2NhbGVbMV0sIHNjYWxlWzJdKTsKICAgICAgc3BoZXJlTm9ybS5tdWx0UmlnaHQoc2F2ZU5vcm0pOwogICAgICB0aGlzLm5vcm1NYXRyaXggPSBzcGhlcmVOb3JtOwoKICAgICAgaWYgKHRoaXMub3BhcXVlUGFzcykgewogICAgICAgIGNvbnRleHQgPSBjb250ZXh0LnNsaWNlKCk7CiAgICAgICAgY29udGV4dC5wdXNoKG9iai5pZCk7CiAgICAgIH0gCiAgICAgIAogICAgICBkcmF3aW5nID0gdGhpcy5vcGFxdWVQYXNzICE9PSBpc190cmFuc3BhcmVudDsKICAgICAgaWYgKGRyYXdpbmcpIHsKICAgICAgICBuYyA9IG9iai5jb2xvckNvdW50OwogICAgICAgIGlmIChuYyA9PT0gMSkgewogICAgICAgICAgdGhpcy5zcGhlcmUub25lY29sb3IgPSBvYmoub25lY29sb3I7CiAgICAgICAgfQogICAgICB9CiAgICAgIAogICAgICB0aGlzLmluaXRTaGFwZUZyb21PYmoodGhpcy5zcGhlcmUsIG9iaik7CgogICAgICBpZiAoIXRoaXMub3BhcXVlUGFzcyAmJiBvYmouZmFzdFRyYW5zcGFyZW5jeSAmJiB0eXBlb2YgdGhpcy5zcGhlcmUuZmFzdHBpZWNlcyA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICB0aGlzLnNwaGVyZS5mYXN0cGllY2VzID0gdGhpcy5nZXRQaWVjZXMoY29udGV4dC5jb250ZXh0LCBvYmouaWQsIDAsIHRoaXMuc3BoZXJlKTsKICAgICAgICB0aGlzLnNwaGVyZS5mYXN0cGllY2VzID0gdGhpcy5zb3J0UGllY2VzKHRoaXMuc3BoZXJlLmZhc3RwaWVjZXMpOwogICAgICAgIHRoaXMuc3BoZXJlLmZhc3RwaWVjZXMgPSB0aGlzLm1lcmdlUGllY2VzKHRoaXMuc3BoZXJlLmZhc3RwaWVjZXMpOwogICAgICB9CgogICAgICBpZiAodGhpcy5vcGFxdWVQYXNzKQogICAgICAgIHNjb3VudCA9IGNvdW50OwogICAgICBlbHNlIHsKICAgICAgICBpbmRpY2VzID0gY29udGV4dC5pbmRpY2VzOwogICAgICAgIGlmIChvYmouZmFzdFRyYW5zcGFyZW5jeSkKICAgICAgICAgIHNjb3VudCA9IGluZGljZXMubGVuZ3RoOyAgLyogRWFjaCBpdGVtIGdpdmVzIHRoZSBjZW50ZXIgb2YgYSB3aG9sZSBzcGhlcmUgKi8KICAgICAgICBlbHNlCiAgICAgICAgICBzY291bnQgPSAxOyAgICAgICAgICAgICAgIC8qIEVhY2ggaXRlbSBpcyBhIGZyYWdtZW50IG9mIHRoZSBzcGhlcmUsIGF0IGxvY2F0aW9uIHN1YmlkICovCiAgICAgIH0KICAgICAgZm9yIChpID0gMDsgaSA8IHNjb3VudDsgaSsrKSB7CiAgICAgICAgc3BoZXJlTVYgPSBuZXcgQ2FudmFzTWF0cml4NCgpOwogICAgICAgIGlmICh0aGlzLm9wYXF1ZVBhc3MpCiAgICAgICAgICBpZHggPSBpOwogICAgICAgIGVsc2UgaWYgKG9iai5mYXN0VHJhbnNwYXJlbmN5KQogICAgICAgICAgaWR4ID0gaW5kaWNlc1tpXTsKICAgICAgICBlbHNlCiAgICAgICAgICBpZHggPSBjb250ZXh0LnN1YmlkOwogICAgICAgIGlmICh0eXBlb2YgaWR4ID09PSAidW5kZWZpbmVkIikKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoImlkeCBpcyB1bmRlZmluZWQiKTsKICAgICAgICBiYXNlb2ZzID0gaWR4Km9iai52T2Zmc2V0cy5zdHJpZGU7CiAgICAgICAgb2ZzID0gYmFzZW9mcyArIG9iai52T2Zmc2V0cy5yYWRvZnM7CiAgICAgICAgc3NjYWxlID0gb2JqLnZhbHVlc1tvZnNdOwoKICAgICAgICBzcGhlcmVNVi5zY2FsZShzc2NhbGUvc2NhbGVbMF0sIHNzY2FsZS9zY2FsZVsxXSwgc3NjYWxlL3NjYWxlWzJdKTsKICAgICAgICBzcGhlcmVNVi50cmFuc2xhdGUob2JqLnZhbHVlc1tiYXNlb2ZzXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoudmFsdWVzW2Jhc2VvZnMrMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqLnZhbHVlc1tiYXNlb2ZzKzJdKTsKICAgICAgICBzcGhlcmVNVi5tdWx0UmlnaHQoc2F2ZU1WKTsKICAgICAgICB0aGlzLm12TWF0cml4ID0gc3BoZXJlTVY7CiAgICAgICAgdGhpcy5zZXRub3JtTWF0cml4MigpOwogICAgICAgIHRoaXMuc2V0cHJtdk1hdHJpeCgpOwogICAgICAgIGlmIChkcmF3aW5nKSB7CiAgICAgICAgICBpZiAobmMgPiAxKSB7CiAgICAgICAgICAgIHRoaXMuc3BoZXJlLm9uZWNvbG9yID0gb2JqLnZhbHVlcy5zbGljZShiYXNlb2ZzICsgb2JqLnZPZmZzZXRzLmNvZnMsIGJhc2VvZnMgKyBvYmoudk9mZnNldHMuY29mcyArIDQpOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5kcmF3U2ltcGxlKHRoaXMuc3BoZXJlLCBzdWJzY2VuZSwgY29udGV4dCk7CiAgICAgICAgfSBlbHNlIAogICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdCh0aGlzLmdldFNwaGVyZVBpZWNlcyhjb250ZXh0LCBpLCBvYmopKTsKICAgICAgfQogICAgICBpZiAoZHJhd2luZykKICAgICAgICB0aGlzLmRpc2FibGVBcnJheXMob2JqLCBlbmFibGVkKTsKICAgICAgdGhpcy5ub3JtTWF0cml4ID0gc2F2ZU5vcm07CiAgICAgIHRoaXMubXZNYXRyaXggPSBzYXZlTVY7CiAgICAgIHRoaXMucHJtdk1hdHJpeCA9IHNhdmVQUk1WOwogICAgICAgIAogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKICAgIAogICAgLyoqCiAgICAgKiBQcmVwYXJlIGNsaXBwbGFuZXMgZm9yIGRyYXdpbmcKICAgICAqIEBwYXJhbSB7IG9iamVjdCB9IG9iaiAtIGNsaXAgcGxhbmVzIG9iamVjdAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZHJhd0NsaXBwbGFuZXMgPSBmdW5jdGlvbihvYmopIHsKICAgICAgdmFyIGNvdW50ID0gb2JqLm9mZnNldHMubGVuZ3RoLAogICAgICAgIElNVkNsaXAgPSBbXTsKICAgICAgZm9yICh2YXIgaT0wOyBpIDwgY291bnQ7IGkrKykgewogICAgICAgIElNVkNsaXBbaV0gPSByZ2x3aWRnZXRDbGFzcy5tdWx0TVYodGhpcy5pbnZNYXRyaXgsIG9iai52Q2xpcHBsYW5lLnNsaWNlKDQqaSwgNCooaSsxKSkpOwogICAgICB9CiAgICAgIG9iai5JTVZDbGlwID0gSU1WQ2xpcDsKICAgICAgcmV0dXJuIFtdOwogICAgfTsKCiAgICAvKioKICAgICAqIFByZXBhcmUgbGluZXN0cmlwIGZvciBkcmF3aW5nCiAgICAgKiBAcGFyYW0geyBvYmplY3QgfSBvYmogLSBsaW5lIHN0cmlwIG9iamVjdAogICAgICogQHBhcmFtIHsgb2JqZWN0IH0gc3Vic2NlbmUgCiAgICAgKiBAcGFyYW0geyBhcnJheSB9IGNvbnRleHQgCiAgICAgKi8gICAgCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZHJhd0xpbmVzdHJpcCA9IGZ1bmN0aW9uKG9iaiwgc3Vic2NlbmUsIGNvbnRleHQpIHsKICAgICAgdmFyIG9yaWdJbmRpY2VzLCBpLCBqLCBtYXJnaW4gPSBvYmoubWF0ZXJpYWwubWFyZ2luOwogCiAgICAgIGlmICh0eXBlb2YgbWFyZ2luICE9PSAidW5kZWZpbmVkIikgCiAgICAgICAgaWYgKCF0aGlzLm1hcmdpblZlY1RvRGF0YVZlYyhvYmosIHN1YnNjZW5lKSkKICAgICAgICAgIHJldHVybiBbXTsKICAgICAgICAgIAogICAgICBpZiAodGhpcy5vcGFxdWVQYXNzKQogICAgICAgIHJldHVybiB0aGlzLmRyYXdTaW1wbGUob2JqLCBzdWJzY2VuZSwgY29udGV4dCk7CiAgICAgIG9yaWdJbmRpY2VzID0gY29udGV4dC5pbmRpY2VzLnNsaWNlKCk7CiAgICAgIGZvciAoaT0wOyBpIDwgb3JpZ0luZGljZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBqID0gb3JpZ0luZGljZXNbaV07CiAgICAgICAgaWYgKGogPCBvYmouY2VudGVycy5sZW5ndGggLSAxKSB7CiAgICAgICAgICBjb250ZXh0LmluZGljZXMgPSBbaiwgaisxXTsKICAgICAgICAgIHRoaXMuZHJhd1NpbXBsZShvYmosIHN1YnNjZW5lLCBjb250ZXh0KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29udGV4dC5pbmRpY2VzID0gb3JpZ0luZGljZXM7CiAgICAgIHJldHVybiBbXTsKICAgIH07CiAgICAgICAgICAKICAgIC8qKgogICAgICogRHJhdyBhIHNwcml0ZXMgb2JqZWN0IGluIGEgc3Vic2NlbmUKICAgICAqIEBwYXJhbSB7IG9iamVjdCB9IG9iaiAtIG9iamVjdCB0byBkcmF3CiAgICAgKiBAcGFyYW0geyBvYmplY3QgfSBzdWJzY2VuZQogICAgICogQHBhcmFtIHsgb2JqZWN0IH0gY29udGV4dAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZHJhd1Nwcml0ZXMgPSBmdW5jdGlvbihvYmosIHN1YnNjZW5lLCBjb250ZXh0KSB7CiAgICAgIHZhciBmbGFncyA9IG9iai5mbGFncywKICAgICAgICAgIGlzX3RyYW5zcGFyZW50ID0gcmdsd2lkZ2V0Q2xhc3MuaXNTZXQoZmxhZ3MsIHJnbHdpZGdldENsYXNzLmZfaXNfdHJhbnNwYXJlbnQpLAogICAgICAgICAgc3ByaXRlczNkID0gcmdsd2lkZ2V0Q2xhc3MuaXNTZXQoZmxhZ3MsIHJnbHdpZGdldENsYXNzLmZfc3ByaXRlc18zZCksCiAgICAgICAgICBmaXhlZF9zaXplID0gcmdsd2lkZ2V0Q2xhc3MuaXNTZXQoZmxhZ3MsIHJnbHdpZGdldENsYXNzLmZfZml4ZWRfc2l6ZSksCiAgICAgICAgICByb3RhdGluZyA9IHJnbHdpZGdldENsYXNzLmlzU2V0KGZsYWdzLCByZ2x3aWRnZXRDbGFzcy5mX3JvdGF0aW5nKSwKICAgICAgICAgIGksaiwKICAgICAgICAgIG9yaWdNViA9IG5ldyBDYW52YXNNYXRyaXg0KCB0aGlzLm12TWF0cml4ICksCiAgICAgICAgICBvcmlnUFJNViA9IG51bGwsCiAgICAgICAgICBvcmlnUFIsCiAgICAgICAgICBwb3MsIHJhZGl1cywgdXNlck1hdHJpeCwKICAgICAgICAgIHJlc3VsdCA9IFtdLCBtYXJnaW4gPSBvYmoubWF0ZXJpYWwubWFyZ2luOwogCiAgICAgIGlmICh0eXBlb2YgbWFyZ2luICE9PSAidW5kZWZpbmVkIikKICAgICAgICBpZiAoIXRoaXMubWFyZ2luVmVjVG9EYXRhVmVjKG9iaiwgc3Vic2NlbmUpKQogICAgICAgICAgcmV0dXJuIFtdOwoKICAgICAgaWYgKCFzcHJpdGVzM2QpIAogICAgICAgIHJldHVybiB0aGlzLmRyYXdTaW1wbGUob2JqLCBzdWJzY2VuZSwgY29udGV4dCk7CiAgICAgIAogICAgICBpZiAoIW9iai5pbml0aWFsaXplZCkKICAgICAgICB0aGlzLmluaXRPYmoob2JqKTsKCiAgICAgIGlmICghb2JqLnZlcnRleENvdW50KQogICAgICAgIHJldHVybiBbXTsKICAgIAogICAgICBpc190cmFuc3BhcmVudCA9IGlzX3RyYW5zcGFyZW50IHx8IG9iai5zb21lSGlkZGVuOwogICAgICAKICAgICAgdmFyIG5vcmlncyA9IG9iai52ZXJ0aWNlcy5sZW5ndGgsCiAgICAgICAgICBzYXZlbm9ybSA9IG5ldyBDYW52YXNNYXRyaXg0KHRoaXMubm9ybU1hdHJpeCksCiAgICAgICAgICBpT3JpZywgYWRqLCBvZmZzZXQ7CgogICAgICB1c2VyTWF0cml4ID0gb2JqLnVzZXJNYXRyaXg7CiAgICAgICAgICAgICAgICAgICAKICAgICAgaWYgKHRoaXMub3BhcXVlUGFzcykgewogICAgICAgIGNvbnRleHQgPSBjb250ZXh0LnNsaWNlKCk7CiAgICAgICAgY29udGV4dC5wdXNoKG9iai5pZCk7CiAgICAgIH0gZWxzZQogICAgICAgIG5vcmlncyA9IDE7CiAgICAgICAgICAKICAgICAgaWYgKHRoaXMucHJtdk1hdHJpeCAhPT0gbnVsbCkKICAgICAgICAgb3JpZ1BSTVYgPSBuZXcgQ2FudmFzTWF0cml4NCggdGhpcy5wcm12TWF0cml4ICk7CgogICAgICBvZmZzZXQgPSBvYmoub2Zmc2V0OwogICAgICAKICAgICAgaWYgKGZpeGVkX3NpemUgJiYgIXJvdGF0aW5nKSB7CiAgICAgICAgb3JpZ1BSID0gdGhpcy5wck1hdHJpeDsKICAgICAgICB0aGlzLnByTWF0cml4ID0gbmV3IENhbnZhc01hdHJpeDQoKTsKICAgICAgfQogICAgICAgIAogICAgICBmb3IgKGlPcmlnPTA7IGlPcmlnIDwgbm9yaWdzOyBpT3JpZysrKSB7CiAgICAgICAgaWYgKHRoaXMub3BhcXVlUGFzcykKICAgICAgICAgIGogPSBpT3JpZzsKICAgICAgICBlbHNlCiAgICAgICAgICBqID0gY29udGV4dC5zdWJpZDsKICAgICAgICBwb3MgPSBbXS5jb25jYXQob2JqLnZlcnRpY2VzW2pdKS5jb25jYXQoMS4wKTsKICAgICAgICByYWRpdXMgPSBvYmoucmFkaWkubGVuZ3RoID4gMSA/IG9iai5yYWRpaVtqXVswXSA6IG9iai5yYWRpaVswXVswXTsKICAgICAgICB0aGlzLm12TWF0cml4ID0gbmV3IENhbnZhc01hdHJpeDQodXNlck1hdHJpeCk7CiAgICAgICAgYWRqID0gdGhpcy5nZXRBZGoob2JqLCBqLCBvZmZzZXQpOwogICAgICAgIHRoaXMubXZNYXRyaXgudHJhbnNsYXRlKDEgLSAyKmFkalswXSwgMSAtIDIqYWRqWzFdLCAxIC0gMiphZGpbMl0pOwogICAgICAgIHRoaXMubXZNYXRyaXguc2NhbGUocmFkaXVzLCByYWRpdXMsIHJhZGl1cyk7CiAgICAgICAgCiAgICAgICAgaWYgKGZpeGVkX3NpemUpIHsKICAgICAgICAgIHZhciB2aWV3cG9ydCA9IHN1YnNjZW5lLnBhcjNkLnZpZXdwb3J0LAogICAgICAgICAgICB3aW53aWR0aCA9IHZpZXdwb3J0LndpZHRoKnRoaXMuY2FudmFzLndpZHRoLAogICAgICAgICAgICB3aW5oZWlnaHQgPSB2aWV3cG9ydC5oZWlnaHQqdGhpcy5jYW52YXMuaGVpZ2h0LAogICAgICAgICAgICBzY2FsZXggPSAyNy93aW53aWR0aCwgc2NhbGV5ID0gMjcvd2luaGVpZ2h0LAogICAgICAgICAgICAgIHNjYWxlID0gTWF0aC5zcXJ0KHNjYWxleCAqIHNjYWxleSk7CiAgICAgICAgICBpZiAoIXJvdGF0aW5nKSB7CiAgICAgICAgICAgIHBvcyA9IHJnbHdpZGdldENsYXNzLm11bHRWTShwb3MsIG9yaWdNVik7CiAgICAgICAgICAgIHBvcyA9IHJnbHdpZGdldENsYXNzLm11bHRWTShwb3MsIG9yaWdQUik7CiAgICAgICAgICAgIHRoaXMubXZNYXRyaXguc2NhbGUoc2NhbGV4LCBzY2FsZXksIHNjYWxlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNjYWxlID0gNC4wICogc2NhbGUgKiBzdWJzY2VuZS5wYXIzZC56b29tOwogICAgICAgICAgICB0aGlzLm12TWF0cml4LnNjYWxlKHNjYWxlLCBzY2FsZSwgc2NhbGUpOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5tdk1hdHJpeC50cmFuc2xhdGUocG9zWzBdL3Bvc1szXSwgcG9zWzFdL3Bvc1szXSwgcG9zWzJdL3Bvc1szXSk7CiAgICAgICAgICBpZiAocm90YXRpbmcpCiAgICAgICAgICAgIHRoaXMubXZNYXRyaXgubXVsdFJpZ2h0KG9yaWdNVik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICghcm90YXRpbmcpIHsKICAgICAgICAgICAgcG9zID0gcmdsd2lkZ2V0Q2xhc3MubXVsdFZNKHBvcywgb3JpZ01WKTsKICAgICAgICAgICAgdGhpcy5tdk1hdHJpeC50cmFuc2xhdGUocG9zWzBdL3Bvc1szXSwgcG9zWzFdL3Bvc1szXSwgcG9zWzJdL3Bvc1szXSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLm12TWF0cml4LnRyYW5zbGF0ZShwb3NbMF0vcG9zWzNdLCBwb3NbMV0vcG9zWzNdLCBwb3NbMl0vcG9zWzNdKTsKICAgICAgICAgICAgdGhpcy5tdk1hdHJpeC5tdWx0UmlnaHQob3JpZ01WKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5zZXRub3JtTWF0cml4MigpOwogICAgICAgIHRoaXMuc2V0cHJtdk1hdHJpeCgpOwogICAgICAKICAgICAgICBqID0gaU9yaWcgJSBvYmouc2hhcGVmaXJzdC5sZW5ndGg7CiAgICAgICAgdmFyIGZpcnN0ID0gb2JqLnNoYXBlZmlyc3Rbal07CiAgICAgICAgCiAgICAgICAgZm9yIChpPTA7IGkgPCBvYmouc2hhcGVsZW5zW2pdOyBpKyspCiAgICAgICAgICBpZiAodGhpcy5vcGFxdWVQYXNzKQogICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KHRoaXMuZHJhd09iaklkKG9iai5vYmplY3RzW2ZpcnN0ICsgaV0sIHN1YnNjZW5lLmlkLCBjb250ZXh0LmNvbmNhdChqKSkpOwogICAgICAgICAgZWxzZQogICAgICAgICAgICB0aGlzLmRyYXdPYmpJZChvYmoub2JqZWN0c1tpXSwgc3Vic2NlbmUuaWQsIGNvbnRleHQpOwogICAgICB9CiAgICAgIHRoaXMubm9ybU1hdHJpeCA9IHNhdmVub3JtOwogICAgICB0aGlzLm12TWF0cml4ID0gb3JpZ01WOwogICAgICBpZiAoZml4ZWRfc2l6ZSAmJiAhcm90YXRpbmcpCiAgICAgICAgdGhpcy5wck1hdHJpeCA9IG9yaWdQUjsKICAgICAgaWYgKG9yaWdQUk1WICE9PSBudWxsKQogICAgICAgIHRoaXMucHJtdk1hdHJpeCA9IG9yaWdQUk1WOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKICAgIAogICAgLyoqCiAgICAgKiBEcmF3IG9iamVjdCB0aGF0IG1pZ2h0IGJlIGluIG1hcmdpbgogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gb2JqIC0gdGV4dCBvYmplY3QgdG8gZHJhdwogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gc3Vic2NlbmUgLSBzdWJzY2VuZSBob2xkaW5nIGl0CiAgICAgKiBAcGFyYW0geyBPYmplY3QgfSBjb250ZXh0IC0gY29udGV4dCBmb3IgZHJhd2luZwogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZHJhd01hcmdpbmFsID0gZnVuY3Rpb24ob2JqLCBzdWJzY2VuZSwgY29udGV4dCkgewogICAgICB2YXIgbWFyZ2luID0gb2JqLm1hdGVyaWFsLm1hcmdpbjsKIAogICAgICBpZiAodHlwZW9mIG1hcmdpbiAhPT0gInVuZGVmaW5lZCIpIAogICAgICAgIGlmICghdGhpcy5tYXJnaW5WZWNUb0RhdGFWZWMob2JqLCBzdWJzY2VuZSkpCiAgICAgICAgICByZXR1cm4gW107CiAgICAgICAgICAKICAgICAgcmV0dXJuIHRoaXMuZHJhd1NpbXBsZShvYmosIHN1YnNjZW5lLCBjb250ZXh0KTsKICAgIH07CiAgICAKICAgIC8qKgogICAgICogRHJhdyBib3VuZGluZyBib3ggYW5kIGRlY29yYXRpb25zCiAgICAgKiBAcGFyYW0geyBPYmplY3QgfSBvYmogLSBiYm94ZGVjbyB0byBkcmF3CiAgICAgKiBAcGFyYW0geyBPYmplY3QgfSBzdWJzY2VuZSAtIHN1YnNjZW5lIGhvbGRpbmcgaXQKICAgICAqIEBwYXJhbSB7IE9iamVjdCB9IGNvbnRleHQgLSBjb250ZXh0IGZvciBkcmF3aW5nCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5kcmF3QkJveCA9IGZ1bmN0aW9uKG9iaiwgc3Vic2NlbmUsIGNvbnRleHQpIHsKICAgICAgdmFyIGZsYWdzID0gb2JqLmZsYWdzLAogICAgICAgICAgaXNfdHJhbnNwYXJlbnQgPSByZ2x3aWRnZXRDbGFzcy5pc1NldChmbGFncywgcmdsd2lkZ2V0Q2xhc3MuZl9pc190cmFuc3BhcmVudCksCiAgICAgICAgICBzY2FsZSwgYmJveCwgaW5kaWNlcywKICAgICAgICAgIGVuYWJsZWQgPSB7fSwgZHJhd2luZywKICAgICAgICAgIHJlc3VsdCA9IFtdLCBpZHgsIGNlbnRlciwgZWRnZXMsCiAgICAgICAgICBzYXZlZDsKCiAgICAgIGlmICghb2JqLmluaXRpYWxpemVkKQogICAgICAgIHRoaXMuaW5pdEJCb3gob2JqKTsKICAgICAgCiAgICAgIGlzX3RyYW5zcGFyZW50ID0gaXNfdHJhbnNwYXJlbnQgfHwgb2JqLnNvbWVIaWRkZW47CgogICAgICBpZiAoIXRoaXMub3BhcXVlUGFzcyAmJiAhaXNfdHJhbnNwYXJlbnQpCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgCiAgICAgIHRoaXMuc2V0QmJveChvYmosIHN1YnNjZW5lKTsKICAgICAgCiAgICAgIHNhdmVkID0gdGhpcy5zZXRCQm94TWF0cmljZXMob2JqKTsKICAgICAgCiAgICAgIGJib3ggPSBvYmouYmJveDsKICAgICAgY2VudGVyID0gb2JqLmNlbnRlcjsKCiAgICAgIHNjYWxlID0gW2Jib3hbMV0tYmJveFswXSwgYmJveFszXS1iYm94WzJdLCBiYm94WzVdLWJib3hbNF1dOwoKICAgICAgaWYgKCFvYmouY3ViZS5pbml0aWFsaXplZCkgewogICAgICAgIHRoaXMuaW5pdE9iaihvYmouY3ViZSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm9wYXF1ZVBhc3MpIHsKICAgICAgICBjb250ZXh0ID0gY29udGV4dC5zbGljZSgpOwogICAgICAgIGNvbnRleHQucHVzaChvYmouaWQpOwogICAgICB9IAogICAgICAKICAgICAgZHJhd2luZyA9IHRoaXMub3BhcXVlUGFzcyAhPT0gaXNfdHJhbnNwYXJlbnQ7CiAgICAgIHRoaXMuY3ViZS5vbmVjb2xvciA9IG9iai5jdWJlLm9uZWNvbG9yOwogICAgICB0aGlzLmluaXRTaGFwZUZyb21PYmoodGhpcy5jdWJlLCBvYmouY3ViZSk7CgogICAgICBpZiAoIXRoaXMub3BhcXVlUGFzcykKICAgICAgICBpbmRpY2VzID0gY29udGV4dC5pbmRpY2VzOwoKICAgICAgaWYgKHRoaXMub3BhcXVlUGFzcykKICAgICAgICBpZHggPSAwOwogICAgICBlbHNlCiAgICAgICAgaWR4ID0gY29udGV4dC5zdWJpZDsKICAgICAgaWYgKHR5cGVvZiBpZHggPT09ICJ1bmRlZmluZWQiKQogICAgICAgIGNvbnNvbGUuZXJyb3IoImlkeCBpcyB1bmRlZmluZWQiKTsKCiAgICAgIGlmIChkcmF3aW5nKSB7CiAgICAgICAgdGhpcy5kcmF3U2ltcGxlKHRoaXMuY3ViZSwgc3Vic2NlbmUsIGNvbnRleHQpOwogICAgICB9IGVsc2UgCiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdCh0aGlzLmdldEN1YmVQaWVjZXMoY29udGV4dCwgb2JqKSk7CgogICAgICBpZiAoIW9iai50aWNrcy5pbml0aWFsaXplZCkgewogICAgICAgIG9iai50aWNrcy5sb2NhdGlvbnMgPSB0aGlzLmdldFRpY2tMb2NhdGlvbnMob2JqKTsKICAgICAgICBvYmoudGlja3MuZWRnZXMgPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgICAgZWRnZXMgPSB0aGlzLmdldFRpY2tFZGdlcyh0aGlzLnBybXZNYXRyaXgpOwogICAgICBpZiAob2JqLm5lZWRzQXhpc0NhbGxiYWNrKSAKICAgICAgICB0aGlzLmRvQXhpc0NhbGxiYWNrKG9iaiwgZWRnZXMpOwogICAgICBpZiAoIW9iai50aWNrcy5lZGdlcyB8fCBlZGdlcy50b1N0cmluZygpICE9PSBvYmoudGlja3MuZWRnZXMudG9TdHJpbmcoKSkgewogICAgICAgIG9iai50aWNrcy5lZGdlcyA9IGVkZ2VzOwogICAgICAgIHRoaXMuZ2V0VGlja1ZlcnRpY2VzKG9iai50aWNrcyk7CiAgICAgICAgdGhpcy5wbGFjZVRpY2tMYWJlbHMob2JqKTsKICAgICAgICB0aGlzLnNldFRpY2tMYWJlbHMob2JqKTsKICAgICAgfQogICAgICBpZiAoIW9iai50aWNrcy5pbml0aWFsaXplZCkgewogICAgICAgIHRoaXMuaW5pdE9iaihvYmoudGlja3MpOwogICAgICAgIHRoaXMuaW5pdE9iaihvYmoubGFiZWxzKTsKICAgICAgfQogICAgICAgIAogICAgICBpZiAoZHJhd2luZykgewogICAgICAgIHRoaXMuZHJhd1NpbXBsZShvYmoudGlja3MsIHN1YnNjZW5lLCBjb250ZXh0KTsKICAgICAgICB0aGlzLmRyYXdTaW1wbGUob2JqLmxhYmVscywgc3Vic2NlbmUsIGNvbnRleHQpOwoKICAgICAgICB0aGlzLmRpc2FibGVBcnJheXMob2JqLCBlbmFibGVkKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KHRoaXMuZHJhd1NpbXBsZShvYmoudGlja3MsIHN1YnNjZW5lLCBjb250ZXh0KSk7CiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdCh0aGlzLmRyYXdTaW1wbGUob2JqLmxhYmVscywgc3Vic2NlbmUsIGNvbnRleHQpKTsKICAgICAgfQoKICAgICAgdGhpcy5yZXN0b3JlQkJveE1hdHJpY2VzKHNhdmVkKTsKICAgICAgICAKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CiAgICAKICAgIC8qKgogICAgICogVXNlIGlkcyB0byBjaG9vc2Ugb2JqZWN0IHRvIGRyYXcKICAgICAqIEBwYXJhbSB7IG51bWVyaWMgfSBpZCAtIG9iamVjdCB0byBkcmF3CiAgICAgKiBAcGFyYW0geyBudW1lcmljIH0gc3Vic2NlbmUKICAgICAqIEBwYXJhbSB7IGFycmF5IH0gY29udGV4dAogICAgICovICAgCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZHJhd09iaklkID0gZnVuY3Rpb24oaWQsIHN1YnNjZW5laWQsIGNvbnRleHQpIHsKICAgICAgaWYgKHR5cGVvZiBpZCAhPT0gIm51bWJlciIpCiAgICAgICAgdGhpcy5hbGVydE9uY2UoImRyYXdPYmpJZCBpZCBpcyAiK3R5cGVvZiBpZCk7CgogICAgICByZXR1cm4gdGhpcy5kcmF3T2JqKHRoaXMuZ2V0T2JqKGlkKSwgdGhpcy5nZXRPYmooc3Vic2NlbmVpZCksIGNvbnRleHQpOwogICB9OwogICAKICAgIC8qKgogICAgICogRHJhdyBhbiBvYmplY3QgaW4gYSBzdWJzY2VuZQogICAgICogQHBhcmFtIHsgb2JqZWN0IH0gb2JqIC0gb2JqZWN0IHRvIGRyYXcKICAgICAqIEBwYXJhbSB7IG9iamVjdCB9IHN1YnNjZW5lCiAgICAgKiBAcGFyYW0geyBhcnJheSB9IGNvbnRleHQKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmRyYXdPYmogPSBmdW5jdGlvbihvYmosIHN1YnNjZW5lLCBjb250ZXh0KSB7CiAgICAgIHN3aXRjaChvYmoudHlwZSkgewogICAgICAgIGNhc2UgImFiY2xpbmVzIjoKICAgICAgICBjYXNlICJzdXJmYWNlIjoKICAgICAgICAgIHJldHVybiB0aGlzLmRyYXdTaW1wbGUob2JqLCBzdWJzY2VuZSwgY29udGV4dCk7CiAgICAgICAgY2FzZSAicG9pbnRzIjoKICAgICAgICBjYXNlICJsaW5lcyI6ICAKICAgICAgICBjYXNlICJ0cmlhbmdsZXMiOgogICAgICAgIGNhc2UgInF1YWRzIjoKICAgICAgICBjYXNlICJ0ZXh0IjoKICAgICAgICAgIHJldHVybiB0aGlzLmRyYXdNYXJnaW5hbChvYmosIHN1YnNjZW5lLCBjb250ZXh0KTsKICAgICAgICBjYXNlICJsaW5lc3RyaXAiOgogICAgICAgICAgcmV0dXJuIHRoaXMuZHJhd0xpbmVzdHJpcChvYmosIHN1YnNjZW5lLCBjb250ZXh0KTsKICAgICAgICBjYXNlICJwbGFuZXMiOgogICAgICAgICAgcmV0dXJuIHRoaXMuZHJhd1BsYW5lcyhvYmosIHN1YnNjZW5lLCBjb250ZXh0KTsKICAgICAgICBjYXNlICJzcGhlcmVzIjoKICAgICAgICAgIHJldHVybiB0aGlzLmRyYXdTcGhlcmVzKG9iaiwgc3Vic2NlbmUsIGNvbnRleHQpOwogICAgICAgIGNhc2UgImNsaXBwbGFuZXMiOgogICAgICAgICAgcmV0dXJuIHRoaXMuZHJhd0NsaXBwbGFuZXMob2JqKTsKICAgICAgICBjYXNlICJzcHJpdGVzIjoKICAgICAgICAgIHJldHVybiB0aGlzLmRyYXdTcHJpdGVzKG9iaiwgc3Vic2NlbmUsIGNvbnRleHQpOwogICAgICAgIGNhc2UgImxpZ2h0IjoKICAgICAgICAgIHJldHVybiBbXTsKICAgICAgICBjYXNlICJiYm94ZGVjbyI6CiAgICAgICAgICByZXR1cm4gdGhpcy5kcmF3QkJveChvYmosIHN1YnNjZW5lLCBjb250ZXh0KTsKICAgICAgfQogICAgICAKICAgICAgY29uc29sZS5lcnJvcigiZHJhd09iaiBmb3IgdHlwZSA9ICIrb2JqLnR5cGUpOwogICAgfTsKCiAgICAvKioKICAgICAqIERyYXcgdGhlIGJhY2tncm91bmQgZm9yIGEgc3Vic2NlbmUKICAgICAqIEBwYXJhbSB7IG51bWJlciB9IGlkIC0gaWQgb2YgYmFja2dyb3VuZCBvYmplY3QKICAgICAqIEBwYXJhbSB7IG51bWJlciB9IHN1YnNjZW5laWQgLSBpZCBvZiBzdWJzY2VuZQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZHJhd0JhY2tncm91bmQgPSBmdW5jdGlvbihpZCwgc3Vic2NlbmVpZCwgY29udGV4dCkgewogICAgICB2YXIgZ2wgPSB0aGlzLmdsIHx8IHRoaXMuaW5pdEdMKCksCiAgICAgICAgICBvYmogPSB0aGlzLmdldE9iaihpZCksCiAgICAgICAgICBzdWJzY2VuZSwKICAgICAgICAgIGJnLCBpLCBzYXZlcHIsIHNhdmVpbnZwciwgc2F2ZW12LCBzYXZlbm9ybSwgbSwgYmJveCwgcmVzdWx0ID0gW10sIAogICAgICAgICAgc2F2ZWRtID0gZ2wuZ2V0UGFyYW1ldGVyKGdsLkRFUFRIX1dSSVRFTUFTSyksCiAgICAgICAgICBzYXZlZHQgPSBnbC5pc0VuYWJsZWQoZ2wuREVQVEhfVEVTVCksCiAgICAgICAgICBzYXZlYmxlbmQgPSBnbC5pc0VuYWJsZWQoZ2wuQkxFTkQpOwoKICAgICAgaWYgKCFvYmouaW5pdGlhbGl6ZWQpCiAgICAgICAgdGhpcy5pbml0T2JqKG9iaik7CgogICAgICBpZiAob2JqLmNvbG9ycy5sZW5ndGgpIHsKICAgICAgICBiZyA9IG9iai5jb2xvcnNbMF07CiAgICAgICAgZ2wuZGVwdGhNYXNrKHRydWUpOwogICAgICAgIGdsLmNsZWFyKGdsLkRFUFRIX0JVRkZFUl9CSVQpOwogICAgICAgIGdsLmNsZWFyQ29sb3IoYmdbMF0sIGJnWzFdLCBiZ1syXSwgYmdbM10pOwogICAgICAgIGdsLmNsZWFyKGdsLkNPTE9SX0JVRkZFUl9CSVQpOwogICAgICAgIHRoaXMuZm9nQ29sb3IgPSBiZzsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmZvZ0NvbG9yID0gWzAsMCwwLDBdOwogICAgICAgIG9iai5jb2xvcnMgPSBbWzAsMCwwLDBdXTsKICAgICAgfQogIAogICAgICB0aGlzLmZvZ1R5cGUgPSBvYmouZm9ndHlwZTsKICAgICAgdGhpcy5mb2dTY2FsZSA9IG9iai5mb2dzY2FsZTsKICAgICAgZ2wuZGlzYWJsZShnbC5CTEVORCk7CiAgICAgIGdsLmRpc2FibGUoZ2wuREVQVEhfVEVTVCk7CiAgICAgIGdsLmRlcHRoTWFzayhmYWxzZSk7CiAgICAgIGlmICh0eXBlb2Ygb2JqLnF1YWQgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgc2F2ZXByID0gdGhpcy5wck1hdHJpeDsKICAgICAgICBzYXZlaW52cHIgPSB0aGlzLmludlByTWF0cml4OwogICAgICAgIHNhdmVtdiA9IHRoaXMubXZNYXRyaXg7CiAgICAgICAgc2F2ZW5vcm0gPSB0aGlzLm5vcm1NYXRyaXg7CiAgICAgICAgdGhpcy5wck1hdHJpeCA9IG5ldyBDYW52YXNNYXRyaXg0KCk7CiAgICAgICAgdGhpcy5pbnZQck1hdHJpeCA9IG5ldyBDYW52YXNNYXRyaXg0KCk7CiAgICAgICAgdGhpcy5tdk1hdHJpeCA9IG5ldyBDYW52YXNNYXRyaXg0KCk7CiAgICAgICAgdGhpcy5ub3JtTWF0cml4ID0gbmV3IENhbnZhc01hdHJpeDQoKTsKICAgICAgICBmb3IgKGk9MDsgaSA8IG9iai5xdWFkLmxlbmd0aDsgaSsrKQogICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdCh0aGlzLmRyYXdPYmpJZChvYmoucXVhZFtpXSwgc3Vic2NlbmVpZCkpOwogICAgICAgIHRoaXMucHJNYXRyaXggPSBzYXZlcHI7CiAgICAgICAgdGhpcy5pbnZQck1hdHJpeCA9IHNhdmVpbnZwcjsKICAgICAgICB0aGlzLm12TWF0cml4ID0gc2F2ZW12OwogICAgICAgIHRoaXMubm9ybU1hdHJpeCA9IHNhdmVub3JtOwoKICAgICAgfSBlbHNlIGlmIChvYmouc3BoZXJlKSB7CiAgICAgICAgc3Vic2NlbmUgPSB0aGlzLmdldE9iaihzdWJzY2VuZWlkKTsKICAgICAgICBzYXZlbXYgPSB0aGlzLm12TWF0cml4OwogICAgICAgIHNhdmVub3JtID0gdGhpcy5ub3JtTWF0cml4OwogICAgICAgIGJib3ggPSBzdWJzY2VuZS5wYXIzZC5iYm94OwogICAgICAgIHZhciBjZW50ZXIgPSBbKGJib3hbMF0gKyBiYm94WzFdKS8yLCAKICAgICAgICAgICAgICAgICAgKGJib3hbMl0gKyBiYm94WzNdKS8yLCAKICAgICAgICAgICAgICAgICAgKGJib3hbNF0gKyBiYm94WzVdKS8yLCAxXSwKICAgICAgICAgICAgc2NhbGUgPSBzdWJzY2VuZS5wYXIzZC5zY2FsZSwKICAgICAgICAgICAgcmFuZ2VzID0gW2Jib3hbMV0gLSBiYm94WzBdLCAKICAgICAgICAgICAgICAgICAgYmJveFszXSAtIGJib3hbMl0sCiAgICAgICAgICAgICAgICAgIGJib3hbNV0gLSBiYm94WzRdXSwKICAgICAgICAgICAgYXZnc2NhbGUgPSByZ2x3aWRnZXRDbGFzcy52bGVuKHJhbmdlcykvTWF0aC5zcXJ0KDMpLAogICAgICAgICAgICBhc3BlY3QgPSBbcmFuZ2VzWzBdKnNjYWxlWzBdL2F2Z3NjYWxlLAogICAgICAgICAgICAgICAgICAgICAgcmFuZ2VzWzFdKnNjYWxlWzFdL2F2Z3NjYWxlLAogICAgICAgICAgICAgICAgICAgICAgcmFuZ2VzWzJdKnNjYWxlWzJdL2F2Z3NjYWxlXSwKICAgICAgICAgICAgbWF4YXNwZWN0ID0gTWF0aC5tYXgoYXNwZWN0WzBdLCBhc3BlY3RbMV0sIGFzcGVjdFsyXSksCiAgICAgICAgICAgIHpvb20gPSBzdWJzY2VuZS5wYXIzZC56b29tOwogICAgICAgIG0gPSBuZXcgQ2FudmFzTWF0cml4NCgpOwogICAgICAgIG0ucm90YXRlKDkwLCAxLCAwLCAwKTsKICAgICAgICBtLnNjYWxlKHpvb20qMi4wKm1heGFzcGVjdCpyYW5nZXNbMF0vYXNwZWN0WzBdLCAKICAgICAgICAgICAgICAgIHpvb20qMi4wKm1heGFzcGVjdCpyYW5nZXNbMV0vYXNwZWN0WzFdLAogICAgICAgICAgICAgICAgem9vbSoyLjAqbWF4YXNwZWN0KnJhbmdlc1syXS9hc3BlY3RbMl0pOwogICAgICAgIG0udHJhbnNsYXRlKGNlbnRlclswXSwgY2VudGVyWzFdLCBjZW50ZXJbMl0pOwogICAgICAgIG0ubXVsdFJpZ2h0KHNhdmVtdik7CiAgICAgICAgY2VudGVyID0gcmdsd2lkZ2V0Q2xhc3MubXVsdFZNKGNlbnRlciwgc2F2ZW12KTsKICAgICAgICBtLnRyYW5zbGF0ZSgtY2VudGVyWzBdLCAtY2VudGVyWzFdLCAtY2VudGVyWzJdKTsKICAgICAgICBtLnNjYWxlKDEsIDEsIDAuMjUvem9vbSk7CiAgICAgICAgbS50cmFuc2xhdGUoY2VudGVyWzBdLCBjZW50ZXJbMV0sIGNlbnRlclsyXSk7CiAgICAgICAgdGhpcy5tdk1hdHJpeCA9IG07CiAgICAgICAgdGhpcy5pbml0U2hhcGVGcm9tT2JqKHRoaXMuc3BoZXJlLCBvYmopOwogICAgICAgIHRoaXMuc3BoZXJlLm9uZWNvbG9yID0gb2JqLmNvbG9ycy5sZW5ndGggPiAxID8gb2JqLmNvbG9yc1sxXSA6IG9iai5jb2xvcnNbMF07CiAgICAgICAgCiAgICAgICAgdGhpcy5ub3JtTWF0cml4ID0gbmV3IENhbnZhc01hdHJpeDQoKTsKICAgICAgICAKICAgICAgICB0aGlzLnNldG5vcm1NYXRyaXgyKCk7CiAgICAgICAgdGhpcy5zZXRwcm12TWF0cml4KCk7CiAgICAgICAgCiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdCh0aGlzLmRyYXdTaW1wbGUodGhpcy5zcGhlcmUsIHN1YnNjZW5lLCBjb250ZXh0KSk7CiAgICAgICAgdGhpcy5tdk1hdHJpeCA9IHNhdmVtdjsKICAgICAgICB0aGlzLm5vcm1NYXRyaXggPSBzYXZlbm9ybTsKICAgICAgfQogICAgICBnbC5kZXB0aE1hc2soc2F2ZWRtKTsKICAgICAgaWYgKHNhdmVkdCkKICAgICAgICBnbC5lbmFibGUoZ2wuREVQVEhfVEVTVCk7CiAgICAgIGlmIChzYXZlYmxlbmQpCiAgICAgICAgZ2wuZW5hYmxlKGdsLkJMRU5EKTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgLyoqCiAgICAgKiBEcmF3IGEgc3Vic2NlbmUKICAgICAqIEBwYXJhbSB7IG51bWJlciB9IHN1YnNjZW5laWQgLSBpZCBvZiBzdWJzY2VuZQogICAgICogQHBhcmFtIHsgYXJyYXkgfSBjb250ZXh0IAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZHJhd1N1YnNjZW5lID0gZnVuY3Rpb24oc3Vic2NlbmVpZCwgY29udGV4dCkgewogICAgICB2YXIgc3ViID0gdGhpcy5nZXRPYmooc3Vic2NlbmVpZCksCiAgICAgICAgICBvYmplY3RzID0gdGhpcy5zY2VuZS5vYmplY3RzLAogICAgICAgICAgY2xpcGlkcyA9IHN1Yi5jbGlwcGxhbmVzLAogICAgICAgICAgc3ViaWRzID0gc3ViLm9iamVjdHMsCiAgICAgICAgICBzdWJzY2VuZV9oYXNfZmFjZXMgPSBmYWxzZSwKICAgICAgICAgIHN1YnNjZW5lX25lZWRzX3NvcnRpbmcgPSBmYWxzZSwKICAgICAgICAgIGZsYWdzLCBpLCBvYmosIHJlc3VsdCA9IFtdOwogICAgICAgICAgCiAgICAgIGlmIChzdWIucGFyM2Quc2tpcFJlZHJhdykKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAKICAgICAgaWYgKHRoaXMub3BhcXVlUGFzcykgewogICAgICAgIGZvciAoaT0wOyBpIDwgc3ViaWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIAkgIG9iaiA9IG9iamVjdHNbc3ViaWRzW2ldXTsKICAgICAgICAgIGZsYWdzID0gb2JqLmZsYWdzOwogICAgICAgICAgaWYgKHR5cGVvZiBmbGFncyAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgc3Vic2NlbmVfaGFzX2ZhY2VzID0gc3Vic2NlbmVfaGFzX2ZhY2VzIHx8IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKHJnbHdpZGdldENsYXNzLmlzU2V0KGZsYWdzLCByZ2x3aWRnZXRDbGFzcy5mX2lzX2xpdCkgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICFyZ2x3aWRnZXRDbGFzcy5pc1NldChmbGFncywgcmdsd2lkZ2V0Q2xhc3MuZl9maXhlZF9xdWFkcykpOwogICAgICAgICAgICBvYmouaXNfdHJhbnNwYXJlbnQgPSBvYmouc29tZUhpZGRlbiB8fCAKICAgICAgICAgICAgICByZ2x3aWRnZXRDbGFzcy5pc1NldChmbGFncywgcmdsd2lkZ2V0Q2xhc3MuZl9pc190cmFuc3BhcmVudCk7CiAgICAgICAgICAgIHN1YnNjZW5lX25lZWRzX3NvcnRpbmcgPSBzdWJzY2VuZV9uZWVkc19zb3J0aW5nIHx8IAogICAgICAgICAgICAgIG9iai5pc190cmFuc3BhcmVudCB8fAogICAgICAgICAgICAgIHJnbHdpZGdldENsYXNzLmlzU2V0KGZsYWdzLCByZ2x3aWRnZXRDbGFzcy5mX2RlcHRoX3NvcnQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5zZXRWaWV3cG9ydChzdWJzY2VuZWlkKTsKCiAgICAgIHRoaXMuc2V0cHJNYXRyaXgoc3Vic2NlbmVpZCk7CiAgICAgIHRoaXMuc2V0SW52UHJNYXRyaXgoKTsKICAgICAgdGhpcy5zZXRtdk1hdHJpeChzdWJzY2VuZWlkKTsKICAgICAgdGhpcy5zZXRub3JtTWF0cml4MigpOwogICAgICB0aGlzLnNldHBybXZNYXRyaXgoKTsKICAgICAgdGhpcy5pbnZNYXRyaXggPSBuZXcgQ2FudmFzTWF0cml4NCh0aGlzLm12TWF0cml4KTsKICAgICAgdGhpcy5pbnZNYXRyaXguaW52ZXJ0KCk7CiAgICAgIAogICAgICBpZiAodGhpcy5vcGFxdWVQYXNzKSB7CiAgICAgICAgY29udGV4dCA9IGNvbnRleHQuc2xpY2UoKTsKICAgICAgICBjb250ZXh0LnB1c2goc3Vic2NlbmVpZCk7CiAgICAgICAgCiAgICAgICAgdGhpcy5kb0JsZW5kaW5nKGZhbHNlKTsKICAgICAgICB0aGlzLnN1YnNjZW5laWQgPSBzdWJzY2VuZWlkOwogICAgICAgIGlmICh0eXBlb2YgdGhpcy5zcGhlcmUgIT09ICJ1bmRlZmluZWQiKSAvLyByZXNldCB0aGlzLnNwaGVyZS5mYXN0cGllY2VzOyBpdCB3aWxsIGJlIHJlY3JlYXRlZCBpZiBuZWVkZWQKICAgICAgICAgIHRoaXMuc3BoZXJlLmZhc3RwaWVjZXMgPSB1bmRlZmluZWQ7CiAgICAgICAgaWYgKHR5cGVvZiBzdWIuYmFja2dyb3VuZElkICE9PSAidW5kZWZpbmVkIikKICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQodGhpcy5kcmF3QmFja2dyb3VuZChzdWIuYmFja2dyb3VuZElkLCBzdWJzY2VuZWlkLCBjb250ZXh0KSk7CiAgICAgIH0KCiAgICAgIGlmIChzdWJpZHMubGVuZ3RoKSB7CiAgICAgICAgICAgIAogICAgICAgIGlmIChjbGlwaWRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBjbGlwaWRzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICB0aGlzLmRyYXdPYmpJZChjbGlwaWRzW2ldLCBzdWJzY2VuZWlkKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgc3ViaWRzID0gc3ViLm9wYXF1ZS5jb25jYXQoc3ViLnRyYW5zcGFyZW50KTsKICAgICAgICBpZiAodGhpcy5vcGFxdWVQYXNzKSB7CiAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc3ViaWRzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KHRoaXMuZHJhd09iaklkKHN1Ymlkc1tpXSwgc3Vic2NlbmVpZCwgY29udGV4dCkpOwogICAgICAgICAgc3ViaWRzID0gc3ViLnN1YnNjZW5lczsKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzdWJpZHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQodGhpcy5kcmF3U3Vic2NlbmUoc3ViaWRzW2ldLCBjb250ZXh0KSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIFNldCB0aGUgY29udGV4dCBmb3IgZHJhd2luZyB0cmFuc3BhcmVudGx5CiAgICAgKiBAcGFyYW0geyBhcnJheSB9IGNvbnRleHQKICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLnNldENvbnRleHQgPSBmdW5jdGlvbihjb250ZXh0KSB7CiAgICAgIHZhciByZXN1bHQgPSBbXSwgb2JqaWQsIG9iaiwgdHlwZTsKICAgICAgY29udGV4dCA9IGNvbnRleHQuc2xpY2UoKTsKICAgICAgY29udGV4dC5yZXZlcnNlKCk7CiAgICAgIHdoaWxlIChjb250ZXh0Lmxlbmd0aCA+IDApIHsKICAgICAgICBvYmppZCA9IGNvbnRleHQucG9wKCk7CiAgICAgICAgb2JqID0gdGhpcy5nZXRPYmoob2JqaWQpOwogICAgICAgIHR5cGUgPSBvYmoudHlwZTsKICAgICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICAgIGNhc2UgInN1YnNjZW5lIjoKICAgICAgICAgICAgdGhpcy5kcmF3U3Vic2NlbmUob2JqaWQsIGZhbHNlKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJzcHJpdGVzIjoKICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdChjb250ZXh0LnBvcCgpKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJzcGhlcmVzIjoKICAgICAgICAgICAgLy8gdGhpcy5pbml0U3BoZXJlRnJvbU9iaihvYmopOyAgLy8gRklYTUU6ICBub3QgbmVlZGVkPwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImJib3hkZWNvIjoKICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdChjb250ZXh0LnBvcCgpKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBjb25zb2xlLmVycm9yKCJiYWQgdHlwZSAnIiwgdHlwZSwgIicgaW4gc2V0Q29udGV4dCIpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKICAgIAogICAgLyoqCiAgICAgKiBEcmF3IHRoZSB0cmFuc3BhcmVudCBwaWVjZXMgb2YgYSBzY2VuZQogICAgICogQHBhcmFtIHtvYmplY3R9IHBpZWNlcwogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZHJhd1BpZWNlcyA9IGZ1bmN0aW9uKHBpZWNlcykgewogICAgICB2YXIgaSwgcHJldmNvbnRleHQgPSBbXSwgY29udGV4dDsKICAgICAgZm9yIChpID0gMDsgaSA8IHBpZWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnRleHQgPSBwaWVjZXNbaV0uY29udGV4dC5zbGljZSgpOwogICAgICAgIGlmIChjb250ZXh0ICE9PSBwcmV2Y29udGV4dCkgewogICAgICAgICAgcHJldmNvbnRleHQgPSBjb250ZXh0LnNsaWNlKCk7CiAgICAgICAgICBjb250ZXh0ID0gdGhpcy5zZXRDb250ZXh0KGNvbnRleHQpOwogICAgICAgICAgdGhpcy5kb0JsZW5kaW5nKHRydWUsIHBpZWNlc1tpXS5vYmppZCk7CiAgICAgICAgfQogICAgICAgIHRoaXMuZHJhd09iaklkKHBpZWNlc1tpXS5vYmppZCwgdGhpcy5zdWJzY2VuZWlkLCAKICAgICAgICAgICAgICAgICAgICAgICBwaWVjZXNbaV0pOwogICAgICB9CiAgICB9OwogCiAgICAvKioKICAgICAqIERyYXcgdGhlIHdob2xlIHNjZW5lCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5kcmF3U2NlbmUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHdhc0RyYXdpbmcgPSB0aGlzLnN0YXJ0RHJhd2luZygpLAogICAgICAgICAgcGllY2VzOwogICAgICBpZiAoIXdhc0RyYXdpbmcpIHsKICAgICAgICBpZiAodGhpcy5zZWxlY3Quc3RhdGUgIT09ICJpbmFjdGl2ZSIpCiAgICAgICAgICB0aGlzLnNlbGVjdGlvbkNoYW5nZWQoKTsKCiAgICAgICAgdGhpcy5kb1N0YXJ0U2NlbmUoKTsKICAgICAgICB0aGlzLm9wYXF1ZVBhc3MgPSB0cnVlOwogICAgICAgIHBpZWNlcyA9IHRoaXMuZHJhd1N1YnNjZW5lKHRoaXMuc2NlbmUucm9vdFN1YnNjZW5lLCBbXSk7CiAgICAgICAgdGhpcy5vcGFxdWVQYXNzID0gZmFsc2U7CiAgICAgICAgcGllY2VzID0gdGhpcy5zb3J0UGllY2VzKHBpZWNlcyk7CiAgICAgICAgcGllY2VzID0gdGhpcy5tZXJnZVBpZWNlcyhwaWVjZXMpOwogICAgICAgIHRoaXMuZHJhd1BpZWNlcyhwaWVjZXMpOwogICAgICB9CiAgICAgIHRoaXMuc3RvcERyYXdpbmcod2FzRHJhd2luZyk7CiAgICB9Owo="></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,CiAgICAvKioKICAgICAqIENoYW5nZSB0aGUgZGlzcGxheWVkIHN1YnNldAogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gZWwgLSBFbGVtZW50IG9mIHRoZSBjb250cm9sOyBub3QgdXNlZC4KICAgICAqIEBwYXJhbSB7IE9iamVjdCB9IGNvbnRyb2wgLSBUaGUgc3Vic2V0IGNvbnRyb2wgZGF0YS4KICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLnN1YnNldFNldHRlciA9IGZ1bmN0aW9uKGVsLCBjb250cm9sKSB7CiAgICAgIGlmICh0eXBlb2YgY29udHJvbC5zdWJzY2VuZXMgPT09ICJ1bmRlZmluZWQiIHx8CiAgICAgICAgICBjb250cm9sLnN1YnNjZW5lcyA9PT0gbnVsbCkKICAgICAgICBjb250cm9sLnN1YnNjZW5lcyA9IHRoaXMuc2NlbmUucm9vdFN1YnNjZW5lOwogICAgICB2YXIgdmFsdWUgPSBNYXRoLnJvdW5kKGNvbnRyb2wudmFsdWUpLAogICAgICAgICAgc3Vic2NlbmVzID0gW10uY29uY2F0KGNvbnRyb2wuc3Vic2NlbmVzKSwKICAgICAgICAgIGZ1bGxzZXQgPSBbXS5jb25jYXQoY29udHJvbC5mdWxsc2V0KSwKICAgICAgICAgIGksIGosIHN1YnNjZW5laWQsCiAgICAgICAgICBhZGRzID0gW10sIGRlbGV0ZXMgPSBbXTsKICAgICAgaWYgKHJnbHdpZGdldENsYXNzLm1pc3NpbmcodmFsdWUpKQogICAgICAgIHZhbHVlID0gY29udHJvbC52YWx1ZSA9IDA7CiAgICAgIGlmIChjb250cm9sLmFjY3VtdWxhdGUpCiAgICAgICAgZm9yIChpPTA7IGkgPD0gdmFsdWU7IGkrKykKICAgICAgICAgIGFkZHMgPSBhZGRzLmNvbmNhdChjb250cm9sLnN1YnNldHNbaV0pOwogICAgICBlbHNlCiAgICAgICAgYWRkcyA9IGFkZHMuY29uY2F0KGNvbnRyb2wuc3Vic2V0c1t2YWx1ZV0pOwogICAgICBkZWxldGVzID0gZnVsbHNldC5maWx0ZXIoZnVuY3Rpb24oeCkgeyByZXR1cm4gYWRkcy5pbmRleE9mKHgpIDwgMDsgfSk7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBzdWJzY2VuZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBzdWJzY2VuZWlkID0gc3Vic2NlbmVzW2ldOwogICAgICAgIGlmICh0eXBlb2YgdGhpcy5nZXRPYmooc3Vic2NlbmVpZCkgPT09ICJ1bmRlZmluZWQiKQogICAgICAgICAgdGhpcy5hbGVydE9uY2UoInR5cGVvZiBvYmplY3QgaXMgdW5kZWZpbmVkIik7CiAgICAgICAgZm9yIChqID0gMDsgaiA8IGFkZHMubGVuZ3RoOyBqKyspCiAgICAgICAgICB0aGlzLmFkZFRvU3Vic2NlbmUoYWRkc1tqXSwgc3Vic2NlbmVpZCk7CiAgICAgICAgZm9yIChqID0gMDsgaiA8IGRlbGV0ZXMubGVuZ3RoOyBqKyspCiAgICAgICAgICB0aGlzLmRlbEZyb21TdWJzY2VuZShkZWxldGVzW2pdLCBzdWJzY2VuZWlkKTsKICAgICAgfQogICAgfTsKCiAgICAvKioKICAgICAqIENoYW5nZSB0aGUgcmVxdWVzdGVkIHByb3BlcnR5CiAgICAgKiBAcGFyYW0geyBPYmplY3QgfSBlbCAtIEVsZW1lbnQgb2YgdGhlIGNvbnRyb2w7IG5vdCB1c2VkLgogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gY29udHJvbCAtIFRoZSBwcm9wZXJ0eSBzZXR0ZXIgY29udHJvbCBkYXRhLgogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUucHJvcGVydHlTZXR0ZXIgPSBmdW5jdGlvbihlbCwgY29udHJvbCkgIHsKICAgICAgdmFyIHZhbHVlID0gY29udHJvbC52YWx1ZSwKICAgICAgICAgIHZhbHVlcyA9IFtdLmNvbmNhdChjb250cm9sLnZhbHVlcyksCiAgICAgICAgICBzdmFscyA9IFtdLmNvbmNhdChjb250cm9sLnBhcmFtKSwKICAgICAgICAgIGRpcmVjdCA9IHZhbHVlc1swXSA9PT0gbnVsbCwKICAgICAgICAgIGVudHJpZXMgPSBbXS5jb25jYXQoY29udHJvbC5lbnRyaWVzKSwKICAgICAgICAgIG5jb2wgPSBlbnRyaWVzLmxlbmd0aCwKICAgICAgICAgIG5yb3cgPSB2YWx1ZXMubGVuZ3RoL25jb2wsCiAgICAgICAgICBwcm9wZXJ0aWVzID0gcmdsd2lkZ2V0Q2xhc3MucmVwZWF0VG9MZW4oY29udHJvbC5wcm9wZXJ0aWVzLCBuY29sKSwKICAgICAgICAgIG9iamlkcyA9IHJnbHdpZGdldENsYXNzLnJlcGVhdFRvTGVuKGNvbnRyb2wub2JqaWRzLCBuY29sKSwKICAgICAgICAgIHByb3BlcnR5LCBvYmppZCA9IG9iamlkc1swXSwKICAgICAgICAgIG9iaiA9IHRoaXMuZ2V0T2JqKG9iamlkKSwKICAgICAgICAgIHByb3B2YWxzLCBpLCBqLCB2MSwgdjIsIHAsIGVudHJ5LCBnbCwgbmVlZHNCaW5kaW5nLAogICAgICAgICAgbmV3cHJvcCwgbmV3aWQsCgogICAgICAgICAgZ2V0UHJvcHZhbHMgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgaWYgKHByb3BlcnR5ID09PSAidXNlck1hdHJpeCIpCiAgICAgICAgICAgICAgcmV0dXJuIG9iai5wYXIzZC51c2VyTWF0cml4LmdldEFzQXJyYXkoKTsKICAgICAgICAgICAgZWxzZSBpZiAocHJvcGVydHkgPT09ICJzY2FsZSIgfHwgcHJvcGVydHkgPT09ICJGT1YiIHx8IHByb3BlcnR5ID09PSAiem9vbSIpCiAgICAgICAgICAgICAgcmV0dXJuIFtdLmNvbmNhdChvYmoucGFyM2RbcHJvcGVydHldKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgIHJldHVybiBbXS5jb25jYXQob2JqW3Byb3BlcnR5XSk7CiAgICAgICAgICB9LAoKICAgICAgICAgIHB1dFByb3B2YWxzID0gZnVuY3Rpb24obmV3dmFscykgewogICAgICAgICAgICBpZiAobmV3dmFscy5sZW5ndGggPT09IDEpCiAgICAgICAgICAgICAgbmV3dmFscyA9IG5ld3ZhbHNbMF07CiAgICAgICAgICAgIGlmIChwcm9wZXJ0eSA9PT0gInVzZXJNYXRyaXgiKQogICAgICAgICAgICAgIG9iai5wYXIzZC51c2VyTWF0cml4LmxvYWQobmV3dmFscyk7CiAgICAgICAgICAgIGVsc2UgaWYgKHByb3BlcnR5ID09PSAic2NhbGUiIHx8IHByb3BlcnR5ID09PSAiRk9WIiB8fCBwcm9wZXJ0eSA9PT0gInpvb20iKQogICAgICAgICAgICAgIG9iai5wYXIzZFtwcm9wZXJ0eV0gPSBuZXd2YWxzOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgb2JqW3Byb3BlcnR5XSA9IG5ld3ZhbHM7CiAgICAgICAgICB9OwoKICAgICAgaWYgKGRpcmVjdCAmJiB0eXBlb2YgdmFsdWUgPT09ICJ1bmRlZmluZWQiKQogICAgICAgIHJldHVybjsKCiAgICAgIGlmIChjb250cm9sLmludGVycCkgewogICAgICAgIHZhbHVlcyA9IHZhbHVlcy5zbGljZSgwLCBuY29sKS5jb25jYXQodmFsdWVzKS4KICAgICAgICAgICAgICAgICBjb25jYXQodmFsdWVzLnNsaWNlKG5jb2wqKG5yb3ctMSksIG5jb2wqbnJvdykpOwogICAgICAgIHN2YWxzID0gWy1JbmZpbml0eV0uY29uY2F0KHN2YWxzKS5jb25jYXQoSW5maW5pdHkpOwogICAgICAgIGZvciAoaSA9IDE7IGkgPCBzdmFscy5sZW5ndGg7IGkrKykgewogICAgICAgICAgaWYgKHZhbHVlIDw9IHN2YWxzW2ldKSB7CiAgICAgICAgICAgIGlmIChzdmFsc1tpXSA9PT0gSW5maW5pdHkpCiAgICAgICAgICAgICAgcCA9IDE7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICBwID0gKHN2YWxzW2ldIC0gdmFsdWUpLyhzdmFsc1tpXSAtIHN2YWxzW2ktMV0pOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoIWRpcmVjdCkgewogICAgICAgIHZhbHVlID0gTWF0aC5yb3VuZCh2YWx1ZSk7CiAgICAgIH0KCiAgICAgIGZvciAoaj0wOyBqPGVudHJpZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICBlbnRyeSA9IGVudHJpZXNbal07CiAgICAgICAgbmV3cHJvcCA9IHByb3BlcnRpZXNbal07CiAgICAgICAgbmV3aWQgPSBvYmppZHNbal07CgogICAgICAgIGlmIChuZXdwcm9wICE9PSBwcm9wZXJ0eSB8fCBuZXdpZCAhPT0gb2JqaWQpIHsKICAgICAgICAgIGlmICh0eXBlb2YgcHJvcGVydHkgIT09ICJ1bmRlZmluZWQiKQogICAgICAgICAgICBwdXRQcm9wdmFscyhwcm9wdmFscyk7CiAgICAgICAgICBwcm9wZXJ0eSA9IG5ld3Byb3A7CiAgICAgICAgICBvYmppZCA9IG5ld2lkOwogICAgICAgICAgb2JqID0gdGhpcy5nZXRPYmoob2JqaWQpOwogICAgICAgICAgcHJvcHZhbHMgPSBnZXRQcm9wdmFscygpOwogICAgICAgIH0KICAgICAgICBpZiAoY29udHJvbC5pbnRlcnApIHsKICAgICAgICAgIHYxID0gdmFsdWVzW25jb2wqKGktMSkgKyBqXTsKICAgICAgICAgIHYyID0gdmFsdWVzW25jb2wqaSArIGpdOwogICAgICAgICAgdGhpcy5zZXRFbGVtZW50KHByb3B2YWxzLCBlbnRyeSwgcCp2MSArICgxLXApKnYyKTsKICAgICAgICB9IGVsc2UgaWYgKCFkaXJlY3QpIHsKICAgICAgICAgIHRoaXMuc2V0RWxlbWVudChwcm9wdmFscywgZW50cnksIHZhbHVlc1tuY29sKnZhbHVlICsgal0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnNldEVsZW1lbnQocHJvcHZhbHMsIGVudHJ5LCB2YWx1ZVtqXSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHB1dFByb3B2YWxzKHByb3B2YWxzKTsKCiAgICAgIG5lZWRzQmluZGluZyA9IFtdOwogICAgICBmb3IgKGo9MDsgaiA8IGVudHJpZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICBpZiAocHJvcGVydGllc1tqXSA9PT0gInZhbHVlcyIgJiYKICAgICAgICAgICAgbmVlZHNCaW5kaW5nLmluZGV4T2Yob2JqaWRzW2pdKSA9PT0gLTEpIHsKICAgICAgICAgIG5lZWRzQmluZGluZy5wdXNoKG9iamlkc1tqXSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZvciAoaj0wOyBqIDwgbmVlZHNCaW5kaW5nLmxlbmd0aDsgaisrKSB7CiAgICAgICAgZ2wgPSB0aGlzLmdsIHx8IHRoaXMuaW5pdEdMKCk7CiAgICAgICAgb2JqID0gdGhpcy5nZXRPYmoobmVlZHNCaW5kaW5nW2pdKTsKICAgICAgICBnbC5iaW5kQnVmZmVyKGdsLkFSUkFZX0JVRkZFUiwgb2JqLmJ1Zik7CiAgICAgICAgZ2wuYnVmZmVyRGF0YShnbC5BUlJBWV9CVUZGRVIsIG9iai52YWx1ZXMsIGdsLlNUQVRJQ19EUkFXKTsKICAgICAgfQogICAgfTsKCiAgICAvKioKICAgICAqIENoYW5nZSB0aGUgcmVxdWVzdGVkIHZlcnRpY2VzCiAgICAgKiBAcGFyYW0geyBPYmplY3QgfSBlbCAtIEVsZW1lbnQgb2YgdGhlIGNvbnRyb2w7IG5vdCB1c2VkLgogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gY29udHJvbCAtIFRoZSB2ZXJ0ZXh0IHNldHRlciBjb250cm9sIGRhdGEuCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS52ZXJ0ZXhTZXR0ZXIgPSBmdW5jdGlvbihlbCwgY29udHJvbCkgIHsKICAgICAgdmFyIHN2YWxzID0gW10uY29uY2F0KGNvbnRyb2wucGFyYW0pLAogICAgICAgICAgaiwgaywgcCwgYSwgcHJvcHZhbHMsIHN0cmlkZSwgb2ZzLCBvYmosIGVudHJ5LAogICAgICAgICAgYXR0cmliLCB2ZXJ0ZXgsIHZhcmllcywKICAgICAgICAgIG9mc3MgICAgPSB7eDoidm9mcyIsIHk6InZvZnMiLCB6OiJ2b2ZzIiwKICAgICAgICAgICAgICAgICAgICAgcmVkOiJjb2ZzIiwgZ3JlZW46ImNvZnMiLCBibHVlOiJjb2ZzIiwKICAgICAgICAgICAgICAgICAgICAgYWxwaGE6ImNvZnMiLCByYWRpaToicmFkb2ZzIiwKICAgICAgICAgICAgICAgICAgICAgbng6Im5vZnMiLCBueToibm9mcyIsIG56OiJub2ZzIiwKICAgICAgICAgICAgICAgICAgICAgb3g6Im9vZnMiLCBveToib29mcyIsIG96OiJvb2ZzIiwKICAgICAgICAgICAgICAgICAgICAgdHM6InRvZnMiLCB0dDoidG9mcyJ9LAogICAgICAgICAgcG9zICAgICA9IHt4OjAsIHk6MSwgejoyLAogICAgICAgICAgICAgICAgICAgICByZWQ6MCwgZ3JlZW46MSwgYmx1ZToyLAogICAgICAgICAgICAgICAgICAgICBhbHBoYTozLHJhZGlpOjAsCiAgICAgICAgICAgICAgICAgICAgIG54OjAsIG55OjEsIG56OjIsCiAgICAgICAgICAgICAgICAgICAgIG94OjAsIG95OjEsIG96OjIsCiAgICAgICAgICAgICAgICAgICAgIHRzOjAsIHR0OjF9LAogICAgICAgIHZhbHVlcyA9IGNvbnRyb2wudmFsdWVzLAogICAgICAgIGRpcmVjdCA9IHZhbHVlcyA9PT0gbnVsbCwKICAgICAgICBuY29sLAogICAgICAgIGludGVycCA9IGNvbnRyb2wuaW50ZXJwLAogICAgICAgIHZlcnRpY2VzID0gW10uY29uY2F0KGNvbnRyb2wudmVydGljZXMpLAogICAgICAgIGF0dHJpYnV0ZXMgPSBbXS5jb25jYXQoY29udHJvbC5hdHRyaWJ1dGVzKSwKICAgICAgICB2YWx1ZSA9IGNvbnRyb2wudmFsdWUsIG5ld3ZhbCwgYWxpYXNlcywgYWxpYXM7CgogICAgICBuY29sID0gTWF0aC5tYXgodmVydGljZXMubGVuZ3RoLCBhdHRyaWJ1dGVzLmxlbmd0aCk7CgogICAgICBpZiAoIW5jb2wpCiAgICAgICAgcmV0dXJuOwoKICAgICAgdmVydGljZXMgPSByZ2x3aWRnZXRDbGFzcy5yZXBlYXRUb0xlbih2ZXJ0aWNlcywgbmNvbCk7CiAgICAgIGF0dHJpYnV0ZXMgPSByZ2x3aWRnZXRDbGFzcy5yZXBlYXRUb0xlbihhdHRyaWJ1dGVzLCBuY29sKTsKCiAgICAgIGlmIChkaXJlY3QpCiAgICAgICAgaW50ZXJwID0gZmFsc2U7CgogICAgICAvKiBKU09OIGRvZXNuJ3QgcGFzcyBJbmZpbml0eSAqLwogICAgICBzdmFsc1swXSA9IC1JbmZpbml0eTsKICAgICAgc3ZhbHNbc3ZhbHMubGVuZ3RoIC0gMV0gPSBJbmZpbml0eTsKCiAgICAgIGZvciAoaiA9IDE7IGogPCBzdmFscy5sZW5ndGg7IGorKykgewogICAgICAgIGlmICh2YWx1ZSA8PSBzdmFsc1tqXSkgewogICAgICAgICAgaWYgKGludGVycCkgewogICAgICAgICAgICBpZiAoc3ZhbHNbal0gPT09IEluZmluaXR5KQogICAgICAgICAgICAgIHAgPSAxOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgcCA9IChzdmFsc1tqXSAtIHZhbHVlKS8oc3ZhbHNbal0gLSBzdmFsc1tqLTFdKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChzdmFsc1tqXSAtIHZhbHVlID4gdmFsdWUgLSBzdmFsc1tqLTFdKQogICAgICAgICAgICAgIGogPSBqIC0gMTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgb2JqID0gdGhpcy5nZXRPYmooY29udHJvbC5vYmppZCk7CiAgICAgIC8vIEZpcnN0LCBtYWtlIHN1cmUgY29sb3IgYXR0cmlidXRlcyB2YXJ5IGluIG9yaWdpbmFsCiAgICAgIGlmICh0eXBlb2Ygb2JqLnZPZmZzZXRzICE9PSAidW5kZWZpbmVkIikgewogICAgICAJdmFyaWVzID0gdHJ1ZTsKICAgICAgICBmb3IgKGsgPSAwOyBrIDwgbmNvbDsgaysrKSB7CiAgICAgICAgICBhdHRyaWIgPSBhdHRyaWJ1dGVzW2tdOwogICAgICAgICAgaWYgKHR5cGVvZiBhdHRyaWIgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgIG9mcyA9IG9iai52T2Zmc2V0c1tvZnNzW2F0dHJpYl1dOwogICAgICAgICAgICBpZiAob2ZzIDwgMCkgewogICAgICAgICAgICAgIHN3aXRjaChhdHRyaWIpIHsKICAgICAgICAgICAgICAJY2FzZSAiYWxwaGEiOgogICAgICAgICAgICAgIAljYXNlICJyZWQiOgogICAgICAgICAgICAgIAljYXNlICJncmVlbiI6CiAgICAgICAgICAgICAgCWNhc2UgImJsdWUiOgogICAgICAgICAgICAgIAkgIG9iai5jb2xvcnMgPSBbb2JqLmNvbG9yc1swXSwgb2JqLmNvbG9yc1swXV07CiAgICAgICAgICAgICAgCSAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhcmllcyA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICghdmFyaWVzKQogICAgICAgICAgdGhpcy5pbml0T2JqSWQoY29udHJvbC5vYmppZCk7CiAgICAgIH0KICAgICAgcHJvcHZhbHMgPSBvYmoudmFsdWVzOwogICAgICBhbGlhc2VzID0gb2JqLmFsaWFzOwogICAgICBpZiAodHlwZW9mIGFsaWFzZXMgPT09ICJ1bmRlZmluZWQiKQogICAgICAgIGFsaWFzZXMgPSBbXTsKICAgICAgZm9yIChrPTA7IGs8bmNvbDsgaysrKSB7CiAgICAgICAgaWYgKGRpcmVjdCkgewogICAgICAgICAgbmV3dmFsID0gdmFsdWU7CiAgICAgICAgfSBlbHNlIGlmIChpbnRlcnApIHsKICAgICAgICAgIG5ld3ZhbCA9IHAqdmFsdWVzW2otMV1ba10gKyAoMS1wKSp2YWx1ZXNbal1ba107CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG5ld3ZhbCA9IHZhbHVlc1tqXVtrXTsKICAgICAgICB9ICAgICAgCQogICAgICAgIGF0dHJpYiA9IGF0dHJpYnV0ZXNba107CiAgICAgICAgdmVydGV4ID0gdmVydGljZXNba107CiAgICAgICAgYWxpYXMgPSBhbGlhc2VzW3ZlcnRleF07CiAgICAgICAgaWYgKG9iai50eXBlID09PSAicGxhbmVzIiB8fCBvYmoudHlwZSA9PT0gImNsaXBwbGFuZXMiKSB7CiAgICAgICAgICBvZnMgPSBbIm54IiwgIm55IiwgIm56IiwgIm9mZnNldCJdLmluZGV4T2YoYXR0cmliKTsKICAgICAgICAgIGlmIChvZnMgPj0gMCkgewogICAgICAgICAgICBpZiAob2ZzIDwgMykgewogICAgICAgICAgICAgIGlmIChvYmoubm9ybWFsc1t2ZXJ0ZXhdW29mc10gIT09IG5ld3ZhbCkgeyAgLy8gQXNzdW1lIG5vIGFsaWFzZXMgaGVyZS4uLgogICAgICAgICAgICAgIAlvYmoubm9ybWFsc1t2ZXJ0ZXhdW29mc10gPSBuZXd2YWw7CiAgICAgICAgICAgICAgCW9iai5pbml0aWFsaXplZCA9IGZhbHNlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBpZiAob2JqLm9mZnNldHNbdmVydGV4XVswXSAhPT0gbmV3dmFsKSB7CiAgICAgICAgICAgICAgCW9iai5vZmZzZXRzW3ZlcnRleF1bMF0gPSBuZXd2YWw7CiAgICAgICAgICAgICAgCW9iai5pbml0aWFsaXplZCA9IGZhbHNlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8gTm90IGEgcGxhbmUgc2V0dGluZy4uLgogICAgICAgIG9mcyA9IG9iai52T2Zmc2V0c1tvZnNzW2F0dHJpYl1dOwogICAgICAgIGlmIChvZnMgPCAwKQogICAgICAgICAgdGhpcy5hbGVydE9uY2UoIkF0dHJpYnV0ZSAnIithdHRyaWIrIicgbm90IGZvdW5kIGluIG9iamVjdCAiK2NvbnRyb2wub2JqaWQpOwogICAgICAgIGVsc2UgewogICAgICAgICAgc3RyaWRlID0gb2JqLnZPZmZzZXRzLnN0cmlkZTsKICAgICAgICAgIG9mcyA9IG9mcyArIHBvc1thdHRyaWJdOwogICAgICAgICAgZW50cnkgPSB2ZXJ0ZXgqc3RyaWRlICsgb2ZzOwogICAgICAgICAgcHJvcHZhbHNbZW50cnldID0gbmV3dmFsOwogICAgICAgICAgaWYgKHR5cGVvZiBhbGlhcyAhPT0gInVuZGVmaW5lZCIpCiAgICAgICAgICAgIGZvciAoYSA9IDA7IGEgPCBhbGlhcy5sZW5ndGg7IGErKykKICAgICAgICAgICAgICBwcm9wdmFsc1thbGlhc1thXSpzdHJpZGUgKyBvZnNdID0gbmV3dmFsOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodHlwZW9mIG9iai5idWYgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgdmFyIGdsID0gdGhpcy5nbCB8fCB0aGlzLmluaXRHTCgpOwogICAgICAgIGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCBvYmouYnVmKTsKICAgICAgICBnbC5idWZmZXJEYXRhKGdsLkFSUkFZX0JVRkZFUiwgcHJvcHZhbHMsIGdsLlNUQVRJQ19EUkFXKTsKICAgICAgfQogICAgfTsKCiAgICAvKioKICAgICAqIENoYW5nZSB0aGUgcmVxdWVzdGVkIHZlcnRleCBwcm9wZXJ0aWVzIGJ5IGFnZQogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gZWwgLSBFbGVtZW50IG9mIHRoZSBjb250cm9sOyBub3QgdXNlZC4KICAgICAqIEBwYXJhbSB7IE9iamVjdCB9IGNvbnRyb2wgLSBUaGUgYWdlIHNldHRlciBjb250cm9sIGRhdGEuCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5hZ2VTZXR0ZXIgPSBmdW5jdGlvbihlbCwgY29udHJvbCkgewogICAgICB2YXIgb2JqaWRzID0gW10uY29uY2F0KGNvbnRyb2wub2JqaWRzKSwKICAgICAgICAgIG5vYmpzID0gb2JqaWRzLmxlbmd0aCwKICAgICAgICAgIHRpbWUgPSBjb250cm9sLnZhbHVlLAogICAgICAgICAgYmlydGhzID0gW10uY29uY2F0KGNvbnRyb2wuYmlydGhzKSwKICAgICAgICAgIGFnZXMgPSBbXS5jb25jYXQoY29udHJvbC5hZ2VzKSwKICAgICAgICAgIHN0ZXBzID0gYmlydGhzLmxlbmd0aCwKICAgICAgICAgIGogPSBBcnJheShzdGVwcyksCiAgICAgICAgICBwID0gQXJyYXkoc3RlcHMpLAogICAgICAgICAgaSwgaywgbCwgYWdlLCBqMCwgcHJvcHZhbHMsIHN0cmlkZSwgb2ZzLCBvYmppZCwgb2JqLAogICAgICAgICAgYXR0cmliLCBkaW0sIHZhcmllcywgYWxpYXMsIGFsaWFzZXMsIGEsIGQsCiAgICAgICAgICBhdHRyaWJzID0gWyJjb2xvcnMiLCAiYWxwaGEiLCAicmFkaWkiLCAidmVydGljZXMiLAogICAgICAgICAgICAgICAgICAgICAibm9ybWFscyIsICJvcmlnaW5zIiwgInRleGNvb3JkcyIsCiAgICAgICAgICAgICAgICAgICAgICJ4IiwgInkiLCAieiIsCiAgICAgICAgICAgICAgICAgICAgICJyZWQiLCAiZ3JlZW4iLCAiYmx1ZSJdLAogICAgICAgICAgb2ZzcyAgICA9IFsiY29mcyIsICJjb2ZzIiwgInJhZG9mcyIsICJ2b2ZzIiwKICAgICAgICAgICAgICAgICAgICAgIm5vZnMiLCAib29mcyIsICJ0b2ZzIiwKICAgICAgICAgICAgICAgICAgICAgInZvZnMiLCAidm9mcyIsICJ2b2ZzIiwKICAgICAgICAgICAgICAgICAgICAgImNvZnMiLCAiY29mcyIsICJjb2ZzIl0sCiAgICAgICAgICBkaW1zICAgID0gWzMsMSwxLDMsCiAgICAgICAgICAgICAgICAgICAgIDMsMiwyLAogICAgICAgICAgICAgICAgICAgICAxLDEsMSwKICAgICAgICAgICAgICAgICAgICAgMSwxLDFdLAogICAgICAgICAgcG9zICAgICA9IFswLDMsMCwwLAogICAgICAgICAgICAgICAgICAgICAwLDAsMCwKICAgICAgICAgICAgICAgICAgICAgMCwxLDIsCiAgICAgICAgICAgICAgICAgICAgIDAsMSwyXTsKICAgICAgLyogSW5maW5pdHkgZG9lc24ndCBtYWtlIGl0IHRocm91Z2ggSlNPTiAqLwogICAgICBhZ2VzWzBdID0gLUluZmluaXR5OwogICAgICBhZ2VzW2FnZXMubGVuZ3RoLTFdID0gSW5maW5pdHk7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBzdGVwczsgaSsrKSB7CiAgICAgICAgaWYgKGJpcnRoc1tpXSAhPT0gbnVsbCkgeyAgLy8gTkEgaW4gUiBiZWNvbWVzIG51bGwKICAgICAgICAgIGFnZSA9IHRpbWUgLSBiaXJ0aHNbaV07CiAgICAgICAgICBmb3IgKGowID0gMTsgYWdlID4gYWdlc1tqMF07IGowKyspOwogICAgICAgICAgaWYgKGFnZXNbajBdID09PSBJbmZpbml0eSkKICAgICAgICAgICAgcFtpXSA9IDE7CiAgICAgICAgICBlbHNlIGlmIChhZ2VzW2owXSA+IGFnZXNbajAtMV0pCiAgICAgICAgICAgIHBbaV0gPSAoYWdlc1tqMF0gLSBhZ2UpLyhhZ2VzW2owXSAtIGFnZXNbajAtMV0pOwogICAgICAgICAgZWxzZQogICAgICAgICAgICBwW2ldID0gMDsKICAgICAgICAgIGpbaV0gPSBqMDsKICAgICAgICB9CiAgICAgIH0KICAgICAgLy8gRmlyc3QsIG1ha2Ugc3VyZSBjb2xvciBhdHRyaWJ1dGVzIHZhcnkgaW4gb3JpZ2luYWwKICAgICAgZm9yIChsID0gMDsgbCA8IG5vYmpzOyBsKyspIHsKICAgICAgCW9iamlkID0gb2JqaWRzW2xdOwogICAgICAJb2JqID0gdGhpcy5nZXRPYmoob2JqaWQpOwogICAgICAJdmFyaWVzID0gdHJ1ZTsKICAgICAgICBpZiAodHlwZW9mIG9iai52T2Zmc2V0cyA9PT0gInVuZGVmaW5lZCIpCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICBmb3IgKGsgPSAwOyBrIDwgYXR0cmlicy5sZW5ndGg7IGsrKykgewogICAgICAgICAgYXR0cmliID0gY29udHJvbFthdHRyaWJzW2tdXTsKICAgICAgICAgIGlmICh0eXBlb2YgYXR0cmliICE9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgICBvZnMgPSBvYmoudk9mZnNldHNbb2Zzc1trXV07CiAgICAgICAgICAgIGlmIChvZnMgPCAwKSB7CiAgICAgICAgICAgICAgc3dpdGNoKGF0dHJpYnNba10pIHsKICAgICAgICAgICAgICAJY2FzZSAiY29sb3JzIjoKICAgICAgICAgICAgICAJY2FzZSAiYWxwaGEiOgogICAgICAgICAgICAgIAljYXNlICJyZWQiOgogICAgICAgICAgICAgIAljYXNlICJncmVlbiI6CiAgICAgICAgICAgICAgCWNhc2UgImJsdWUiOgogICAgICAgICAgICAgIAkgIG9iai5jb2xvcnMgPSBbb2JqLmNvbG9yc1swXSwgb2JqLmNvbG9yc1swXV07CiAgICAgICAgICAgICAgCSAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHZhcmllcyA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICghdmFyaWVzKQogICAgICAgICAgdGhpcy5pbml0T2JqSWQob2JqaWQpOwogICAgICB9CiAgICAgIGZvciAobCA9IDA7IGwgPCBub2JqczsgbCsrKSB7CiAgICAgICAgb2JqaWQgPSBvYmppZHNbbF07CiAgICAgICAgb2JqID0gdGhpcy5nZXRPYmoob2JqaWQpOwogICAgICAgIGlmICh0eXBlb2Ygb2JqLnZPZmZzZXRzID09PSAidW5kZWZpbmVkIikKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIGFsaWFzZXMgPSBvYmouYWxpYXM7CiAgICAgICAgaWYgKHR5cGVvZiBhbGlhc2VzID09PSAidW5kZWZpbmVkIikKICAgICAgICAgIGFsaWFzZXMgPSBbXTsKICAgICAgICBwcm9wdmFscyA9IG9iai52YWx1ZXM7CiAgICAgICAgc3RyaWRlID0gb2JqLnZPZmZzZXRzLnN0cmlkZTsKICAgICAgICBmb3IgKGsgPSAwOyBrIDwgYXR0cmlicy5sZW5ndGg7IGsrKykgewogICAgICAgICAgYXR0cmliID0gY29udHJvbFthdHRyaWJzW2tdXTsKICAgICAgICAgIGlmICh0eXBlb2YgYXR0cmliICE9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgICBvZnMgPSBvYmoudk9mZnNldHNbb2Zzc1trXV07CiAgICAgICAgICAgIGlmIChvZnMgPj0gMCkgewogICAgICAgICAgICAgIGRpbSA9IGRpbXNba107CiAgICAgICAgICAgICAgb2ZzID0gb2ZzICsgcG9zW2tdOwogICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzdGVwczsgaSsrKSB7CiAgICAgICAgICAgICAgCWFsaWFzID0gYWxpYXNlc1tpXTsKICAgICAgICAgICAgICAgIGlmIChiaXJ0aHNbaV0gIT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgZm9yIChkPTA7IGQgPCBkaW07IGQrKykgewogICAgICAgICAgICAgICAgICAgIHByb3B2YWxzW2kqc3RyaWRlICsgb2ZzICsgZF0gPSBwW2ldKmF0dHJpYltkaW0qKGpbaV0tMSkgKyBkXSArICgxLXBbaV0pKmF0dHJpYltkaW0qaltpXSArIGRdOwogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYWxpYXMgIT09ICJ1bmRlZmluZWQiKQogICAgICAgICAgICAgICAgICAgICAgZm9yIChhPTA7IGEgPCBhbGlhcy5sZW5ndGg7IGErKykKICAgICAgICAgICAgICAgICAgICAgICAgcHJvcHZhbHNbYWxpYXNbYV0qc3RyaWRlICsgb2ZzICsgZF0gPSBwcm9wdmFsc1tpKnN0cmlkZSArIG9mcyArIGRdOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICB0aGlzLmFsZXJ0T25jZSgiXCciK2F0dHJpYnNba10rIlwnIHByb3BlcnR5IG5vdCBmb3VuZCBpbiBvYmplY3QgIitvYmppZCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIG9iai52YWx1ZXMgPSBwcm9wdmFsczsKICAgICAgICBpZiAodHlwZW9mIG9iai5idWYgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICB2YXIgZ2wgPSB0aGlzLmdsIHx8IHRoaXMuaW5pdEdMKCk7CiAgICAgICAgICBnbC5iaW5kQnVmZmVyKGdsLkFSUkFZX0JVRkZFUiwgb2JqLmJ1Zik7CiAgICAgICAgICBnbC5idWZmZXJEYXRhKGdsLkFSUkFZX0JVRkZFUiwgb2JqLnZhbHVlcywgZ2wuU1RBVElDX0RSQVcpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICAvKioKICAgICAqIEJyaWRnZSB0byBvbGQgc3R5bGUgY29udHJvbAogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gZWwgLSBFbGVtZW50IG9mIHRoZSBjb250cm9sOyBub3QgdXNlZC4KICAgICAqIEBwYXJhbSB7IE9iamVjdCB9IGNvbnRyb2wgLSBUaGUgYnJpZGdlIGNvbnRyb2wgZGF0YS4KICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLm9sZEJyaWRnZSA9IGZ1bmN0aW9uKGVsLCBjb250cm9sKSB7CiAgICAgIHZhciBhdHRybmFtZSwgZ2xvYmFsID0gd2luZG93W2NvbnRyb2wucHJlZml4ICsgInJnbCJdOwogICAgICBpZiAoZ2xvYmFsKQogICAgICAgIGZvciAoYXR0cm5hbWUgaW4gZ2xvYmFsKQogICAgICAgICAgdGhpc1thdHRybmFtZV0gPSBnbG9iYWxbYXR0cm5hbWVdOwogICAgICB3aW5kb3dbY29udHJvbC5wcmVmaXggKyAicmdsIl0gPSB0aGlzOwogICAgfTsKCiAgICAvKioKICAgICAqIFNldCB1cCBhIHBsYXllciBjb250cm9sCiAgICAgKiBAcGFyYW0geyBPYmplY3QgfSBlbCAtIFRoZSBwbGF5ZXIgY29udHJvbCBlbGVtZW50CiAgICAgKiBAcGFyYW0geyBPYmplY3QgfSBjb250cm9sIC0gVGhlIHBsYXllciBkYXRhLgogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuUGxheWVyID0gZnVuY3Rpb24oZWwsIGNvbnRyb2wpIHsKICAgICAgdmFyCiAgICAgICAgc2VsZiA9IHRoaXMsCiAgICAgICAgY29tcG9uZW50cyA9IFtdLmNvbmNhdChjb250cm9sLmNvbXBvbmVudHMpLAogICAgICAgIGJ1dHRvbkxhYmVscyA9IFtdLmNvbmNhdChjb250cm9sLmJ1dHRvbkxhYmVscyksCgogICAgICAgIFRpY2sgPSBmdW5jdGlvbigpIHsgLyogInRoaXMiIHdpbGwgYmUgYSB0aW1lciAqLwogICAgICAgICAgdmFyIGksCiAgICAgICAgICAgICAgbm9taW5hbCA9IHRoaXMudmFsdWUsCiAgICAgICAgICAgICAgc2xpZGVyID0gdGhpcy5TbGlkZXIsCiAgICAgICAgICAgICAgbGFiZWxzID0gdGhpcy5vdXRwdXRMYWJlbHMsCiAgICAgICAgICAgICAgb3V0cHV0ID0gdGhpcy5PdXRwdXQsCiAgICAgICAgICAgICAgc3RlcDsKICAgICAgICAgIGlmICh0eXBlb2Ygc2xpZGVyICE9PSAidW5kZWZpbmVkIiAmJiBub21pbmFsICE9PSBzbGlkZXIudmFsdWUpCiAgICAgICAgICAgIHNsaWRlci52YWx1ZSA9IG5vbWluYWw7CiAgICAgICAgICBpZiAodHlwZW9mIG91dHB1dCAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgc3RlcCA9IE1hdGgucm91bmQoKG5vbWluYWwgLSBvdXRwdXQuc2xpZGVyTWluKS9vdXRwdXQuc2xpZGVyU3RlcCk7CiAgICAgICAgICAgIGlmIChsYWJlbHMgIT09IG51bGwpIHsKICAgICAgICAgICAgICBvdXRwdXQuaW5uZXJIVE1MID0gbGFiZWxzW3N0ZXBdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHN0ZXAgPSBzdGVwKm91dHB1dC5zbGlkZXJTdGVwICsgb3V0cHV0LnNsaWRlck1pbjsKICAgICAgICAgICAgICBvdXRwdXQuaW5uZXJIVE1MID0gc3RlcC50b1ByZWNpc2lvbihvdXRwdXQub3V0cHV0UHJlY2lzaW9uKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgZm9yIChpPTA7IGkgPCB0aGlzLmFjdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdGhpcy5hY3Rpb25zW2ldLnZhbHVlID0gbm9taW5hbDsKICAgICAgICAgIH0KICAgICAgICAgIHNlbGYuYXBwbHlDb250cm9scyhlbCwgdGhpcy5hY3Rpb25zLCBmYWxzZSk7CiAgICAgICAgICBzZWxmLmRyYXdTY2VuZSgpOwogICAgICAgIH0sCgogICAgICAgIE9uU2xpZGVySW5wdXQgPSBmdW5jdGlvbigpIHsgLyogInRoaXMiIHdpbGwgYmUgdGhlIHNsaWRlciAqLwogICAgICAgICAgdGhpcy5yZ2x0aW1lci52YWx1ZSA9IE51bWJlcih0aGlzLnZhbHVlKTsKICAgICAgICAgIHRoaXMucmdsdGltZXIuVGljaygpOwogICAgICAgIH0sCgogICAgICAgIGFkZFNsaWRlciA9IGZ1bmN0aW9uKG1pbiwgbWF4LCBzdGVwLCB2YWx1ZSkgewogICAgICAgICAgdmFyIHNsaWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7CiAgICAgICAgICBzbGlkZXIudHlwZSA9ICJyYW5nZSI7CiAgICAgICAgICBzbGlkZXIubWluID0gbWluOwogICAgICAgICAgc2xpZGVyLm1heCA9IG1heDsKICAgICAgICAgIHNsaWRlci5zdGVwID0gc3RlcDsKICAgICAgICAgIHNsaWRlci52YWx1ZSA9IHZhbHVlOwogICAgICAgICAgc2xpZGVyLm9uaW5wdXQgPSBPblNsaWRlcklucHV0OwogICAgICAgICAgc2xpZGVyLnNsaWRlckFjdGlvbnMgPSBjb250cm9sLmFjdGlvbnM7CiAgICAgICAgICBzbGlkZXIuc2xpZGVyU2NlbmUgPSB0aGlzOwogICAgICAgICAgc2xpZGVyLmNsYXNzTmFtZSA9ICJyZ2wtc2xpZGVyIjsKICAgICAgICAgIHNsaWRlci5pZCA9IGVsLmlkICsgIi1zbGlkZXIiOwogICAgICAgICAgZWwucmdsdGltZXIuU2xpZGVyID0gc2xpZGVyOwogICAgICAgICAgc2xpZGVyLnJnbHRpbWVyID0gZWwucmdsdGltZXI7CiAgICAgICAgICBlbC5hcHBlbmRDaGlsZChzbGlkZXIpOwogICAgICAgIH0sCgogICAgICAgIGFkZExhYmVsID0gZnVuY3Rpb24obGFiZWxzLCBtaW4sIHN0ZXAsIHByZWNpc2lvbikgewogICAgICAgICAgdmFyIG91dHB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm91dHB1dCIpOwogICAgICAgICAgb3V0cHV0LnNsaWRlck1pbiA9IG1pbjsKICAgICAgICAgIG91dHB1dC5zbGlkZXJTdGVwID0gc3RlcDsKICAgICAgICAgIG91dHB1dC5vdXRwdXRQcmVjaXNpb24gPSBwcmVjaXNpb247CiAgICAgICAgICBvdXRwdXQuY2xhc3NOYW1lID0gInJnbC1sYWJlbCI7CiAgICAgICAgICBvdXRwdXQuaWQgPSBlbC5pZCArICItbGFiZWwiOwogICAgICAgICAgZWwucmdsdGltZXIuT3V0cHV0ID0gb3V0cHV0OwogICAgICAgICAgZWwucmdsdGltZXIub3V0cHV0TGFiZWxzID0gbGFiZWxzOwogICAgICAgICAgZWwuYXBwZW5kQ2hpbGQob3V0cHV0KTsKICAgICAgICB9LAoKICAgICAgICBhZGRCdXR0b24gPSBmdW5jdGlvbih3aGljaCwgbGFiZWwsIGFjdGl2ZSkgewogICAgICAgICAgdmFyIGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0IiksCiAgICAgICAgICAgICAgb25jbGlja3MgPSB7UmV2ZXJzZTogZnVuY3Rpb24oKSB7IHRoaXMucmdsdGltZXIucmV2ZXJzZSgpO30sCiAgICAgICAgICAgICAgICAgICAgUGxheTogZnVuY3Rpb24oKSB7IHRoaXMucmdsdGltZXIucGxheSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5yZ2x0aW1lci5lbmFibGVkID8gdGhpcy5pbmFjdGl2ZVZhbHVlIDogdGhpcy5hY3RpdmVWYWx1ZTsgfSwKICAgICAgICAgICAgICAgICAgIFNsb3dlcjogZnVuY3Rpb24oKSB7IHRoaXMucmdsdGltZXIuc2xvd2VyKCk7IH0sCiAgICAgICAgICAgICAgICAgICBGYXN0ZXI6IGZ1bmN0aW9uKCkgeyB0aGlzLnJnbHRpbWVyLmZhc3RlcigpOyB9LAogICAgICAgICAgICAgICAgICAgUmVzZXQ6IGZ1bmN0aW9uKCkgeyB0aGlzLnJnbHRpbWVyLnJlc2V0KCk7IH0sCiAgICAgICAgICAgICAgCSAgIFN0ZXA6ICBmdW5jdGlvbigpIHsgdGhpcy5yZ2x0aW1lci5zdGVwKCk7IH0KICAgICAgICAgICAgICB9OwogICAgICAgICAgYnV0dG9uLnJnbHRpbWVyID0gZWwucmdsdGltZXI7CiAgICAgICAgICBidXR0b24udHlwZSA9ICJidXR0b24iOwogICAgICAgICAgYnV0dG9uLnZhbHVlID0gbGFiZWw7CiAgICAgICAgICBidXR0b24uYWN0aXZlVmFsdWUgPSBsYWJlbDsKICAgICAgICAgIGJ1dHRvbi5pbmFjdGl2ZVZhbHVlID0gYWN0aXZlOwogICAgICAgICAgaWYgKHdoaWNoID09PSAiUGxheSIpCiAgICAgICAgICAgIGJ1dHRvbi5yZ2x0aW1lci5QbGF5QnV0dG9uID0gYnV0dG9uOwogICAgICAgICAgYnV0dG9uLm9uY2xpY2sgPSBvbmNsaWNrc1t3aGljaF07CiAgICAgICAgICBidXR0b24uY2xhc3NOYW1lID0gInJnbC1idXR0b24iOwogICAgICAgICAgYnV0dG9uLmlkID0gZWwuaWQgKyAiLSIgKyB3aGljaDsKICAgICAgICAgIGVsLmFwcGVuZENoaWxkKGJ1dHRvbik7CiAgICAgICAgfTsKCiAgICAgICAgaWYgKHR5cGVvZiBjb250cm9sLnJlaW5pdCAhPT0gInVuZGVmaW5lZCIgJiYgY29udHJvbC5yZWluaXQgIT09IG51bGwpIHsKICAgICAgICAgIGNvbnRyb2wuYWN0aW9ucy5yZWluaXQgPSBjb250cm9sLnJlaW5pdDsKICAgICAgICB9CiAgICAgICAgZWwucmdsdGltZXIgPSBuZXcgcmdsdGltZXJDbGFzcyhUaWNrLCBjb250cm9sLnN0YXJ0LCBjb250cm9sLmludGVydmFsLCBjb250cm9sLnN0b3AsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sLnN0ZXAsIGNvbnRyb2wudmFsdWUsIGNvbnRyb2wucmF0ZSwgY29udHJvbC5sb29wLCBjb250cm9sLmFjdGlvbnMpOwogICAgICAgIGZvciAodmFyIGk9MDsgaSA8IGNvbXBvbmVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHN3aXRjaChjb21wb25lbnRzW2ldKSB7CiAgICAgICAgICAgIGNhc2UgIlNsaWRlciI6IGFkZFNsaWRlcihjb250cm9sLnN0YXJ0LCBjb250cm9sLnN0b3AsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbC5zdGVwLCBjb250cm9sLnZhbHVlKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAiTGFiZWwiOiBhZGRMYWJlbChjb250cm9sLmxhYmVscywgY29udHJvbC5zdGFydCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sLnN0ZXAsIGNvbnRyb2wucHJlY2lzaW9uKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICBhZGRCdXR0b24oY29tcG9uZW50c1tpXSwgYnV0dG9uTGFiZWxzW2ldLCBjb250cm9sLnBhdXNlKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWwucmdsdGltZXIuVGljaygpOwogICAgfTsKCiAgICAvKioKICAgICAqIEFwcGx5IGFsbCByZWdpc3RlcmVkIGNvbnRyb2xzCiAgICAgKiBAcGFyYW0geyBPYmplY3QgfSBlbCAtIERPTSBlbGVtZW50IG9mIHRoZSBjb250cm9sCiAgICAgKiBAcGFyYW0geyBPYmplY3QgfSB4IC0gTGlzdCBvZiBhY3Rpb25zIHRvIGFwcGx5CiAgICAgKiBAcGFyYW0geyBib29sZWFuIH0gW2RyYXc9dHJ1ZV0gLSBXaGV0aGVyIHRvIHJlZHJhdyBhZnRlciBhcHBseWluZwogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuYXBwbHlDb250cm9scyA9IGZ1bmN0aW9uKGVsLCB4LCBkcmF3KSB7CiAgICAgIHZhciBzZWxmID0gdGhpcywgcmVpbml0ID0geC5yZWluaXQsIGksIGNvbnRyb2wsIHR5cGU7CiAgICAgIGZvciAoaSA9IDA7IGkgPCB4Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29udHJvbCA9IHhbaV07CiAgICAgICAgdHlwZSA9IGNvbnRyb2wudHlwZTsKICAgICAgICBzZWxmW3R5cGVdKGVsLCBjb250cm9sKTsKICAgICAgfQogICAgICBpZiAodHlwZW9mIHJlaW5pdCAhPT0gInVuZGVmaW5lZCIgJiYgcmVpbml0ICE9PSBudWxsKSB7CiAgICAgICAgcmVpbml0ID0gW10uY29uY2F0KHJlaW5pdCk7CiAgICAgICAgZm9yIChpID0gMDsgaSA8IHJlaW5pdC5sZW5ndGg7IGkrKykKICAgICAgICAgIHNlbGYuZ2V0T2JqKHJlaW5pdFtpXSkuaW5pdGlhbGl6ZWQgPSBmYWxzZTsKICAgICAgfQogICAgICBpZiAodHlwZW9mIGRyYXcgPT09ICJ1bmRlZmluZWQiIHx8IGRyYXcpCiAgICAgICAgc2VsZi5kcmF3U2NlbmUoKTsKICAgIH07CgogICAgLyoqCiAgICAgKiBIYW5kbGVyIGZvciBzY2VuZSBjaGFuZ2UKICAgICAqIEBwYXJhbSB7IE9iamVjdCB9IG1lc3NhZ2UgLSBXaGF0IHNvcnQgb2Ygc2NlbmUgY2hhbmdlIHRvIGRvPwogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuc2NlbmVDaGFuZ2VIYW5kbGVyID0gZnVuY3Rpb24obWVzc2FnZSkgewogICAgICB2YXIgc2VsZiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG1lc3NhZ2UuZWxlbWVudElkKS5yZ2xpbnN0YW5jZSwKICAgICAgICAgIG9ianMgPSBtZXNzYWdlLm9iamVjdHMsIG1hdCA9IG1lc3NhZ2UubWF0ZXJpYWwsCiAgICAgICAgICByb290ID0gbWVzc2FnZS5yb290U3Vic2NlbmUsCiAgICAgICAgICBpbml0U3VicyA9IG1lc3NhZ2UuaW5pdFN1YnNjZW5lcywKICAgICAgICAgIHJlZHJhdyA9IG1lc3NhZ2UucmVkcmF3U2NlbmUsCiAgICAgICAgICBza2lwUmVkcmF3ID0gbWVzc2FnZS5za2lwUmVkcmF3LAogICAgICAgICAgZGVsZXRlcywgc3VicywgYWxsc3VicyA9IFtdLCBpLGo7CiAgICAgIGlmICh0eXBlb2YgbWVzc2FnZS5kZWxldGUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgZGVsZXRlcyA9IFtdLmNvbmNhdChtZXNzYWdlLmRlbGV0ZSk7CiAgICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlLmRlbGZyb21TdWJzY2VuZXMgIT09ICJ1bmRlZmluZWQiKQogICAgICAgICAgc3VicyA9IFtdLmNvbmNhdChtZXNzYWdlLmRlbGZyb21TdWJzY2VuZXMpOwogICAgICAgIGVsc2UKICAgICAgICAgIHN1YnMgPSBbXTsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZGVsZXRlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgZm9yIChqID0gMDsgaiA8IHN1YnMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgc2VsZi5kZWxGcm9tU3Vic2NlbmUoZGVsZXRlc1tpXSwgc3Vic1tqXSk7CiAgICAgICAgICB9CiAgICAgICAgICBkZWxldGUgc2VsZi5zY2VuZS5vYmplY3RzW2RlbGV0ZXNbaV1dOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodHlwZW9mIG9ianMgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgT2JqZWN0LmtleXMob2JqcykuZm9yRWFjaChmdW5jdGlvbihrZXkpewogICAgICAgICAga2V5ID0gcGFyc2VJbnQoa2V5LCAxMCk7CiAgICAgICAgICBzZWxmLnNjZW5lLm9iamVjdHNba2V5XSA9IG9ianNba2V5XTsKICAgICAgICAgIHNlbGYuaW5pdE9iaklkKGtleSk7CiAgICAgICAgICB2YXIgb2JqID0gc2VsZi5nZXRPYmooa2V5KSwKICAgICAgICAgICAgICBzdWJzID0gW10uY29uY2F0KG9iai5pblN1YnNjZW5lcyksIGs7CiAgICAgICAgICBhbGxzdWJzID0gYWxsc3Vicy5jb25jYXQoc3Vicyk7CiAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgc3Vicy5sZW5ndGg7IGsrKykKICAgICAgICAgICAgc2VsZi5hZGRUb1N1YnNjZW5lKGtleSwgc3Vic1trXSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgaWYgKHR5cGVvZiBtYXQgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgc2VsZi5zY2VuZS5tYXRlcmlhbCA9IG1hdDsKICAgICAgfQogICAgICBpZiAodHlwZW9mIHJvb3QgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgc2VsZi5zY2VuZS5yb290U3Vic2NlbmUgPSByb290OwogICAgICB9CiAgICAgIGlmICh0eXBlb2YgaW5pdFN1YnMgIT09ICJ1bmRlZmluZWQiKQogICAgICAgIGFsbHN1YnMgPSBhbGxzdWJzLmNvbmNhdChpbml0U3Vicyk7CiAgICAgIGFsbHN1YnMgPSBzZWxmLnVuaXF1ZShhbGxzdWJzKTsKICAgICAgZm9yIChpID0gMDsgaSA8IGFsbHN1YnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBzZWxmLmluaXRTdWJzY2VuZShhbGxzdWJzW2ldKTsKICAgICAgfQogICAgICBpZiAodHlwZW9mIHNraXBSZWRyYXcgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgcm9vdCA9IHNlbGYuZ2V0T2JqKHNlbGYuc2NlbmUucm9vdFN1YnNjZW5lKTsKICAgICAgICByb290LnBhcjNkLnNraXBSZWRyYXcgPSBza2lwUmVkcmF3OwogICAgICB9CiAgICAgIGlmIChyZWRyYXcpCiAgICAgICAgc2VsZi5kcmF3U2NlbmUoKTsKICAgIH07Cg=="></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,ICAgIC8qKgogICAgICogTWV0aG9kcyByZWxhdGVkIHRvIHNlbGVjdGlvbgogICAgICogQG5hbWUgX19fTUVUSE9EU19GT1JfU0VMRUNUSU9OX19fCiAgICAgKiBAbWVtYmVyb2Ygcmdsd2lkZ2V0Q2xhc3MKICAgICAqIEBraW5kIGZ1bmN0aW9uCiAgICAgKiBAaW5zdGFuY2UKICAgICAqLwogICAgIAogICAgLyoqCiAgICAgKiBSZXNwb25kIHRvIGJydXNoIGNoYW5nZQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuc2VsZWN0aW9uQ2hhbmdlZCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgaSwgaiwgaywgaWQsIHN1YmlkID0gdGhpcy5zZWxlY3Quc3Vic2NlbmUsIHN1YnNjZW5lLAogICAgICAgICAgb2JqaWRzLCBvYmosCiAgICAgICAgICBwMSA9IHRoaXMuc2VsZWN0LnJlZ2lvbi5wMSwgcDIgPSB0aGlzLnNlbGVjdC5yZWdpb24ucDIsCiAgICAgICAgICBmaWx0ZXIsIHNlbGVjdGlvbiA9IFtdLCBoYW5kbGUsIGtleXMsIHhtaW4sIHgsIHhtYXgsIHltaW4sIHksIHltYXgsIHosIHYsCiAgICAgICAgICBzb21lSGlkZGVuOwogICAgICBpZiAoIXN1YmlkKQogICAgICAgIHJldHVybjsKICAgICAgc3Vic2NlbmUgPSB0aGlzLmdldE9iaihzdWJpZCk7CiAgICAgIG9iamlkcyA9IHN1YnNjZW5lLm9iamVjdHM7CiAgICAgIGZpbHRlciA9IHRoaXMuc2NlbmUuY3Jvc3N0YWxrLmZpbHRlcjsKICAgICAgdGhpcy5zZXRtdk1hdHJpeChzdWJpZCk7CiAgICAgIHRoaXMuc2V0cHJNYXRyaXgoc3ViaWQpOwogICAgICB0aGlzLnNldHBybXZNYXRyaXgoKTsKICAgICAgeG1pbiA9IE1hdGgubWluKHAxLngsIHAyLngpOwogICAgICB4bWF4ID0gTWF0aC5tYXgocDEueCwgcDIueCk7CiAgICAgIHltaW4gPSBNYXRoLm1pbihwMS55LCBwMi55KTsKICAgICAgeW1heCA9IE1hdGgubWF4KHAxLnksIHAyLnkpOwogICAgICBmb3IgKGkgPSAwOyBpIDwgb2JqaWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIAlpZCA9IG9iamlkc1tpXTsKICAgICAgCWogPSB0aGlzLnNjZW5lLmNyb3NzdGFsay5pZC5pbmRleE9mKGlkKTsKICAgICAgCWlmIChqID49IDApIHsKICAgICAgCSAga2V5cyA9IHRoaXMuc2NlbmUuY3Jvc3N0YWxrLmtleVtqXTsKICAgICAgCSAgb2JqID0gdGhpcy5nZXRPYmooaWQpOwogICAgICAJICBzb21lSGlkZGVuID0gZmFsc2U7CiAgICAgIAkgIGZvciAoayA9IDA7IGsgPCBrZXlzLmxlbmd0aDsgaysrKSB7CiAgICAgIAkgICAgaWYgKGZpbHRlciAmJiBmaWx0ZXIuaW5kZXhPZihrZXlzW2tdKSA8IDApIHsKICAgICAgCSAgICAgIHNvbWVIaWRkZW4gPSB0cnVlOwogICAgICAJICAgICAgY29udGludWU7CiAgICAgIAkgICAgfQogICAgICAJICAgIHYgPSBbXS5jb25jYXQob2JqLnZlcnRpY2VzW2tdKS5jb25jYXQoMS4wKTsKICAgICAgICAgICAgdiA9IHJnbHdpZGdldENsYXNzLm11bHRWTSh2LCB0aGlzLnBybXZNYXRyaXgpOwogICAgICAgICAgICB4ID0gdlswXS92WzNdOwogICAgICAgICAgICB5ID0gdlsxXS92WzNdOwogICAgICAgICAgICB6ID0gdlsyXS92WzNdOwogICAgICAgICAgICBpZiAoeG1pbiA8PSB4ICYmIHggPD0geG1heCAmJiB5bWluIDw9IHkgJiYgeSA8PSB5bWF4ICYmIC0xLjAgPD0geiAmJiB6IDw9IDEuMCkgewogICAgICAgICAgICAgIHNlbGVjdGlvbi5wdXNoKGtleXNba10pOwogICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICBzb21lSGlkZGVuID0gdHJ1ZTsKICAgICAgCSAgfQogICAgICAJICBvYmouc29tZUhpZGRlbiA9IHNvbWVIaWRkZW4gJiYgKGZpbHRlciB8fCBzZWxlY3Rpb24ubGVuZ3RoKTsKICAgICAgCSAgb2JqLmluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgIAkgIC8qIFdobyBzaG91bGQgd2Ugbm90aWZ5PyAgT25seSBzaGFyZWQgZGF0YSBpbiB0aGUgY3VycmVudCBzdWJzY2VuZSwgb3IgZXZlcnlvbmU/ICovCiAgICAgIAkgIGlmICghdGhpcy5lcXVhbEFycmF5cyhzZWxlY3Rpb24sIHRoaXMuc2NlbmUuY3Jvc3N0YWxrLnNlbGVjdGlvbikpIHsKICAgICAgCSAgICBoYW5kbGUgPSB0aGlzLnNjZW5lLmNyb3NzdGFsay5zZWxfaGFuZGxlW2pdOwogICAgICAJICAgIGhhbmRsZS5zZXQoc2VsZWN0aW9uLCB7cmdsU3Vic2NlbmVJZDogdGhpcy5zZWxlY3Quc3Vic2NlbmV9KTsKICAgICAgCSAgfQogICAgICAJfQogICAgICB9CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIFJlc3BvbmQgdG8gc2VsZWN0aW9uIG9yIGZpbHRlciBjaGFuZ2UgZnJvbSBjcm9zc3RhbGsKICAgICAqIEBwYXJhbSB7IE9iamVjdCB9IGV2ZW50IC0gY3Jvc3N0YWxrIGV2ZW50CiAgICAgKiBAcGFyYW0geyBib29sZWFuIH0gZmlsdGVyIC0gZmlsdGVyIG9yIHNlbGVjdGlvbj8KICAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLnNlbGVjdGlvbiA9IGZ1bmN0aW9uKGV2ZW50LCBmaWx0ZXIpIHsKICAgICAgCXZhciBpLCBqLCBpZHMsIG9iaiwga2V5cywgY3Jvc3N0YWxrID0gdGhpcy5zY2VuZS5jcm9zc3RhbGssCiAgICAgIAkgICAgc2VsZWN0aW9uLCBzb21lSGlkZGVuOwoKICAgICAgCS8vIFJlY29yZCB0aGUgbWVzc2FnZSBhbmQgZmluZCBvdXQgaWYgdGhpcyBldmVudCBtYWtlcyBzb21lIG9iamVjdHMgaGF2ZSBtaXhlZCB2YWx1ZXM6CiAgICAgIAkKICAgICAgCWNyb3NzdGFsayA9IHRoaXMuc2NlbmUuY3Jvc3N0YWxrOwogICAgICAJCiAgICAgIAlpZiAoZmlsdGVyKSB7CiAgICAgIAkgIGZpbHRlciA9IGNyb3NzdGFsay5maWx0ZXIgPSBldmVudC52YWx1ZTsKICAgICAgCSAgc2VsZWN0aW9uID0gY3Jvc3N0YWxrLnNlbGVjdGlvbjsKICAgICAgCX0gZWxzZSB7ICAKICAgICAgICAgIHNlbGVjdGlvbiA9IGNyb3NzdGFsay5zZWxlY3Rpb24gPSBldmVudC52YWx1ZTsKICAgICAgICAgIGZpbHRlciA9IGNyb3NzdGFsay5maWx0ZXI7CiAgICAgIAl9CiAgICAgICAgaWRzID0gY3Jvc3N0YWxrLmlkOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBpZHMubGVuZ3RoIDsgaSsrKSB7CiAgICAgICAgICBvYmogPSB0aGlzLmdldE9iaihpZHNbaV0pOwogICAgICAgICAgb2JqLmluaXRpYWxpemVkID0gZmFsc2U7CiAgICAgICAgICBrZXlzID0gY3Jvc3N0YWxrLmtleVtpXTsKICAgICAgICAgIHNvbWVIaWRkZW4gPSBmYWxzZTsKICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBrZXlzLmxlbmd0aCAmJiAhc29tZUhpZGRlbjsgaisrKSB7CiAgICAgICAgICAgIGlmICgoZmlsdGVyICYmIGZpbHRlci5pbmRleE9mKGtleXNbal0pIDwgMCkgfHwKICAgICAgICAgICAgICAgIChzZWxlY3Rpb24ubGVuZ3RoICYmIHNlbGVjdGlvbi5pbmRleE9mKGtleXNbal0pIDwgMCkpCiAgICAgICAgICAgICAgICBzb21lSGlkZGVuID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICAgIG9iai5zb21lSGlkZGVuID0gc29tZUhpZGRlbjsKICAgICAgICB9CiAgICAgICAgdGhpcy5kcmF3U2NlbmUoKTsKICAgIH07CiAgICAKICAgIC8qKgogICAgICogQ2xlYXIgdGhlIHNlbGVjdGlvbiBicnVzaAogICAgICogQHBhcmFtIHsgbnVtYmVyIH0gZXhjZXB0IC0gU3Vic2NlbmUgdGhhdCBzaG91bGQgaWdub3JlIHRoaXMgcmVxdWVzdAogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuY2xlYXJCcnVzaCA9IGZ1bmN0aW9uKGV4Y2VwdCkgewogICAgICBpZiAodGhpcy5zZWxlY3Quc3Vic2NlbmUgIT09IGV4Y2VwdCkgewogICAgICAgIHRoaXMuc2VsZWN0LnJlZ2lvbiA9IHtwMToge3g6SW5maW5pdHksIHk6SW5maW5pdHl9LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcDI6IHt4OkluZmluaXR5LCB5OkluZmluaXR5fX07CiAgICAgICAgdGhpcy5zZWxlY3Rpb25DaGFuZ2VkKCk7CiAgICAgICAgdGhpcy5zZWxlY3Quc3RhdGUgPSAiaW5hY3RpdmUiOwogICAgICAgIHRoaXMuZGVsRnJvbVN1YnNjZW5lKHRoaXMuc2NlbmUuYnJ1c2hJZCwgdGhpcy5zZWxlY3Quc3Vic2NlbmUpOwogICAgICB9CiAgICAgIHRoaXMuZHJhd1NjZW5lKCk7CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIFNldCB0aGUgdmVydGljZXMgaW4gdGhlIHNlbGVjdGlvbiBib3ggb2JqZWN0CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5pbml0U2VsZWN0aW9uID0gZnVuY3Rpb24oaWQpIHsKICAgICAgaWYgKHR5cGVvZiB0aGlzLnNlbGVjdC5yZWdpb24gPT09ICJ1bmRlZmluZWQiKQogICAgICAgIHJldHVybjsKICAgICAgdmFyIG9iaiA9IHRoaXMuZ2V0T2JqKGlkKSwKICAgICAgICAgIHAxID0gdGhpcy5zZWxlY3QucmVnaW9uLnAxLAogICAgICAgICAgcDIgPSB0aGlzLnNlbGVjdC5yZWdpb24ucDI7CiAgICAgICAgICAKICAgICAgb2JqLnZlcnRpY2VzID0gW1twMS54LCBwMS55LCAwLjBdLAogICAgICAgICAgICAgICAgICAgICAgW3AyLngsIHAxLnksIDAuMF0sCiAgICAgICAgICAgICAgICAgICAgICBbcDIueCwgcDIueSwgMC4wXSwKICAgICAgICAgICAgICAgICAgICAgIFtwMS54LCBwMi55LCAwLjBdLAogICAgICAgICAgICAgICAgICAgICAgW3AxLngsIHAxLnksIDAuMF1dOwogICAgfTsK"></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,Ci8qIGdsb2JhbHMgcmdsdGltZXJDbGFzczogdHJ1ZSAqLwoKLyoqCiAqIFRoZSBjbGFzcyBvZiBhbiByZ2wgdGltZXIgb2JqZWN0CiAqIEBjbGFzcwoqLwoKLyoqCiAqIENvbnN0cnVjdCBhbiByZ2x0aW1lckNsYXNzIG9iamVjdAogKiBAY29uc3RydWN0b3IKICogQHBhcmFtIHsgZnVuY3Rpb24gfSBUaWNrIC0gYWN0aW9uIHdoZW4gdGltZXIgZmlyZXMKICogQHBhcmFtIHsgbnVtYmVyIH0gc3RhcnRUaW1lIC0gbm9taW5hbCBzdGFydCB0aW1lIGluIHNlY29uZHMKICogQHBhcmFtIHsgbnVtYmVyIH0gaW50ZXJ2YWwgLSBzZWNvbmRzIGJldHdlZW4gdXBkYXRlcwogKiBAcGFyYW0geyBudW1iZXIgfSBzdG9wVGltZSAtIG5vbWluYWwgc3RvcCB0aW1lIGluIHNlY29uZHMKICogQHBhcmFtIHsgbnVtYmVyIH0gc3RlcFNpemUgLSBub21pbmFsIHN0ZXAgc2l6ZQogKiBAcGFyYW0geyBudW1iZXIgfSB2YWx1ZSAtIGN1cnJlbnQgbm9taW5hbCB0aW1lCiAqIEBwYXJhbSB7IG51bWJlciB9IHJhdGUgLSBub21pbmFsIHVuaXRzIHBlciBzZWNvbmQKICogQHBhcmFtIHsgc3RyaW5nIH0gbG9vcCAtICJub25lIiwgImN5Y2xlIiBvciAib3NjaWxsYXRlIgogKiBAcGFyYW0geyBPYmplY3QgfSBhY3Rpb25zIC0gbGlzdCBvZiBhY3Rpb25zCiAqLwpyZ2x0aW1lckNsYXNzID0gZnVuY3Rpb24oVGljaywgc3RhcnRUaW1lLCBpbnRlcnZhbCwgc3RvcFRpbWUsIHN0ZXBTaXplLCB2YWx1ZSwgcmF0ZSwgbG9vcCwgYWN0aW9ucykgewogIHRoaXMuZW5hYmxlZCA9IGZhbHNlOwogIHRoaXMudGltZXJJZCA9IDA7CiAgLyoqIG5vbWluYWwgc3RhcnQgdGltZSBpbiBzZWNvbmRzICovCiAgdGhpcy5zdGFydFRpbWUgPSBzdGFydFRpbWU7ICAgCiAgLyoqIGN1cnJlbnQgbm9taW5hbCB0aW1lICovICAgICAgCiAgdGhpcy52YWx1ZSA9IHZhbHVlOwogIC8qKiBzZWNvbmRzIGJldHdlZW4gdXBkYXRlcyAqLyAgICAgICAgICAgICAgICAgCiAgdGhpcy5pbnRlcnZhbCA9IGludGVydmFsOwogIC8qKiBub21pbmFsIHN0b3AgdGltZSAqLyAgICAgICAgICAgCiAgdGhpcy5zdG9wVGltZSA9IHN0b3BUaW1lOwogIC8qKiBub21pbmFsIHN0ZXAgc2l6ZSAqLyAgICAgICAgICAgCiAgdGhpcy5zdGVwU2l6ZSA9IHN0ZXBTaXplOwogIC8qKiBub21pbmFsIHVuaXRzIHBlciBzZWNvbmQgKi8gICAgICAgICAgIAogIHRoaXMucmF0ZSA9IHJhdGU7CiAgLyoqICJub25lIiwgImN5Y2xlIiwgb3IgIm9zY2lsbGF0ZSIgKi8gICAgICAgICAgICAgICAgICAgCiAgdGhpcy5sb29wID0gbG9vcDsKICAvKiogcmVhbCB3b3JsZCBzdGFydCB0aW1lICovICAgICAgICAgICAgICAgICAgIAogIHRoaXMucmVhbFN0YXJ0ID0gdW5kZWZpbmVkOwogIC8qKiBtdWx0aXBsaWVyIGZvciBmYXN0LWZvcndhcmQgb3IgcmV2ZXJzZSAqLyAgICAgICAgIAogIHRoaXMubXVsdGlwbGllciA9IDE7ICAgICAgICAgICAgICAgIAogIHRoaXMuYWN0aW9ucyA9IGFjdGlvbnM7CiAgdGhpcy5UaWNrID0gVGljazsKfTsKCgogICAgLyoqCiAgICAgKiBNZXRob2RzIHJlbGF0ZWQgdG8gcGxheWVycwogICAgICogQG5hbWUgX19fTUVUSE9EU19GT1JfUExBWUVSU19fXwogICAgICogQG1lbWJlcm9mIHJnbHRpbWVyQ2xhc3MKICAgICAqIEBraW5kIGZ1bmN0aW9uCiAgICAgKiBAaW5zdGFuY2UKICAgICAqLwoKICAvKioKICAgKiBTdGFydCBwbGF5aW5nCiAgICogQG1lbWJlcm9mIHJnbHRpbWVyQ2xhc3MKICAgKi8KICByZ2x0aW1lckNsYXNzLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5lbmFibGVkKSB7CiAgICAgIHRoaXMuZW5hYmxlZCA9IGZhbHNlOwogICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVySWQpOwogICAgICB0aGlzLnRpbWVySWQgPSAwOwogICAgICByZXR1cm47CiAgICB9CiAgICB2YXIgdGljayA9IGZ1bmN0aW9uKHNlbGYpIHsKICAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKCk7CiAgICAgIHNlbGYudmFsdWUgPSBzZWxmLm11bHRpcGxpZXIqc2VsZi5yYXRlKihub3cgLSBzZWxmLnJlYWxTdGFydCkvMTAwMCArIHNlbGYuc3RhcnRUaW1lOwogICAgICBzZWxmLmZvcmNlVG9SYW5nZSgpOwogICAgICBpZiAodHlwZW9mIHNlbGYuVGljayAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICBzZWxmLlRpY2soc2VsZi52YWx1ZSk7CiAgICAgIH0KCiAgICB9OwogICAgdGhpcy5yZWFsU3RhcnQgPSBuZXcgRGF0ZSgpIC0gMTAwMCoodGhpcy52YWx1ZSAtIHRoaXMuc3RhcnRUaW1lKS90aGlzLnJhdGUvdGhpcy5tdWx0aXBsaWVyOwogICAgdGhpcy50aW1lcklkID0gd2luZG93LnNldEludGVydmFsKHRpY2ssIDEwMDAqdGhpcy5pbnRlcnZhbCwgdGhpcyk7CiAgICB0aGlzLmVuYWJsZWQgPSB0cnVlOwogIH07CgogIC8qKgogICAqIEZvcmNlIHZhbHVlIGludG8gbGVnYWwgcmFuZ2UKICAgKi8KICByZ2x0aW1lckNsYXNzLnByb3RvdHlwZS5mb3JjZVRvUmFuZ2UgPSBmdW5jdGlvbigpIHsKICAgIGlmICh0aGlzLnZhbHVlID4gdGhpcy5zdG9wVGltZSArIHRoaXMuc3RlcFNpemUvMiB8fCB0aGlzLnZhbHVlIDwgdGhpcy5zdGFydFRpbWUgLSB0aGlzLnN0ZXBTaXplLzIpIHsKICAgICAgaWYgKCF0aGlzLmxvb3ApIHsKICAgICAgICB0aGlzLnJlc2V0KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIGN5Y2xlID0gdGhpcy5zdG9wVGltZSAtIHRoaXMuc3RhcnRUaW1lICsgdGhpcy5zdGVwU2l6ZSwKICAgICAgICAgICAgbmV3dmFsID0gKHRoaXMudmFsdWUgLSB0aGlzLnN0YXJ0VGltZSkgJSBjeWNsZSArIHRoaXMuc3RhcnRUaW1lOwogICAgICAgIGlmIChuZXd2YWwgPCB0aGlzLnN0YXJ0VGltZSkgewogICAgICAgICAgbmV3dmFsICs9IGN5Y2xlOwogICAgICAgIH0KICAgICAgICB0aGlzLnJlYWxTdGFydCArPSAodGhpcy52YWx1ZSAtIG5ld3ZhbCkqMTAwMC90aGlzLm11bHRpcGxpZXIvdGhpcy5yYXRlOwogICAgICAgIHRoaXMudmFsdWUgPSBuZXd2YWw7CiAgICAgIH0KICAgIH0KICB9OwoKICAvKioKICAgKiBSZXNldCB0byBzdGFydCB2YWx1ZXMKICAgKi8KICByZ2x0aW1lckNsYXNzLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKCkgewogICAgdGhpcy52YWx1ZSA9IHRoaXMuc3RhcnRUaW1lOwogICAgdGhpcy5uZXdtdWx0aXBsaWVyKDEpOwogICAgaWYgKHR5cGVvZiB0aGlzLlRpY2sgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgdGhpcy5UaWNrKHRoaXMudmFsdWUpOwogICAgfQogICAgaWYgKHRoaXMuZW5hYmxlZCkKICAgICAgdGhpcy5wbGF5KCk7ICAvKiByZWFsbHkgcGF1c2UuLi4gKi8KICAgIGlmICh0eXBlb2YgdGhpcy5QbGF5QnV0dG9uICE9PSAidW5kZWZpbmVkIikKICAgICAgdGhpcy5QbGF5QnV0dG9uLnZhbHVlID0gIlBsYXkiOwogIH07CgogIC8qKgogICAqIEluY3JlYXNlIHRoZSBtdWx0aXBsaWVyIHRvIHBsYXkgZmFzdGVyCiAgICovCiAgcmdsdGltZXJDbGFzcy5wcm90b3R5cGUuZmFzdGVyID0gZnVuY3Rpb24oKSB7CiAgICB0aGlzLm5ld211bHRpcGxpZXIoTWF0aC5TUVJUMip0aGlzLm11bHRpcGxpZXIpOwogIH07CgogIC8qKgogICAqIERlY3JlYXNlIHRoZSBtdWx0aXBsaWVyIHRvIHBsYXkgc2xvd2VyCiAgICovCiAgcmdsdGltZXJDbGFzcy5wcm90b3R5cGUuc2xvd2VyID0gZnVuY3Rpb24oKSB7CiAgICB0aGlzLm5ld211bHRpcGxpZXIodGhpcy5tdWx0aXBsaWVyL01hdGguU1FSVDIpOwogIH07CgogIC8qKgogICAqIENoYW5nZSBzaWduIG9mIG11bHRpcGxpZXIgdG8gcmV2ZXJzZSBkaXJlY3Rpb24KICAgKi8KICByZ2x0aW1lckNsYXNzLnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24oKSB7CiAgICB0aGlzLm5ld211bHRpcGxpZXIoLXRoaXMubXVsdGlwbGllcik7CiAgfTsKCiAgLyoqCiAgICogU2V0IG11bHRpcGxpZXIgZm9yIHBsYXkgc3BlZWQKICAgKiBAcGFyYW0geyBudW1iZXIgfSBuZXdtdWx0IC0gbmV3IHZhbHVlCiAgICovCiAgcmdsdGltZXJDbGFzcy5wcm90b3R5cGUubmV3bXVsdGlwbGllciA9IGZ1bmN0aW9uKG5ld211bHQpIHsKICAgIGlmIChuZXdtdWx0ICE9PSB0aGlzLm11bHRpcGxpZXIpIHsKICAgICAgdGhpcy5yZWFsU3RhcnQgKz0gMTAwMCoodGhpcy52YWx1ZSAtIHRoaXMuc3RhcnRUaW1lKS90aGlzLnJhdGUqKDEvdGhpcy5tdWx0aXBsaWVyIC0gMS9uZXdtdWx0KTsKICAgICAgdGhpcy5tdWx0aXBsaWVyID0gbmV3bXVsdDsKICAgIH0KICB9OwoKICAvKioKICAgKiBUYWtlIG9uZSBzdGVwCiAgICovCiAgcmdsdGltZXJDbGFzcy5wcm90b3R5cGUuc3RlcCA9IGZ1bmN0aW9uKCkgewogICAgdGhpcy52YWx1ZSArPSB0aGlzLnJhdGUqdGhpcy5tdWx0aXBsaWVyOwogICAgdGhpcy5mb3JjZVRvUmFuZ2UoKTsKICAgIGlmICh0eXBlb2YgdGhpcy5UaWNrICE9PSAidW5kZWZpbmVkIikKICAgICAgdGhpcy5UaWNrKHRoaXMudmFsdWUpOwogIH07Cg=="></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,LyoqCiAqIFByZXR0eSBmdW5jdGlvbiBmcm9tIFIKICogQG5hbWUgX19fUFJFVFRZX0ZST01fUl9fXwogKiBAbWVtYmVyb2Ygcmdsd2lkZ2V0Q2xhc3MKICogQGtpbmQgZnVuY3Rpb24KICogQGluc3RhbmNlCiAqLwoKCi8qIFRoaXMgZmlsZSBpcyB0cmFuc2xhdGVkIGZyb20gcHJldHR5LmMsIHdoaWNoIHdhcwogdGFrZW4gZnJvbSB0aGUgUiBzb3VyY2VzLCByNjE3NDQgb2Ygc3JjL2FwcGwvcHJldHR5LmMsCiB3aXRoIG1pbmltYWwgY2hhbmdlcyAqLwoKLyoKICogIFIgOiBBIENvbXB1dGVyIExhbmd1YWdlIGZvciBTdGF0aXN0aWNhbCBEYXRhIEFuYWx5c2lzCiAqICBDb3B5cmlnaHQgKEMpIDE5OTUtMjAxMiAgVGhlIFIgQ29yZSBUZWFtCiAqCiAqICBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQogKiAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkKICogIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlciB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yCiAqICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgogKgogKiAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCiAqICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgogKiAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZQogKiAgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KICoKICogIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlCiAqICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbTsgaWYgbm90LCBhIGNvcHkgaXMgYXZhaWxhYmxlIGF0CiAqICBodHRwOi8vd3d3LnItcHJvamVjdC5vcmcvTGljZW5zZXMvCiAqLwoKLyoqICAgICAKICogQ29uc3RydWN0IHByZXR0eSB2YWx1ZXMgdG8gY292ZXIgYW4gaW50ZXJ2YWwKICogQHBhcmFtIHsgbnVtYmVyIH0gbG8gLSBsb3dlciBlbmQgb2YgaW50ZXJ2YWwKICogQHBhcmFtIHsgbnVtYmVyIH0gdXAgLSB1cHBlciBlbmQgb2YgaW50ZXJ2YWwKICogQHBhcmFtIHsgbnVtYmVyIH0gbmRpdiAtIHJlcXVlc3RlZCBudW1iZXIgb2YgZGl2aXNpb25zCiAqIEBwYXJhbSB7IG51bWJlciB9IG1pbl9uIC0gbWluaW11bSBkaXZpc2lvbnMKICogQHBhcmFtIHsgbnVtYmVyIH0gc2hyaW5rX3NtbCAtIGlmIHRvbyBtYW55IGNlbGxzLCBhbW91bnQgdG8gc2hyaW5rIGJ5CiAqIEBwYXJhbSB7IG51bWJlciB9IGhpZ2hfdV9mYWN0IC0gYmlhcyBpbiBmYXZvdXIgb2YgbGFyZ2VyIHVuaXRzCiAqIEBwYXJhbSB7IG51bWJlciB9IGVwc19jb3JyZWN0aW9uIC0gY29ycmVjdGlvbiB0byBib3VuZHMKICogQHBhcmFtIHsgQm9vbGVhbiB9IHJldHVybl9ib3VuZHMgLSB3aGV0aGVyIHRvIHJldHVybiBib3VuZHMKICogQGRlc2NyaXB0aW9uCiAqIFByZXR0eSBJbnRlcnZhbHMKCiAqIENvbnN0cnVjdHMgbSAicHJldHR5IiB2YWx1ZXMgd2hpY2ggY292ZXIgdGhlIGdpdmVuIGludGVydmFsCSpsbyA8PSAqdXAKICoJbSB+PSAqbmRpdiArIDEJKGkuZS4sIG5kaXYgOj0gYXBwcm94aW1hdGUgbnVtYmVyIG9mIElOVEVSVkFMUykKICoKICogSXQgaXMgbm90IHF1aXRlIGNsZWFyIHdoYXQgc2hvdWxkIGhhcHBlbiBmb3IJICpsbyA9ICp1cDsKICogUyBpdHNlbGYgYmVoYXZlcyBxdWl0ZSBmdW5pbGx5LCB0aGVuLgogKgogKiBJbiBteSBvcGluaW9uLCBhIHByb3BlciAncHJldHR5JyBzaG91bGQgYWx3YXlzIGVuc3VyZQogKiAqbG8gPCAqdXAsIGFuZCBoZW5jZSAqbmRpdiA+PTEgaW4gdGhlIHJlc3VsdC4KICogSG93ZXZlciwgaW4gUyBhbmQgaGVyZSwgd2UgYWxsb3cgICpsbyA9PSAqdXAsIGFuZCAqbmRpdiA9IDAuCiAqIE5vdGUgaG93ZXZlciwgdGhhdCB3ZSBhcmUgTk9UIENPTVBBVElCTEUgdG8gUy4gW01hcnRpbiBNLl0KICoKICogTkVXICgwLjYzLjIpOiBucywgbnUgYXJlIGRvdWJsZSAoPT0+IG5vIGRhbmdlciBvZiBpbnRlZ2VyIG92ZXJmbG93KQogKgogKiBXZSBkZXRlcm1pbmUKICogaWYgdGhlIGludGVydmFsICh1cCAtIGxvKSBpcyBgYHNtYWxsJycgWzw9PT4JIGlfc21hbGwgPT0gVFJVRSwgYmVsb3ddLgogKiBGb3IgdGhlIGBgaV9zbWFsbCcnIHNpdHVhdGlvbiwgdGhlcmUgaXMgYSBwYXJhbWV0ZXIgIHNocmlua19zbWwsCiAqIHRoZSBmYWN0b3IgYnkgd2hpY2ggdGhlICJzY2FsZSIgaXMgc2hydW5rLgkJfn5+fn5+fn5+fgogKiBJdCBpcyBhZHZpc2FibGUgdG8gc2V0IGl0IHRvIHNvbWUgKHNtYWxsZXIpIGludGVnZXIgcG93ZXIgb2YgMiwKICogc2luY2UgdGhpcyBlbmFibGVzIGV4YWN0IGZsb2F0aW5nIHBvaW50IGRpdmlzaW9uLgogKi8Kcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLlJfcHJldHR5ID0gZnVuY3Rpb24oCiAgbG8sIHVwLCBuZGl2LCBtaW5fbiwgc2hyaW5rX3NtbCwgaGlnaF91X2ZhY3QsCiAgZXBzX2NvcnJlY3Rpb24sIHJldHVybl9ib3VuZHMpIHsKICAvKiBGcm9tIHZlcnNpb24gMC42NSBvbiwgd2UgaGFkIHJvdW5kaW5nX2VwcyA6PSAxZS01LCBiZWZvcmUsIHIuLmVwcyA9IDAKICAgKiAxZS03IGlzIGNvbnNpc3RlbnQgd2l0aCBzZXEuZGVmYXVsdCgpICovCiAgdmFyIHJvdW5kaW5nX2VwcyA9IDFlLTcsICBoID0gaGlnaF91X2ZhY3RbMF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoNSA9IGhpZ2hfdV9mYWN0WzFdLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkeCwgY2VsbCwgdW5pdCwgYmFzZSwgVSwgbnMsIG51LCBrLCBpX3NtYWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERCTF9FUFNJTE9OID0gTnVtYmVyLkVQU0lMT04sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgREJMX01JTiA9IE51bWJlci5NSU5fVkFMVUUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgREJMX01BWCA9IE51bWJlci5NQVhfVkFMVUU7CiAgCiAgZHggPSB1cCAtIGxvOwogIC8qIGNlbGwgOj0gInNjYWxlIgloZXJlICovCiAgaWYgKGR4ID09PSAwICYmIHVwID09PSAwKSB7IC8qICB1cCA9PSBsbyA9PSAwCSAqLwogIGNlbGwgPSAxOwogICAgaV9zbWFsbCA9IHRydWU7CiAgfSBlbHNlIHsKICAgIGNlbGwgPSBNYXRoLm1heChNYXRoLmFicyhsbyksIE1hdGguYWJzKHVwKSk7CiAgICAvKiBVID0gdXBwZXIgYm91bmQgb24gY2VsbC91bml0ICovCiAgICBVID0gKDEgKyAoaDUgPj0gMS41KmgrMC41KSkgPyAxLygxK2gpIDogMS41LygxK2g1KTsKICAgIC8qIGFkZGVkIHRpbWVzIDMsIGFzIHNldmVyYWwgY2FsY3VsYXRpb25zIGhlcmUgKi8KICAgIGlfc21hbGwgPSBkeCA8IGNlbGwgKiBVICogTWF0aC5tYXgoMSxuZGl2KSAqIERCTF9FUFNJTE9OICozOwogIH0KICAKICAvKk9MRDogY2VsbCA9IEZMVF9FUFNJTE9OKyBkeCAvICpuZGl2OyBGTFRfRVBTSUxPTiA9IDEuMTkyZS0wNyAqLwogIGlmKGlfc21hbGwpIHsKICAgIGlmKGNlbGwgPiAxMCkKICAgICAgY2VsbCA9IDkgKyBjZWxsLzEwOwogICAgY2VsbCAqPSBzaHJpbmtfc21sOwogICAgaWYobWluX24gPiAxKSBjZWxsIC89IG1pbl9uOwogIH0gZWxzZSB7CiAgICBjZWxsID0gZHg7CiAgICBpZihuZGl2ID4gMSkgY2VsbCAvPSBuZGl2OwogIH0KICAKICBpZihjZWxsIDwgMjAqREJMX01JTikgewogICAgLyogd2FybmluZyhfKCJJbnRlcm5hbChwcmV0dHkoKSk6IHZlcnkgc21hbGwgcmFuZ2UuLiBjb3JyZWN0ZWQiKSk7ICovCiAgICBjZWxsID0gMjAqREJMX01JTjsKICB9IGVsc2UgaWYoY2VsbCAqIDEwID4gREJMX01BWCkgewogICAgLyogd2FybmluZyhfKCJJbnRlcm5hbChwcmV0dHkoKSk6IHZlcnkgbGFyZ2UgcmFuZ2UuLiBjb3JyZWN0ZWQiKSk7ICovCiAgICBjZWxsID0gMC4xKkRCTF9NQVg7CiAgfQogIGJhc2UgPSBNYXRoLnBvdygxMCwgTWF0aC5mbG9vcihNYXRoLmxvZzEwKGNlbGwpKSk7IC8qIGJhc2UgPD0gY2VsbCA8IDEwKmJhc2UgKi8KICAgIAogICAgLyogdW5pdCA6IGZyb20geyAxLDIsNSwxMCB9ICogYmFzZQogICAgICoJIHN1Y2ggdGhhdCB8dSAtIGNlbGx8IGlzIHNtYWxsLAogICAgICogZmF2b3JpbmcgbGFyZ2VyIChpZiBoID4gMSwgZWxzZSBzbWFsbGVyKSAgdSAgdmFsdWVzOwogICAgICogZmF2b3IgJzUnIG1vcmUgdGhhbiAnMicgIGlmIGg1ID4gaCAgKGRlZmF1bHQgaDUgPSAuNSArIDEuNSBoKSAqLwogICAgdW5pdCA9IGJhc2U7CiAgICBpZigoVSA9IDIqYmFzZSktY2VsbCA8ICBoKihjZWxsLXVuaXQpKSB7IHVuaXQgPSBVOwogICAgICBpZigoVSA9IDUqYmFzZSktY2VsbCA8IGg1KihjZWxsLXVuaXQpKSB7IHVuaXQgPSBVOwogICAgICAgIGlmKChVID0xMCpiYXNlKS1jZWxsIDwgIGgqKGNlbGwtdW5pdCkpIHVuaXQgPSBVOyB9fQogICAgLyogUmVzdWx0OiBjIDo9IGNlbGwsICB1IDo9IHVuaXQsICBiIDo9IGJhc2UKICAgICAqCWMgaW4gWwkxLAkgICAgICAoMisgaCkgLygxK2gpIF0gYiA9PT4gdT0gIGIKICAgICAqCWMgaW4gKCAoMisgaCkvKDEraCksICAoNSsyaDUpLygxK2g1KV0gYiA9PT4gdT0gMmIKICAgICAqCWMgaW4gKCAoNSsyaCkvKDEraCksICgxMCs1aCkgLygxK2gpIF0gYiA9PT4gdT0gNWIKICAgICAqCWMgaW4gKCgxMCs1aCkvKDEraCksCSAgICAgICAgIDEwICkgYiA9PT4gdT0xMGIKICAgICAqCiAgICAgKgk9PT0+CTIvNSAqKDIraCkvKDEraCkgIDw9ICBjL3UgIDw9ICAoMitoKS8oMStoKQkqLwogICAgCiAgICBucyA9IE1hdGguZmxvb3IobG8vdW5pdCtyb3VuZGluZ19lcHMpOwogICAgbnUgPSBNYXRoLmNlaWwgKHVwL3VuaXQtcm91bmRpbmdfZXBzKTsKICAgIAogICAgaWYoZXBzX2NvcnJlY3Rpb24gJiYgKGVwc19jb3JyZWN0aW9uID4gMSB8fCAhaV9zbWFsbCkpIHsKICAgICAgaWYobG8gIT09IDAuMCkgbG8gKj0gKDEtIERCTF9FUFNJTE9OKTsgZWxzZSBsbyA9IC1EQkxfTUlOOwogICAgICBpZih1cCAhPT0gMC4wKSB1cCAqPSAoMSsgREJMX0VQU0lMT04pOyBlbHNlIHVwID0gK0RCTF9NSU47CiAgICB9CiAgICAKICAgIHdoaWxlKG5zKnVuaXQgPiBsbyArIHJvdW5kaW5nX2Vwcyp1bml0KSBucy0tOwogICAgCiAgICB3aGlsZShudSp1bml0IDwgdXAgLSByb3VuZGluZ19lcHMqdW5pdCkgbnUrKzsKICAgIAogICAgayA9IE1hdGguZmxvb3IoMC41ICsgbnUgLSBucyk7CiAgICBpZihrIDwgbWluX24pIHsKICAgICAgLyogZW5zdXJlIHRoYXQJbnUgLSBucwkgPT0gbWluX24gKi8KICAgICAgCiAgICAgIGsgPSBtaW5fbiAtIGs7CiAgICAgIGlmKG5zID49IDApIHsKICAgICAgICBudSArPSBrLzI7CiAgICAgICAgbnMgLT0gay8yICsgayUyOy8qID09PiBudS1ucyA9IG9sZChudS1ucykgKyBtaW5fbiAtayA9IG1pbl9uICovCiAgICAgIH0gZWxzZSB7CiAgICAgICAgbnMgLT0gay8yOwogICAgICAgIG51ICs9IGsvMiArIGslMjsKICAgICAgfQogICAgICBuZGl2ID0gbWluX247CiAgICB9IGVsc2UgewogICAgICBuZGl2ID0gazsKICAgIH0KICAgIGlmKHJldHVybl9ib3VuZHMpIHsgLyogaWYoKSdzIHRvIGVuc3VyZSB0aGF0IHJlc3VsdCBjb3ZlcnMgb3JpZ2luYWwgcmFuZ2UgKi8KICAgICAgaWYobnMgKiB1bml0IDwgbG8pIGxvID0gbnMgKiB1bml0OwogICAgICBpZihudSAqIHVuaXQgPiB1cCkgdXAgPSBudSAqIHVuaXQ7CiAgICB9IGVsc2UgewogICAgICBsbyA9IG5zOwogICAgICB1cCA9IG51OwogICAgfQogICAgcmV0dXJuIHtsbzpsbywgdXA6dXAsIG5kaXY6bmRpdiwgdW5pdDp1bml0fTsKfTsK"></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,ICAgIC8qKgogICAgICogTWV0aG9kcyByZWxhdGVkIHRvIGF4ZXMKICAgICAqIEBuYW1lIF9fX01FVEhPRFNfRk9SX0FYRVNfX18KICAgICAqIEBtZW1iZXJvZiByZ2x3aWRnZXRDbGFzcwogICAgICogQGtpbmQgZnVuY3Rpb24KICAgICAqIEBpbnN0YW5jZQogICAgICovCiAgICAgCiAgICAvKioKICAgICAqIENob29zZSBlZGdlcyBmb3IgdGlja3MKICAgICAqIEBwYXJhbSB7IE1hdHJpeCB9IHBybXYgLSBwcm9qZWN0aW9uLW1vZGVsLXZpZXcgbWF0cml4CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5nZXRUaWNrRWRnZXMgPSBmdW5jdGlvbihwcm12KXsKICAgICAgdmFyIHZlcnRpY2VzID0gW1swLDAsMCwxXSwgWzAsMCwxLDFdLAogICAgICAgICAgICAgICAgICAgICAgWzAsMSwwLDFdLCBbMCwxLDEsMV0sCiAgICAgICAgICAgICAgICAgICAgICBbMSwwLDAsMV0sIFsxLDAsMSwxXSwKICAgICAgICAgICAgICAgICAgICAgIFsxLDEsMCwxXSwgWzEsMSwxLDFdXSwgCiAgICAgICAgICAgZGltLCBpLCBqLCBrLCBlZGdlcywgaHVsbCwgc3RlcCwgcmVzdWx0ID0gW10sIHByb2ogPSBbXSwKCiAgICAgICAgLy8gRmlsdGVyIHRvIGVkZ2VzIHRoYXQgYXJlIG9uIHNpZGVzIHRoYXQgd291bGQKICAgICAgICAvLyBiZSBzaG93biB3aXRoIGEgZmlsbGVkIGJhY2tpbmcuCiAgICAgICAgCiAgICAgIGhhc19iYWNrID0gZnVuY3Rpb24oZWRnZSkgewogICAgICAgICAgdmFyIG5vcm1hbHMgPSBbW10sIFtdXSwKICAgICAgICAgICAgICB2ZXJ0cyA9IFt2ZXJ0aWNlc1tlZGdlWzBdXSwgCiAgICAgICAgICAgICAgICAgICAgICAgdmVydGljZXNbZWRnZVsxXV1dLCAKICAgICAgICAgICAgICBub3JtYWwsIG0sIG47CiAgICAgICAgICBuID0gMDsKICAgICAgICAgIGZvciAobT0wOyBtPDM7IG0rKykgewogICAgICAgICAgICBpZiAodmVydHNbMF1bbV0gPT09IHZlcnRzWzFdW21dKSB7CiAgICAgICAgICAgICAgbm9ybWFsc1tuXSA9IFswLDAsMCwxXTsKICAgICAgICAgICAgICBub3JtYWxzW25dW21dID0gMip2ZXJ0c1swXVttXSAtIDE7CiAgICAgICAgICAgICAgbisrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBmb3IgKG49MDsgbjwyOyBuKyspIHsKICAgICAgICAgICAgbm9ybWFsID0gcmdsd2lkZ2V0Q2xhc3MubXVsdFZNKG5vcm1hbHNbbl0sIHNlbGYubm9ybU1hdHJpeCk7CiAgICAgICAgICAgIGlmIChub3JtYWxbMl0gPCAwIHx8CiAgICAgICAgICAgICAgICAobm9ybWFsWzJdID09PSAwICYmIG5vcm1hbFswXSA8IDApKQogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0sIHNlbGYgPSB0aGlzOwogICAgICAgIAogICAgICBmb3IgKGkgPSAwOyBpIDwgdmVydGljZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBwcm9qW2ldID0gcmdsd2lkZ2V0Q2xhc3MubXVsdFZNKHZlcnRpY2VzW2ldLCBwcm12KTsKICAgICAgICBwcm9qW2ldWzBdID0gcHJvaltpXVswXS9wcm9qW2ldWzNdOwogICAgICAgIHByb2pbaV1bMV0gPSBwcm9qW2ldWzFdL3Byb2pbaV1bM107CiAgICAgICAgcHJvaltpXVsyXSA9IGk7CiAgICAgIH0KICAgICAgaHVsbCA9IHJnbHdpZGdldENsYXNzLmNodWxsKHByb2ouc2xpY2UoKSk7ICAKICAgICAgZm9yIChpID0gMDsgaSA8IGh1bGwubGVuZ3RoOyBpKyspCiAgICAgICAgaHVsbFtpXSA9IGh1bGxbaV1bMl07CiAgICAgIGh1bGwucHVzaChodWxsWzBdKTsKICAgICAgZm9yIChkaW0gPSAwOyBkaW0gPCAzOyBkaW0rKykgeyAKICAgICAgICBlZGdlcyA9IFtdOwogICAgICAgIHN0ZXAgPSBNYXRoLnBvdygyLCAyLWRpbSk7CiAgICAgICAgZm9yIChpID0gMDsgaSA8IDQ7IGkrKykgewogICAgICAgICAgaiA9IChkaW0gPT09IDApID8gaSA6IChkaW0gPT09IDEpID8gaSArIDIqKGk+MSkgOiAyKmk7CiAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgaHVsbC5sZW5ndGggLSAxOyBrKyspIHsKICAgICAgICAgICAgaWYgKChodWxsW2tdID09PSBqICYmIGh1bGxbaysxXSA9PT0gaiArIHN0ZXApIHx8CiAgICAgICAgICAgICAgICAoaHVsbFtrXSA9PT0gaitzdGVwICYmIGh1bGxbaysxXSA9PT0gaikpCiAgICAgICAgICAKICAgICAgICAgICAgICBlZGdlcy5wdXNoKFtqLCBqK3N0ZXBdLCBbaitzdGVwLCBqXSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBlZGdlcyA9IGVkZ2VzLmZpbHRlcihoYXNfYmFjayk7CiAgICAgICAgCiAgICAgICAgLy8gRmluZCB0aGUgZWRnZSB3aXRoIGEgdmVydGV4IGNsb3Nlc3QKICAgICAgICAvLyB0byB0aGUgYm90dG9tIGxlZnQgY29ybmVyCiAgICAgICAgaWYgKGVkZ2VzLmxlbmd0aCkgewogICAgICAgICAgdmFyIGJlc3QsIGJlc3QyLCB2YWwgPSBJbmZpbml0eSwgbmV3dmFsOwogICAgICAgICAgZm9yIChpID0gMDsgaSA8IGVkZ2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGogPSBlZGdlc1tpXVswXTsKICAgICAgICAgICAgbmV3dmFsID0gcHJvaltqXVswXSArIHByb2pbal1bMV07CiAgICAgICAgICAgIGlmIChuZXd2YWwgPCB2YWwpIHsKICAgICAgICAgICAgICBiZXN0ID0gajsKICAgICAgICAgICAgICBiZXN0MiA9IGVkZ2VzW2ldWzFdOwogICAgICAgICAgICAgIHZhbCA9IG5ld3ZhbDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKHR5cGVvZiBiZXN0ICE9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgICByZXN1bHRbZGltXSA9IHZlcnRpY2VzW2Jlc3RdLnNsaWNlKDAsMyk7CiAgICAgICAgICAgIHJlc3VsdFtkaW1dW2RpbV0gPSB1bmRlZmluZWQ7CiAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgcmVzdWx0W2RpbV0gPSB1bmRlZmluZWQ7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIENob29zZSB0aWNrIGxvY2F0aW9ucwogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gb2JqIC0gVGhlIGJib3hkZWNvCiAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLmdldFRpY2tMb2NhdGlvbnMgPSBmdW5jdGlvbihvYmopewogICAgICB2YXIgZGltLCBpLCBsaW1pdHMsIGxvY2F0aW9ucyA9IFtdLCByZXN1bHQgPSBbW10sW10sW11dLCB2YWx1ZSwKICAgICAgICAgIGxlbiwgZGVsdGEsIHJhbmdlLCBiYm94ID0gb2JqLmJib3g7CiAgICAgIG9iai5uZWVkc0F4aXNDYWxsYmFjayA9IGZhbHNlOwogICAgICBmb3IgKGRpbSA9IDA7IGRpbSA8IDM7IGRpbSsrKSB7CiAgICAgICAgbGltaXRzID0gYmJveC5zbGljZSgyKmRpbSwgMipkaW0gKyAyKTsKICAgICAgICByYW5nZSA9IGxpbWl0c1sxXSAtIGxpbWl0c1swXTsKICAgICAgICBzd2l0Y2gob2JqLmF4ZXMubW9kZVtkaW1dKSB7CiAgICAgICAgY2FzZSAiY3VzdG9tIjoKICAgICAgICAgIGZvciAoaT0wOyBpIDwgb2JqLnZlcnRpY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhbHVlID0gKG9iai52ZXJ0aWNlc1tpXVtkaW1dIC0gbGltaXRzWzBdKS9yYW5nZTsKICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gInVuZGVmaW5lZCIgJiYKICAgICAgICAgICAgICAgICFpc05hTih2YWx1ZSkpCiAgICAgICAgICAgICAgcmVzdWx0W2RpbV0ucHVzaCh2YWx1ZSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJmaXhlZHN0ZXAiOgogICAgICAgICAgbGVuID0gTWF0aC5mbG9vcihyYW5nZS9vYmouYXhlcy5zdGVwW2RpbV0pOwogICAgICAgICAgZGVsdGEgPSBvYmouYXhlcy5zdGVwW2RpbV07CiAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspCiAgICAgICAgICAgIHJlc3VsdFtkaW1dLnB1c2goaSpkZWx0YSk7ICAgICAgICAgIAogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAiZml4ZWRudW0iOgogICAgICAgICAgbGVuID0gb2JqLmF4ZXMubnRpY2tzW2RpbV07CiAgICAgICAgICBkZWx0YSA9IChsZW4gPiAxKSA/IHJhbmdlLyhsZW4tMSkgOiAwOwogICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKQogICAgICAgICAgICByZXN1bHRbZGltXS5wdXNoKGkqZGVsdGEvcmFuZ2UpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAicHJldHR5IjoKICAgICAgICAgIGxvY2F0aW9ucyA9IHRoaXMuUl9wcmV0dHkobGltaXRzWzBdLCBsaW1pdHNbMV0sIG9iai5heGVzLm50aWNrc1tkaW1dLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMywgLy8gbWluX24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAuNzUsIC8vIHNocmlua19zbWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsxLjUsIDIuNzVdLCAvLyBoaWdoX3VfZmFjdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCwgLy8gZXBzX2NvcnJlY3Rpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDApOyAvLyByZXR1cm5fYm91bmRzKSAgCiAgICAgICAgICBmb3IgKGkgPSBsb2NhdGlvbnMubG87IGkgPD0gbG9jYXRpb25zLnVwOyBpKyspIHsKICAgICAgICAgICAgdmFsdWUgPSAoaSpsb2NhdGlvbnMudW5pdCAtIGxpbWl0c1swXSkvcmFuZ2U7CiAgICAgICAgICAgIGlmICgwIDwgdmFsdWUgJiYgdmFsdWUgPCAxKQogICAgICAgICAgICAgIHJlc3VsdFtkaW1dLnB1c2godmFsdWUpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAidXNlciI6CiAgICAgICAgICBvYmoubmVlZHNBeGlzQ2FsbGJhY2sgPSB0cnVlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIFNldCB0aWNrIHZlcnRpY2VzCiAgICAgKiBAcGFyYW0geyBPYmplY3QgfSB0aWNrcyAtIHRoZSB0aWNrIG9iamVjdAogICAgICogQHBhcmFtIHsgQXJyYXkgfSAgZWRnZXMgLSBXaGljaCBlZGdlcyBnZXQgdGhlIHRpY2tzPwogICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5nZXRUaWNrVmVydGljZXMgPSBmdW5jdGlvbih0aWNrcykgewogICAgICB2YXIgZGltLCBpLCBqLCB2ZXJ0aWNlcyA9IFtdLCBsb2NhdGlvbnMsIAogICAgICAgICAgZWRnZXMgPSB0aWNrcy5lZGdlcywgZWRnZTsKICAgICAgZm9yIChkaW0gPSAwOyBkaW0gPCAzOyBkaW0rKykgewogICAgICAgIGxvY2F0aW9ucyA9IHRpY2tzLmxvY2F0aW9uc1tkaW1dOwogICAgICAgIGlmIChsb2NhdGlvbnMubGVuZ3RoKQogICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxvY2F0aW9ucy5sZW5ndGg7IGkrKykgCiAgICAgICAgICAgIGlmICh0eXBlb2YgZWRnZXNbZGltXSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgICBlZGdlID0gZWRnZXNbZGltXS5zbGljZSgpOwogICAgICAgICAgICAgIGVkZ2VbZGltXSA9IGxvY2F0aW9uc1tpXTsKICAgICAgICAgICAgICB2ZXJ0aWNlcy5wdXNoKGVkZ2UpOwogICAgICAgICAgICAgIGVkZ2UgPSBlZGdlLnNsaWNlKCk7CiAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IDM7IGorKykgICAgICAgCiAgICAgICAgICAgICAgICBpZiAoKGRpbSA8IDIgJiYgaiA9PT0gMSAtIGRpbSkgfHwgCiAgICAgICAgICAgICAgICAgICAgKGRpbSA9PT0gMiAmJiBqID09PSAwKSkKICAgICAgICAgICAgICAgICAgZWRnZVtqXSArPSAyKihlZGdlW2pdIC0gMC41KS90aWNrcy5heGVzLm1hcmtsZW5bZGltXTsKICAgICAgICAgICAgICB2ZXJ0aWNlcy5wdXNoKGVkZ2UpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICB0aWNrcy52ZXJ0aWNlcyA9IHZlcnRpY2VzOwogICAgICB0aWNrcy52ZXJ0ZXhDb3VudCA9IHZlcnRpY2VzLmxlbmd0aDsKICAgICAgdGlja3MudmFsdWVzID0gbmV3IEZsb2F0MzJBcnJheShyZ2x3aWRnZXRDbGFzcy5mbGF0dGVuKHZlcnRpY2VzKSk7CiAgICAgIHRpY2tzLmluaXRpYWxpemVkID0gZmFsc2U7CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIFNldCB0aWNrIGxhYmVsIHBvc2l0aW9ucwogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gb2JqIC0gdGhlIGJib3ggb2JqZWN0CiAgICAqLwogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLnBsYWNlVGlja0xhYmVscyA9IGZ1bmN0aW9uKG9iaikgewogICAgICB2YXIgdGlja3MgPSBvYmoudGlja3MsIGxhYmVscyA9IG9iai5sYWJlbHMsIGksaixrLAogICAgICAgICAgdmVydGljZXMgPSBbXSwgdGlja3ZlcnRpY2VzID0gdGlja3MudmVydGljZXMsIAogICAgICAgICAgdmVydGV4LCBsb2NhdGlvbnMsIGRpbSwgZWRnZXMgPSBvYmoudGlja3MuZWRnZXM7CiAgICAgIGogPSAwOwogICAgICBmb3IgKGRpbSA9IDA7IGRpbSA8IDM7IGRpbSsrKSB7CiAgICAgICAgaWYgKHR5cGVvZiBlZGdlc1tkaW1dID09PSAidW5kZWZpbmVkIikgCiAgICAgICAgICBjb250aW51ZTsKICAgICAgICBsb2NhdGlvbnMgPSB0aWNrcy5sb2NhdGlvbnNbZGltXTsKICAgICAgICBpZiAobG9jYXRpb25zLmxlbmd0aCkKICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsb2NhdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGlzTmFOKGxvY2F0aW9uc1tpXSkpCiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIHdoaWxlIChqIDwgdGlja3ZlcnRpY2VzLmxlbmd0aCAmJiAKICAgICAgICAgICAgICAgICAgIHRpY2t2ZXJ0aWNlc1tqXVtkaW1dICE9PSBsb2NhdGlvbnNbaV0pIGorKzsKICAgICAgICAgICAgaWYgKGogPj0gdGlja3ZlcnRpY2VzLmxlbmd0aCkKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgdmVydGV4ID0gdGlja3ZlcnRpY2VzW2pdLnNsaWNlKCk7CiAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCAzOyBrKyspCiAgICAgICAgICAgICAgdmVydGV4W2tdICs9IDIqKHRpY2t2ZXJ0aWNlc1tqKzFdW2tdIC0gdmVydGV4W2tdKTsKICAgICAgICAgICAgdmVydGljZXMucHVzaCh2ZXJ0ZXgpOwogICAgICAgICAgICBqICs9IDI7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICBsYWJlbHMudmVydGljZXMgPSB2ZXJ0aWNlczsKICAgICAgbGFiZWxzLmNlbnRlcnMgPSBsYWJlbHMudmVydGljZXM7CiAgICAgIGxhYmVscy5pbml0aWFsaXplZCA9IGZhbHNlOwogICAgfTsgIAogICAgIAogICAgLyoqCiAgICAgKiBTZXQgdGljayBsYWJlbHMKICAgICAqIEBwYXJhbSB7IE9iamVjdCB9IG9iaiAtIHRoZSBiYm94IG9iamVjdAogICAgICovIAogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLnNldFRpY2tMYWJlbHMgPSBmdW5jdGlvbihvYmopIHsKICAgICAgdmFyIHRpY2tzID0gb2JqLnRpY2tzLCBtb2RlLCBsb2NhdGlvbnMsIGxhYmVscyA9IFtdLAogICAgICBzdGFydCA9IDAsIG50aWNrcywgZGltLCBpLCBsaW1pdHMsIHJhbmdlLCB2YWx1ZXMsIG1heCwKICAgICAgZWRnZXMgPSBvYmoudGlja3MuZWRnZXM7CiAgICAgIGZvciAoZGltID0gMDsgZGltIDwgMzsgZGltKyspIHsKICAgICAgICBpZiAodHlwZW9mIGVkZ2VzW2RpbV0gPT09ICJ1bmRlZmluZWQiKSAKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIG1vZGUgPSBvYmouYXhlcy5tb2RlW2RpbV07CiAgICAgICAgbnRpY2tzID0gb2JqLmF4ZXMubnRpY2tzW2RpbV07IC8vIHVzZWQgb24gaW5wdXQgb25seSBmb3IgY3VzdG9tIQogICAgICAgIGlmIChtb2RlID09PSAiY3VzdG9tIikgCiAgICAgICAgICBsYWJlbHMgPSBsYWJlbHMuY29uY2F0KG9iai50ZXh0cy5zbGljZShzdGFydCwgc3RhcnQgKyBudGlja3MpKTsKICAgICAgICBlbHNlIHsKICAgICAgICAgIGxpbWl0cyA9IG9iai5iYm94LnNsaWNlKDIqZGltLCAyKihkaW0rMSkpOwogICAgICAgICAgcmFuZ2UgPSBsaW1pdHNbMV0gLSBsaW1pdHNbMF07CiAgICAgICAgICBsb2NhdGlvbnMgPSB0aWNrcy5sb2NhdGlvbnNbZGltXTsKICAgICAgICAgIG1heCA9IC1JbmZpbml0eTsKICAgICAgICAgIHZhbHVlcyA9IFtdOwogICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxvY2F0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YWx1ZXMucHVzaChsaW1pdHNbMF0gKyByYW5nZSpsb2NhdGlvbnNbaV0pOwogICAgICAgICAgICBtYXggPSBNYXRoLm1heChtYXgsIE1hdGguYWJzKHZhbHVlc1tpXSkpOwogICAgICAgICAgfQogICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxvY2F0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoTWF0aC5hYnModmFsdWVzW2ldKS9tYXggPCBNYXRoLnBvdygxMCwgLTUpKQogICAgICAgICAgICAgIHZhbHVlc1tpXSA9IDA7CiAgICAgICAgICAgIGxhYmVscy5wdXNoKHJnbHdpZGdldENsYXNzLnNpZ25pZih2YWx1ZXNbaV0sIDQpLnRvU3RyaW5nKCkpOwogICAgICAgICAgfQogICAgICAgICAgb2JqLmF4ZXMubnRpY2tzW2RpbV0gPSBsb2NhdGlvbnMubGVuZ3RoOyAgCiAgICAgICAgfQogICAgICAgIHN0YXJ0ICs9IG50aWNrczsKICAgICAgfQogICAgICBvYmoubGFiZWxzLnRleHRzID0gbGFiZWxzOwogICAgfTsKCiAgICAvKioKICAgICAqIFNldCBiYm94ZGVjbyBiYm94IGFuZCBjZW50ZXIgdmVjdG9yIAogICAgICogQHBhcmFtIHsgT2JqZWN0IH0gb2JqIC0gdGhlIGJib3ggb2JqZWN0CiAgICAgKi8gCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuc2V0QmJveCA9IGZ1bmN0aW9uKG9iaiwgc3Vic2NlbmUpIHsKICAgICAgdmFyIGksIGV4cGFuZCwgY2VudGVyID0gW10sIGJib3g7CiAgICAgIGlmICghb2JqLmluaXRpYWxpemVkKQogICAgICAgIHRoaXMuaW5pdEJCb3gob2JqKTsKICAgICAgICAKICAgICAgYmJveCA9IFtdLmNvbmNhdChzdWJzY2VuZS5wYXIzZC5iYm94KTsKICAgICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykgewogICAgICAgIGV4cGFuZCA9IG9iai5heGVzLmV4cGFuZFtpXTsKICAgICAgICBjZW50ZXJbaV0gPSAoYmJveFsyKmldICsgYmJveFsyKmkgKyAxXSkvMjsKICAgICAgICBiYm94WzIqaV0gPSBjZW50ZXJbaV0gLSBleHBhbmQqKGJib3hbMippICsgMV0gLSBjZW50ZXJbaV0pOwogICAgICAgIGJib3hbMippKzFdID0gY2VudGVyW2ldICsgZXhwYW5kKihiYm94WzIqaSArIDFdIC0gY2VudGVyW2ldKTsKICAgICAgfQogICAgICBvYmouYmJveCA9IGJib3g7CiAgICAgIG9iai5jZW50ZXIgPSBjZW50ZXI7CiAgICB9OwoKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5zZXRCQm94TWF0cmljZXMgPSBmdW5jdGlvbihvYmopIHsKICAgICAgdmFyIHNhdmVkID0ge25vcm1NYXRyaXg6IG5ldyBDYW52YXNNYXRyaXg0KHRoaXMubm9ybU1hdHJpeCksCiAgICAgICAgICAgICAgICAgICBtdk1hdHJpeDogbmV3IENhbnZhc01hdHJpeDQodGhpcy5tdk1hdHJpeCl9LAogICAgICAgICAgYmJveE5vcm0sIGJib3hNViwgYmJveCA9IG9iai5iYm94LCBzY2FsZTsKICAgICAgICAgIAogICAgICBiYm94Tm9ybSA9IG5ldyBDYW52YXNNYXRyaXg0KCk7CiAgICAgIHNjYWxlID0gW2Jib3hbMV0tYmJveFswXSwgYmJveFszXS1iYm94WzJdLCBiYm94WzVdLWJib3hbNF1dOwogICAgICBiYm94Tm9ybS5zY2FsZSgxL3NjYWxlWzBdLCAxL3NjYWxlWzFdLCAxL3NjYWxlWzJdKTsKICAgICAgYmJveE5vcm0ubXVsdFJpZ2h0KHNhdmVkLm5vcm1NYXRyaXgpOwogICAgICB0aGlzLm5vcm1NYXRyaXggPSBiYm94Tm9ybTsKCiAgICAgIGJib3hNViA9IG5ldyBDYW52YXNNYXRyaXg0KCk7CiAgICAgIGJib3hNVi5zY2FsZShzY2FsZVswXSwgc2NhbGVbMV0sIHNjYWxlWzJdKTsKICAgICAgYmJveE1WLnRyYW5zbGF0ZShiYm94WzBdLCBiYm94WzJdLCBiYm94WzRdKTsKICAgICAgYmJveE1WLm11bHRSaWdodChzYXZlZC5tdk1hdHJpeCk7CiAgICAgIHRoaXMubXZNYXRyaXggPSBvYmoubXZNYXRyaXggPSBiYm94TVY7CiAgICAgIAogICAgICBpZiAodGhpcy5wcm12TWF0cml4ID09PSBudWxsKQogICAgICAgIHNhdmVkLnBybXZNYXRyaXggPSBudWxsOwogICAgICBlbHNlCiAgICAgICAgc2F2ZWQucHJtdk1hdHJpeCA9IG5ldyBDYW52YXNNYXRyaXg0KHRoaXMucHJtdk1hdHJpeCk7CiAgICAgICAgCiAgICAgIHRoaXMuc2V0cHJtdk1hdHJpeCgpOwogICAgICBvYmoucHJtdk1hdHJpeCA9IHRoaXMucHJtdk1hdHJpeDsKICAgICAgCiAgICAgIHJldHVybiBzYXZlZDsKICAgIH07CiAgICAKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5yZXN0b3JlQkJveE1hdHJpY2VzID0gZnVuY3Rpb24oc2F2ZWQpIHsKICAgICAgdGhpcy5ub3JtTWF0cml4ID0gc2F2ZWQubm9ybU1hdHJpeDsKICAgICAgdGhpcy5tdk1hdHJpeCAgID0gc2F2ZWQubXZNYXRyaXg7CiAgICAgIHRoaXMucHJtdk1hdHJpeCA9IHNhdmVkLnBybXZNYXRyaXg7CiAgICB9OwogICAgCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZ2V0TWFyZ2luUGFyYW1ldGVycyA9IGZ1bmN0aW9uKGJib3hkZWNvLCBtYXRlcmlhbCkgewogICAgICAvLyBBc3N1bWUgd2UndmUgcnVuIHRoaXMuc2V0QmJveChiYm94ZGVjbywgc3Vic2NlbmUpOwogICAgICB2YXIgYmJveCA9IGJib3hkZWNvLmJib3gsCiAgICAgICAgICBlZGdlID0gW10uY29uY2F0KG1hdGVyaWFsLmVkZ2UpLAogICAgICAgICAgc2F2ZWQsIGVkZ2VzLCBpLCAKICAgICAgICAgIGF0ID0gbWF0ZXJpYWwubWFyZ2luLCBsaW5lLCBsZXZlbCwgdHJhbnMsIHNjYWxlOwoKICAgICAgaWYgKG1hdGVyaWFsLmZsb2F0aW5nKSB7CiAgICAgICAgc2F2ZWQgPSB0aGlzLnNldEJCb3hNYXRyaWNlcyhiYm94ZGVjbyk7CiAgICAgICAgZWRnZXMgPSB0aGlzLmdldFRpY2tFZGdlcyh0aGlzLnBybXZNYXRyaXgpW2F0XTsKICAgICAgICB0aGlzLnJlc3RvcmVCQm94TWF0cmljZXMoc2F2ZWQpOwogICAgICAgIGlmICh0eXBlb2YgZWRnZXMgIT09ICJ1bmRlZmluZWQiKQogICAgICAgICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykgewogICAgICAgICAgICBpZiAoZWRnZXNbaV0gPCAxKSBlZGdlc1tpXSA9IC0xOwogICAgICAgICAgICAgIGVkZ2VbaV0gPSBlZGdlW2ldKmVkZ2VzW2ldOwogICAgICAgIH0gZWxzZQogICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQogICAgICBzd2l0Y2goYXQpIHsKICAgICAgY2FzZSAwOiBsaW5lID0gMTsKICAgICAgICAgICAgICBsZXZlbCA9IDI7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgMTogbGluZSA9IDA7CiAgICAgICAgICAgICAgbGV2ZWwgPSAyOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICBjYXNlIDI6IGxpbmUgPSAwOwogICAgICAgICAgICAgIGxldmVsID0gMTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgfQogICAgICBzY2FsZSA9IFtlZGdlWzBdKihiYm94WzFdLWJib3hbMF0pL2Jib3hkZWNvLmF4ZXMubWFya2xlblswXSwgCiAgICAgICAgICAgICAgIGVkZ2VbMV0qKGJib3hbM10tYmJveFsyXSkvYmJveGRlY28uYXhlcy5tYXJrbGVuWzFdLCAKICAgICAgICAgICAgICAgZWRnZVsyXSooYmJveFs1XS1iYm94WzRdKS9iYm94ZGVjby5heGVzLm1hcmtsZW5bMl1dOwogICAgICB0cmFucyA9IFtlZGdlWzBdID09PSAxID8gYmJveFsxXSA6IGJib3hbMF0sCiAgICAgICAgICAgICAgIGVkZ2VbMV0gPT09IDEgPyBiYm94WzNdIDogYmJveFsyXSwKICAgICAgICAgICAgICAgZWRnZVsyXSA9PT0gMSA/IGJib3hbNV0gOiBiYm94WzRdXTsKICAgICAgcmV0dXJuIHthdDogYXQsIGxpbmU6IGxpbmUsIGxldmVsOiBsZXZlbCwgdHJhbnM6IHRyYW5zLCBzY2FsZTogc2NhbGV9OyAgICAgICAgCiAgICB9OwogICAgCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZml4VmVydGV4ID0gZnVuY3Rpb24ob3JpZywgcGFybXMsIGNlbnRlciwgYmJveCkgewogICAgICB2YXIgdmVydGV4ID0gWzAsMCwwXTsKICAgICAgaWYgKHJnbHdpZGdldENsYXNzLm1pc3Npbmcob3JpZ1swXSkpCiAgICAgICAgdmVydGV4W3Bhcm1zLmF0XSA9IGNlbnRlcltwYXJtcy5hdF07CiAgICAgIGVsc2UgaWYgKG9yaWdbMF0gPT09ICItSW5mIikKICAgICAgICB2ZXJ0ZXhbcGFybXMuYXRdID0gYmJveFsyKnBhcm1zLmF0XTsKICAgICAgZWxzZSBpZiAob3JpZ1swXSA9PT0gIkluZiIpCiAgICAgICAgdmVydGV4W3Bhcm1zLmF0XSA9IGJib3hbMipwYXJtcy5hdCArIDFdOwogICAgICBlbHNlCiAgICAgICAgdmVydGV4W3Bhcm1zLmF0XSA9IG9yaWdbMF07CiAgICAgIHZlcnRleFtwYXJtcy5saW5lXSA9IHBhcm1zLnNjYWxlW3Bhcm1zLmxpbmVdKm9yaWdbMV0gKyAKICAgICAgICAgIHBhcm1zLnRyYW5zW3Bhcm1zLmxpbmVdOwogICAgICB2ZXJ0ZXhbcGFybXMubGV2ZWxdID0gcGFybXMuc2NhbGVbcGFybXMubGV2ZWxdKm9yaWdbMl0gKyAKICAgICAgICAgIHBhcm1zLnRyYW5zW3Bhcm1zLmxldmVsXTsKICAgICAgcmV0dXJuIHZlcnRleDsKICAgIH07CiAgICAKICAgIHJnbHdpZGdldENsYXNzLnByb3RvdHlwZS5maXhOb3JtYWwgPSBmdW5jdGlvbihvcmlnLCBwYXJtcykgewogICAgICB2YXIgdmVydGV4ID0gWzAsMCwwXTsKICAgICAgdmVydGV4W3Bhcm1zLmF0XSA9IG9yaWdbMF07CiAgICAgIHZlcnRleFtwYXJtcy5saW5lXSA9IG9yaWdbMV0vcGFybXMuc2NhbGVbcGFybXMubGluZV07CiAgICAgIHZlcnRleFtwYXJtcy5sZXZlbF0gPSBvcmlnWzJdL3Bhcm1zLnNjYWxlW3Bhcm1zLmxldmVsXTsKICAgICAgcmV0dXJuIHZlcnRleDsKICAgIH07CgogICAgcmdsd2lkZ2V0Q2xhc3MucHJvdG90eXBlLm1hcmdpblZlY1RvRGF0YVZlYyA9IGZ1bmN0aW9uKG9iaiwgc3Vic2NlbmUpIHsKICAgICAgdmFyIGJib3hkZWNvID0gdGhpcy5nZXRCQm94RGVjbyhzdWJzY2VuZSksCiAgICAgICAgICBjZW50ZXIsIGJib3gsIHBhcm1zLCBwYXJtc2pzb24sCiAgICAgICAgICBvcmlnID0gb2JqLm9yaWcsIAogICAgICAgICAgdmVydGljZXMgPSBbXSwgbm9ybWFscyA9IFtdLAogICAgICAgICAgY2VudGVycyA9IFtdLCBpLCB2ZXJ0ZXg7CiAgICAgIGlmICh0eXBlb2Ygb3JpZyA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICBvcmlnID0ge3ZlcnQ6IG9iai52ZXJ0aWNlcywKICAgICAgICAgICAgICAgIG5vcm06IG9iai5ub3JtYWxzLAogICAgICAgICAgICAgICAgY2VudDogb2JqLmNlbnRlcnMsCiAgICAgICAgICAgICAgICBkb05vcm1hbHM6IHR5cGVvZiBvYmoubm9ybWFscyAhPT0gInVuZGVmaW5lZCIsCiAgICAgICAgICAgICAgICBkb0NlbnRlcnM6IHR5cGVvZiBvYmouY2VudGVycyAhPT0gInVuZGVmaW5lZCIsCiAgICAgICAgICAgICAgICBwYXJtczogIiIKICAgICAgICAgICAgICAgfTsKICAgICAgICBvYmoub3JpZyA9IG9yaWc7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlb2YgYmJveGRlY28gIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgdGhpcy5zZXRCYm94KGJib3hkZWNvLCBzdWJzY2VuZSk7CiAgICAgICAgY2VudGVyID0gYmJveGRlY28uY2VudGVyOwogICAgICAgIGJib3ggPSBiYm94ZGVjby5iYm94OwogICAgICAgIHBhcm1zID0gdGhpcy5nZXRNYXJnaW5QYXJhbWV0ZXJzKGJib3hkZWNvLCBvYmoubWF0ZXJpYWwpOwogICAgICAgIGlmICh0eXBlb2YgcGFybXMgPT09ICJ1bmRlZmluZWQiKQogICAgICAgICAgcmV0dXJuIGZhbHNlOyAgLyogYXhpcyBpcyBub3QgY3VycmVudGx5IHNob3duICovCiAgICAgICAgCiAgICAgICAgcGFybXNqc29uID0gSlNPTi5zdHJpbmdpZnkocGFybXMpOwogICAgICAgIGlmIChwYXJtc2pzb24gPT09IG9yaWcucGFybXMpCiAgICAgICAgICByZXR1cm4gdHJ1ZTsgIC8qIG5vdGhpbmcgaGFzIGNoYW5nZWQgKi8KICAgIAogICAgICAgIG9yaWcucGFybXMgPSBwYXJtc2pzb247CiAgICAgICAgCiAgICAgICAgZm9yIChpPTA7IGkgPCBvcmlnLnZlcnQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHZlcnRleCA9IHRoaXMuZml4VmVydGV4KG9yaWcudmVydFtpXSwgcGFybXMsIGNlbnRlciwgYmJveCk7CiAgICAgICAgICB2ZXJ0aWNlcy5wdXNoKHZlcnRleCk7CiAgICAgICAgfQogICAgICAgIG9iai52ZXJ0aWNlcyA9IHZlcnRpY2VzOwogICAgICAgIGlmIChvcmlnLmRvTm9ybWFscykgewogICAgICAgICAgZm9yIChpPTA7IGkgPCBvcmlnLm5vcm0ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdmVydGV4ID0gdGhpcy5maXhOb3JtYWwob3JpZy5ub3JtW2ldLCBwYXJtcyk7CiAgICAgICAgICAgIG5vcm1hbHMucHVzaCh2ZXJ0ZXgpOwogICAgICAgICAgfQogICAgICAgICAgb2JqLm5vcm1hbHMgPSBub3JtYWxzOwogICAgICAgIH0KICAgICAgICBpZiAob3JpZy5kb0NlbnRlcnMpIHsKICAgICAgICAgIGZvciAoaT0wOyBpIDwgb3JpZy5jZW50Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZlcnRleCA9IHRoaXMuZml4VmVydGV4KG9yaWcuY2VudFtpXSwgcGFybXMsIGNlbnRlciwgYmJveCk7CiAgICAgICAgICAgIGNlbnRlcnMucHVzaCh2ZXJ0ZXgpOwogICAgICAgICAgfQogICAgICAgICAgb2JqLmNlbnRlcnMgPSBjZW50ZXJzOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBvYmouaW5pdGlhbGl6ZWQgPSBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLndhcm4oImJib3hkZWNvIG5vdCBmb3VuZCIpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfTsKCiAgICByZ2x3aWRnZXRDbGFzcy5wcm90b3R5cGUuZG9BeGlzQ2FsbGJhY2sgPSBmdW5jdGlvbihvYmosIGVkZ2VzKSB7CiAgICAgIHZhciBpLCBqLCBjb2RlLCBheGlzLCBmbjsKICAgICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykgewogICAgICAgIGlmIChvYmouYXhlcy5tb2RlW2ldID09PSAidXNlciIpIHsKICAgICAgICAgIGF4aXMgPSBbIngiLCAieSIsICJ6Il1baV07CiAgICAgICAgICBpZiAodHlwZW9mIG9iai5jYWxsYmFja3MgIT09ICJ1bmRlZmluZWQiICYmCiAgICAgICAgICAgICAgdHlwZW9mIChjb2RlID0gb2JqLmNhbGxiYWNrc1theGlzXSkgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgIGlmICh0eXBlb2YgZWRnZXNbaV0gIT09ICJ1bmRlZmluZWQiKQogICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCAzOyBqKyspCiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVkZ2VzW2ldW2pdICE9PSAidW5kZWZpbmVkIikKICAgICAgICAgICAgICAgICAgYXhpcyA9IGF4aXMgKyAoZWRnZXNbaV1bal0gPiAwID8gIisiIDogIi0iKTsKICAgICAgICAgICAgCiAgICAgICAgICAvKiBqc2hpbnQgZXZpbDp0cnVlICovCiAgICAgICAgICAgIGZuID0gRnVuY3Rpb24oJyJ1c2Ugc3RyaWN0IjtyZXR1cm4gKCcgKyBjb2RlICsgJyknKSgpOwogICAgICAgICAgLyoganNoaW50IGV2aWw6ZmFsc2UgKi8KICAgICAgICAgICAgZm4uY2FsbCh0aGlzLCBheGlzKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07Cg=="></script>
<script title="rglwidgetClass" src="data:application/javascript;base64,LyoqCiAgICAgKiBNZXRob2RzIHJlbGF0ZWQgdG8gYW5pbWF0aW9ucwogICAgICogQG5hbWUgX19fTUVUSE9EU19GT1JfQU5JTUFUSU9OX19fCiAgICAgKiBAbWVtYmVyb2Ygcmdsd2lkZ2V0Q2xhc3MKICAgICAqIEBraW5kIGZ1bmN0aW9uCiAgICAgKiBAaW5zdGFuY2UKICAgICAqLwogICAgLyoqCiAgICAgKiBCaW5hcnkgc2VhcmNoCiAgICAgKiBAcGFyYW0geCAtIHggY29vcmRpbmF0ZXMgaW4gaW5jcmVhc2luZyBvcmRlcgogICAgICogQHBhcmFtIG5ld3ggLSB2YWx1ZSB0byBmaW5kLCBhc3N1bWVkIHRvIGJlIGluIHRoZSByYW5nZSBvZiB4CiAgICAgKiBAcmVzdWx0IGluZGV4IG9mIGxhcmdlc3QgeCB2YWx1ZSBiZWxvdyBuZXd4CiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLmJpc2VjdCA9IGZ1bmN0aW9uKHgsIG5ld3gpIHsKICAgICAgdmFyIGxvID0gMCwgaGkgPSB4Lmxlbmd0aCAtIDEsIG1pZDsKICAgICAgd2hpbGUgKGxvIDwgaGkgLSAxKSB7CiAgICAgICAgbWlkID0gTWF0aC5yb3VuZCgobG8gKyBoaSkvMik7CiAgICAgICAgaWYgKHhbbWlkXSA8IG5ld3gpCiAgICAgICAgICBsbyA9IG1pZDsKICAgICAgICBlbHNlCiAgICAgICAgICBoaSA9IG1pZDsKICAgICAgfQogICAgICByZXR1cm4gbG87CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIFN0ZXAgaW50ZXJwb2xhdGlvbiAoY29uc3RhbnQgb3V0c2lkZSBib3VuZHMpCiAgICAgKiBAcGFyYW0geCAtIHggY29vcmRpbmF0ZXMgaW4gaW5jcmVhc2luZyBvcmRlcgogICAgICogQHBhcmFtIHYgLSB2YWx1ZXMgYXQgeDsgZWl0aGVyIGEgdmVjdG9yIG9yIG1hdHJpeAogICAgICogQHBhcmFtIG5ld3ggLSB2YWx1ZSBhdCB3aGljaCB0byBldmFsdWF0ZQogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5zdGVwID0gZnVuY3Rpb24oeCwgdiwgbmV3eCkgewogICAgICB2YXIgbiwgbG87CiAgICAgIGlmIChuZXd4IDw9IHhbMF0pCiAgICAgICAgcmV0dXJuIHZbMF07ICAgIAogICAgICBuID0geC5sZW5ndGg7CiAgICAgIGlmIChuZXd4ID49IHhbbi0xXSkKICAgICAgICByZXR1cm4gdltuLTFdOwogICAgICBsbyA9IHRoaXMuYmlzZWN0KHgsIG5ld3gpOwogICAgICByZXR1cm4gdltsb107CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIExpbmVhciBpbnRlcnBvbGF0aW9uIChjb25zdGFudCBvdXRzaWRlIGJvdW5kcykKICAgICAqIEBwYXJhbSB4IC0geCBjb29yZGluYXRlcyBpbiBpbmNyZWFzaW5nIG9yZGVyCiAgICAgKiBAcGFyYW0gdiAtIHZhbHVlcyBhdCB4OyBlaXRoZXIgYSB2ZWN0b3Igb3IgbWF0cml4CiAgICAgKiBAcGFyYW0gbmV3eCAtIHZhbHVlIGF0IHdoaWNoIHRvIGV2YWx1YXRlCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLmxlcnAgPSBmdW5jdGlvbih4LCB2LCBuZXd4KSB7CiAgICAgIHZhciBpLCBuLCBsbywgaGksIGFscGhhLCByZXN1bHQ7CiAgICAgIGlmIChuZXd4IDw9IHhbMF0pCiAgICAgICAgcmV0dXJuIHZbMF07ICAgIAogICAgICBuID0geC5sZW5ndGg7CiAgICAgIGlmIChuZXd4ID49IHhbbi0xXSkKICAgICAgICByZXR1cm4gdltuLTFdOwogICAgICBsbyA9IHRoaXMuYmlzZWN0KHgsIG5ld3gpOwogICAgICBpZiAobmV3eCA9PT0geFtsb10pCiAgICAgICAgcmV0dXJuIHZbbG9dOwogICAgICBoaSA9IGxvICsgMTsKICAgICAgaWYgKG5ld3ggPT09IHhbaGldKQogICAgICAgIHJldHVybiB2W2hpXTsKICAgICAgYWxwaGEgPSAobmV3eCAtIHhbbG9dKS8oeFtoaV0gLSB4W2xvXSk7CiAgICAgIHJlc3VsdCA9IHZbbG9dOwogICAgICBuID0gcmVzdWx0Lmxlbmd0aDsKICAgICAgaWYgKHR5cGVvZiBuICE9PSAidW5kZWZpbmVkIikgewogICAgICAgIGZvciAoaSA9IDA7IGkgPCBuOyBpKyspCiAgICAgICAgICByZXN1bHRbaV0gPSAoMSAtIGFscGhhKSpyZXN1bHRbaV0gKyBhbHBoYSp2W2hpXVtpXTsKICAgICAgfSBlbHNlCiAgICAgICAgcmVzdWx0ID0gKDEgLSBhbHBoYSkqcmVzdWx0ICsgYWxwaGEqdltoaV07CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwogICAgCiAgICAvKioKICAgICAqIFNwaGVyaWNhbCBsaW5lYXIgaW50ZXJwb2xhdGlvbiAoY29uc3RhbnQgb3V0c2lkZSBib3VuZHMpCiAgICAgKiBAcGFyYW0geCAtIHggY29vcmRpbmF0ZXMgaW4gaW5jcmVhc2luZyBvcmRlcgogICAgICogQHBhcmFtIHYgLSBhIG1hdHJpeCBvZiB1bml0IHF1YXRlcm5pb25zCiAgICAgKiBAcGFyYW0gbmV3eCAtIHZhbHVlIGF0IHdoaWNoIHRvIGV2YWx1YXRlCiAgICAgKi8KICAgIHJnbHdpZGdldENsYXNzLnNsZXJwID0gZnVuY3Rpb24oeCwgdiwgbmV3eCkgewogICAgICB2YXIgbiwgbG8sIGhpLCBhbHBoYSwgcmVzdWx0LAogICAgICAgICAgcDAsIHAxLCBkb3QsIE9tZWdhLCBhbHBoYTAsIGFscGhhMSwgbGVuOwogICAgICBpZiAobmV3eCA8PSB4WzBdKQogICAgICAgIHJldHVybiB2WzBdOyAgICAKICAgICAgaWYgKG5ld3ggPj0geFtuLTFdKQogICAgICAgIHJldHVybiB2W24tMV07CiAgICAgIGxvID0gdGhpcy5iaXNlY3QoeCwgbmV3eCk7CiAgICAgIGlmIChuZXd4ID09PSB4W2xvXSkKICAgICAgICByZXR1cm4gdltsb107CiAgICAgIGhpID0gbG8gKyAxOwogICAgICBpZiAobmV3eCA9PT0geFtoaV0pCiAgICAgICAgcmV0dXJuIHZbaGldOwogICAgICBwMCA9IHZbbG9dOwogICAgICBwMSA9IHZbaGldOwogICAgICBkb3QgPSBwMFswXSpwMVswXSArIAogICAgICAgICAgICBwMFsxXSpwMVsxXSArCiAgICAgICAgICAgIHAwWzJdKnAxWzJdICsKICAgICAgICAgICAgcDBbM10qcDFbM107CiAgICAgIGlmIChkb3QgPCAwKSB7CiAgICAgICAgcDEgPSBbLXAxWzBdLCAtcDFbMV0sIC1wMVsyXSwgLXAxWzNdXTsKICAgICAgICBkb3QgPSAtZG90OwogICAgICB9CiAgICAgIGlmIChkb3QgPj0gMSkKICAgICAgICByZXN1bHQgPSBwMTsKICAgICAgZWxzZSB7CiAgICAgICAgYWxwaGEgPSAobmV3eCAtIHhbbG9dKS8oeFtoaV0gLSB4W2xvXSk7CiAgICAgICAgT21lZ2EgPSBNYXRoLmFjb3MoZG90KTsKICAgICAgICBhbHBoYTAgPSBNYXRoLnNpbigoMSAtIGFscGhhKSpPbWVnYSk7CiAgICAgICAgYWxwaGExID0gTWF0aC5zaW4oYWxwaGEqT21lZ2EpOwogICAgICAgIHJlc3VsdCA9IFthbHBoYTAqcDBbMF0gKyBhbHBoYTEqcDFbMF0sCiAgICAgICAgICAgICAgICAgIGFscGhhMCpwMFsxXSArIGFscGhhMSpwMVsxXSwKICAgICAgICAgICAgICAgICAgYWxwaGEwKnAwWzJdICsgYWxwaGExKnAxWzJdLAogICAgICAgICAgICAgICAgICBhbHBoYTAqcDBbM10gKyBhbHBoYTEqcDFbM11dOwogICAgICB9CiAgICAgIGxlbiA9IE1hdGguc3FydChyZXN1bHRbMF0qcmVzdWx0WzBdICsKICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFsxXSpyZXN1bHRbMV0gKwogICAgICAgICAgICAgICAgICAgICAgcmVzdWx0WzJdKnJlc3VsdFsyXSArCiAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbM10qcmVzdWx0WzNdKTsKICAgICAgcmV0dXJuIFtyZXN1bHRbMF0vbGVuLAogICAgICAgICAgICAgIHJlc3VsdFsxXS9sZW4sCiAgICAgICAgICAgICAgcmVzdWx0WzJdL2xlbiwKICAgICAgICAgICAgICByZXN1bHRbM10vbGVuXTsKICAgIH07CgogICAgLyoqCiAgICAgKiBSb3RhdGUgdXNpbmcgdW5pdCBxdWF0ZXJuaW9uCiAgICAgKiBAcGFyYW0gcSAtIGEgc2luZ2xlIHVuaXQgcXVhdGVybmlvbgogICAgICovCiAgICByZ2x3aWRnZXRDbGFzcy5yb3RhdGVCeVF1YXRlcm5pb24gPSBmdW5jdGlvbihNLCBxKSB7CgogICAgdmFyIHh4ID0gcVswXSpxWzBdLAogICAgICAgIHh5ID0gcVswXSpxWzFdLAogICAgICAgIHh6ID0gcVswXSpxWzJdLAogICAgICAgIHh3ID0gcVswXSpxWzNdLAogICAgICAgIHl5ID0gcVsxXSpxWzFdLAogICAgICAgIHl6ID0gcVsxXSpxWzJdLAogICAgICAgIHl3ID0gcVsxXSpxWzNdLAogICAgICAgIHp6ID0gcVsyXSpxWzJdLAogICAgICAgIHp3ID0gcVsyXSpxWzNdLAogICAgICAgIG1hdHJpeCA9IG5ldyBDYW52YXNNYXRyaXg0KCk7CiAgICAgIG1hdHJpeC5tMTEgPSAxIC0gMiooeXkgKyB6eik7CiAgICAgIG1hdHJpeC5tMTIgPSAyKih4eSArIHp3KTsKICAgICAgbWF0cml4Lm0xMyA9IDIqKHh6IC0geXcpOwogICAgICAgIAogICAgICBtYXRyaXgubTIxID0gMiooeHkgLSB6dyk7CiAgICAgIG1hdHJpeC5tMjIgPSAxIC0gMiooeHggKyB6eik7CiAgICAgIG1hdHJpeC5tMjMgPSAyKih5eiArIHh3KTsKCiAgICAgIG1hdHJpeC5tMzEgPSAyKih4eiArIHl3KTsKICAgICAgbWF0cml4Lm0zMiA9IDIqKHl6IC0geHcpOwogICAgICBtYXRyaXgubTMzID0gMSAtIDIqKHh4ICsgeXkpOwoKICAgICAgTS5tdWx0UmlnaHQobWF0cml4KTsgICAgICAKICAgIH07Cg=="></script>
<link href="data:text/css;charset-utf-8;base64,LnJnbFBsYXllciB7CiAgd2lkdGg6IGF1dG87CiAgaGVpZ2h0OiBhdXRvOwp9CgoucmdsUGxheWVyIC5yZ2wtYnV0dG9uIHsKICB3aWR0aDogYXV0bzsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgZm9udC1zaXplOiA3NSU7Cn0KCi5yZ2xQbGF5ZXIgLnJnbC1zbGlkZXIgewogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICB3aWR0aDogMzAlOwp9CgoucmdsUGxheWVyIC5yZ2wtbGFiZWwgewogIGRpc3BsYXk6IGlubGluZTsKICBwYWRkaW5nLWxlZnQ6IDZweDsKICBwYWRkaW5nLXJpZ2h0OiA2cHg7Cn0K" rel="stylesheet" />
<script title="CanvasMatrix4" src="data:application/javascript;base64,LyogZ2xvYmFscyBDYW52YXNNYXRyaXg0OiB0cnVlICovCi8qIGdsb2JhbHMgV2ViR0xGbG9hdEFycmF5ICovCi8qIGpzaGludCBlcWVxZXE6IGZhbHNlICovCi8qCiAqIENvcHlyaWdodCAoQykgMjAwOSBBcHBsZSBJbmMuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAqCiAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAogKiBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMKICogYXJlIG1ldDoKICogMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHQKICogICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLgogKiAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAogKiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhlCiAqICAgIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uCiAqCiAqIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgQVBQTEUgSU5DLiBgYEFTIElTJycgQU5EIEFOWQogKiBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRQogKiBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIKICogUFVSUE9TRSBBUkUgRElTQ0xBSU1FRC4gIElOIE5PIEVWRU5UIFNIQUxMIEFQUExFIElOQy4gT1IKICogQ09OVFJJQlVUT1JTIEJFIExJQUJMRSBGT1IgQU5ZIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsCiAqIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywKICogUFJPQ1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUzsgTE9TUyBPRiBVU0UsIERBVEEsIE9SCiAqIFBST0ZJVFM7IE9SIEJVU0lORVNTIElOVEVSUlVQVElPTikgSE9XRVZFUiBDQVVTRUQgQU5EIE9OIEFOWSBUSEVPUlkKICogT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUCiAqIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFIFVTRQogKiBPRiBUSElTIFNPRlRXQVJFLCBFVkVOIElGIEFEVklTRUQgT0YgVEhFIFBPU1NJQklMSVRZIE9GIFNVQ0ggREFNQUdFLgoKICogQ29weXJpZ2h0ICgyMDE2KSBEdW5jYW4gTXVyZG9jaCAtIGZpeGVkIENhbnZhc01hdHJpeDQub3J0aG8sCiAqIGNsZWFuZWQgdXAuCiAqLwovKgogICAgQ2FudmFzTWF0cml4NCBjbGFzcwoKICAgIFRoaXMgY2xhc3MgaW1wbGVtZW50cyBhIDR4NCBtYXRyaXguIEl0IGhhcyBmdW5jdGlvbnMgd2hpY2gKICAgIGR1cGxpY2F0ZSB0aGUgZnVuY3Rpb25hbGl0eSBvZiB0aGUgT3BlbkdMIG1hdHJpeCBzdGFjayBhbmQKICAgIGdsdXQgZnVuY3Rpb25zLgoKICAgIElETDoKCiAgICBbCiAgICAgICAgQ29uc3RydWN0b3IoaW4gQ2FudmFzTWF0cml4NCBtYXRyaXgpLCAgICAgICAgICAgLy8gY29weSBwYXNzZWQgbWF0cml4IGludG8gbmV3IENhbnZhc01hdHJpeDQKICAgICAgICBDb25zdHJ1Y3RvcihpbiBzZXF1ZW5jZTxmbG9hdD4gYXJyYXkpICAgICAgICAgICAvLyBjcmVhdGUgbmV3IENhbnZhc01hdHJpeDQgd2l0aCAxNiBmbG9hdHMgKHJvdyBtYWpvcikKICAgICAgICBDb25zdHJ1Y3RvcigpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgbmV3IENhbnZhc01hdHJpeDQgd2l0aCBpZGVudGl0eSBtYXRyaXgKICAgIF0KICAgIGludGVyZmFjZSBDYW52YXNNYXRyaXg0IHsKICAgICAgICBhdHRyaWJ1dGUgZmxvYXQgbTExOwogICAgICAgIGF0dHJpYnV0ZSBmbG9hdCBtMTI7CiAgICAgICAgYXR0cmlidXRlIGZsb2F0IG0xMzsKICAgICAgICBhdHRyaWJ1dGUgZmxvYXQgbTE0OwogICAgICAgIGF0dHJpYnV0ZSBmbG9hdCBtMjE7CiAgICAgICAgYXR0cmlidXRlIGZsb2F0IG0yMjsKICAgICAgICBhdHRyaWJ1dGUgZmxvYXQgbTIzOwogICAgICAgIGF0dHJpYnV0ZSBmbG9hdCBtMjQ7CiAgICAgICAgYXR0cmlidXRlIGZsb2F0IG0zMTsKICAgICAgICBhdHRyaWJ1dGUgZmxvYXQgbTMyOwogICAgICAgIGF0dHJpYnV0ZSBmbG9hdCBtMzM7CiAgICAgICAgYXR0cmlidXRlIGZsb2F0IG0zNDsKICAgICAgICBhdHRyaWJ1dGUgZmxvYXQgbTQxOwogICAgICAgIGF0dHJpYnV0ZSBmbG9hdCBtNDI7CiAgICAgICAgYXR0cmlidXRlIGZsb2F0IG00MzsKICAgICAgICBhdHRyaWJ1dGUgZmxvYXQgbTQ0OwoKICAgICAgICB2b2lkIGxvYWQoaW4gQ2FudmFzTWF0cml4NCBtYXRyaXgpOyAgICAgICAgICAgICAgICAgLy8gY29weSB0aGUgdmFsdWVzIGZyb20gdGhlIHBhc3NlZCBtYXRyaXgKICAgICAgICB2b2lkIGxvYWQoaW4gc2VxdWVuY2U8ZmxvYXQ+IGFycmF5KTsgICAgICAgICAgICAgICAgLy8gY29weSAxNiBmbG9hdHMgaW50byB0aGUgbWF0cml4CiAgICAgICAgc2VxdWVuY2U8ZmxvYXQ+IGdldEFzQXJyYXkoKTsgICAgICAgICAgICAgICAgICAgICAgIC8vIHJldHVybiB0aGUgbWF0cml4IGFzIGFuIGFycmF5IG9mIDE2IGZsb2F0cwogICAgICAgIFdlYkdMRmxvYXRBcnJheSBnZXRBc0NhbnZhc0Zsb2F0QXJyYXkoKTsgICAgICAgICAgIC8vIHJldHVybiB0aGUgbWF0cml4IGFzIGEgV2ViR0xGbG9hdEFycmF5IHdpdGggMTYgdmFsdWVzCiAgICAgICAgdm9pZCBtYWtlSWRlbnRpdHkoKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlcGxhY2UgdGhlIG1hdHJpeCB3aXRoIGlkZW50aXR5CiAgICAgICAgdm9pZCB0cmFuc3Bvc2UoKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlcGxhY2UgdGhlIG1hdHJpeCB3aXRoIGl0cyB0cmFuc3Bvc2UKICAgICAgICB2b2lkIGludmVydCgpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVwbGFjZSB0aGUgbWF0cml4IHdpdGggaXRzIGludmVyc2UKCiAgICAgICAgdm9pZCB0cmFuc2xhdGUoaW4gZmxvYXQgeCwgaW4gZmxvYXQgeSwgaW4gZmxvYXQgeik7IC8vIG11bHRpcGx5IHRoZSBtYXRyaXggYnkgcGFzc2VkIHRyYW5zbGF0aW9uIHZhbHVlcyBvbiB0aGUgcmlnaHQKICAgICAgICB2b2lkIHNjYWxlKGluIGZsb2F0IHgsIGluIGZsb2F0IHksIGluIGZsb2F0IHopOyAgICAgLy8gbXVsdGlwbHkgdGhlIG1hdHJpeCBieSBwYXNzZWQgc2NhbGUgdmFsdWVzIG9uIHRoZSByaWdodAogICAgICAgIHZvaWQgcm90YXRlKGluIGZsb2F0IGFuZ2xlLCAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtdWx0aXBseSB0aGUgbWF0cml4IGJ5IHBhc3NlZCByb3RhdGlvbiB2YWx1ZXMgb24gdGhlIHJpZ2h0CiAgICAgICAgICAgICAgICAgICAgaW4gZmxvYXQgeCwgaW4gZmxvYXQgeSwgaW4gZmxvYXQgeik7ICAgIC8vIChhbmdsZSBpcyBpbiBkZWdyZWVzKQogICAgICAgIHZvaWQgbXVsdFJpZ2h0KGluIENhbnZhc01hdHJpeCBtYXRyaXgpOyAgICAgICAgICAgICAvLyBtdWx0aXBseSB0aGUgbWF0cml4IGJ5IHRoZSBwYXNzZWQgbWF0cml4IG9uIHRoZSByaWdodAogICAgICAgIHZvaWQgbXVsdExlZnQoaW4gQ2FudmFzTWF0cml4IG1hdHJpeCk7ICAgICAgICAgICAgICAvLyBtdWx0aXBseSB0aGUgbWF0cml4IGJ5IHRoZSBwYXNzZWQgbWF0cml4IG9uIHRoZSBsZWZ0CiAgICAgICAgdm9pZCBvcnRobyhpbiBmbG9hdCBsZWZ0LCBpbiBmbG9hdCByaWdodCwgICAgICAgICAgIC8vIG11bHRpcGx5IHRoZSBtYXRyaXggYnkgdGhlIHBhc3NlZCBvcnRobyB2YWx1ZXMgb24gdGhlIHJpZ2h0CiAgICAgICAgICAgICAgICAgICBpbiBmbG9hdCBib3R0b20sIGluIGZsb2F0IHRvcCwKICAgICAgICAgICAgICAgICAgIGluIGZsb2F0IG5lYXIsIGluIGZsb2F0IGZhcik7CiAgICAgICAgdm9pZCBmcnVzdHVtKGluIGZsb2F0IGxlZnQsIGluIGZsb2F0IHJpZ2h0LCAgICAgICAgIC8vIG11bHRpcGx5IHRoZSBtYXRyaXggYnkgdGhlIHBhc3NlZCBmcnVzdHVtIHZhbHVlcyBvbiB0aGUgcmlnaHQKICAgICAgICAgICAgICAgICAgICAgaW4gZmxvYXQgYm90dG9tLCBpbiBmbG9hdCB0b3AsCiAgICAgICAgICAgICAgICAgICAgIGluIGZsb2F0IG5lYXIsIGluIGZsb2F0IGZhcik7CiAgICAgICAgdm9pZCBwZXJzcGVjdGl2ZShpbiBmbG9hdCBmb3Z5LCBpbiBmbG9hdCBhc3BlY3QsICAgIC8vIG11bHRpcGx5IHRoZSBtYXRyaXggYnkgdGhlIHBhc3NlZCBwZXJzcGVjdGl2ZSB2YWx1ZXMgb24gdGhlIHJpZ2h0CiAgICAgICAgICAgICAgICAgICAgICAgICBpbiBmbG9hdCB6TmVhciwgaW4gZmxvYXQgekZhcik7CiAgICAgICAgdm9pZCBsb29rYXQoaW4gZmxvYXQgZXlleCwgaW4gZmxvYXQgZXlleSwgaW4gZmxvYXQgZXlleiwgICAgLy8gbXVsdGlwbHkgdGhlIG1hdHJpeCBieSB0aGUgcGFzc2VkIGxvb2thdAogICAgICAgICAgICAgICAgICAgIGluIGZsb2F0IGN0cngsIGluIGZsb2F0IGN0cnksIGluIGZsb2F0IGN0cnosICAgIC8vIHZhbHVlcyBvbiB0aGUgcmlnaHQKICAgICAgICAgICAgICAgICAgICBpbiBmbG9hdCB1cHgsIGluIGZsb2F0IHVweSwgaW4gZmxvYXQgdXB6KTsKICAgIH0KKi8KCkNhbnZhc01hdHJpeDQgPSBmdW5jdGlvbihtKQp7CiAgICBpZiAodHlwZW9mIG0gPT0gJ29iamVjdCcpIHsKICAgICAgICBpZiAoImxlbmd0aCIgaW4gbSAmJiBtLmxlbmd0aCA+PSAxNikgewogICAgICAgICAgICB0aGlzLmxvYWQobVswXSwgbVsxXSwgbVsyXSwgbVszXSwgbVs0XSwgbVs1XSwgbVs2XSwgbVs3XSwgbVs4XSwgbVs5XSwgbVsxMF0sIG1bMTFdLCBtWzEyXSwgbVsxM10sIG1bMTRdLCBtWzE1XSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAobSBpbnN0YW5jZW9mIENhbnZhc01hdHJpeDQpIHsKICAgICAgICAgICAgdGhpcy5sb2FkKG0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgfQogICAgdGhpcy5tYWtlSWRlbnRpdHkoKTsKfTsKCkNhbnZhc01hdHJpeDQucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbigpCnsKICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDEgJiYgdHlwZW9mIGFyZ3VtZW50c1swXSA9PSAnb2JqZWN0JykgewogICAgICAgIHZhciBtYXRyaXggPSBhcmd1bWVudHNbMF07CgogICAgICAgIGlmICgibGVuZ3RoIiBpbiBtYXRyaXggJiYgbWF0cml4Lmxlbmd0aCA9PSAxNikgewogICAgICAgICAgICB0aGlzLm0xMSA9IG1hdHJpeFswXTsKICAgICAgICAgICAgdGhpcy5tMTIgPSBtYXRyaXhbMV07CiAgICAgICAgICAgIHRoaXMubTEzID0gbWF0cml4WzJdOwogICAgICAgICAgICB0aGlzLm0xNCA9IG1hdHJpeFszXTsKCiAgICAgICAgICAgIHRoaXMubTIxID0gbWF0cml4WzRdOwogICAgICAgICAgICB0aGlzLm0yMiA9IG1hdHJpeFs1XTsKICAgICAgICAgICAgdGhpcy5tMjMgPSBtYXRyaXhbNl07CiAgICAgICAgICAgIHRoaXMubTI0ID0gbWF0cml4WzddOwoKICAgICAgICAgICAgdGhpcy5tMzEgPSBtYXRyaXhbOF07CiAgICAgICAgICAgIHRoaXMubTMyID0gbWF0cml4WzldOwogICAgICAgICAgICB0aGlzLm0zMyA9IG1hdHJpeFsxMF07CiAgICAgICAgICAgIHRoaXMubTM0ID0gbWF0cml4WzExXTsKCiAgICAgICAgICAgIHRoaXMubTQxID0gbWF0cml4WzEyXTsKICAgICAgICAgICAgdGhpcy5tNDIgPSBtYXRyaXhbMTNdOwogICAgICAgICAgICB0aGlzLm00MyA9IG1hdHJpeFsxNF07CiAgICAgICAgICAgIHRoaXMubTQ0ID0gbWF0cml4WzE1XTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKGFyZ3VtZW50c1swXSBpbnN0YW5jZW9mIENhbnZhc01hdHJpeDQpIHsKCiAgICAgICAgICAgIHRoaXMubTExID0gbWF0cml4Lm0xMTsKICAgICAgICAgICAgdGhpcy5tMTIgPSBtYXRyaXgubTEyOwogICAgICAgICAgICB0aGlzLm0xMyA9IG1hdHJpeC5tMTM7CiAgICAgICAgICAgIHRoaXMubTE0ID0gbWF0cml4Lm0xNDsKCiAgICAgICAgICAgIHRoaXMubTIxID0gbWF0cml4Lm0yMTsKICAgICAgICAgICAgdGhpcy5tMjIgPSBtYXRyaXgubTIyOwogICAgICAgICAgICB0aGlzLm0yMyA9IG1hdHJpeC5tMjM7CiAgICAgICAgICAgIHRoaXMubTI0ID0gbWF0cml4Lm0yNDsKCiAgICAgICAgICAgIHRoaXMubTMxID0gbWF0cml4Lm0zMTsKICAgICAgICAgICAgdGhpcy5tMzIgPSBtYXRyaXgubTMyOwogICAgICAgICAgICB0aGlzLm0zMyA9IG1hdHJpeC5tMzM7CiAgICAgICAgICAgIHRoaXMubTM0ID0gbWF0cml4Lm0zNDsKCiAgICAgICAgICAgIHRoaXMubTQxID0gbWF0cml4Lm00MTsKICAgICAgICAgICAgdGhpcy5tNDIgPSBtYXRyaXgubTQyOwogICAgICAgICAgICB0aGlzLm00MyA9IG1hdHJpeC5tNDM7CiAgICAgICAgICAgIHRoaXMubTQ0ID0gbWF0cml4Lm00NDsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0KCiAgICB0aGlzLm1ha2VJZGVudGl0eSgpOwp9OwoKQ2FudmFzTWF0cml4NC5wcm90b3R5cGUuZ2V0QXNBcnJheSA9IGZ1bmN0aW9uKCkKewogICAgcmV0dXJuIFsKICAgICAgICB0aGlzLm0xMSwgdGhpcy5tMTIsIHRoaXMubTEzLCB0aGlzLm0xNCwKICAgICAgICB0aGlzLm0yMSwgdGhpcy5tMjIsIHRoaXMubTIzLCB0aGlzLm0yNCwKICAgICAgICB0aGlzLm0zMSwgdGhpcy5tMzIsIHRoaXMubTMzLCB0aGlzLm0zNCwKICAgICAgICB0aGlzLm00MSwgdGhpcy5tNDIsIHRoaXMubTQzLCB0aGlzLm00NAogICAgXTsKfTsKCkNhbnZhc01hdHJpeDQucHJvdG90eXBlLmdldEFzV2ViR0xGbG9hdEFycmF5ID0gZnVuY3Rpb24oKQp7CiAgICByZXR1cm4gbmV3IFdlYkdMRmxvYXRBcnJheSh0aGlzLmdldEFzQXJyYXkoKSk7Cn07CgpDYW52YXNNYXRyaXg0LnByb3RvdHlwZS5tYWtlSWRlbnRpdHkgPSBmdW5jdGlvbigpCnsKICAgIHRoaXMubTExID0gMTsKICAgIHRoaXMubTEyID0gMDsKICAgIHRoaXMubTEzID0gMDsKICAgIHRoaXMubTE0ID0gMDsKCiAgICB0aGlzLm0yMSA9IDA7CiAgICB0aGlzLm0yMiA9IDE7CiAgICB0aGlzLm0yMyA9IDA7CiAgICB0aGlzLm0yNCA9IDA7CgogICAgdGhpcy5tMzEgPSAwOwogICAgdGhpcy5tMzIgPSAwOwogICAgdGhpcy5tMzMgPSAxOwogICAgdGhpcy5tMzQgPSAwOwoKICAgIHRoaXMubTQxID0gMDsKICAgIHRoaXMubTQyID0gMDsKICAgIHRoaXMubTQzID0gMDsKICAgIHRoaXMubTQ0ID0gMTsKfTsKCkNhbnZhc01hdHJpeDQucHJvdG90eXBlLnRyYW5zcG9zZSA9IGZ1bmN0aW9uKCkKewogICAgdmFyIHRtcCA9IHRoaXMubTEyOwogICAgdGhpcy5tMTIgPSB0aGlzLm0yMTsKICAgIHRoaXMubTIxID0gdG1wOwoKICAgIHRtcCA9IHRoaXMubTEzOwogICAgdGhpcy5tMTMgPSB0aGlzLm0zMTsKICAgIHRoaXMubTMxID0gdG1wOwoKICAgIHRtcCA9IHRoaXMubTE0OwogICAgdGhpcy5tMTQgPSB0aGlzLm00MTsKICAgIHRoaXMubTQxID0gdG1wOwoKICAgIHRtcCA9IHRoaXMubTIzOwogICAgdGhpcy5tMjMgPSB0aGlzLm0zMjsKICAgIHRoaXMubTMyID0gdG1wOwoKICAgIHRtcCA9IHRoaXMubTI0OwogICAgdGhpcy5tMjQgPSB0aGlzLm00MjsKICAgIHRoaXMubTQyID0gdG1wOwoKICAgIHRtcCA9IHRoaXMubTM0OwogICAgdGhpcy5tMzQgPSB0aGlzLm00MzsKICAgIHRoaXMubTQzID0gdG1wOwp9OwoKQ2FudmFzTWF0cml4NC5wcm90b3R5cGUuaW52ZXJ0ID0gZnVuY3Rpb24oKQp7CiAgICAvLyBDYWxjdWxhdGUgdGhlIDR4NCBkZXRlcm1pbmFudAogICAgLy8gSWYgdGhlIGRldGVybWluYW50IGlzIHplcm8sCiAgICAvLyB0aGVuIHRoZSBpbnZlcnNlIG1hdHJpeCBpcyBub3QgdW5pcXVlLgogICAgdmFyIGRldCA9IHRoaXMuX2RldGVybWluYW50NHg0KCk7CgogICAgaWYgKE1hdGguYWJzKGRldCkgPCAxZS04KQogICAgICAgIHJldHVybiBudWxsOwoKICAgIHRoaXMuX21ha2VBZGpvaW50KCk7CgogICAgLy8gU2NhbGUgdGhlIGFkam9pbnQgbWF0cml4IHRvIGdldCB0aGUgaW52ZXJzZQogICAgdGhpcy5tMTEgLz0gZGV0OwogICAgdGhpcy5tMTIgLz0gZGV0OwogICAgdGhpcy5tMTMgLz0gZGV0OwogICAgdGhpcy5tMTQgLz0gZGV0OwoKICAgIHRoaXMubTIxIC89IGRldDsKICAgIHRoaXMubTIyIC89IGRldDsKICAgIHRoaXMubTIzIC89IGRldDsKICAgIHRoaXMubTI0IC89IGRldDsKCiAgICB0aGlzLm0zMSAvPSBkZXQ7CiAgICB0aGlzLm0zMiAvPSBkZXQ7CiAgICB0aGlzLm0zMyAvPSBkZXQ7CiAgICB0aGlzLm0zNCAvPSBkZXQ7CgogICAgdGhpcy5tNDEgLz0gZGV0OwogICAgdGhpcy5tNDIgLz0gZGV0OwogICAgdGhpcy5tNDMgLz0gZGV0OwogICAgdGhpcy5tNDQgLz0gZGV0Owp9OwoKQ2FudmFzTWF0cml4NC5wcm90b3R5cGUudHJhbnNsYXRlID0gZnVuY3Rpb24oeCx5LHopCnsKICAgIGlmICh4ID09PSB1bmRlZmluZWQpCiAgICAgICAgeCA9IDA7CiAgICBpZiAoeSA9PT0gdW5kZWZpbmVkKQogICAgICAgIHkgPSAwOwogICAgaWYgKHogPT09IHVuZGVmaW5lZCkKICAgICAgICB6ID0gMDsKCiAgICB2YXIgbWF0cml4ID0gbmV3IENhbnZhc01hdHJpeDQoKTsKICAgIG1hdHJpeC5tNDEgPSB4OwogICAgbWF0cml4Lm00MiA9IHk7CiAgICBtYXRyaXgubTQzID0gejsKCiAgICB0aGlzLm11bHRSaWdodChtYXRyaXgpOwp9OwoKQ2FudmFzTWF0cml4NC5wcm90b3R5cGUuc2NhbGUgPSBmdW5jdGlvbih4LHkseikKewogICAgaWYgKHggPT09IHVuZGVmaW5lZCkKICAgICAgICB4ID0gMTsKICAgIGlmICh6ID09PSB1bmRlZmluZWQpIHsKICAgICAgICBpZiAoeSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHkgPSB4OwogICAgICAgICAgICB6ID0geDsKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgICAgICB6ID0gMTsKICAgIH0KICAgIGVsc2UgaWYgKHkgPT09IHVuZGVmaW5lZCkKICAgICAgICB5ID0geDsKCiAgICB2YXIgbWF0cml4ID0gbmV3IENhbnZhc01hdHJpeDQoKTsKICAgIG1hdHJpeC5tMTEgPSB4OwogICAgbWF0cml4Lm0yMiA9IHk7CiAgICBtYXRyaXgubTMzID0gejsKCiAgICB0aGlzLm11bHRSaWdodChtYXRyaXgpOwp9OwoKQ2FudmFzTWF0cml4NC5wcm90b3R5cGUucm90YXRlID0gZnVuY3Rpb24oYW5nbGUseCx5LHopCnsKICAgIC8vIGFuZ2xlcyBhcmUgaW4gZGVncmVlcy4gU3dpdGNoIHRvIHJhZGlhbnMKICAgIGFuZ2xlID0gYW5nbGUgLyAxODAgKiBNYXRoLlBJOwoKICAgIGFuZ2xlIC89IDI7CiAgICB2YXIgc2luQSA9IE1hdGguc2luKGFuZ2xlKTsKICAgIHZhciBjb3NBID0gTWF0aC5jb3MoYW5nbGUpOwogICAgdmFyIHNpbkEyID0gc2luQSAqIHNpbkE7CgogICAgLy8gbm9ybWFsaXplCiAgICB2YXIgbGVuZ3RoID0gTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkgKyB6ICogeik7CiAgICBpZiAobGVuZ3RoID09PSAwKSB7CiAgICAgICAgLy8gYmFkIHZlY3RvciwganVzdCB1c2Ugc29tZXRoaW5nIHJlYXNvbmFibGUKICAgICAgICB4ID0gMDsKICAgICAgICB5ID0gMDsKICAgICAgICB6ID0gMTsKICAgIH0gZWxzZSBpZiAobGVuZ3RoICE9IDEpIHsKICAgICAgICB4IC89IGxlbmd0aDsKICAgICAgICB5IC89IGxlbmd0aDsKICAgICAgICB6IC89IGxlbmd0aDsKICAgIH0KCiAgICB2YXIgbWF0ID0gbmV3IENhbnZhc01hdHJpeDQoKTsKCiAgICAvLyBvcHRpbWl6ZSBjYXNlIHdoZXJlIGF4aXMgaXMgYWxvbmcgbWFqb3IgYXhpcwogICAgaWYgKHggPT0gMSAmJiB5ID09PSAwICYmIHogPT09IDApIHsKICAgICAgICBtYXQubTExID0gMTsKICAgICAgICBtYXQubTEyID0gMDsKICAgICAgICBtYXQubTEzID0gMDsKICAgICAgICBtYXQubTIxID0gMDsKICAgICAgICBtYXQubTIyID0gMSAtIDIgKiBzaW5BMjsKICAgICAgICBtYXQubTIzID0gMiAqIHNpbkEgKiBjb3NBOwogICAgICAgIG1hdC5tMzEgPSAwOwogICAgICAgIG1hdC5tMzIgPSAtMiAqIHNpbkEgKiBjb3NBOwogICAgICAgIG1hdC5tMzMgPSAxIC0gMiAqIHNpbkEyOwogICAgICAgIG1hdC5tMTQgPSBtYXQubTI0ID0gbWF0Lm0zNCA9IDA7CiAgICAgICAgbWF0Lm00MSA9IG1hdC5tNDIgPSBtYXQubTQzID0gMDsKICAgICAgICBtYXQubTQ0ID0gMTsKICAgIH0gZWxzZSBpZiAoeCA9PT0gMCAmJiB5ID09IDEgJiYgeiA9PT0gMCkgewogICAgICAgIG1hdC5tMTEgPSAxIC0gMiAqIHNpbkEyOwogICAgICAgIG1hdC5tMTIgPSAwOwogICAgICAgIG1hdC5tMTMgPSAtMiAqIHNpbkEgKiBjb3NBOwogICAgICAgIG1hdC5tMjEgPSAwOwogICAgICAgIG1hdC5tMjIgPSAxOwogICAgICAgIG1hdC5tMjMgPSAwOwogICAgICAgIG1hdC5tMzEgPSAyICogc2luQSAqIGNvc0E7CiAgICAgICAgbWF0Lm0zMiA9IDA7CiAgICAgICAgbWF0Lm0zMyA9IDEgLSAyICogc2luQTI7CiAgICAgICAgbWF0Lm0xNCA9IG1hdC5tMjQgPSBtYXQubTM0ID0gMDsKICAgICAgICBtYXQubTQxID0gbWF0Lm00MiA9IG1hdC5tNDMgPSAwOwogICAgICAgIG1hdC5tNDQgPSAxOwogICAgfSBlbHNlIGlmICh4ID09PSAwICYmIHkgPT09IDAgJiYgeiA9PSAxKSB7CiAgICAgICAgbWF0Lm0xMSA9IDEgLSAyICogc2luQTI7CiAgICAgICAgbWF0Lm0xMiA9IDIgKiBzaW5BICogY29zQTsKICAgICAgICBtYXQubTEzID0gMDsKICAgICAgICBtYXQubTIxID0gLTIgKiBzaW5BICogY29zQTsKICAgICAgICBtYXQubTIyID0gMSAtIDIgKiBzaW5BMjsKICAgICAgICBtYXQubTIzID0gMDsKICAgICAgICBtYXQubTMxID0gMDsKICAgICAgICBtYXQubTMyID0gMDsKICAgICAgICBtYXQubTMzID0gMTsKICAgICAgICBtYXQubTE0ID0gbWF0Lm0yNCA9IG1hdC5tMzQgPSAwOwogICAgICAgIG1hdC5tNDEgPSBtYXQubTQyID0gbWF0Lm00MyA9IDA7CiAgICAgICAgbWF0Lm00NCA9IDE7CiAgICB9IGVsc2UgewogICAgICAgIHZhciB4MiA9IHgqeDsKICAgICAgICB2YXIgeTIgPSB5Knk7CiAgICAgICAgdmFyIHoyID0geip6OwoKICAgICAgICBtYXQubTExID0gMSAtIDIgKiAoeTIgKyB6MikgKiBzaW5BMjsKICAgICAgICBtYXQubTEyID0gMiAqICh4ICogeSAqIHNpbkEyICsgeiAqIHNpbkEgKiBjb3NBKTsKICAgICAgICBtYXQubTEzID0gMiAqICh4ICogeiAqIHNpbkEyIC0geSAqIHNpbkEgKiBjb3NBKTsKICAgICAgICBtYXQubTIxID0gMiAqICh5ICogeCAqIHNpbkEyIC0geiAqIHNpbkEgKiBjb3NBKTsKICAgICAgICBtYXQubTIyID0gMSAtIDIgKiAoejIgKyB4MikgKiBzaW5BMjsKICAgICAgICBtYXQubTIzID0gMiAqICh5ICogeiAqIHNpbkEyICsgeCAqIHNpbkEgKiBjb3NBKTsKICAgICAgICBtYXQubTMxID0gMiAqICh6ICogeCAqIHNpbkEyICsgeSAqIHNpbkEgKiBjb3NBKTsKICAgICAgICBtYXQubTMyID0gMiAqICh6ICogeSAqIHNpbkEyIC0geCAqIHNpbkEgKiBjb3NBKTsKICAgICAgICBtYXQubTMzID0gMSAtIDIgKiAoeDIgKyB5MikgKiBzaW5BMjsKICAgICAgICBtYXQubTE0ID0gbWF0Lm0yNCA9IG1hdC5tMzQgPSAwOwogICAgICAgIG1hdC5tNDEgPSBtYXQubTQyID0gbWF0Lm00MyA9IDA7CiAgICAgICAgbWF0Lm00NCA9IDE7CiAgICB9CiAgICB0aGlzLm11bHRSaWdodChtYXQpOwp9OwoKQ2FudmFzTWF0cml4NC5wcm90b3R5cGUubXVsdFJpZ2h0ID0gZnVuY3Rpb24obWF0KQp7CiAgICB2YXIgbTExID0gKHRoaXMubTExICogbWF0Lm0xMSArIHRoaXMubTEyICogbWF0Lm0yMSArCiAgICAgICAgICAgICAgIHRoaXMubTEzICogbWF0Lm0zMSArIHRoaXMubTE0ICogbWF0Lm00MSk7CiAgICB2YXIgbTEyID0gKHRoaXMubTExICogbWF0Lm0xMiArIHRoaXMubTEyICogbWF0Lm0yMiArCiAgICAgICAgICAgICAgIHRoaXMubTEzICogbWF0Lm0zMiArIHRoaXMubTE0ICogbWF0Lm00Mik7CiAgICB2YXIgbTEzID0gKHRoaXMubTExICogbWF0Lm0xMyArIHRoaXMubTEyICogbWF0Lm0yMyArCiAgICAgICAgICAgICAgIHRoaXMubTEzICogbWF0Lm0zMyArIHRoaXMubTE0ICogbWF0Lm00Myk7CiAgICB2YXIgbTE0ID0gKHRoaXMubTExICogbWF0Lm0xNCArIHRoaXMubTEyICogbWF0Lm0yNCArCiAgICAgICAgICAgICAgIHRoaXMubTEzICogbWF0Lm0zNCArIHRoaXMubTE0ICogbWF0Lm00NCk7CgogICAgdmFyIG0yMSA9ICh0aGlzLm0yMSAqIG1hdC5tMTEgKyB0aGlzLm0yMiAqIG1hdC5tMjEgKwogICAgICAgICAgICAgICB0aGlzLm0yMyAqIG1hdC5tMzEgKyB0aGlzLm0yNCAqIG1hdC5tNDEpOwogICAgdmFyIG0yMiA9ICh0aGlzLm0yMSAqIG1hdC5tMTIgKyB0aGlzLm0yMiAqIG1hdC5tMjIgKwogICAgICAgICAgICAgICB0aGlzLm0yMyAqIG1hdC5tMzIgKyB0aGlzLm0yNCAqIG1hdC5tNDIpOwogICAgdmFyIG0yMyA9ICh0aGlzLm0yMSAqIG1hdC5tMTMgKyB0aGlzLm0yMiAqIG1hdC5tMjMgKwogICAgICAgICAgICAgICB0aGlzLm0yMyAqIG1hdC5tMzMgKyB0aGlzLm0yNCAqIG1hdC5tNDMpOwogICAgdmFyIG0yNCA9ICh0aGlzLm0yMSAqIG1hdC5tMTQgKyB0aGlzLm0yMiAqIG1hdC5tMjQgKwogICAgICAgICAgICAgICB0aGlzLm0yMyAqIG1hdC5tMzQgKyB0aGlzLm0yNCAqIG1hdC5tNDQpOwoKICAgIHZhciBtMzEgPSAodGhpcy5tMzEgKiBtYXQubTExICsgdGhpcy5tMzIgKiBtYXQubTIxICsKICAgICAgICAgICAgICAgdGhpcy5tMzMgKiBtYXQubTMxICsgdGhpcy5tMzQgKiBtYXQubTQxKTsKICAgIHZhciBtMzIgPSAodGhpcy5tMzEgKiBtYXQubTEyICsgdGhpcy5tMzIgKiBtYXQubTIyICsKICAgICAgICAgICAgICAgdGhpcy5tMzMgKiBtYXQubTMyICsgdGhpcy5tMzQgKiBtYXQubTQyKTsKICAgIHZhciBtMzMgPSAodGhpcy5tMzEgKiBtYXQubTEzICsgdGhpcy5tMzIgKiBtYXQubTIzICsKICAgICAgICAgICAgICAgdGhpcy5tMzMgKiBtYXQubTMzICsgdGhpcy5tMzQgKiBtYXQubTQzKTsKICAgIHZhciBtMzQgPSAodGhpcy5tMzEgKiBtYXQubTE0ICsgdGhpcy5tMzIgKiBtYXQubTI0ICsKICAgICAgICAgICAgICAgdGhpcy5tMzMgKiBtYXQubTM0ICsgdGhpcy5tMzQgKiBtYXQubTQ0KTsKCiAgICB2YXIgbTQxID0gKHRoaXMubTQxICogbWF0Lm0xMSArIHRoaXMubTQyICogbWF0Lm0yMSArCiAgICAgICAgICAgICAgIHRoaXMubTQzICogbWF0Lm0zMSArIHRoaXMubTQ0ICogbWF0Lm00MSk7CiAgICB2YXIgbTQyID0gKHRoaXMubTQxICogbWF0Lm0xMiArIHRoaXMubTQyICogbWF0Lm0yMiArCiAgICAgICAgICAgICAgIHRoaXMubTQzICogbWF0Lm0zMiArIHRoaXMubTQ0ICogbWF0Lm00Mik7CiAgICB2YXIgbTQzID0gKHRoaXMubTQxICogbWF0Lm0xMyArIHRoaXMubTQyICogbWF0Lm0yMyArCiAgICAgICAgICAgICAgIHRoaXMubTQzICogbWF0Lm0zMyArIHRoaXMubTQ0ICogbWF0Lm00Myk7CiAgICB2YXIgbTQ0ID0gKHRoaXMubTQxICogbWF0Lm0xNCArIHRoaXMubTQyICogbWF0Lm0yNCArCiAgICAgICAgICAgICAgIHRoaXMubTQzICogbWF0Lm0zNCArIHRoaXMubTQ0ICogbWF0Lm00NCk7CgogICAgdGhpcy5tMTEgPSBtMTE7CiAgICB0aGlzLm0xMiA9IG0xMjsKICAgIHRoaXMubTEzID0gbTEzOwogICAgdGhpcy5tMTQgPSBtMTQ7CgogICAgdGhpcy5tMjEgPSBtMjE7CiAgICB0aGlzLm0yMiA9IG0yMjsKICAgIHRoaXMubTIzID0gbTIzOwogICAgdGhpcy5tMjQgPSBtMjQ7CgogICAgdGhpcy5tMzEgPSBtMzE7CiAgICB0aGlzLm0zMiA9IG0zMjsKICAgIHRoaXMubTMzID0gbTMzOwogICAgdGhpcy5tMzQgPSBtMzQ7CgogICAgdGhpcy5tNDEgPSBtNDE7CiAgICB0aGlzLm00MiA9IG00MjsKICAgIHRoaXMubTQzID0gbTQzOwogICAgdGhpcy5tNDQgPSBtNDQ7Cn07CgpDYW52YXNNYXRyaXg0LnByb3RvdHlwZS5tdWx0TGVmdCA9IGZ1bmN0aW9uKG1hdCkKewogICAgdmFyIG0xMSA9IChtYXQubTExICogdGhpcy5tMTEgKyBtYXQubTEyICogdGhpcy5tMjEgKwogICAgICAgICAgICAgICBtYXQubTEzICogdGhpcy5tMzEgKyBtYXQubTE0ICogdGhpcy5tNDEpOwogICAgdmFyIG0xMiA9IChtYXQubTExICogdGhpcy5tMTIgKyBtYXQubTEyICogdGhpcy5tMjIgKwogICAgICAgICAgICAgICBtYXQubTEzICogdGhpcy5tMzIgKyBtYXQubTE0ICogdGhpcy5tNDIpOwogICAgdmFyIG0xMyA9IChtYXQubTExICogdGhpcy5tMTMgKyBtYXQubTEyICogdGhpcy5tMjMgKwogICAgICAgICAgICAgICBtYXQubTEzICogdGhpcy5tMzMgKyBtYXQubTE0ICogdGhpcy5tNDMpOwogICAgdmFyIG0xNCA9IChtYXQubTExICogdGhpcy5tMTQgKyBtYXQubTEyICogdGhpcy5tMjQgKwogICAgICAgICAgICAgICBtYXQubTEzICogdGhpcy5tMzQgKyBtYXQubTE0ICogdGhpcy5tNDQpOwoKICAgIHZhciBtMjEgPSAobWF0Lm0yMSAqIHRoaXMubTExICsgbWF0Lm0yMiAqIHRoaXMubTIxICsKICAgICAgICAgICAgICAgbWF0Lm0yMyAqIHRoaXMubTMxICsgbWF0Lm0yNCAqIHRoaXMubTQxKTsKICAgIHZhciBtMjIgPSAobWF0Lm0yMSAqIHRoaXMubTEyICsgbWF0Lm0yMiAqIHRoaXMubTIyICsKICAgICAgICAgICAgICAgbWF0Lm0yMyAqIHRoaXMubTMyICsgbWF0Lm0yNCAqIHRoaXMubTQyKTsKICAgIHZhciBtMjMgPSAobWF0Lm0yMSAqIHRoaXMubTEzICsgbWF0Lm0yMiAqIHRoaXMubTIzICsKICAgICAgICAgICAgICAgbWF0Lm0yMyAqIHRoaXMubTMzICsgbWF0Lm0yNCAqIHRoaXMubTQzKTsKICAgIHZhciBtMjQgPSAobWF0Lm0yMSAqIHRoaXMubTE0ICsgbWF0Lm0yMiAqIHRoaXMubTI0ICsKICAgICAgICAgICAgICAgbWF0Lm0yMyAqIHRoaXMubTM0ICsgbWF0Lm0yNCAqIHRoaXMubTQ0KTsKCiAgICB2YXIgbTMxID0gKG1hdC5tMzEgKiB0aGlzLm0xMSArIG1hdC5tMzIgKiB0aGlzLm0yMSArCiAgICAgICAgICAgICAgIG1hdC5tMzMgKiB0aGlzLm0zMSArIG1hdC5tMzQgKiB0aGlzLm00MSk7CiAgICB2YXIgbTMyID0gKG1hdC5tMzEgKiB0aGlzLm0xMiArIG1hdC5tMzIgKiB0aGlzLm0yMiArCiAgICAgICAgICAgICAgIG1hdC5tMzMgKiB0aGlzLm0zMiArIG1hdC5tMzQgKiB0aGlzLm00Mik7CiAgICB2YXIgbTMzID0gKG1hdC5tMzEgKiB0aGlzLm0xMyArIG1hdC5tMzIgKiB0aGlzLm0yMyArCiAgICAgICAgICAgICAgIG1hdC5tMzMgKiB0aGlzLm0zMyArIG1hdC5tMzQgKiB0aGlzLm00Myk7CiAgICB2YXIgbTM0ID0gKG1hdC5tMzEgKiB0aGlzLm0xNCArIG1hdC5tMzIgKiB0aGlzLm0yNCArCiAgICAgICAgICAgICAgIG1hdC5tMzMgKiB0aGlzLm0zNCArIG1hdC5tMzQgKiB0aGlzLm00NCk7CgogICAgdmFyIG00MSA9IChtYXQubTQxICogdGhpcy5tMTEgKyBtYXQubTQyICogdGhpcy5tMjEgKwogICAgICAgICAgICAgICBtYXQubTQzICogdGhpcy5tMzEgKyBtYXQubTQ0ICogdGhpcy5tNDEpOwogICAgdmFyIG00MiA9IChtYXQubTQxICogdGhpcy5tMTIgKyBtYXQubTQyICogdGhpcy5tMjIgKwogICAgICAgICAgICAgICBtYXQubTQzICogdGhpcy5tMzIgKyBtYXQubTQ0ICogdGhpcy5tNDIpOwogICAgdmFyIG00MyA9IChtYXQubTQxICogdGhpcy5tMTMgKyBtYXQubTQyICogdGhpcy5tMjMgKwogICAgICAgICAgICAgICBtYXQubTQzICogdGhpcy5tMzMgKyBtYXQubTQ0ICogdGhpcy5tNDMpOwogICAgdmFyIG00NCA9IChtYXQubTQxICogdGhpcy5tMTQgKyBtYXQubTQyICogdGhpcy5tMjQgKwogICAgICAgICAgICAgICBtYXQubTQzICogdGhpcy5tMzQgKyBtYXQubTQ0ICogdGhpcy5tNDQpOwoKICAgIHRoaXMubTExID0gbTExOwogICAgdGhpcy5tMTIgPSBtMTI7CiAgICB0aGlzLm0xMyA9IG0xMzsKICAgIHRoaXMubTE0ID0gbTE0OwoKICAgIHRoaXMubTIxID0gbTIxOwogICAgdGhpcy5tMjIgPSBtMjI7CiAgICB0aGlzLm0yMyA9IG0yMzsKICAgIHRoaXMubTI0ID0gbTI0OwoKICAgIHRoaXMubTMxID0gbTMxOwogICAgdGhpcy5tMzIgPSBtMzI7CiAgICB0aGlzLm0zMyA9IG0zMzsKICAgIHRoaXMubTM0ID0gbTM0OwoKICAgIHRoaXMubTQxID0gbTQxOwogICAgdGhpcy5tNDIgPSBtNDI7CiAgICB0aGlzLm00MyA9IG00MzsKICAgIHRoaXMubTQ0ID0gbTQ0Owp9OwoKQ2FudmFzTWF0cml4NC5wcm90b3R5cGUub3J0aG8gPSBmdW5jdGlvbihsZWZ0LCByaWdodCwgYm90dG9tLCB0b3AsIG5lYXIsIGZhcikKewogICAgdmFyIHR4ID0gKGxlZnQgKyByaWdodCkgLyAobGVmdCAtIHJpZ2h0KTsKICAgIHZhciB0eSA9ICh0b3AgKyBib3R0b20pIC8gKGJvdHRvbSAtIHRvcCk7CiAgICB2YXIgdHogPSAoZmFyICsgbmVhcikgLyAobmVhciAtIGZhcik7CgogICAgdmFyIG1hdHJpeCA9IG5ldyBDYW52YXNNYXRyaXg0KCk7CiAgICBtYXRyaXgubTExID0gMiAvIChyaWdodCAtIGxlZnQpOwogICAgbWF0cml4Lm0xMiA9IDA7CiAgICBtYXRyaXgubTEzID0gMDsKICAgIG1hdHJpeC5tMTQgPSAwOwogICAgbWF0cml4Lm0yMSA9IDA7CiAgICBtYXRyaXgubTIyID0gMiAvICh0b3AgLSBib3R0b20pOwogICAgbWF0cml4Lm0yMyA9IDA7CiAgICBtYXRyaXgubTI0ID0gMDsKICAgIG1hdHJpeC5tMzEgPSAwOwogICAgbWF0cml4Lm0zMiA9IDA7CiAgICBtYXRyaXgubTMzID0gLTIgLyAoZmFyIC0gbmVhcik7CiAgICBtYXRyaXgubTM0ID0gMDsKICAgIG1hdHJpeC5tNDEgPSB0eDsKICAgIG1hdHJpeC5tNDIgPSB0eTsKICAgIG1hdHJpeC5tNDMgPSB0ejsKICAgIG1hdHJpeC5tNDQgPSAxOwoKICAgIHRoaXMubXVsdFJpZ2h0KG1hdHJpeCk7Cn07CgpDYW52YXNNYXRyaXg0LnByb3RvdHlwZS5mcnVzdHVtID0gZnVuY3Rpb24obGVmdCwgcmlnaHQsIGJvdHRvbSwgdG9wLCBuZWFyLCBmYXIpCnsKICAgIHZhciBtYXRyaXggPSBuZXcgQ2FudmFzTWF0cml4NCgpOwogICAgdmFyIEEgPSAocmlnaHQgKyBsZWZ0KSAvIChyaWdodCAtIGxlZnQpOwogICAgdmFyIEIgPSAodG9wICsgYm90dG9tKSAvICh0b3AgLSBib3R0b20pOwogICAgdmFyIEMgPSAtKGZhciArIG5lYXIpIC8gKGZhciAtIG5lYXIpOwogICAgdmFyIEQgPSAtKDIgKiBmYXIgKiBuZWFyKSAvIChmYXIgLSBuZWFyKTsKCiAgICBtYXRyaXgubTExID0gKDIgKiBuZWFyKSAvIChyaWdodCAtIGxlZnQpOwogICAgbWF0cml4Lm0xMiA9IDA7CiAgICBtYXRyaXgubTEzID0gMDsKICAgIG1hdHJpeC5tMTQgPSAwOwoKICAgIG1hdHJpeC5tMjEgPSAwOwogICAgbWF0cml4Lm0yMiA9IDIgKiBuZWFyIC8gKHRvcCAtIGJvdHRvbSk7CiAgICBtYXRyaXgubTIzID0gMDsKICAgIG1hdHJpeC5tMjQgPSAwOwoKICAgIG1hdHJpeC5tMzEgPSBBOwogICAgbWF0cml4Lm0zMiA9IEI7CiAgICBtYXRyaXgubTMzID0gQzsKICAgIG1hdHJpeC5tMzQgPSAtMTsKCiAgICBtYXRyaXgubTQxID0gMDsKICAgIG1hdHJpeC5tNDIgPSAwOwogICAgbWF0cml4Lm00MyA9IEQ7CiAgICBtYXRyaXgubTQ0ID0gMDsKCiAgICB0aGlzLm11bHRSaWdodChtYXRyaXgpOwp9OwoKQ2FudmFzTWF0cml4NC5wcm90b3R5cGUucGVyc3BlY3RpdmUgPSBmdW5jdGlvbihmb3Z5LCBhc3BlY3QsIHpOZWFyLCB6RmFyKQp7CiAgICB2YXIgdG9wID0gTWF0aC50YW4oZm92eSAqIE1hdGguUEkgLyAzNjApICogek5lYXI7CiAgICB2YXIgYm90dG9tID0gLXRvcDsKICAgIHZhciBsZWZ0ID0gYXNwZWN0ICogYm90dG9tOwogICAgdmFyIHJpZ2h0ID0gYXNwZWN0ICogdG9wOwogICAgdGhpcy5mcnVzdHVtKGxlZnQsIHJpZ2h0LCBib3R0b20sIHRvcCwgek5lYXIsIHpGYXIpOwp9OwoKQ2FudmFzTWF0cml4NC5wcm90b3R5cGUubG9va2F0ID0gZnVuY3Rpb24oZXlleCwgZXlleSwgZXlleiwgY2VudGVyeCwgY2VudGVyeSwgY2VudGVyeiwgdXB4LCB1cHksIHVweikKewogICAgdmFyIG1hdHJpeCA9IG5ldyBDYW52YXNNYXRyaXg0KCksCiAgICAgICAgeHgsIHh5LCB4ejsKCiAgICAvLyBNYWtlIHJvdGF0aW9uIG1hdHJpeAoKICAgIC8vIFogdmVjdG9yCiAgICB2YXIgenggPSBleWV4IC0gY2VudGVyeDsKICAgIHZhciB6eSA9IGV5ZXkgLSBjZW50ZXJ5OwogICAgdmFyIHp6ID0gZXlleiAtIGNlbnRlcno7CiAgICB2YXIgbWFnID0gTWF0aC5zcXJ0KHp4ICogenggKyB6eSAqIHp5ICsgenogKiB6eik7CiAgICBpZiAobWFnKSB7CiAgICAgICAgenggLz0gbWFnOwogICAgICAgIHp5IC89IG1hZzsKICAgICAgICB6eiAvPSBtYWc7CiAgICB9CgogICAgLy8gWSB2ZWN0b3IKICAgIHZhciB5eCA9IHVweDsKICAgIHZhciB5eSA9IHVweTsKICAgIHZhciB5eiA9IHVwejsKCiAgICAvLyBYIHZlY3RvciA9IFkgY3Jvc3MgWgogICAgeHggPSAgeXkgKiB6eiAtIHl6ICogenk7CiAgICB4eSA9IC15eCAqIHp6ICsgeXogKiB6eDsKICAgIHh6ID0gIHl4ICogenkgLSB5eSAqIHp4OwoKICAgIC8vIFJlY29tcHV0ZSBZID0gWiBjcm9zcyBYCiAgICB5eCA9IHp5ICogeHogLSB6eiAqIHh5OwogICAgeXkgPSAtenggKiB4eiArIHp6ICogeHg7CiAgICB5eCA9IHp4ICogeHkgLSB6eSAqIHh4OwoKICAgIC8vIGNyb3NzIHByb2R1Y3QgZ2l2ZXMgYXJlYSBvZiBwYXJhbGxlbG9ncmFtLCB3aGljaCBpcyA8IDEuMCBmb3IKICAgIC8vIG5vbi1wZXJwZW5kaWN1bGFyIHVuaXQtbGVuZ3RoIHZlY3RvcnM7IHNvIG5vcm1hbGl6ZSB4LCB5IGhlcmUKCiAgICBtYWcgPSBNYXRoLnNxcnQoeHggKiB4eCArIHh5ICogeHkgKyB4eiAqIHh6KTsKICAgIGlmIChtYWcpIHsKICAgICAgICB4eCAvPSBtYWc7CiAgICAgICAgeHkgLz0gbWFnOwogICAgICAgIHh6IC89IG1hZzsKICAgIH0KCiAgICBtYWcgPSBNYXRoLnNxcnQoeXggKiB5eCArIHl5ICogeXkgKyB5eiAqIHl6KTsKICAgIGlmIChtYWcpIHsKICAgICAgICB5eCAvPSBtYWc7CiAgICAgICAgeXkgLz0gbWFnOwogICAgICAgIHl6IC89IG1hZzsKICAgIH0KCiAgICBtYXRyaXgubTExID0geHg7CiAgICBtYXRyaXgubTEyID0geHk7CiAgICBtYXRyaXgubTEzID0geHo7CiAgICBtYXRyaXgubTE0ID0gMDsKCiAgICBtYXRyaXgubTIxID0geXg7CiAgICBtYXRyaXgubTIyID0geXk7CiAgICBtYXRyaXgubTIzID0geXo7CiAgICBtYXRyaXgubTI0ID0gMDsKCiAgICBtYXRyaXgubTMxID0geng7CiAgICBtYXRyaXgubTMyID0genk7CiAgICBtYXRyaXgubTMzID0geno7CiAgICBtYXRyaXgubTM0ID0gMDsKCiAgICBtYXRyaXgubTQxID0gMDsKICAgIG1hdHJpeC5tNDIgPSAwOwogICAgbWF0cml4Lm00MyA9IDA7CiAgICBtYXRyaXgubTQ0ID0gMTsKICAgIG1hdHJpeC50cmFuc2xhdGUoLWV5ZXgsIC1leWV5LCAtZXlleik7CgogICAgdGhpcy5tdWx0UmlnaHQobWF0cml4KTsKfTsKCi8vIFN1cHBvcnQgZnVuY3Rpb25zCkNhbnZhc01hdHJpeDQucHJvdG90eXBlLl9kZXRlcm1pbmFudDJ4MiA9IGZ1bmN0aW9uKGEsIGIsIGMsIGQpCnsKICAgIHJldHVybiBhICogZCAtIGIgKiBjOwp9OwoKQ2FudmFzTWF0cml4NC5wcm90b3R5cGUuX2RldGVybWluYW50M3gzID0gZnVuY3Rpb24oYTEsIGEyLCBhMywgYjEsIGIyLCBiMywgYzEsIGMyLCBjMykKewogICAgcmV0dXJuIGExICogdGhpcy5fZGV0ZXJtaW5hbnQyeDIoYjIsIGIzLCBjMiwgYzMpIC0KICAgICAgICAgYjEgKiB0aGlzLl9kZXRlcm1pbmFudDJ4MihhMiwgYTMsIGMyLCBjMykgKwogICAgICAgICBjMSAqIHRoaXMuX2RldGVybWluYW50MngyKGEyLCBhMywgYjIsIGIzKTsKfTsKCkNhbnZhc01hdHJpeDQucHJvdG90eXBlLl9kZXRlcm1pbmFudDR4NCA9IGZ1bmN0aW9uKCkKewogICAgdmFyIGExID0gdGhpcy5tMTE7CiAgICB2YXIgYjEgPSB0aGlzLm0xMjsKICAgIHZhciBjMSA9IHRoaXMubTEzOwogICAgdmFyIGQxID0gdGhpcy5tMTQ7CgogICAgdmFyIGEyID0gdGhpcy5tMjE7CiAgICB2YXIgYjIgPSB0aGlzLm0yMjsKICAgIHZhciBjMiA9IHRoaXMubTIzOwogICAgdmFyIGQyID0gdGhpcy5tMjQ7CgogICAgdmFyIGEzID0gdGhpcy5tMzE7CiAgICB2YXIgYjMgPSB0aGlzLm0zMjsKICAgIHZhciBjMyA9IHRoaXMubTMzOwogICAgdmFyIGQzID0gdGhpcy5tMzQ7CgogICAgdmFyIGE0ID0gdGhpcy5tNDE7CiAgICB2YXIgYjQgPSB0aGlzLm00MjsKICAgIHZhciBjNCA9IHRoaXMubTQzOwogICAgdmFyIGQ0ID0gdGhpcy5tNDQ7CgogICAgcmV0dXJuIGExICogdGhpcy5fZGV0ZXJtaW5hbnQzeDMoYjIsIGIzLCBiNCwgYzIsIGMzLCBjNCwgZDIsIGQzLCBkNCkgLQogICAgICAgICBiMSAqIHRoaXMuX2RldGVybWluYW50M3gzKGEyLCBhMywgYTQsIGMyLCBjMywgYzQsIGQyLCBkMywgZDQpICsKICAgICAgICAgYzEgKiB0aGlzLl9kZXRlcm1pbmFudDN4MyhhMiwgYTMsIGE0LCBiMiwgYjMsIGI0LCBkMiwgZDMsIGQ0KSAtCiAgICAgICAgIGQxICogdGhpcy5fZGV0ZXJtaW5hbnQzeDMoYTIsIGEzLCBhNCwgYjIsIGIzLCBiNCwgYzIsIGMzLCBjNCk7Cn07CgpDYW52YXNNYXRyaXg0LnByb3RvdHlwZS5fbWFrZUFkam9pbnQgPSBmdW5jdGlvbigpCnsKICAgIHZhciBhMSA9IHRoaXMubTExOwogICAgdmFyIGIxID0gdGhpcy5tMTI7CiAgICB2YXIgYzEgPSB0aGlzLm0xMzsKICAgIHZhciBkMSA9IHRoaXMubTE0OwoKICAgIHZhciBhMiA9IHRoaXMubTIxOwogICAgdmFyIGIyID0gdGhpcy5tMjI7CiAgICB2YXIgYzIgPSB0aGlzLm0yMzsKICAgIHZhciBkMiA9IHRoaXMubTI0OwoKICAgIHZhciBhMyA9IHRoaXMubTMxOwogICAgdmFyIGIzID0gdGhpcy5tMzI7CiAgICB2YXIgYzMgPSB0aGlzLm0zMzsKICAgIHZhciBkMyA9IHRoaXMubTM0OwoKICAgIHZhciBhNCA9IHRoaXMubTQxOwogICAgdmFyIGI0ID0gdGhpcy5tNDI7CiAgICB2YXIgYzQgPSB0aGlzLm00MzsKICAgIHZhciBkNCA9IHRoaXMubTQ0OwoKICAgIC8vIFJvdyBjb2x1bW4gbGFiZWxpbmcgcmV2ZXJzZWQgc2luY2Ugd2UgdHJhbnNwb3NlIHJvd3MgJiBjb2x1bW5zCiAgICB0aGlzLm0xMSAgPSAgIHRoaXMuX2RldGVybWluYW50M3gzKGIyLCBiMywgYjQsIGMyLCBjMywgYzQsIGQyLCBkMywgZDQpOwogICAgdGhpcy5tMjEgID0gLSB0aGlzLl9kZXRlcm1pbmFudDN4MyhhMiwgYTMsIGE0LCBjMiwgYzMsIGM0LCBkMiwgZDMsIGQ0KTsKICAgIHRoaXMubTMxICA9ICAgdGhpcy5fZGV0ZXJtaW5hbnQzeDMoYTIsIGEzLCBhNCwgYjIsIGIzLCBiNCwgZDIsIGQzLCBkNCk7CiAgICB0aGlzLm00MSAgPSAtIHRoaXMuX2RldGVybWluYW50M3gzKGEyLCBhMywgYTQsIGIyLCBiMywgYjQsIGMyLCBjMywgYzQpOwoKICAgIHRoaXMubTEyICA9IC0gdGhpcy5fZGV0ZXJtaW5hbnQzeDMoYjEsIGIzLCBiNCwgYzEsIGMzLCBjNCwgZDEsIGQzLCBkNCk7CiAgICB0aGlzLm0yMiAgPSAgIHRoaXMuX2RldGVybWluYW50M3gzKGExLCBhMywgYTQsIGMxLCBjMywgYzQsIGQxLCBkMywgZDQpOwogICAgdGhpcy5tMzIgID0gLSB0aGlzLl9kZXRlcm1pbmFudDN4MyhhMSwgYTMsIGE0LCBiMSwgYjMsIGI0LCBkMSwgZDMsIGQ0KTsKICAgIHRoaXMubTQyICA9ICAgdGhpcy5fZGV0ZXJtaW5hbnQzeDMoYTEsIGEzLCBhNCwgYjEsIGIzLCBiNCwgYzEsIGMzLCBjNCk7CgogICAgdGhpcy5tMTMgID0gICB0aGlzLl9kZXRlcm1pbmFudDN4MyhiMSwgYjIsIGI0LCBjMSwgYzIsIGM0LCBkMSwgZDIsIGQ0KTsKICAgIHRoaXMubTIzICA9IC0gdGhpcy5fZGV0ZXJtaW5hbnQzeDMoYTEsIGEyLCBhNCwgYzEsIGMyLCBjNCwgZDEsIGQyLCBkNCk7CiAgICB0aGlzLm0zMyAgPSAgIHRoaXMuX2RldGVybWluYW50M3gzKGExLCBhMiwgYTQsIGIxLCBiMiwgYjQsIGQxLCBkMiwgZDQpOwogICAgdGhpcy5tNDMgID0gLSB0aGlzLl9kZXRlcm1pbmFudDN4MyhhMSwgYTIsIGE0LCBiMSwgYjIsIGI0LCBjMSwgYzIsIGM0KTsKCiAgICB0aGlzLm0xNCAgPSAtIHRoaXMuX2RldGVybWluYW50M3gzKGIxLCBiMiwgYjMsIGMxLCBjMiwgYzMsIGQxLCBkMiwgZDMpOwogICAgdGhpcy5tMjQgID0gICB0aGlzLl9kZXRlcm1pbmFudDN4MyhhMSwgYTIsIGEzLCBjMSwgYzIsIGMzLCBkMSwgZDIsIGQzKTsKICAgIHRoaXMubTM0ICA9IC0gdGhpcy5fZGV0ZXJtaW5hbnQzeDMoYTEsIGEyLCBhMywgYjEsIGIyLCBiMywgZDEsIGQyLCBkMyk7CiAgICB0aGlzLm00NCAgPSAgIHRoaXMuX2RldGVybWluYW50M3gzKGExLCBhMiwgYTMsIGIxLCBiMiwgYjMsIGMxLCBjMiwgYzMpOwp9Owo="></script>
	</head>
	<body>
		<p id="rgl75719-aria" hidden>3D plot</p>
<div id="rgl75719" style="width:772px;height:500px;" class="rglWebGL html-widget" role="img" aria-labelledby="rgl75719-aria"></div>
<script type="application/json" data-for="rgl75719">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmode":"modulate","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":6,"objects":{"14":{"id":14,"type":"clipplanes","offsets":[[-1],[32],[-0],[50],[-0],[0.200000002980232]],"normals":"0","flags":512},"15":{"id":15,"type":"lines","material":{"lit":false},"vertices":"1","colors":"2","centers":"3","ignoreExtent":false,"flags":32832},"16":{"id":16,"type":"lines","material":{"lit":false},"vertices":"4","colors":"5","centers":"6","ignoreExtent":false,"flags":32832},"18":{"id":18,"type":"text","material":{"lit":false,"margin":0,"floating":true,"edge":[0,1,1]},"vertices":"7","colors":"8","texts":[[""]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"9","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"19":{"id":19,"type":"text","material":{"lit":false,"margin":1,"floating":true,"edge":[1,1,1]},"vertices":"10","colors":"11","texts":[[""]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"12","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"20":{"id":20,"type":"text","material":{"lit":false,"margin":2,"floating":true,"edge":[1,1,1]},"vertices":"13","colors":"14","texts":[[""]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"15","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"21":{"id":21,"type":"points","material":{"lit":false,"size":5},"vertices":"16","colors":"17","centers":"18","ignoreExtent":false,"flags":34816},"22":{"id":22,"type":"linestrip","material":{"lit":false,"lwd":3},"vertices":"19","colors":"20","centers":"21","ignoreExtent":false,"flags":41024},"23":{"id":23,"type":"linestrip","material":{"lit":false,"lwd":2},"vertices":"22","colors":"23","centers":"24","ignoreExtent":false,"flags":41024},"24":{"id":24,"type":"linestrip","material":{"lit":false,"lwd":3},"vertices":"25","colors":"26","centers":"27","ignoreExtent":false,"flags":41024},"25":{"id":25,"type":"linestrip","material":{"lit":false,"lwd":2},"vertices":"28","colors":"29","centers":"30","ignoreExtent":false,"flags":41024},"26":{"id":26,"type":"linestrip","material":{"lit":false,"lwd":3},"vertices":"31","colors":"32","centers":"33","ignoreExtent":false,"flags":41024},"27":{"id":27,"type":"linestrip","material":{"lit":false,"lwd":2},"vertices":"34","colors":"35","centers":"36","ignoreExtent":false,"flags":41024},"28":{"id":28,"type":"linestrip","material":{"lit":false,"lwd":3},"vertices":"37","colors":"38","centers":"39","ignoreExtent":false,"flags":41024},"29":{"id":29,"type":"linestrip","material":{"lit":false,"lwd":2},"vertices":"40","colors":"41","centers":"42","ignoreExtent":false,"flags":41024},"30":{"id":30,"type":"linestrip","material":{"lit":false,"lwd":3},"vertices":"43","colors":"44","centers":"45","ignoreExtent":false,"flags":41024},"31":{"id":31,"type":"linestrip","material":{"lit":false,"lwd":2},"vertices":"46","colors":"47","centers":"48","ignoreExtent":false,"flags":41024},"32":{"id":32,"type":"linestrip","material":{"lit":false,"lwd":3},"vertices":"49","colors":"50","centers":"51","ignoreExtent":false,"flags":41024},"33":{"id":33,"type":"linestrip","material":{"lit":false,"lwd":2},"vertices":"52","colors":"53","centers":"54","ignoreExtent":false,"flags":41024},"34":{"id":34,"type":"linestrip","material":{"lit":false,"lwd":3},"vertices":"55","colors":"56","centers":"57","ignoreExtent":false,"flags":41024},"35":{"id":35,"type":"linestrip","material":{"lit":false,"lwd":2},"vertices":"58","colors":"59","centers":"60","ignoreExtent":false,"flags":41024},"36":{"id":36,"type":"linestrip","material":{"lit":false,"lwd":2},"vertices":"61","colors":"62","centers":"63","ignoreExtent":false,"flags":41024},"37":{"id":37,"type":"lines","material":{"lit":false},"vertices":"64","colors":"65","centers":"66","ignoreExtent":true,"flags":32832},"38":{"id":38,"type":"text","material":{"lit":false},"vertices":"67","colors":"68","texts":[[" 0"],[" 5"],["10"],["15"],["20"],["25"],["30"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"69","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"39":{"id":39,"type":"lines","material":{"lit":false},"vertices":"70","colors":"71","centers":"72","ignoreExtent":true,"flags":32832},"40":{"id":40,"type":"text","material":{"lit":false},"vertices":"73","colors":"74","texts":[[" 0"],["10"],["20"],["30"],["40"],["50"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"75","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"41":{"id":41,"type":"lines","material":{"lit":false},"vertices":"76","colors":"77","centers":"78","ignoreExtent":true,"flags":32832},"42":{"id":42,"type":"lines","material":{"lit":false},"vertices":"79","colors":"80","centers":"81","ignoreExtent":true,"flags":32832},"43":{"id":43,"type":"text","material":{"lit":false,"margin":0,"edge":[0,-1,-1]},"vertices":"82","colors":"83","texts":[["Car"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"84","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"44":{"id":44,"type":"text","material":{"lit":false,"margin":1,"edge":[-1,-1,-1]},"vertices":"85","colors":"86","texts":[["MPG"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"87","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"10":{"id":10,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"12":{"id":12,"type":"background","material":{"lit":false,"back":"lines"},"colors":"88","centers":"89","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"17":{"id":17,"type":"bboxdeco","material":{"front":"culled","back":"culled"},"colors":"90","axes":{"mode":["none","none","none"],"step":[-1,-1,-1],"nticks":[0,0,0],"marklen":[15,15,15],"expand":[1.02999997138977,1.02999997138977,1.02999997138977]},"draw_front":false,"flags":32769},"13":{"id":13,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":6,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,145.523620605469],"modelMatrix":[[1.09567308425903,0,0,-17.5307693481445],[0,0.232340201735497,159.587371826172,-6.76724243164062],[0,-0.63834947347641,58.0850524902344,-135.373382568359],[0,0,0,1]],"projMatrix":[[6.78554677963257,0,0,0],[0,6.78554677963257,0,0],[0,0,-3.86370372772217,-524.595886230469],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,15],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1.09567308425903,0.6793172955513,169.829330444336],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":0.550000011920929,"bbox":[123,-123,123,-123,123,-123],"windowRect":[1245,719,1501,975],"family":"sans","font":1,"cex":1,"useFreeType":true,"fontname":"/home/martyn/R/rgl/fonts/FreeSans.ttf","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"inherit","projection":"inherit","model":"inherit","mouse":"inherit"},"objects":[14,15,10],"parent":6,"subscenes":[],"flags":33600},"6":{"id":6,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":6,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,145.523620605469],"modelMatrix":[[1.09567308425903,0,0,-17.5307693481445],[0,0.232340201735497,159.587371826172,-6.76724243164062],[0,-0.63834947347641,58.0850524902344,-135.373382568359],[0,0,0,1]],"projMatrix":[[6.78554677963257,0,0,0],[0,6.78554677963257,0,0],[0,0,-3.86370372772217,-524.595886230469],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,15],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1.09567308425903,0.6793172955513,169.829330444336],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":0.550000011920929,"bbox":[0,32,0,50,0,0.200000002980232],"windowRect":[1245,719,1501,975],"family":"sans","font":1,"cex":1,"useFreeType":true,"fontname":"/home/martyn/R/rgl/fonts/FreeSans.ttf","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[12,17,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,10,13],"subscenes":13,"flags":44881}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":772,"height":772,"buffer":{"accessors":[{"bufferView":0,"componentType":5120,"count":6,"type":"VEC3"},{"bufferView":1,"componentType":5126,"count":4,"type":"VEC3"},{"bufferView":2,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":3,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":4,"componentType":5126,"count":4,"type":"VEC3"},{"bufferView":5,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":6,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":7,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":8,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":9,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":10,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":11,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":12,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":13,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":14,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":15,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":16,"componentType":5126,"count":32,"type":"VEC3"},{"bufferView":17,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":18,"componentType":5126,"count":32,"type":"VEC3"},{"bufferView":19,"componentType":5126,"count":200,"type":"VEC3"},{"bufferView":20,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":21,"componentType":5126,"count":200,"type":"VEC3"},{"bufferView":22,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":23,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":24,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":25,"componentType":5126,"count":200,"type":"VEC3"},{"bufferView":26,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":27,"componentType":5126,"count":200,"type":"VEC3"},{"bufferView":28,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":29,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":30,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":31,"componentType":5126,"count":200,"type":"VEC3"},{"bufferView":32,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":33,"componentType":5126,"count":200,"type":"VEC3"},{"bufferView":34,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":35,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":36,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":37,"componentType":5126,"count":200,"type":"VEC3"},{"bufferView":38,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":39,"componentType":5126,"count":200,"type":"VEC3"},{"bufferView":40,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":41,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":42,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":43,"componentType":5126,"count":200,"type":"VEC3"},{"bufferView":44,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":45,"componentType":5126,"count":200,"type":"VEC3"},{"bufferView":46,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":47,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":48,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":49,"componentType":5126,"count":200,"type":"VEC3"},{"bufferView":50,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":51,"componentType":5126,"count":200,"type":"VEC3"},{"bufferView":52,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":53,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":54,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":55,"componentType":5126,"count":200,"type":"VEC3"},{"bufferView":56,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":57,"componentType":5126,"count":200,"type":"VEC3"},{"bufferView":58,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":59,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":60,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":61,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":62,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":63,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":64,"componentType":5126,"count":16,"type":"VEC3"},{"bufferView":65,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":66,"componentType":5126,"count":8,"type":"VEC3"},{"bufferView":67,"componentType":5126,"count":7,"type":"VEC3"},{"bufferView":68,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":69,"componentType":5126,"count":7,"type":"VEC3"},{"bufferView":70,"componentType":5126,"count":14,"type":"VEC3"},{"bufferView":71,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":72,"componentType":5126,"count":7,"type":"VEC3"},{"bufferView":73,"componentType":5126,"count":6,"type":"VEC3"},{"bufferView":74,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":75,"componentType":5126,"count":6,"type":"VEC3"},{"bufferView":76,"componentType":5126,"count":14,"type":"VEC3"},{"bufferView":77,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":78,"componentType":5126,"count":7,"type":"VEC3"},{"bufferView":79,"componentType":5126,"count":12,"type":"VEC3"},{"bufferView":80,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":81,"componentType":5126,"count":6,"type":"VEC3"},{"bufferView":82,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":83,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":84,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":85,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":86,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":87,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":88,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":89,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":90,"componentType":5121,"count":1,"type":"VEC4"}],"bufferViews":[{"buffer":0,"byteLength":18,"byteOffset":0},{"buffer":0,"byteLength":48,"byteOffset":20},{"buffer":0,"byteLength":4,"byteOffset":68},{"buffer":0,"byteLength":24,"byteOffset":72},{"buffer":0,"byteLength":48,"byteOffset":96},{"buffer":0,"byteLength":4,"byteOffset":144},{"buffer":0,"byteLength":24,"byteOffset":148},{"buffer":0,"byteLength":12,"byteOffset":172},{"buffer":0,"byteLength":4,"byteOffset":184},{"buffer":0,"byteLength":12,"byteOffset":188},{"buffer":0,"byteLength":12,"byteOffset":200},{"buffer":0,"byteLength":4,"byteOffset":212},{"buffer":0,"byteLength":12,"byteOffset":216},{"buffer":0,"byteLength":12,"byteOffset":228},{"buffer":0,"byteLength":4,"byteOffset":240},{"buffer":0,"byteLength":12,"byteOffset":244},{"buffer":0,"byteLength":384,"byteOffset":256},{"buffer":0,"byteLength":4,"byteOffset":640},{"buffer":0,"byteLength":384,"byteOffset":644},{"buffer":0,"byteLength":2400,"byteOffset":1028},{"buffer":0,"byteLength":4,"byteOffset":3428},{"buffer":0,"byteLength":2400,"byteOffset":3432},{"buffer":0,"byteLength":24,"byteOffset":5832},{"buffer":0,"byteLength":16,"byteOffset":5856},{"buffer":0,"byteLength":24,"byteOffset":5872},{"buffer":0,"byteLength":2400,"byteOffset":5896},{"buffer":0,"byteLength":4,"byteOffset":8296},{"buffer":0,"byteLength":2400,"byteOffset":8300},{"buffer":0,"byteLength":24,"byteOffset":10700},{"buffer":0,"byteLength":16,"byteOffset":10724},{"buffer":0,"byteLength":24,"byteOffset":10740},{"buffer":0,"byteLength":2400,"byteOffset":10764},{"buffer":0,"byteLength":4,"byteOffset":13164},{"buffer":0,"byteLength":2400,"byteOffset":13168},{"buffer":0,"byteLength":24,"byteOffset":15568},{"buffer":0,"byteLength":16,"byteOffset":15592},{"buffer":0,"byteLength":24,"byteOffset":15608},{"buffer":0,"byteLength":2400,"byteOffset":15632},{"buffer":0,"byteLength":4,"byteOffset":18032},{"buffer":0,"byteLength":2400,"byteOffset":18036},{"buffer":0,"byteLength":24,"byteOffset":20436},{"buffer":0,"byteLength":16,"byteOffset":20460},{"buffer":0,"byteLength":24,"byteOffset":20476},{"buffer":0,"byteLength":2400,"byteOffset":20500},{"buffer":0,"byteLength":4,"byteOffset":22900},{"buffer":0,"byteLength":2400,"byteOffset":22904},{"buffer":0,"byteLength":24,"byteOffset":25304},{"buffer":0,"byteLength":16,"byteOffset":25328},{"buffer":0,"byteLength":24,"byteOffset":25344},{"buffer":0,"byteLength":2400,"byteOffset":25368},{"buffer":0,"byteLength":4,"byteOffset":27768},{"buffer":0,"byteLength":2400,"byteOffset":27772},{"buffer":0,"byteLength":24,"byteOffset":30172},{"buffer":0,"byteLength":16,"byteOffset":30196},{"buffer":0,"byteLength":24,"byteOffset":30212},{"buffer":0,"byteLength":2400,"byteOffset":30236},{"buffer":0,"byteLength":4,"byteOffset":32636},{"buffer":0,"byteLength":2400,"byteOffset":32640},{"buffer":0,"byteLength":24,"byteOffset":35040},{"buffer":0,"byteLength":16,"byteOffset":35064},{"buffer":0,"byteLength":24,"byteOffset":35080},{"buffer":0,"byteLength":24,"byteOffset":35104},{"buffer":0,"byteLength":4,"byteOffset":35128},{"buffer":0,"byteLength":24,"byteOffset":35132},{"buffer":0,"byteLength":192,"byteOffset":35156},{"buffer":0,"byteLength":4,"byteOffset":35348},{"buffer":0,"byteLength":96,"byteOffset":35352},{"buffer":0,"byteLength":84,"byteOffset":35448},{"buffer":0,"byteLength":4,"byteOffset":35532},{"buffer":0,"byteLength":84,"byteOffset":35536},{"buffer":0,"byteLength":168,"byteOffset":35620},{"buffer":0,"byteLength":4,"byteOffset":35788},{"buffer":0,"byteLength":84,"byteOffset":35792},{"buffer":0,"byteLength":72,"byteOffset":35876},{"buffer":0,"byteLength":4,"byteOffset":35948},{"buffer":0,"byteLength":72,"byteOffset":35952},{"buffer":0,"byteLength":168,"byteOffset":36024},{"buffer":0,"byteLength":16,"byteOffset":36192},{"buffer":0,"byteLength":84,"byteOffset":36208},{"buffer":0,"byteLength":144,"byteOffset":36292},{"buffer":0,"byteLength":16,"byteOffset":36436},{"buffer":0,"byteLength":72,"byteOffset":36452},{"buffer":0,"byteLength":12,"byteOffset":36524},{"buffer":0,"byteLength":4,"byteOffset":36536},{"buffer":0,"byteLength":12,"byteOffset":36540},{"buffer":0,"byteLength":12,"byteOffset":36552},{"buffer":0,"byteLength":4,"byteOffset":36564},{"buffer":0,"byteLength":12,"byteOffset":36568},{"buffer":0,"byteLength":4,"byteOffset":36580},{"buffer":0,"byteLength":3,"byteOffset":36584},{"buffer":0,"byteLength":4,"byteOffset":36587}],"buffers":[{"byteLength":36591,"bytes":"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\nAACAP9TNoEBovz47AACAPx/YqECcg1M7AACAP2nisEBRImo7AACAP7TsuECLXIE7AACAP//2\nwEDtso47AACAP0kByUBdI507AACAP5QL0UDpvKw7AACAP98V2UCBjr07AACAPykg4UDZps87\nAACAP3Qq6UBGFOM7AACAP7408UCe5Pc7AACAPwk/+UCHEgc8AACAP6qkAEH68BI8AACAP8+p\nBEFckx88AACAP/SuCEHN/iw8AACAPxq0DEHJNzs8AACAPz+5EEELQko8AACAP2S+FEF6IFo8\nAACAP4rDGEES1Wo8AACAP6/IHEHOYHw8AACAP9TNIEHJYYc8AACAP/rSJEEN/pA8AACAPx/Y\nKEHvA5s8AACAP0TdLEGEcaU8AACAP2niMEEyRLA8AACAP4/nNEGkeLs8AACAP7TsOEHMCsc8\nAACAP9nxPEHW9dI8AACAP//2QEEsNN88AACAPyT8REFvv+s8AACAP0kBSUF7kPg8AACAP28G\nTUG0zwI9AACAP5QLUUHFcQk9AACAP7kQVUG+KRA9AACAP98VWUGU8hY9AACAPwQbXUHkxh09\nAACAPykgYUH/oCQ9AACAP04lZUHqeis9AACAP3QqaUFtTjI9AACAP5kvbUEVFTk9AACAP740\ncUFCyD89AACAP+Q5dUEvYUY9AACAPwk/eUH92Ew9AACAPy5EfUHAKFM9AACAP6qkgEGKSVk9\nAACAPzyngkF1NF89AACAP8+phEG34mQ9AACAP2KshkGlTWo9AACAP/SuiEHIbm89AACAP4ex\nikHnP3Q9AACAPxq0jEESu3g9AACAP6y2jkGw2nw9AACAPz+5kEHFTIA9AACAP9K7kkFr+YE9\nAACAP2S+lEEicYM9AACAP/fAlkH/sYQ9AACAP4rDmEFfuoU9AACAPxzGmkHliIY9AACAP6/I\nnEGAHIc9AACAP0LLnkFrdIc9AACAP9TNoEExkIc9AACAP2fQokGub4c9AACAP/rSpEEME4c9\nAACAP4zVpkHIeoY9AACAPx/YqEGqp4U9AACAP7LaqkHMmoQ9AACAP0TdrEGOVYM9AACAP9ff\nrkGb2YE9AACAP2nisEHiKIA9AACAP/zkskEhi3w9AACAP4/ntEEeZHg9AACAPyHqtkH84XM9\nAACAP7TsuEFbCm89AACAP0fvukEv42k9AACAP9nxvEG6cmQ9AACAP2z0vkF1v149AACAP//2\n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\nxUBp4jBBMkSwPFVVxUCP5zRBpHi7PFVVxUC07DhBzArHPFVVxUDZ8TxB1vXSPFVVxUD/9kBB\nLDTfPFVVxUAk/ERBb7/rPFVVxUBJAUlBe5D4PFVVxUBvBk1BtM8CPVVVxUCUC1FBxXEJPVVV\nxUC5EFVBvikQPVVVxUDfFVlBlPIWPVVVxUAEG11B5MYdPVVVxUApIGFB/6AkPVVVxUBOJWVB\n6norPVVVxUB0KmlBbU4yPVVVxUCZL21BFRU5PVVVxUC+NHFBQsg/PVVVxUDkOXVBL2FGPVVV\nxUAJP3lB/dhMPVVVxUAuRH1BwChTPVVVxUCqpIBBiklZPVVVxUA8p4JBdTRfPVVVxUDPqYRB\nt+JkPVVVxUBirIZBpU1qPVVVxUD0rohByG5vPVVVxUCHsYpB5z90PVVVxUAatIxBErt4PVVV\nxUCsto5BsNp8PVVVxUA/uZBBxUyAPVVVxUDSu5JBa/mBPVVVxUBkvpRBInGDPVVVxUD3wJZB\n/7GEPVVVxUCKw5hBX7qFPVVVxUAcxppB5YiGPVVVxUCvyJxBgByHPVVVxUBCy55Ba3SHPVVV\nxUDUzaBBMZCHPVVVxUBn0KJBrm+HPVVVxUD60qRBDBOHPVVVxUCM1aZByHqGPVVVxUAf2KhB\nqqeFPVVVxUCy2qpBzJqEPVVVxUBE3axBjlWDPVVVxUDX365Bm9mBPVVVxUBp4rBB4iiAPVVV\nxUD85LJBIYt8PVVVxUCP57RBHmR4PVVVxUAh6rZB/OFzPVVVxUC07LhBWwpvPVVVxUBH77pB\nL+NpPVVVxUDZ8bxBunJkPVVVxUBs9L5Bdb9ePVVVxUD/9sBBDtBYPVVVxUCR+cJBU6tSPVVV\nxUAk/MRBKVhMPVVVxUC3/sZBgN1FPVVVxUBJAclBREI/PVVVxUDcA8tBUI04PVVVxUBvBs1B\naMUxPVVVxUABCc9BKfEqPVVVxUCUC9FBARckPVVVxUAnDtNBJT0dPVVVxUC5ENVBiGkWPVVV\nxUBME9dB1aEPPVVVxUDfFdlBZ+sIPVVVxUBxGNtBQ0sCPVVVxUAEG91BKYz3PFVVxUCXHd9B\nU8DqPFVVxUApIOFB3DrePFVVxUC8IuNB2gLSPFVVxUBOJeVBnB7GPFVVxUDhJ+dBqZO6PFVV\nxUB0KulBw2avPFVVxUAGLetB7JukPFVVxUCZL+1BaDaaPFVVxUAsMu9BxDiQPFVVxUC+NPFB\n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\n0ruSQWv5gT1VVcVAZL6UQSJxgz1VVcVA98CWQf+xhD1VVcVAisOYQV+6hT1VVcVAHMaaQeWI\nhj1VVcVAr8icQYAchz1VVcVAQsueQWt0hz1VVcVA1M2gQTGQhz1VVcVAZ9CiQa5vhz1VVcVA\n+tKkQQwThz1VVcVAjNWmQch6hj1VVcVAH9ioQaqnhT1VVcVAstqqQcyahD1VVcVARN2sQY5V\ngz1VVcVA19+uQZvZgT1VVcVAaeKwQeIogD1VVcVA/OSyQSGLfD1VVcVAj+e0QR5keD1VVcVA\nIeq2Qfzhcz1VVcVAtOy4QVsKbz1VVcVAR++6QS/jaT1VVcVA2fG8QbpyZD1VVcVAbPS+QXW/\nXj1VVcVA//bAQQ7QWD1VVcVAkfnCQVOrUj1VVcVAJPzEQSlYTD1VVcVAt/7GQYDdRT1VVcVA\nSQHJQURCPz1VVcVA3APLQVCNOD1VVcVAbwbNQWjFMT1VVcVAAQnPQSnxKj1VVcVAlAvRQQEX\nJD1VVcVAJw7TQSU9HT1VVcVAuRDVQYhpFj1VVcVATBPXQdWhDz1VVcVA3xXZQWfrCD1VVcVA\ncRjbQUNLAj1VVcVABBvdQSmM9zxVVcVAlx3fQVPA6jxVVcVAKSDhQdw63jxVVcVAvCLjQdoC\n0jxVVcVATiXlQZwexjxVVcVA4SfnQamTujxVVcVAdCrpQcNmrzxVVcVABi3rQeybpDxVVcVA\nmS/tQWg2mjxVVcVALDLvQcQ4kDxVVcVAvjTxQd6khjxVVcVAUTfzQdj3ejxVVcVA5Dn1QQl9\naTxVVcVAdjz3QVTZWDxVVcVACT/5QaoLSTxVVcVAnEH7QfoROjxVVcVALkT9QU3pKzxVVcVA\nwUb/QdaNHjxVVcVAqqQAQg37ETxVVcVA86UBQsYrBjxVVcVAPKcCQoI09jtVVcVAhqgDQo+A\n4TtVVcVAz6kEQnYuzjtVVcVAGKsFQlUwvDtVVcVAYqwGQs93qztVVcVAq60HQiv2mztVVcVA\n9K4IQnOcjTtVVcVAPrAJQptbgDtVVcVAh7EKQidJaDtVVcVA0LILQtHQUTtVVcVAGrQMQq8w\nPTtVVcVAY7UNQsZLKjtVVcVArLYOQscFGTtVVcVA9rcPQjBDCTtVVcVAP7kQQsrS9TpVVcVA\niLoRQoq92zpVVcVA0rsSQncVxDpVVcVAG70TQpWrrjpVVcVAZL4UQjFTmzpVVcVArr8VQuXh\niTpVVcVA98AWQkFfdDpVVcVAQMIXQlMtWDpVVcVAisMYQiznPjpVVcVA08QZQoZKKDpVVcVA\nHMYaQpQZFDpVVcVAZscbQtsaAjpVVcVAr8gcQiIy5DlVVcVA+MkdQunFxzlVVcVAQsseQjqW\nrjlVVcVAi8wfQpxPmDlVVcVA1M0gQoelhDlVVcVAHs8hQg+kZjlVVcVAZ9AiQqUqSDlVVcVA\nsNEjQs1qLTlVVcVA+tIkQkn7FTlVVcVAQ9QlQuJ8ATlVVcVAjNUmQlIz3zhVVcVA1tYnQoYI\nwDhVVcVAH9goQmzupDhVVcVAaNkpQolojThVVcVAstoqQjoPcjhVVcVA+9srQu3QTjhVVcVA\nRN0sQrRlMDhVVcVAjt4tQvUwFjhVVcVA198uQhFQ/zdVVcVAIOEvQueg2DdVVcVAaeIwQoh8\ntzdVVcVAs+MxQholmzdVVcVA/OQyQgr0gjdVVcVAReYzQguvXDdVVcVAj+c0QligOTdVVcVA\n2Og1QvDdGzdVVcVAIeo2QrqmAjdVVcVAa+s3Qkem2jZVVcVAtOw4QiKktjZVVcVA/e05QkNM\nmDZVVcVAR+86QuuMfTZVVcVAkPA7QmmxUjZVVcVA2fE8QpXGLjZVVcVAI/M9QsS6EDZVVcVA\nbPQ+Qv1H7zVVVcVAtfU/Qk11xTVVVcVA//ZAQo6pojVVVcVASPhBQvXDhTVVVcVAkflCQkef\nWzVVVcVA2/pDQtH6MzVVVcVAJPxEQp48EzVVVcVAbf1FQp578DRVVcVAt/5GQtkMxDRVVcVA\nAABIQq+MnzRVVcVAmrmgQQAAAABVVcVAmrmgQTGQhz0AAAAAzs1NPwAAAAAAAIA/VVXFQJq5\noEEAAAAAVVXFQJq5oEExkIc9VVU1QQAAAADHGoY5VVU1QaqkgD7O9pk5VVU1QaqkAD8mdbA5\nVVU1Qf/2QD/b4sk5VVU1QaqkgD/6k+Y5VVU1QdTNoD/1cQM6VVU1Qf/2wD/nmhU6VVU1QSkg\n4T9v+ik6VVU1QaqkAEBeykA6VVU1QT+5EEDbSFo6VVU1QdTNIECFuHY6VVU1QWniMEBHMIs6\nVVU1Qf/2QEBlxpw6VVU1QZQLUUDZRrA6VVU1QSkgYUA63MU6VVU1Qb40cUBqs906VVU1Qaqk\ngECO+/c6VVU1QfSuiED/cgo7VVU1QT+5kEASUxo7VVU1QYrDmECvuCs7VVU1QdTNoEBovz47\nVVU1QR/YqECcg1M7VVU1QWnisEBRImo7VVU1QbTsuECLXIE7VVU1Qf/2wEDtso47VVU1QUkB\nyUBdI507VVU1QZQL0UDpvKw7VVU1Qd8V2UCBjr07VVU1QSkg4UDZps87VVU1QXQq6UBGFOM7\nVVU1Qb408UCe5Pc7VVU1QQk/+UCHEgc8VVU1QaqkAEH68BI8VVU1Qc+pBEFckx88VVU1QfSu\nCEHN/iw8VVU1QRq0DEHJNzs8VVU1QT+5EEELQko8VVU1QWS+FEF6IFo8VVU1QYrDGEES1Wo8\nVVU1Qa/IHEHOYHw8VVU1QdTNIEHJYYc8VVU1QfrSJEEN/pA8VVU1QR/YKEHvA5s8VVU1QUTd\nLEGEcaU8VVU1QWniMEEyRLA8VVU1QY/nNEGkeLs8VVU1QbTsOEHMCsc8VVU1QdnxPEHW9dI8\nVVU1Qf/2QEEsNN88VVU1QST8REFvv+s8VVU1QUkBSUF7kPg8VVU1QW8GTUG0zwI9VVU1QZQL\nUUHFcQk9VVU1QbkQVUG+KRA9VVU1Qd8VWUGU8hY9VVU1QQQbXUHkxh09VVU1QSkgYUH/oCQ9\nVVU1QU4lZUHqeis9VVU1QXQqaUFtTjI9VVU1QZkvbUEVFTk9VVU1Qb40cUFCyD89VVU1QeQ5\ndUEvYUY9VVU1QQk/eUH92Ew9VVU1QS5EfUHAKFM9VVU1QaqkgEGKSVk9VVU1QTyngkF1NF89\nVVU1Qc+phEG34mQ9VVU1QWKshkGlTWo9VVU1QfSuiEHIbm89VVU1QYexikHnP3Q9VVU1QRq0\njEESu3g9VVU1Qay2jkGw2nw9VVU1QT+5kEHFTIA9VVU1QdK7kkFr+YE9VVU1QWS+lEEicYM9\nVVU1QffAlkH/sYQ9VVU1QYrDmEFfuoU9VVU1QRzGmkHliIY9VVU1Qa/InEGAHIc9VVU1QULL\nnkFrdIc9VVU1QdTNoEExkIc9VVU1QWfQokGub4c9VVU1QfrSpEEME4c9VVU1QYzVpkHIeoY9\nVVU1QR/YqEGqp4U9VVU1QbLaqkHMmoQ9VVU1QUTdrEGOVYM9VVU1QdffrkGb2YE9VVU1QWni\nsEHiKIA9VVU1QfzkskEhi3w9VVU1QY/ntEEeZHg9VVU1QSHqtkH84XM9VVU1QbTsuEFbCm89\nVVU1QUfvukEv42k9VVU1QdnxvEG6cmQ9VVU1QWz0vkF1v149VVU1Qf/2wEEO0Fg9VVU1QZH5\nwkFTq1I9VVU1QST8xEEpWEw9VVU1Qbf+xkGA3UU9VVU1QUkByUFEQj89VVU1QdwDy0FQjTg9\nVVU1QW8GzUFoxTE9VVU1QQEJz0Ep8So9VVU1QZQL0UEBFyQ9VVU1QScO00ElPR09VVU1QbkQ\n1UGIaRY9VVU1QUwT10HVoQ89VVU1Qd8V2UFn6wg9VVU1QXEY20FDSwI9VVU1QQQb3UEpjPc8\nVVU1QZcd30FTwOo8VVU1QSkg4UHcOt48VVU1Qbwi40HaAtI8VVU1QU4l5UGcHsY8VVU1QeEn\n50Gpk7o8VVU1QXQq6UHDZq88VVU1QQYt60Hsm6Q8VVU1QZkv7UFoNpo8VVU1QSwy70HEOJA8\nVVU1Qb408UHepIY8VVU1QVE380HY93o8VVU1QeQ59UEJfWk8VVU1QXY890FU2Vg8VVU1QQk/\n+UGqC0k8VVU1QZxB+0H6ETo8VVU1QS5E/UFN6Ss8VVU1QcFG/0HWjR48VVU1QaqkAEIN+xE8\nVVU1QfOlAULGKwY8VVU1QTynAkKCNPY7VVU1QYaoA0KPgOE7VVU1Qc+pBEJ2Ls47VVU1QRir\nBUJVMLw7VVU1QWKsBkLPd6s7VVU1QautB0Ir9ps7VVU1QfSuCEJznI07VVU1QT6wCUKbW4A7\nVVU1QYexCkInSWg7VVU1QdCyC0LR0FE7VVU1QRq0DEKvMD07VVU1QWO1DULGSyo7VVU1Qay2\nDkLHBRk7VVU1Qfa3D0IwQwk7VVU1QT+5EELK0vU6VVU1QYi6EUKKvds6VVU1QdK7EkJ3FcQ6\nVVU1QRu9E0KVq646VVU1QWS+FEIxU5s6VVU1Qa6/FULl4Yk6VVU1QffAFkJBX3Q6VVU1QUDC\nF0JTLVg6VVU1QYrDGEIs5z46VVU1QdPEGUKGSig6VVU1QRzGGkKUGRQ6VVU1QWbHG0LbGgI6\nVVU1Qa/IHEIiMuQ5VVU1QfjJHULpxcc5VVU1QULLHkI6lq45VVU1QYvMH0KcT5g5VVU1QdTN\nIEKHpYQ5VVU1QR7PIUIPpGY5VVU1QWfQIkKlKkg5VVU1QbDRI0LNai05VVU1QfrSJEJJ+xU5\nVVU1QUPUJULifAE5VVU1QYzVJkJSM984VVU1QdbWJ0KGCMA4VVU1QR/YKEJs7qQ4VVU1QWjZ\nKUKJaI04VVU1QbLaKkI6D3I4VVU1QfvbK0Lt0E44VVU1QUTdLEK0ZTA4VVU1QY7eLUL1MBY4\nVVU1QdffLkIRUP83VVU1QSDhL0LnoNg3VVU1QWniMEKIfLc3VVU1QbPjMUIaJZs3VVU1Qfzk\nMkIK9II3VVU1QUXmM0ILr1w3VVU1QY/nNEJYoDk3VVU1QdjoNULw3Rs3VVU1QSHqNkK6pgI3\nVVU1QWvrN0JHpto2VVU1QbTsOEIipLY2VVU1Qf3tOUJDTJg2VVU1QUfvOkLrjH02VVU1QZDw\nO0JpsVI2VVU1QdnxPEKVxi42VVU1QSPzPULEuhA2VVU1QWz0PkL9R+81VVU1QbX1P0JNdcU1\nVVU1Qf/2QEKOqaI1VVU1QUj4QUL1w4U1VVU1QZH5QkJHn1s1VVU1Qdv6Q0LR+jM1VVU1QST8\nREKePBM1VVU1QW39RUKee/A0VVU1Qbf+RkLZDMQ0VVU1QQAASEKvjJ80AAABAVVVNUEAAAAA\nxxqGOVVVNUGqpIA+zvaZOVVVNUGqpAA/JnWwOVVVNUH/9kA/2+LJOVVVNUGqpIA/+pPmOVVV\nNUHUzaA/9XEDOlVVNUH/9sA/55oVOlVVNUEpIOE/b/opOlVVNUGqpABAXspAOlVVNUE/uRBA\n20haOlVVNUHUzSBAhbh2OlVVNUFp4jBARzCLOlVVNUH/9kBAZcacOlVVNUGUC1FA2UawOlVV\nNUEpIGFAOtzFOlVVNUG+NHFAarPdOlVVNUGqpIBAjvv3OlVVNUH0rohA/3IKO1VVNUE/uZBA\nElMaO1VVNUGKw5hAr7grO1VVNUHUzaBAaL8+O1VVNUEf2KhAnINTO1VVNUFp4rBAUSJqO1VV\nNUG07LhAi1yBO1VVNUH/9sBA7bKOO1VVNUFJAclAXSOdO1VVNUGUC9FA6bysO1VVNUHfFdlA\ngY69O1VVNUEpIOFA2abPO1VVNUF0KulARhTjO1VVNUG+NPFAnuT3O1VVNUEJP/lAhxIHPFVV\nNUGqpABB+vASPFVVNUHPqQRBXJMfPFVVNUH0rghBzf4sPFVVNUEatAxByTc7PFVVNUE/uRBB\nC0JKPFVVNUFkvhRBeiBaPFVVNUGKwxhBEtVqPFVVNUGvyBxBzmB8PFVVNUHUzSBByWGHPFVV\nNUH60iRBDf6QPFVVNUEf2ChB7wObPFVVNUFE3SxBhHGlPFVVNUFp4jBBMkSwPFVVNUGP5zRB\npHi7PFVVNUG07DhBzArHPFVVNUHZ8TxB1vXSPFVVNUH/9kBBLDTfPFVVNUEk/ERBb7/rPFVV\nNUFJAUlBe5D4PFVVNUFvBk1BtM8CPVVVNUGUC1FBxXEJPVVVNUG5EFVBvikQPVVVNUHfFVlB\nlPIWPVVVNUEEG11B5MYdPVVVNUEpIGFB/6AkPVVVNUFOJWVB6norPVVVNUF0KmlBbU4yPVVV\nNUGZL21BFRU5PVVVNUG+NHFBQsg/PVVVNUHkOXVBL2FGPVVVNUEJP3lB/dhMPVVVNUEuRH1B\nwChTPVVVNUGqpIBBiklZPVVVNUE8p4JBdTRfPVVVNUHPqYRBt+JkPVVVNUFirIZBpU1qPVVV\nNUH0rohByG5vPVVVNUGHsYpB5z90PVVVNUEatIxBErt4PVVVNUGsto5BsNp8PVVVNUE/uZBB\nxUyAPVVVNUHSu5JBa/mBPVVVNUFkvpRBInGDPVVVNUH3wJZB/7GEPVVVNUGKw5hBX7qFPVVV\nNUEcxppB5YiGPVVVNUGvyJxBgByHPVVVNUFCy55Ba3SHPVVVNUHUzaBBMZCHPVVVNUFn0KJB\nrm+HPVVVNUH60qRBDBOHPVVVNUGM1aZByHqGPVVVNUEf2KhBqqeFPVVVNUGy2qpBzJqEPVVV\nNUFE3axBjlWDPVVVNUHX365Bm9mBPVVVNUFp4rBB4iiAPVVVNUH85LJBIYt8PVVVNUGP57RB\nHmR4PVVVNUEh6rZB/OFzPVVVNUG07LhBWwpvPVVVNUFH77pBL+NpPVVVNUHZ8bxBunJkPVVV\nNUFs9L5Bdb9ePVVVNUH/9sBBDtBYPVVVNUGR+cJBU6tSPVVVNUEk/MRBKVhMPVVVNUG3/sZB\ngN1FPVVVNUFJAclBREI/PVVVNUHcA8tBUI04PVVVNUFvBs1BaMUxPVVVNUEBCc9BKfEqPVVV\nNUGUC9FBARckPVVVNUEnDtNBJT0dPVVVNUG5ENVBiGkWPVVVNUFME9dB1aEPPVVVNUHfFdlB\nZ+sIPVVVNUFxGNtBQ0sCPVVVNUEEG91BKYz3PFVVNUGXHd9BU8DqPFVVNUEpIOFB3DrePFVV\nNUG8IuNB2gLSPFVVNUFOJeVBnB7GPFVVNUHhJ+dBqZO6PFVVNUF0KulBw2avPFVVNUEGLetB\n7JukPFVVNUGZL+1BaDaaPFVVNUEsMu9BxDiQPFVVNUG+NPFB3qSGPFVVNUFRN/NB2Pd6PFVV\nNUHkOfVBCX1pPFVVNUF2PPdBVNlYPFVVNUEJP/lBqgtJPFVVNUGcQftB+hE6PFVVNUEuRP1B\n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\nAACEQd8V2UCBjr07AACEQSkg4UDZps87AACEQXQq6UBGFOM7AACEQb408UCe5Pc7AACEQQk/\n+UCHEgc8AACEQaqkAEH68BI8AACEQc+pBEFckx88AACEQfSuCEHN/iw8AACEQRq0DEHJNzs8\nAACEQT+5EEELQko8AACEQWS+FEF6IFo8AACEQYrDGEES1Wo8AACEQa/IHEHOYHw8AACEQdTN\nIEHJYYc8AACEQfrSJEEN/pA8AACEQR/YKEHvA5s8AACEQUTdLEGEcaU8AACEQWniMEEyRLA8\nAACEQY/nNEGkeLs8AACEQbTsOEHMCsc8AACEQdnxPEHW9dI8AACEQf/2QEEsNN88AACEQST8\nREFvv+s8AACEQUkBSUF7kPg8AACEQW8GTUG0zwI9AACEQZQLUUHFcQk9AACEQbkQVUG+KRA9\nAACEQd8VWUGU8hY9AACEQQQbXUHkxh09AACEQSkgYUH/oCQ9AACEQU4lZUHqeis9AACEQXQq\naUFtTjI9AACEQZkvbUEVFTk9AACEQb40cUFCyD89AACEQeQ5dUEvYUY9AACEQQk/eUH92Ew9\nAACEQS5EfUHAKFM9AACEQaqkgEGKSVk9AACEQTyngkF1NF89AACEQc+phEG34mQ9AACEQWKs\nhkGlTWo9AACEQfSuiEHIbm89AACEQYexikHnP3Q9AACEQRq0jEESu3g9AACEQay2jkGw2nw9\nAACEQT+5kEHFTIA9AACEQdK7kkFr+YE9AACEQWS+lEEicYM9AACEQffAlkH/sYQ9AACEQYrD\nmEFfuoU9AACEQRzGmkHliIY9AACEQa/InEGAHIc9AACEQULLnkFrdIc9AACEQdTNoEExkIc9\nAACEQWfQokGub4c9AACEQfrSpEEME4c9AACEQYzVpkHIeoY9AACEQR/YqEGqp4U9AACEQbLa\nqkHMmoQ9AACEQUTdrEGOVYM9AACEQdffrkGb2YE9AACEQWnisEHiKIA9AACEQfzkskEhi3w9\nAACEQY/ntEEeZHg9AACEQSHqtkH84XM9AACEQbTsuEFbCm89AACEQUfvukEv42k9AACEQdnx\nvEG6cmQ9AACEQWz0vkF1v149AACEQf/2wEEO0Fg9AACEQZH5wkFTq1I9AACEQST8xEEpWEw9\nAACEQbf+xkGA3UU9AACEQUkByUFEQj89AACEQdwDy0FQjTg9AACEQW8GzUFoxTE9AACEQQEJ\n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\nrUFvBk1BtM8CPVVVrUGUC1FBxXEJPVVVrUG5EFVBvikQPVVVrUHfFVlBlPIWPVVVrUEEG11B\n5MYdPVVVrUEpIGFB/6AkPVVVrUFOJWVB6norPVVVrUF0KmlBbU4yPVVVrUGZL21BFRU5PVVV\nrUG+NHFBQsg/PVVVrUHkOXVBL2FGPVVVrUEJP3lB/dhMPVVVrUEuRH1BwChTPVVVrUGqpIBB\niklZPVVVrUE8p4JBdTRfPVVVrUHPqYRBt+JkPVVVrUFirIZBpU1qPVVVrUH0rohByG5vPVVV\nrUGHsYpB5z90PVVVrUEatIxBErt4PVVVrUGsto5BsNp8PVVVrUE/uZBBxUyAPVVVrUHSu5JB\na/mBPVVVrUFkvpRBInGDPVVVrUH3wJZB/7GEPVVVrUGKw5hBX7qFPVVVrUEcxppB5YiGPVVV\nrUGvyJxBgByHPVVVrUFCy55Ba3SHPVVVrUHUzaBBMZCHPVVVrUFn0KJBrm+HPVVVrUH60qRB\nDBOHPVVVrUGM1aZByHqGPVVVrUEf2KhBqqeFPVVVrUGy2qpBzJqEPVVVrUFE3axBjlWDPVVV\nrUHX365Bm9mBPVVVrUFp4rBB4iiAPVVVrUH85LJBIYt8PVVVrUGP57RBHmR4PVVVrUEh6rZB\n/OFzPVVVrUG07LhBWwpvPVVVrUFH77pBL+NpPVVVrUHZ8bxBunJkPVVVrUFs9L5Bdb9ePVVV\nrUH/9sBBDtBYPVVVrUGR+cJBU6tSPVVVrUEk/MRBKVhMPVVVrUG3/sZBgN1FPVVVrUFJAclB\nREI/PVVVrUHcA8tBUI04PVVVrUFvBs1BaMUxPVVVrUEBCc9BKfEqPVVVrUGUC9FBARckPVVV\nrUEnDtNBJT0dPVVVrUG5ENVBiGkWPVVVrUFME9dB1aEPPVVVrUHfFdlBZ+sIPVVVrUFxGNtB\nQ0sCPVVVrUEEG91BKYz3PFVVrUGXHd9BU8DqPFVVrUEpIOFB3DrePFVVrUG8IuNB2gLSPFVV\nrUFOJeVBnB7GPFVVrUHhJ+dBqZO6PFVVrUF0KulBw2avPFVVrUEGLetB7JukPFVVrUGZL+1B\naDaaPFVVrUEsMu9BxDiQPFVVrUG+NPFB3qSGPFVVrUFRN/NB2Pd6PFVVrUHkOfVBCX1pPFVV\nrUF2PPdBVNlYPFVVrUEJP/lBqgtJPFVVrUGcQftB+hE6PFVVrUEuRP1BTekrPFVVrUHBRv9B\n1o0ePFVVrUGqpABCDfsRPFVVrUHzpQFCxisGPFVVrUE8pwJCgjT2O1VVrUGGqANCj4DhO1VV\nrUHPqQRCdi7OO1VVrUEYqwVCVTC8O1VVrUFirAZCz3erO1VVrUGrrQdCK/abO1VVrUH0rghC\nc5yNO1VVrUE+sAlCm1uAO1VVrUGHsQpCJ0loO1VVrUHQsgtC0dBRO1VVrUEatAxCrzA9O1VV\nrUFjtQ1CxksqO1VVrUGstg5CxwUZO1VVrUH2tw9CMEMJO1VVrUE/uRBCytL1OlVVrUGIuhFC\nir3bOlVVrUHSuxJCdxXEOlVVrUEbvRNClauuOlVVrUFkvhRCMVObOlVVrUGuvxVC5eGJOlVV\nrUH3wBZCQV90OlVVrUFAwhdCUy1YOlVVrUGKwxhCLOc+OlVVrUHTxBlChkooOlVVrUEcxhpC\nlBkUOlVVrUFmxxtC2xoCOlVVrUGvyBxCIjLkOVVVrUH4yR1C6cXHOVVVrUFCyx5COpauOVVV\nrUGLzB9CnE+YOVVVrUHUzSBCh6WEOVVVrUEezyFCD6RmOVVVrUFn0CJCpSpIOVVVrUGw0SNC\nzWotOVVVrUH60iRCSfsVOVVVrUFD1CVC4nwBOVVVrUGM1SZCUjPfOFVVrUHW1idChgjAOFVV\nrUEf2ChCbO6kOFVVrUFo2SlCiWiNOFVVrUGy2ipCOg9yOFVVrUH72ytC7dBOOFVVrUFE3SxC\ntGUwOFVVrUGO3i1C9TAWOFVVrUHX3y5CEVD/N1VVrUEg4S9C56DYN1VVrUFp4jBCiHy3N1VV\nrUGz4zFCGiWbN1VVrUH85DJCCvSCN1VVrUFF5jNCC69cN1VVrUGP5zRCWKA5N1VVrUHY6DVC\n8N0bN1VVrUEh6jZCuqYCN1VVrUFr6zdCR6baNlVVrUG07DhCIqS2NlVVrUH97TlCQ0yYNlVV\nrUFH7zpC64x9NlVVrUGQ8DtCabFSNlVVrUHZ8TxClcYuNlVVrUEj8z1CxLoQNlVVrUFs9D5C\n/UfvNVVVrUG19T9CTXXFNVVVrUH/9kBCjqmiNVVVrUFI+EFC9cOFNVVVrUGR+UJCR59bNVVV\nrUHb+kNC0fozNVVVrUEk/ERCnjwTNVVVrUFt/UVCnnvwNFVVrUG3/kZC2QzENFVVrUEAAEhC\nr4yfNAAAAQFVVa1BAAAAAMcahjlVVa1BqqSAPs72mTlVVa1BqqQAPyZ1sDlVVa1B//ZAP9vi\nyTlVVa1BqqSAP/qT5jlVVa1B1M2gP/VxAzpVVa1B//bAP+eaFTpVVa1BKSDhP2/6KTpVVa1B\nqqQAQF7KQDpVVa1BP7kQQNtIWjpVVa1B1M0gQIW4djpVVa1BaeIwQEcwizpVVa1B//ZAQGXG\nnDpVVa1BlAtRQNlGsDpVVa1BKSBhQDrcxTpVVa1BvjRxQGqz3TpVVa1BqqSAQI779zpVVa1B\n9K6IQP9yCjtVVa1BP7mQQBJTGjtVVa1BisOYQK+4KztVVa1B1M2gQGi/PjtVVa1BH9ioQJyD\nUztVVa1BaeKwQFEiajtVVa1BtOy4QItcgTtVVa1B//bAQO2yjjtVVa1BSQHJQF0jnTtVVa1B\nlAvRQOm8rDtVVa1B3xXZQIGOvTtVVa1BKSDhQNmmzztVVa1BdCrpQEYU4ztVVa1BvjTxQJ7k\n9ztVVa1BCT/5QIcSBzxVVa1BqqQAQfrwEjxVVa1Bz6kEQVyTHzxVVa1B9K4IQc3+LDxVVa1B\nGrQMQck3OzxVVa1BP7kQQQtCSjxVVa1BZL4UQXogWjxVVa1BisMYQRLVajxVVa1Br8gcQc5g\nfDxVVa1B1M0gQclhhzxVVa1B+tIkQQ3+kDxVVa1BH9goQe8DmzxVVa1BRN0sQYRxpTxVVa1B\naeIwQTJEsDxVVa1Bj+c0QaR4uzxVVa1BtOw4QcwKxzxVVa1B2fE8Qdb10jxVVa1B//ZAQSw0\n3zxVVa1BJPxEQW+/6zxVVa1BSQFJQXuQ+DxVVa1BbwZNQbTPAj1VVa1BlAtRQcVxCT1VVa1B\nuRBVQb4pED1VVa1B3xVZQZTyFj1VVa1BBBtdQeTGHT1VVa1BKSBhQf+gJD1VVa1BTiVlQep6\nKz1VVa1BdCppQW1OMj1VVa1BmS9tQRUVOT1VVa1BvjRxQULIPz1VVa1B5Dl1QS9hRj1VVa1B\nCT95Qf3YTD1VVa1BLkR9QcAoUz1VVa1BqqSAQYpJWT1VVa1BPKeCQXU0Xz1VVa1Bz6mEQbfi\nZD1VVa1BYqyGQaVNaj1VVa1B9K6IQchubz1VVa1Bh7GKQec/dD1VVa1BGrSMQRK7eD1VVa1B\nrLaOQbDafD1VVa1BP7mQQcVMgD1VVa1B0ruSQWv5gT1VVa1BZL6UQSJxgz1VVa1B98CWQf+x\nhD1VVa1BisOYQV+6hT1VVa1BHMaaQeWIhj1VVa1Br8icQYAchz1VVa1BQsueQWt0hz1VVa1B\n1M2gQTGQhz1VVa1BZ9CiQa5vhz1VVa1B+tKkQQwThz1VVa1BjNWmQch6hj1VVa1BH9ioQaqn\nhT1VVa1BstqqQcyahD1VVa1BRN2sQY5Vgz1VVa1B19+uQZvZgT1VVa1BaeKwQeIogD1VVa1B\n/OSyQSGLfD1VVa1Bj+e0QR5keD1VVa1BIeq2Qfzhcz1VVa1BtOy4QVsKbz1VVa1BR++6QS/j\naT1VVa1B2fG8QbpyZD1VVa1BbPS+QXW/Xj1VVa1B//bAQQ7QWD1VVa1BkfnCQVOrUj1VVa1B\nJPzEQSlYTD1VVa1Bt/7GQYDdRT1VVa1BSQHJQURCPz1VVa1B3APLQVCNOD1VVa1BbwbNQWjF\nMT1VVa1BAQnPQSnxKj1VVa1BlAvRQQEXJD1VVa1BJw7TQSU9HT1VVa1BuRDVQYhpFj1VVa1B\nTBPXQdWhDz1VVa1B3xXZQWfrCD1VVa1BcRjbQUNLAj1VVa1BBBvdQSmM9zxVVa1Blx3fQVPA\n6jxVVa1BKSDhQdw63jxVVa1BvCLjQdoC0jxVVa1BTiXlQZwexjxVVa1B4SfnQamTujxVVa1B\ndCrpQcNmrzxVVa1BBi3rQeybpDxVVa1BmS/tQWg2mjxVVa1BLDLvQcQ4kDxVVa1BvjTxQd6k\nhjxVVa1BUTfzQdj3ejxVVa1B5Dn1QQl9aTxVVa1Bdjz3QVTZWDxVVa1BCT/5QaoLSTxVVa1B\nnEH7QfoROjxVVa1BLkT9QU3pKzxVVa1BwUb/QdaNHjxVVa1BqqQAQg37ETxVVa1B86UBQsYr\nBjxVVa1BPKcCQoI09jtVVa1BhqgDQo+A4TtVVa1Bz6kEQnYuzjtVVa1BGKsFQlUwvDtVVa1B\nYqwGQs93qztVVa1Bq60HQiv2mztVVa1B9K4IQnOcjTtVVa1BPrAJQptbgDtVVa1Bh7EKQidJ\naDtVVa1B0LILQtHQUTtVVa1BGrQMQq8wPTtVVa1BY7UNQsZLKjtVVa1BrLYOQscFGTtVVa1B\n9rcPQjBDCTtVVa1BP7kQQsrS9TpVVa1BiLoRQoq92zpVVa1B0rsSQncVxDpVVa1BG70TQpWr\nrjpVVa1BZL4UQjFTmzpVVa1Brr8VQuXhiTpVVa1B98AWQkFfdDpVVa1BQMIXQlMtWDpVVa1B\nisMYQiznPjpVVa1B08QZQoZKKDpVVa1BHMYaQpQZFDpVVa1BZscbQtsaAjpVVa1Br8gcQiIy\n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"}]},"context":{"shiny":false,"rmarkdown":null},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG) || defined(USE_ENVMAP)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n// USE_ENVMAP implies NEEDS_VNORMAL\n\n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n\n#ifdef USE_ENVMAP\n  vReflection = normalize(reflect(vPosition.xyz/vPosition.w, \n                        normalize(vNormal.xyz/vNormal.w)));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n\n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    // Simulate two-sided lighting\n    if (n.z < 0.0)\n      n = -n;\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i]) {\n        if (finite[i]) {\n          lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n        } else {\n          lightdir = (mvMatrix * vec4(lightdir, 0.)).xyz;\n        }\n      }\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n\n// These calculations use the definitions from \n// https://docs.gl/gl3/glTexEnv\n\n#ifdef USE_ENVMAP\n    float m = 2.0 * sqrt(dot(vReflection, vReflection) + 2.0*vReflection.z + 1.0);\n    vec4 textureColor = texture2D(uSampler, vReflection.xy / m + vec2(0.5, 0.5));\n#else\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n#endif\n\n#ifdef TEXTURE_rgb\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(textureColor.rgb, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*vec4(textureColor.rgb, 1.);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb, lighteffect.a);\n#endif\n\n#endif //TEXTURE_rgb\n        \n#ifdef TEXTURE_rgba\n\n#ifdef TEXMODE_replace\n// already done\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*textureColor;\n#endif\n\n#ifdef TEXMODE_decal\n    textureColor = vec4((1. - textureColor.a)*lighteffect.rgb) +\n                     textureColor.a*textureColor.rgb, \n                     lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n    \n#endif //TEXTURE_rgba\n    \n#ifdef TEXTURE_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(lighteffect.rgb, luminance);\n#endif \n\n#if defined(TEXMODE_modulate) || defined(TEXMODE_blend) || defined(TEXMODE_add)\n    textureColor = vec4(lighteffect.rgb, lighteffect.a*luminance);\n#endif\n \n#endif // TEXTURE_alpha\n    \n// The TEXTURE_luminance values are not from that reference    \n#ifdef TEXTURE_luminance\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, lighteffect.a);\n#endif\n\n#endif // TEXTURE_luminance\n \n    \n#ifdef TEXTURE_luminance_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, textureColor.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n\n#endif\n\n#endif // TEXTURE_luminance_alpha\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true},"fastTransparency":true},"evals":[],"jsHooks":[]}</script>
	</body>
</html>
</div></div>
</div>
<p>Now, the degree to which this is a <em>good</em> model is not something we are concerned with at this moment. But we should be thinking of this as our proposed <em>data generating process</em>. If the data appears to adhere to this model, then we can assume that we have capture some element of how the data values came to be. The better the model fit, the more confidence we have that this conceptualisation of MPG as a normal random variate is reflective of reality.</p>
<p>The key thing to understand here is that we have now created a <em>model of the observed variance</em> for <code class="docutils literal notranslate"><span class="pre">mpg</span></code>. In the previous section, we simply calculated the variance without any reference to a probability distribution. This was not a model, it was simply a quantification of what we could see in the data. By adding the normal distribution, we have turned this observation into a <em>model</em>. This is to say that we have a mathematical description of where the data comes from and why it varies the way it does. We have created a proposition for the <em>data generating process</em> and in doing so have condensed all the information within the data into two key number: the mean of the distribution and the variance of the distribution. Taken together, we have proposed these two numbers explain everything that we can see. The mean gives us some universal truth that exists across every measurement of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> and the variance tells us how much we expect measured values of <code class="docutils literal notranslate"><span class="pre">mpg</span></code> to deviate from this universal truth.</p>
<div class="math notranslate nohighlight">
\[
y_{i} \sim \mathcal{N}\left(\mu,\sigma^{2}\right) 
\]</div>
<p>or, equivalently, as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
    y_{i}           &amp;= \mu + \epsilon_{i}                       \\ 
    \epsilon_{i}    &amp;\sim \mathcal{N}\left(0,\sigma^{2}\right). \\
\end{align*}
\end{split}\]</div>
<aside class="topic">
<p class="topic-title">Section Summary</p>
<p>In this section, we have explored the general framework under which the vast majority of analyses in this course will be based.</p>
</aside>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="constant-foot" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>This may seem a bit of a stretch, as you might think it would be more reasonable to assume that the parameters of a population may shift around over time. This is actually one of the assumptions that differs between classical and Bayesian methods, as we will see later on the course. However, referring back to the idea of a <em>model</em>, this is a useful simplification that serves to make the mathematics easier and the model more tractable.</p>
</aside>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="2.prob-random-vars.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Probability and Random Variables</p>
      </div>
    </a>
    <a class="right-next"
       href="4.maximum-likelihood.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Maximum Likelihood Estimation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-a-model">Defining a Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parametric-models">Parametric Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-analogy-of-the-shadow">The Analogy of the Shadow</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#elements-of-a-model">Elements of a Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-population-distribution">The Population Distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-mean-function">The Mean Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-variance-function">The Variance Function</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-modelling-process">The Modelling Process</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-models-and-the-normal-distribution">Linear Models and the Normal Distribution</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr George Farmer & Dr Martyn McFarquhar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>